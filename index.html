/**
 * Google Apps Script to automatically convert team names in Google Sheets
 * to match FlashLive API format
 * 
 * Instructions:
 * 1. Open your Google Sheet
 * 2. Go to Extensions > Apps Script
 * 3. Delete any existing code
 * 4. Paste this entire script
 * 5. Save the script
 * 6. The script will run automatically whenever the sheet is edited
 */

// Copa Sudamericana specific team name mappings
const COPA_SUDAMERICANA_MAP = {
  'Independiente del Valle': 'Ind. del Valle (Ecu)',
  'Atlético Mineiro': 'Atletico-MG (Bra)',
  'Atletico Mineiro': 'Atletico-MG (Bra)',
  'Universidad Chile': 'U. De Chile (Chi)',
  'U. De Chile': 'U. De Chile (Chi)',
  'Lanús': 'Lanus (Arg)',
  'Lanus': 'Lanus (Arg)',
  'Alianza Lima': 'Alianza Lima (Per)',
  'Bolivar': 'Bolivar (Bol)',
  'Once Caldas': 'Once Caldas (Col)',
  'Central Córdoba': 'Central Cordoba (Arg)',
  'Central Cordoba': 'Central Cordoba (Arg)',
  'Godoy Cruz': 'Godoy Cruz (Arg)',
  'Independiente': 'Independiente (Arg)',
  'U. Católica': 'U. Catolica (Ecu)',
  'U. Catolica': 'U. Catolica (Ecu)',
  'Cienciano': 'Cienciano (Per)',
  'América de Cali': 'America De Cali (Col)',
  'America De Cali': 'America De Cali (Col)',
  'Mushuc Runa': 'Mushuc Runa (Ecu)',
  'Huracán': 'Huracan (Arg)',
  'Huracan': 'Huracan (Arg)',
  'Bucaramanga': 'Bucaramanga (Col)',
  'Guarani': 'Guarani (Par)',
  'Gremio': 'Gremio (Bra)',
  'SA Bulo Bulo': 'SA Bulo Bulo (Bol)',
  'Palestino': 'Palestino (Chi)',
  'Bahia': 'Bahia (Bra)',
  'Vasco': 'Vasco (Bra)',
  'Cerro Largo': 'Cerro Largo (Uru)',
  'Boston River': 'Boston River (Uru)',
  'Nacional Potosí': 'Nacional Potosi (Bol)',
  'Nacional Potosi': 'Nacional Potosi (Bol)',
  'Corinthians': 'Corinthians (Bra)',
  'Racing Montevideo': 'Racing Montevideo (Uru)',
  'Grau': 'Grau (Per)',
  'Sp. Luqueño': 'Sp. Luqueno (Par)',
  'Sp. Luqueno': 'Sp. Luqueno (Par)',
  'Cruzeiro': 'Cruzeiro (Bra)',
  'Unión de Santa Fe': 'Union de Santa Fe (Arg)',
  'Union de Santa Fe': 'Union de Santa Fe (Arg)',
  'Fluminense': 'Fluminense (Bra)',
  'U. Española': 'U. Espanola (Chi)',
  'U. Espanola': 'U. Espanola (Chi)',
  'GV San José': 'GV San Jose (Bol)',
  'GV San Jose': 'GV San Jose (Bol)',
  'FBC Melgar': 'FBC Melgar (Per)',
  'Puerto Cabello': 'Puerto Cabello (Ven)',
  'Caracas': 'Caracas (Ven)',
  'Deportes Iquique': 'Deportes Iquique (Chi)',
  'Defensa y Justicia': 'Defensa y Justicia (Arg)',
  'Vitória': 'Vitoria (Bra)',
  'Vitoria': 'Vitoria (Bra)'
};

// Copa Libertadores specific team name mappings
const COPA_LIBERTADORES_MAP = {
  // Add Copa Libertadores specific mappings here
  // These will be different from Copa Sudamericana mappings
  // Example: 'Boca Juniors': 'Boca Juniors (Arg)',
  // Add all Copa Libertadores teams with their specific FlashLive API names
};

// General team name mapping: Google Sheets format → FlashLive API format
const TEAM_NAME_MAP = {
  // LaLiga
  'Oviedo': 'R. Oviedo',
  'Espanyol': 'Espanyol',
  'Sevilla FC': 'Sevilla',
  'Mallorca': 'Mallorca',
  'Barcelona': 'Barcelona',
  'Girona': 'Girona',
  'Villarreal': 'Villarreal',
  'Real Betis': 'Betis',
  'Atlético Madrid': 'Atl. Madrid',
  'Osasuna': 'Osasuna',
  'Elche': 'Elche',
  'Athletic Bilbao': 'Ath Bilbao',
  'Celta Vigo': 'Celta Vigo',
  'Real Sociedad': 'Real Sociedad',
  'Levante': 'Levante',
  'Rayo Vallecano': 'Rayo Vallecano',
  'Getafe': 'Getafe',
  'Real Madrid': 'Real Madrid',
  'Alavés': 'Alaves',
  'Valencia': 'Valencia',
  
  // Premier League
  'Nottingham Forest': 'Nottingham',
  'Chelsea': 'Chelsea',
  'Crystal Palace': 'Crystal Palace',
  'AFC Bournemouth': 'Bournemouth',
  'Burnley': 'Burnley',
  'Leeds United': 'Leeds',
  'Sunderland': 'Sunderland',
  'Wolverhampton Wanderers': 'Wolves',
  'Manchester City': 'Manchester City',
  'Everton': 'Everton',
  'Brighton & Hove Albion': 'Brighton',
  'Newcastle United': 'Newcastle',
  'Fulham': 'Fulham',
  'Arsenal': 'Arsenal',
  'Tottenham Hotspur': 'Tottenham',
  'Aston Villa': 'Aston Villa',
  'Liverpool': 'Liverpool',
  'Manchester United': 'Manchester Utd',
  'West Ham United': 'West Ham',
  'Brentford': 'Brentford',
  
  // Ligue 1
  'LOSC': 'Lille',
  'PSG': 'PSG',
  'Paris FC': 'Paris FC',
  'Strasbourg': 'Strasbourg',
  'Marseille': 'Marseille',
  'Lyon': 'Lyon',
  'Monaco': 'Monaco',
  'Lens': 'Lens',
  'Toulouse': 'Toulouse',
  'Rennes': 'Rennes',
  'Brest': 'Brest',
  'Nice': 'Nice',
  'Lorient': 'Lorient',
  'Le Havre': 'Le Havre',
  'Nantes': 'Nantes',
  'Auxerre': 'Auxerre',
  'Angers': 'Angers',
  'Metz': 'Metz',
  
  // Bundesliga
  'FC Union Berlin': 'Union Berlin',
  'Borussia Mönchengladbach': 'B. Monchengladbach',
  'VfL Wolfsburg': 'Wolfsburg',
  'VfB Stuttgart': 'Stuttgart',
  '1. FC Heidenheim 1846': 'Heidenheim',
  'Werder Bremen': 'Werder Bremen',
  'Mainz': 'Mainz',
  'Bayer Leverkusen': 'Bayer Leverkusen',
  'FC Köln': 'FC Koln',
  'FC Augsburg': 'Augsburg',
  'RB Leipzig': 'RB Leipzig',
  'Hamburger SV': 'Hamburger SV',
  'Bayern Munich': 'Bayern Munich',
  'Borussia Dortmund': 'Dortmund',
  'SC Freiburg': 'Freiburg',
  'Eintracht Frankfurt': 'Eintracht Frankfurt',
  'FC St. Pauli': 'St. Pauli',
  'TSG Hoffenheim': 'Hoffenheim',
  
  // Serie A
  'Pisa': 'Pisa',
  'Hellas Verona': 'Verona',
  'Lecce': 'Lecce',
  'Sassuolo': 'Sassuolo',
  'Torino': 'Torino',
  'Napoli': 'Napoli',
  'AS Roma': 'AS Roma',
  'Inter Milan': 'Inter',
  'Como 1907': 'Como',
  'Juventus': 'Juventus',
  'Cagliari': 'Cagliari',
  'Bologna': 'Bologna',
  'Genoa': 'Genoa',
  'Parma': 'Parma',
  'Atalanta': 'Atalanta',
  'Lazio': 'Lazio',
  'AC Milan': 'AC Milan',
  'Fiorentina': 'Fiorentina',
  'Cremonese': 'Cremonese',
  'Udinese': 'Udinese',
  
  // MLS
  'Atlanta United FC': 'Atlanta Utd',
  'D.C. United': 'DC United',
  'Charlotte FC': 'Charlotte',
  'Philadelphia Union': 'Philadelphia Union',
  'FC Cincinnati': 'FC Cincinnati',
  'Montréal': 'CF Montreal',
  'Columbus Crew': 'Columbus Crew',
  'New York Red Bulls': 'New York Red Bulls',
  'Nashville SC': 'Nashville SC',
  'Inter Miami CF': 'Inter Miami',
  'New York City FC': 'New York City',
  'Seattle Sounders': 'Seattle Sounders',
  'Toronto FC': 'Toronto FC',
  'Orlando City': 'Orlando City',
  'Colorado Rapids': 'Colorado Rapids',
  'LAFC': 'Los Angeles FC',
  'Sporting Kansas City': 'Sporting Kansas City',
  'Houston Dynamo': 'Houston Dynamo',
  'Los Angeles Galaxy': 'Los Angeles Galaxy',
  'Minnesota United FC': 'Minnesota United',
  'Portland Timbers': 'Portland Timbers',
  'San Diego FC': 'San Diego FC',
  'St. Louis City SC': 'St. Louis City',
  'Real Salt Lake': 'Real Salt Lake',
  'Vancouver Whitecaps': 'Vancouver Whitecaps',
  'FC Dallas': 'FC Dallas',
  'San Jose Earthquakes': 'San Jose Earthquakes',
  'Austin FC': 'Austin FC',
  
  // UEFA Champions League
  'Olympiacos': 'Olympiacos Piraeus',
  'Barcelona': 'Barcelona',
  'Pafos': 'Pafos',
  'Kairat': 'Kairat Almaty',
  'Atletico Madrid': 'Atl. Madrid',
  'Arsenal': 'Arsenal',
  'Paris Saint-Germain': 'PSG',
  'Bayer Leverkusen': 'Bayer Leverkusen',
  'Borussia Dortmund': 'Dortmund',
  'Copenhagen': 'FC Copenhagen',
  'Benfica': 'Benfica',
  'Newcastle United': 'Newcastle',
  'Napoli': 'Napoli',
  'PSV Eindhoven': 'PSV',
  'Inter Milan': 'Inter',
  'Union Saint-Gilloise': 'Royale Union SG',
  'Manchester City': 'Manchester City',
  'Villarreal': 'Villarreal',
  'Qarabag': 'Qarabag',
  'Athletic Bilbao': 'Ath Bilbao',
  'Bodo/Glimt': 'Bodo/Glimt',
  'Galatasaray': 'Galatasaray',
  'Tottenham Hotspur': 'Tottenham',
  'Monaco': 'Monaco',
  'Slavia Prague': 'Slavia Prague',
  'Atalanta': 'Atalanta',
  'Ajax': 'Ajax',
  'Chelsea': 'Chelsea',
  'Liverpool': 'Liverpool',
  'Eintracht Frankfurt': 'Eintracht Frankfurt',
  'Club Brugge': 'Club Brugge KV',
  'Bayern Munich': 'Bayern Munich',
  'Juventus': 'Juventus',
  'Real Madrid': 'Real Madrid',
  'Marseille': 'Marseille',
  'Sporting CP': 'Sporting CP',
  
  // Liga MX
  'Puebla': 'Puebla',
  'Tijuana': 'Club Tijuana',
  'Tigres UANL': 'Tigres UANL',
  'Necaxa': 'Necaxa',
  'Atlético San Luis': 'Atl. San Luis',
  'Atlas': 'Atlas',
  'FC Juarez': 'Juarez',
  'Pachuca': 'Pachuca',
  'Toluca': 'Toluca',
  'Querétaro': 'Queretaro',
  'Santos Laguna': 'Santos Laguna',
  'León': 'Club Leon',
  'Monterrey': 'Monterrey',
  'Pumas UNAM': 'UNAM Pumas',
  'Chivas de Guadalajara': 'Guadalajara Chivas',
  'Mazatlán FC': 'Mazatlan FC',
  'Cruz Azul': 'Cruz Azul',
  'América': 'Club America',
  
  // NWSL
  'Houston Dash': 'Houston Dash W',
  'Kansas City Current': 'Kansas City Current W',
  'San Diego Wave': 'San Diego Wave W',
  'Chicago Stars': 'Chicago W',
  'NJ/NY Gotham FC': 'Gotham W',
  'Racing Louisville FC': 'Racing Louisville W',
  'Angel City': 'Angel City W',
  'Portland Thorns': 'Portland Thorns W',
  'Chicago Stars': 'Chicago W',
  'Kansas City Current': 'Kansas City Current W',
  'San Diego Wave': 'San Diego Wave W',
  'North Carolina Courage': 'North Carolina Courage W',
  'NJ/NY Gotham FC': 'Gotham W',
  'Orlando Pride': 'Orlando Pride W',
  'Seattle Reign': 'Seattle Reign W',
  'Portland Thorns': 'Portland Thorns W',
  'Houston Dash': 'Houston Dash W',
  'Racing Louisville FC': 'Racing Louisville W',
  'Bay FC': 'Bay FC W',
  'Utah Royals': 'Utah Royals W',
  'Washington Spirit': 'Washington Spirit W',
  
  // UEFA Europa League
  'Braga': 'Braga',
  'Red Star Belgrade': 'Crvena zvezda',
  'FCSB': 'FCSB',
  'Bologna': 'Bologna',
  'SK Brann': 'Brann',
  'Rangers': 'Rangers',
  'Fenerbahçe': 'Fenerbahce',
  'VfB Stuttgart': 'Stuttgart',
  'Feyenoord Rotterdam': 'Feyenoord',
  'Panathinaikos F.C.': 'Panathinaikos',
  'Go Ahead Eagles': 'G.A. Eagles',
  'Aston Villa': 'Aston Villa',
  'Genk': 'Genk',
  'Real Betis': 'Betis',
  'Lyon': 'Lyon',
  'Basel': 'Basel',
  'RB Salzburg': 'Salzburg',
  'Ferencvaros': 'Ferencvaros',
  'AS Roma': 'AS Roma',
  'FC Viktoria Plzeň': 'Plzen',
  'Celta Vigo': 'Celta Vigo',
  'Nice': 'Nice',
  'Celtic': 'Celtic',
  'SK Sturm Graz': 'Sturm Graz',
  'SC Freiburg': 'Freiburg',
  'FC Utrecht': 'Utrecht',
  'Lille': 'Lille',
  'PAOK Thessaloniki': 'PAOK',
  'Maccabi Tel-Aviv': 'Maccabi Tel Aviv',
  'FC Midtjylland': 'Midtjylland',
  'Malmö': 'Malmo FF',
  'Dinamo Zagreb': 'D. Zagreb',
  'Nottingham Forest': 'Nottingham',
  'Porto': 'FC Porto',
  'BSC Young Boys': 'Young Boys',
  'Ludogorets': 'Ludogorets',
  
  // UEFA Conference League
  'AEK Athens': 'AEK Athens',
  'Aberdeen': 'Aberdeen',
  'Breiðablik': 'Breiðablik',
  'KuPS': 'KuPS',
  'Drita': 'Drita',
  'Omonia Nicosia': 'Omonia Nicosia',
  'BK Häcken': 'BK Häcken',
  'Rayo Vallecano': 'Rayo Vallecano',
  'HNK Rijeka': 'HNK Rijeka',
  'Sparta Prague': 'Sparta Prague',
  'Shakhtar Donetsk': 'Shakhtar Donetsk',
  'Legia Warsaw': 'Legia Warsaw',
  'KF Shkëndija': 'KF Shkëndija',
  'Shelbourne FC': 'Shelbourne FC',
  'SK Rapid Wien': 'SK Rapid Wien',
  'Fiorentina': 'Fiorentina',
  'Strasbourg': 'Strasbourg',
  'Jagiellonia Białystok': 'Jagiellonia Białystok',
  'AZ Alkmaar': 'AZ Alkmaar',
  'Slovan Bratislava': 'Slovan Bratislava',
  'Crystal Palace': 'Crystal Palace',
  'AEK Larnaca': 'AEK Larnaca',
  'Hamrun Spartans': 'Hamrun Spartans',
  'Lausanne-Sport': 'Lausanne-Sport',
  'Lincoln Red Imps': 'Lincoln Red Imps',
  'Lech Poznań': 'Lech Poznań',
  'Mainz': 'Mainz',
  'HŠK Zrinjski Mostar': 'HŠK Zrinjski Mostar',
  'Shamrock Rovers': 'Shamrock Rovers',
  'Celje': 'Celje',
  'Samsunspor': 'Samsunspor',
  'Dynamo Kyiv': 'Dynamo Kyiv',
  'Universitatea Craiova': 'Universitatea Craiova',
  'Noah': 'Noah',
  'SK Sigma Olomouc': 'SK Sigma Olomouc',
  'Raków Częstochowa': 'Raków Częstochowa',
  
  // NCAAF
  'FIU': 'Florida International',
  'Louisiana Tech': 'Louisiana Tech',
  'Delaware': 'Delaware Fightin',
  'New Mexico State': 'New Mexico State',
  'Georgia State': 'Georgia State Panthers',
  'Dartmouth': 'Dartmouth',
  'Charlotte': 'Charlotte',
  'Virginia Tech': 'Virginia Tech',
  'Nevada': 'Nevada',
  'Sacramento State': 'Sacramento State',
  'Old Dominion': 'Old Dominion',
  'Kent State': 'Kent State',
  'Kansas': 'Kansas',
  'Nebraska': 'Nebraska',
  'Eastern Michigan': 'Eastern Michigan',
  'Ole Miss': 'Ole Miss',
  'Oklahoma': 'Oklahoma',
  'Purdue': 'Purdue',
  'Wake Forest': 'Wake Forest',
  'Memphis': 'Memphis',
  'Georgia Tech': 'Georgia Tech',
  'Indiana': 'Indiana',
  'North Carolina': 'North Carolina',
  'Yale': 'Yale',
  'Penn': 'Penn',
  'Pennsylvania': 'Pennsylvania',
  'Wagner': 'Wagner',
  'Princeton': 'Princeton',
  'Marist': 'Marist',
  'Davidson': 'Davidson',
  'Bucknell': 'Bucknell',
  'Arkansas': 'Arkansas',
  'Buffalo': 'Buffalo',
  'North Carolina Central': 'North Carolina Central',
  'Fordham': 'Fordham',
  'Valparaiso': 'Valparaiso',
  'Tennessee Tech': 'Tennessee Tech',
  'Stetson': 'Stetson',
  'Holy Cross': 'Holy Cross',
  'Cornell': 'Cornell',
  'Bethune-Cookman': 'Bethune-Cookman',
  'Youngstown State': 'Youngstown State',
  'West Georgia': 'West Georgia',
  'Tuskegee': 'Tuskegee',
  'South Dakota': 'South Dakota',
  'Norfolk State': 'Norfolk State',
  'Furman': 'Furman',
  'Charleston Southern': 'Charleston Southern',
  'Benedict': 'Benedict',
  'Tennessee State': 'Tennessee State',
  'Rice': 'Rice',
  'New Mexico': 'New Mexico',
  'Weber State': 'Weber State',
  'Prairie View A&M': 'Prairie View A&M',
  'Alcorn State': 'Alcorn State',
  'Southern Illinois': 'Southern Illinois',
  'Northern Colorado': 'Northern Colorado',
  'Mercer': 'Mercer',
  'Lindenwood': 'Lindenwood',
  'Houston Christian': 'Houston Christian',
  'Washington State': 'Washington State',
  'South Carolina': 'South Carolina',
  'Northern Illinois': 'Northern Illinois',
  'Iowa State': 'Iowa State',
  'Navy': 'Navy',
  'Washington': 'Washington Huskies',
  'Southern Miss': 'Southern Miss',
  'Central Michigan': 'Central Michigan',
  'Iowa': 'Iowa',
  'Vanderbilt': 'Vanderbilt',
  'Pittsburgh': 'Pittsburgh',
  'Fresno State': 'Fresno State',
  'Tulsa': 'Tulsa',
  'Miami-OH': 'Miami (Oh)',
  'Alabama State': 'Alabama State',
  'Howard': 'Howard',
  'Samford': 'Samford',
  'East Tennessee State': 'East Tennessee State',
  'Cincinnati': 'Cincinnati Bearcats',
  'Texas Tech': 'Texas Tech',
  'Idaho': 'Idaho',
  'North Dakota': 'North Dakota',
  'Nicholls': 'Nicholls',
  'Austin Peay': 'Austin Peay',
  'Mississippi State': 'Mississippi St.',
  'Southern': 'Southern',
  'Northwestern State': 'Northwestern State',
  'West Virginia': 'West Virginia',
  'Grambling State': 'Grambling State',
  'Idaho State': 'Idaho State',
  'Arkansas State': 'Arkansas State',
  'Troy': 'Troy',
  'Miami': 'Miami (FL)',
  'Oregon': 'Oregon',
  'East Texas A&M': 'East Texas A&M',
  'Louisville': 'Louisville',
  'Wyoming': 'Wyoming',
  'Michigan State': 'Michigan State',
  'LSU': 'LSU',
  'Kentucky': 'Kentucky',
  'Arizona State': 'Arizona State',
  'South Dakota State': 'South Dakota State',
  'Utah Tech': 'Utah Tech',
  'UT Rio Grande Valley': 'UT Rio Grande Valley',
  'Cal Poly': 'Cal Poly',
  'Utah': 'Utah',
  'Texas State': 'Texas State Bobcats',
  'Kennesaw State': 'Kennesaw State',
  'Middle Tennessee': 'Middle Tennessee St',
  'Missouri State': 'Missouri State',
  'Delaware State': 'Delaware State',
  'Coastal Carolina': 'Coastal Carolina',
  'UTSA': 'UTSA',
  'Brown': 'Brown',
  'Syracuse': 'Syracuse',
  'Northern Arizona': 'Northern Arizona',
  'Air Force': 'Air Force',
  'Clemson': 'Clemson',
  'North Texas': 'North Texas',
  'UConn': 'Connecticut',
  'Texas': 'Texas',
  'Columbia': 'Columbia',
  'Colorado': 'Colorado Buffaloes',
  'Bowling Green': 'Bowling Green',
  'Western Michigan': 'Western Michigan',
  'Boise State': 'Boise State',
  'NC State': 'North Carolina State',
  'Maryland': 'Maryland',
  'Auburn': 'Auburn',
  'South Alabama': 'South Alabama',
  'SMU': 'Southern Methodist',
  'Minnesota': 'Minnesota',
  'Mississippi Valley State': 'Mississippi Valley State',
  'Morgan State': 'Morgan State',
  'St. Thomas (MN)': 'St. Thomas',
  'Virginia Tech': 'Virginia Tech',
  'UNLV': 'UNLV Rebels',
  'Texas Southern': 'Texas Southern',
  'Montana': 'Montana',
  'Northern Iowa': 'Northern Iowa',
  'South Dakota State': 'South Dakota State',
  'Harvard': 'Harvard',
  'Alabama A&M': 'Alabama A&M',
  'Arkansas-Pine Bluff': 'Arkansas-Pine Bluff',
  'Liberty': 'Liberty Flames',
  'Florida': 'Florida Gators',
  'Stanford': 'Stanford',
  'North Dakota State': 'North Dakota State',
  'Eastern Washington': 'Eastern Washington',
  'UC Davis': 'UC Davis',
  'Murray State': 'Murray State',
  'Portland State': 'Portland State',
  'San Diego State': 'San Diego State',
  'Florida State': 'Florida State',
  'Oregon State': 'Oregon State',
  'San Jose State': 'San Jose State',
  'Akron': 'Akron',
  'Ohio': 'Ohio',
  'Toledo': 'Toledo',
  'Appalachian State': 'Appalachian State',
  'South Florida': 'South Florida',
  'UCF': 'UCF',
  'USC': 'USC',
  'Army': 'Army',
  'Mississippi State': 'Mississippi St.',
  'Temple': 'Temple',
  'WKU': 'Western Kentucky',
  'Boston College': 'Boston College',
  'Tennessee': 'Tennessee',
  'Illinois': 'Illinois',
  'UAB': 'UAB',
  'Louisiana': 'Louisiana-Lafayette',
  'Texas A&M': 'Texas A&M',
  'Missouri': 'Missouri',
  'Florida Atlantic': 'Florida Atlantic',
  'Colorado State': 'Colorado State Rams',
  'Virginia': 'Virginia',
  'California': 'California',
  'Hawaii': 'Hawaii',
  'Massachusetts': 'Massachusetts',
  'Ball State': 'Ball State',
  'Georgia Southern': 'Georgia Southern',
  'Tulane': 'Tulane',
  'Penn State': 'Penn State',
  'Michigan': 'Michigan',
  'Rutgers': 'Rutgers',
  'Baylor': 'Baylor',
  'UCLA': 'UCLA',
  'UTEP': 'UTEP',
  'Duke': 'Duke',
  'Jackson State': 'Jackson State',
  'Florida A&M': 'Florida A&M',
  'East Carolina': 'East Carolina',
  'Alabama': 'Alabama',
  'Georgia': 'Georgia',
  'Notre Dame': 'Notre Dame',
  'Ohio State': 'Ohio State',
  'Wisconsin': 'Wisconsin',
  'Sam Houston': 'Sam Houston State',
  'Montana State': 'Montana State',
  'Kansas State': 'Kansas State',
  'Oklahoma State': 'Oklahoma State',
  'Louisiana-Monroe': 'Louisiana-Monroe',
  'TCU': 'TCU',
  'BYU': 'Brigham Young',
  'Northwestern': 'Northwestern',
  'Houston': 'Houston',
  'Arizona': 'Arizona',
  'Marshall': 'Marshall',
  'James Madison': 'James Madison',
  'Jacksonville State': 'Jacksonville State',
  
  
  // Argentine Primera División
  'Estudiantes': 'Estudiantes L.P.',
  'Union de Santa Fe': 'Union de Santa Fe',
  'Unión de Santa Fe': 'Union de Santa Fe',
  'Unión Santa Fe': 'Union de Santa Fe',
  'Defensa y Justicia': 'Defensa y Justicia',
  'Argentinos Juniors': 'Argentinos Jrs',
  'Central Córdoba SdE': 'Central Cordoba',
  'Belgrano': 'Belgrano',
  'Barracas Central': 'Barracas Central',
  'Tigre': 'Tigre',
  'Racing Club': 'Racing Club',
  'Boca Juniors': 'Boca Juniors',
  'Banfield': 'Banfield',
  'Huracan': 'Huracan',
  'Huracán': 'Huracan',
  'Independiente Rivadavia': 'Ind. Rivadavia',
  'Newell\'s Old Boys': 'Newells Old Boys',
  'Aldosivi': 'Aldosivi',
  'Deportivo Riestra': 'Dep. Riestra',
  'Lanus (Arg)': 'Lanus',
  'Lanús': 'Lanus',
  'Vélez Sarsfield': 'Velez Sarsfield',
  'Rosario Central': 'Rosario Central',
  'River Plate': 'River Plate',
  'San Lorenzo': 'San Lorenzo',
  'San Martín San Juan': 'San Martin S.J.',
  'Atlético Tucumán': 'Atl. Tucuman',
  'Sarmiento': 'Sarmiento Junin',
  'Instituto': 'Instituto',
  'Talleres Córdoba': 'Talleres Cordoba',
  'Gimnasia La Plata': 'Gimnasia L.P.',
  'Platense': 'Platense',
  'Godoy Cruz': 'Godoy Cruz',
  'Independiente': 'Independiente',
  
  // Belgian Pro League
  'Union Saint-Gilloise': 'Royale Union SG',
  'Club Brugge': 'Club Brugge KV',
  'Anderlecht': 'Anderlecht',
  'Mechelen': 'KV Mechelen',
  'Sint-Truiden': 'St. Truiden',
  'Zulte-Waregem': 'Waregem',
  'Gent': 'Gent',
  'Genk': 'Genk',
  'Westerlo': 'Westerlo',
  'Standard Liège': 'St. Liege',
  'RAAL La Louvière': 'RAAL La Louviere',
  'Sporting Charleroi': 'Charleroi',
  'Cercle Brugge': 'Cercle Brugge KSV',
  'Antwerp': 'Antwerp',
  'OH Leuven': 'Leuven',
  'Dender': 'Dender',
  
  // Ligue 1
  'Olympique Marseille': 'Marseille',
  'PSG': 'PSG',
  'Strasbourg': 'Strasbourg',
  'Lens': 'Lens',
  'Olympique Lyonnais': 'Lyon',
  'Lille': 'Lille',
  'Monaco': 'Monaco',
  'Toulouse': 'Toulouse',
  'Rennes': 'Rennes',
  'Nice': 'Nice',
  'Paris': 'Paris FC',
  'Brest': 'Brest',
  'Lorient': 'Lorient',
  'Auxerre': 'Auxerre',
  'Nantes': 'Nantes',
  'Le Havre': 'Le Havre',
  'Angers SCO': 'Angers',
  'Metz': 'Metz',
  
  // EFL Championship
  'Coventry City': 'Coventry',
  'Middlesbrough': 'Middlesbrough',
  'Millwall': 'Millwall',
  'Bristol City': 'Bristol City',
  'Charlton Athletic': 'Charlton',
  'Stoke City': 'Stoke',
  'Hull City': 'Hull',
  'Leicester City': 'Leicester',
  'West Bromwich Albion': 'West Brom',
  'Preston North End': 'Preston',
  'Queens Park Rangers': 'QPR',
  'Birmingham City': 'Birmingham',
  'Ipswich Town': 'Ipswich',
  'Swansea City': 'Swansea',
  'Portsmouth': 'Portsmouth',
  'Watford': 'Watford',
  'Southampton': 'Southampton',
  'Derby County': 'Derby',
  'Wrexham': 'Wrexham',
  'Oxford United': 'Oxford Utd',
  'Sheffield United': 'Sheffield Utd',
  'Norwich City': 'Norwich',
  'Blackburn Rovers': 'Blackburn',
  'Sheffield Wednesday': 'Sheffield Wed',
  
  // Super Lig
  'Galatasaray': 'Galatasaray',
  'Trabzonspor': 'Trabzonspor',
  'Fenerbahçe': 'Fenerbahce',
  'Fenerbahce': 'Fenerbahce',
  'Gaziantep FK': 'Gaziantep',
  'Gaziantep': 'Gaziantep',
  'Göztepe': 'Goztepe',
  'Goztepe': 'Goztepe',
  'Samsunspor': 'Samsunspor',
  'Beşiktaş': 'Besiktas',
  'Besiktas': 'Besiktas',
  'Alanyaspor': 'Alanyaspor',
  'Konyaspor': 'Konyaspor',
  'Antalyaspor': 'Antalyaspor',
  'Kasımpaşa': 'Kasimpasa',
  'Kasimpasa': 'Kasimpasa',
  'Rizespor': 'Rizespor',
  'Gençlerbirliği': 'Genclerbirligi',
  'Genclerbirligi': 'Genclerbirligi',
  'Eyüpspor': 'Eyupspor',
  'Eyupspor': 'Eyupspor',
  'Kocaelispor': 'Kocaelispor',
  'İstanbul Başakşehir': 'Basaksehir',
  'Istanbul Basaksehir': 'Basaksehir',
  'Basaksehir': 'Basaksehir',
  'Kayserispor': 'Kayserispor',
  'Fatih Karagümrük': 'Karagumruk',
  'Fatih Karagumruk': 'Karagumruk',
  'Karagumruk': 'Karagumruk',
  
  // Brasileirão
  'Flamengo': 'Flamengo RJ',
  'Cruzeiro': 'Cruzeiro',
  'Mirassol': 'Mirassol',
  'Botafogo': 'Botafogo RJ',
  'Bahia': 'Bahia',
  'Fluminense': 'Fluminense',
  'Vasco da Gama': 'Vasco',
  'Vasco': 'Vasco',
  'São Paulo': 'Sao Paulo',
  'Sao Paulo': 'Sao Paulo',
  'RB Bragantino': 'Bragantino',
  'Bragantino': 'Bragantino',
  'Corinthians': 'Corinthians',
  'Grêmio': 'Gremio',
  'Gremio': 'Gremio',
  'Ceará': 'Ceara',
  'Ceara': 'Ceara',
  'Internacional': 'Internacional',
  'Atlético Mineiro': 'Atletico-MG',
  'Atletico Mineiro': 'Atletico-MG',
  'Atletico-MG': 'Atletico-MG',
  'Santos': 'Santos',
  'Vitória': 'Vitoria',
  'Vitoria': 'Vitoria',
  'Juventude': 'Juventude',
  'Fortaleza': 'Fortaleza',
  'Sport Recife': 'Sport Recife',
  'Palmeiras': 'Palmeiras',
  
  // USL Championship
  'Louisville City': 'Louisville City',
  'Charleston Battery': 'Charleston',
  'Hartford Athletic': 'Hartford Athletic',
  'Pittsburgh Riverhounds': 'Pittsburgh',
  'North Carolina': 'North Carolina',
  'Loudoun United': 'Loudoun',
  'Rhode Island': 'Rhode Island',
  'Detroit City': 'Detroit',
  'Indy Eleven': 'Indy Eleven',
  'Tampa Bay Rowdies': 'Tampa Bay',
  'Miami FC': 'Miami FC',
  'Birmingham City': 'Birmingham',
  'Birmingham Legion': 'Birmingham',
  'FC Tulsa': 'FC Tulsa',
  'New Mexico United': 'New Mexico',
  'Sacramento Republic': 'Sacramento Republic',
  'El Paso Locomotive': 'El Paso',
  'Phoenix Rising': 'Phoenix Rising',
  'San Antonio': 'San Antonio',
  'Colorado Springs': 'Colorado Springs',
  'Orange County SC': 'Orange County SC',
  'Lexington': 'Lexington',
  'Oakland Roots': 'Oakland Roots',
  'Monterey Bay': 'Monterey Bay',
  'Las Vegas Lights': 'Las Vegas Lights'
};

/**
 * This function runs automatically whenever the spreadsheet is edited
 */
function onEdit(e) {
  // Prevent infinite loops by checking if we're already processing
  if (PropertiesService.getScriptProperties().getProperty('processing') === 'true') {
    return;
  }
  
  try {
    PropertiesService.getScriptProperties().setProperty('processing', 'true');
    
    const sheet = e.source.getActiveSheet();
    const range = e.range;
    const sheetName = sheet.getName();
    
    // Get the edited cell value
    const editedValue = range.getValue();
    
    // Check if the edited value matches any team name in our map
    if (editedValue && typeof editedValue === 'string') {
      let mappedValue = null;
      
      // Apply league-specific mappings based on sheet name
      if (sheetName === 'CopaSudamericana') {
        mappedValue = COPA_SUDAMERICANA_MAP[editedValue.trim()];
      } else if (sheetName === 'CopaLibertadores') {
        mappedValue = COPA_LIBERTADORES_MAP[editedValue.trim()];
      } else {
        // Use general mapping for all other sheets
        mappedValue = TEAM_NAME_MAP[editedValue.trim()];
      }
      
      if (mappedValue && mappedValue !== editedValue) {
        // Replace with the FlashLive API format
        range.setValue(mappedValue);
        Logger.log(`Converted "${editedValue}" to "${mappedValue}" in sheet "${sheetName}"`);
      }
    }
  } finally {
    PropertiesService.getScriptProperties().setProperty('processing', 'false');
  }
}

/**
 * Manual function to convert ALL team names in the entire active sheet
 * Run this once after installing the script to convert existing data
 * Go to Extensions > Apps Script > Select "convertAllTeamNames" > Click Run
 */
function convertAllTeamNames() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const sheetName = sheet.getName();
  const dataRange = sheet.getDataRange();
  const values = dataRange.getValues();
  
  let changesCount = 0;
  
  // Determine which mapping to use based on sheet name
  let mappingToUse = TEAM_NAME_MAP;
  if (sheetName === 'CopaSudamericana') {
    mappingToUse = COPA_SUDAMERICANA_MAP;
  } else if (sheetName === 'CopaLibertadores') {
    mappingToUse = COPA_LIBERTADORES_MAP;
  }
  
  // Loop through all cells
  for (let row = 0; row < values.length; row++) {
    for (let col = 0; col < values[row].length; col++) {
      const cellValue = values[row][col];
      
      if (cellValue && typeof cellValue === 'string') {
        const mappedValue = mappingToUse[cellValue.trim()];
        
        if (mappedValue && mappedValue !== cellValue) {
          values[row][col] = mappedValue;
          changesCount++;
        }
      }
    }
  }
  
  // Write all changes back to the sheet at once (more efficient)
  if (changesCount > 0) {
    dataRange.setValues(values);
    SpreadsheetApp.getActiveSpreadsheet().toast(
      `Converted ${changesCount} team names to FlashLive API format`, 
      'Conversion Complete', 
      5
    );
    Logger.log(`Converted ${changesCount} team names in sheet "${sheetName}"`);
  } else {
    SpreadsheetApp.getActiveSpreadsheet().toast(
      'No team names needed conversion', 
      'Already Up to Date', 
      3
    );
  }
}

/**
 * Manual function to convert ALL team names in ALL sheets in the document
 * Run this once after installing the script to convert existing data across all sheets
 * Go to Extensions > Apps Script > Select "convertAllSheetsTeamNames" > Click Run
 */
function convertAllSheetsTeamNames() {
  const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  const sheets = spreadsheet.getSheets();
  let totalChanges = 0;
  let sheetsProcessed = 0;
  
  for (const sheet of sheets) {
    try {
      const sheetName = sheet.getName();
      const dataRange = sheet.getDataRange();
      const values = dataRange.getValues();
      let sheetChanges = 0;
      
      // Determine which mapping to use based on sheet name
      let mappingToUse = TEAM_NAME_MAP;
      if (sheetName === 'CopaSudamericana') {
        mappingToUse = COPA_SUDAMERICANA_MAP;
      } else if (sheetName === 'CopaLibertadores') {
        mappingToUse = COPA_LIBERTADORES_MAP;
      }
      
      // Loop through all cells in this sheet
      for (let row = 0; row < values.length; row++) {
        for (let col = 0; col < values[row].length; col++) {
          const cellValue = values[row][col];
          
          if (cellValue && typeof cellValue === 'string') {
            const mappedValue = mappingToUse[cellValue.trim()];
            
            if (mappedValue && mappedValue !== cellValue) {
              values[row][col] = mappedValue;
              sheetChanges++;
            }
          }
        }
      }
      
      // Write changes back to this sheet if any were made
      if (sheetChanges > 0) {
        dataRange.setValues(values);
        Logger.log(`Sheet "${sheetName}": Converted ${sheetChanges} team names`);
      }
      
      totalChanges += sheetChanges;
      sheetsProcessed++;
      
    } catch (error) {
      Logger.log(`Error processing sheet "${sheet.getName()}": ${error.message}`);
    }
  }
  
  // Show final results
  if (totalChanges > 0) {
    SpreadsheetApp.getActiveSpreadsheet().toast(
      `Converted ${totalChanges} team names across ${sheetsProcessed} sheets`, 
      'All Sheets Conversion Complete', 
      5
    );
    Logger.log(`Total: Converted ${totalChanges} team names across ${sheetsProcessed} sheets`);
  } else {
    SpreadsheetApp.getActiveSpreadsheet().toast(
      'No team names needed conversion across all sheets', 
      'All Sheets Already Up to Date', 
      3
    );
  }
}

/**
 * Manual function to convert team names in a specific range
 * Select the cells you want to convert, then run this function
 */
function convertSelectedRange() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const sheetName = sheet.getName();
  const range = sheet.getActiveRange();
  const values = range.getValues();
  
  let changesCount = 0;
  
  // Determine which mapping to use based on sheet name
  let mappingToUse = TEAM_NAME_MAP;
  if (sheetName === 'CopaSudamericana') {
    mappingToUse = COPA_SUDAMERICANA_MAP;
  } else if (sheetName === 'CopaLibertadores') {
    mappingToUse = COPA_LIBERTADORES_MAP;
  }
  
  // Loop through selected cells
  for (let row = 0; row < values.length; row++) {
    for (let col = 0; col < values[row].length; col++) {
      const cellValue = values[row][col];
      
      if (cellValue && typeof cellValue === 'string') {
        const mappedValue = mappingToUse[cellValue.trim()];
        
        if (mappedValue && mappedValue !== cellValue) {
          values[row][col] = mappedValue;
          changesCount++;
        }
      }
    }
  }
  
  // Write changes back
  if (changesCount > 0) {
    range.setValues(values);
    SpreadsheetApp.getActiveSpreadsheet().toast(
      `Converted ${changesCount} team names in selection`, 
      'Conversion Complete', 
      5
    );
  } else {
    SpreadsheetApp.getActiveSpreadsheet().toast(
      'No team names needed conversion in selection', 
      'Already Up to Date', 
      3
    );
  }
}

/**
 * Creates a custom menu when the spreadsheet is opened
 */
function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('Team Name Converter')
    .addItem('Convert All Team Names (Current Sheet)', 'convertAllTeamNames')
    .addItem('Convert All Team Names (ALL SHEETS)', 'convertAllSheetsTeamNames')
    .addItem('Convert Selected Range', 'convertSelectedRange')
    .addToUi();
}

