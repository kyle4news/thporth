<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="google-site-verification" content="VoA7EfXHDZCU-Em6FGijJneXQVJfMKXUFZNcGNew_i8" />
	  <script defer src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app-compat.js"></script>
<script defer src="https://www.gstatic.com/firebasejs/10.0.0/firebase-auth-compat.js"></script> <!-- ✅ NEW -->
<script defer src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore-compat.js"></script>
    <!-- Luxon for date/time handling - Deferred to improve page load performance -->
    <script defer src="https://cdn.jsdelivr.net/npm/luxon@3.x/build/global/luxon.min.js"></script>
	 <style>
      /* RESTORED: Original CSS for news tabs */
      .news-tab[data-tab="fantasy"],
      .news-tab[data-tab="transactions"],
      #fantasy-feed,
      #transactions-feed {
        display: none !important;
      }
    </style>
	  

    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WWK5WV7N');</script>
<!-- End Google Tag Manager -->

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-K8SHPNFM9Y"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-K8SHPNFM9Y');
</script>

    <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
    <!-- Preconnect to external domains for faster DNS resolution -->
    <link rel="preconnect" href="https://www.gstatic.com">
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://static.flashscore.com">
    <link rel="dns-prefetch" href="https://www.flashscore.com">
    <link rel="dns-prefetch" href="https://github.com">
    <link rel="dns-prefetch" href="https://raw.githubusercontent.com">
    <link rel="dns-prefetch" href="https://r2.thesportsdb.com">
    
    <meta name="description" content="Get the latest sports news, social buzz, and live scores for NFL, NBA, MLB, and more — all in one place.">
    <meta name="robots" content="index, follow" />
    <title>THPORTH | Breaking news. Highlights. Social. Videos.</title>
    
    <!-- Canonical URL to prevent mobile version indexing -->
    <link rel="canonical" href="https://thporth.com" />
    
    <!-- Immediate redirect for mobile subdomain (executes before page loads) -->
    <script>
      if (window.location.hostname === 'm.thporth.com') {
        window.location.replace('https://thporth.com' + window.location.pathname + window.location.search + window.location.hash);
      }
    </script>
    
    <!-- Additional meta tags to help with mobile/desktop versioning -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
   
<link rel="icon" type="image/png" href="THPORTH logo.png" />
  
    <link rel="canonical" href="https://www.thporth.com/" />
    
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.thporth.com/" />
<meta property="og:title" content="THPORTH | All the latest sports news" />
<meta property="og:description" content="Get the latest sports news, social buzz, and live scores for NFL, NBA, MLB, and more — all in one place." />
    <meta property="og:image" content="THPORTH logo.png" />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:url" content="https://www.thporth.com/" />
<meta name="twitter:title" content="THPORTH | All the latest sports news" />
<meta name="twitter:description" content="Get the latest sports news, social buzz, and live scores for NFL, NBA, MLB, and more — all in one place." />
    <meta name="twitter:image" content="THPORTH logo.png" />
   <style>
  /* ────────────────────────────────────────────────────────── */
  /* Global Resets                        */
  /* ────────────────────────────────────────────────────────── */
  html,
  body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: Arial, sans-serif;
    background-color: #151515;
    color: white;
    overflow: hidden; /* Prevent all page-level scrolling - only columns scroll */
    zoom: 1;
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
  }

  ul,
  li {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .spacer-line {
    height: 10px;
  }

/* --- CSS FROM testing_testing-3.html (Live Games Viewer) --- */
.league-section {
    margin-top: 1px !important;
    margin-bottom: 1px !important;
    border-top: 1px solid transparent;
    border-bottom: 1px solid transparent;
}
.league-title { /* Renamed from .league-header to .league-title for clarity within this context */
    font-size: 14px;
    margin-bottom: 20px;
    border-bottom: 2px solid #555;
    padding-bottom: 0.3rem;
    padding-left: 10px;
    background-color: #555; /* Inherited from .league-header in index-7 */
    color: #e0e0e0; /* Inherited from .league-header in index-7 */
    padding: 0.75rem 1rem; /* Inherited from .league-header in index-7 */
    font-weight: 600; /* Inherited from .league-header in index-7 */
    border-top: 1px solid #555; /* Inherited from .league-header in index-7 */
    /* border-radius: 0.5rem; /* Inherited from .league-header in index-7 */
    /* box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* Inherited from .league-header in index-7 */
    margin-top: 32px; /* Inherited from .league-header in index-7 */
}
.league-title:first-child {
    margin-top: 10px;
}
.game-table {
    border-collapse: separate; /* Allow spacing between table rows for block effect */
    border-spacing: 0 4px; /* 4px between all rows */
    width: 100%;
    table-layout: fixed;
    max-width: 100%;
}
.game-table td {
    padding: 4px 10px; /* Default cell padding */
    vertical-align: top;
    font-size: 12px; /* Default font size for all cells */
}
/* Ensure first column (time/status) uses 11px - applies to all game tables */
.game-table td:first-child,
.game-table td:nth-child(1),
.game-table > tbody > tr > td:first-child,
.game-table > tbody > tr > td:nth-child(1),
table.game-table td:first-child,
table.game-table td:nth-child(1) {
    font-size: 11px !important;
}
.game-table td:nth-child(2) { /* Second column (teams) */
    width: 100% !important;
    min-width: 248px !important;
    max-width: none !important;
}
@media (max-width: 768px) {
    .game-table td:nth-child(2) { /* Responsive teams column */
        min-width: 200px !important;
    }
}
@media (max-width: 767px) {
    .column.tv-listings .game-table col:nth-child(1) {
        width: 20% !important;
    }
    .column.tv-listings .game-table col:nth-child(2) {
        width: 50% !important;
    }
    .column.tv-listings .game-table col:nth-child(3) {
        width: 7% !important;
    }
    .column.tv-listings .game-table col:nth-child(4) {
        width: 33% !important;
    }
.column.tv-listings .game-table td {
    padding: 4px 10px !important;
    min-width: 0 !important;
}
.column.tv-listings .game-table td:nth-child(1) { /* Start time/status column */
    width: auto !important;
    min-width: 95px !important;
    text-align: left !important;
    padding-left: 10px !important;
    padding-right: 6px !important;
    font-size: 11px !important;
}
.column.tv-listings .game-table td:nth-child(2) { /* Teams column */
    width: auto !important;
    white-space: normal !important;
    overflow: visible !important;
    text-overflow: unset !important;
    word-break: break-word !important;
    line-height: 1.3 !important;
}
.column.tv-listings .game-table .team-cell {
    white-space: normal !important;
    overflow: visible !important;
    text-overflow: unset !important;
    word-break: break-word !important;
    line-height: 1.3 !important;
}
.column.tv-listings .game-table td:nth-child(3) { /* Score column */
    width: auto !important;
    text-align: right !important;
    padding-left: 6px !important;
    padding-right: 6px !important;
    font-size: 11px !important;
}
.column.tv-listings .game-table td:nth-child(4) { /* Channel column */
    width: auto !important;
    text-align: center !important;
    padding-right: 10px !important;
    white-space: normal !important;
    overflow: visible !important;
    word-break: break-word !important;
}
.column.tv-listings .game-table td:nth-child(4) > div {
    position: static !important;
    transform: none !important;
    left: auto !important;
    top: auto !important;
    display: inline-block !important;
    width: auto !important;
    text-align: center !important;
    white-space: normal !important;
    overflow-wrap: anywhere !important;
    }
}
.game-table td:nth-child(3) { /* Override default padding for score column */
    padding-left: 4px;
    padding-right: 0;
}
.game-table td:nth-child(1) { /* First column (time/status) */
    width: 77px;
    min-width: 77px;
    text-align: left;
    padding-right: 5px;
    font-size: 11px !important; /* Override to ensure 11px for start times */
}
.game-table td:nth-child(3) { /* Third column (score) */
    width: 30px !important;
    min-width: 30px !important;
    text-align: right !important;
    padding-right: 0 !important;
    padding-left: 4px !important;
	font-size: 12px !important;
}
.game-table td:nth-child(4) { /* Fourth column (empty spacer) */
    width: 5px !important;
    min-width: 5px !important;
    padding: 0 !important;
    border: none !important;
	font-size: 10px !important;
}

.game-row {
    /* Remove block styling - back to simple rows */
}
.game-row.live-filter-hidden {
    display: none !important;
}
.game-separator {
    /* Add line break after each game */
}
.game-separator.live-filter-hidden {
    display: none !important;
}
.game-separator::after {
    content: "\A";
    white-space: pre;
    display: block;
    height: 30px;
}
/* Remove the pseudo-gap if the separator is the first row in the table (after spacer) */
.game-table > tbody > tr.game-separator:first-of-type::after,
.game-table > tbody > tr.game-separator:nth-child(2)::after {
    display: none;
}
.atp-doubles-spacer {
    height: 1.5em;
}
.atp-doubles-spacer td {
    height: 1.5em;
    padding: 0;
    border: none;
    line-height: 0;
}
.error {
    color: red;
}

        /* Videos Column Styling */
        .videos-column {
            border-left: none;
        }

.videos-tab {
    flex: 1;
    background-color: #2a2a2a;
    border: none;
    color: #5f5f5f;
    padding: 6px 8px;
    font-size: 11px;
    font-weight: 500;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.videos-tab:hover {
    background-color: #2a2a2a;
    color: #5f5f5f;
}

.videos-tab.active {
    background-color: #3c3c3c;
    color: white;
}

        .videos-content {
            flex: 1;
            padding: 0;
            margin: 0;
            overflow-y: auto !important;
            overflow-x: hidden !important;
            background-color: #000000;
            display: block;
        }

        /* Ensure all video thumbnails are the same size and spacing - target all possible selectors including universal */
        #dynamicVideosContent img,
        #dynamicVideosContent .video-thumbnail,
        rssapp-feed img,
        rssapp-feed .rssapp-item img,
        rssapp-feed .rssapp-item-image img,
        rssapp-feed .rssapp-item-content img,
        rssapp-feed a img,
        rssapp-feed div img,
        rssapp-feed * img {
            width: 100% !important;
            max-width: 400px !important;
            height: 225px !important;
            min-height: 225px !important;
            max-height: 225px !important;
            object-fit: cover !important;
            display: block !important;
            margin-bottom: 8px !important;
            margin-top: 0 !important;
            border-radius: 4px !important;
            aspect-ratio: 16/9 !important;
        }
        
        /* Ensure consistent spacing for video titles - target all possible selectors */
        #dynamicVideosContent h3,
        rssapp-feed h3,
        rssapp-feed .rssapp-item-title,
        rssapp-feed .rssapp-item h3,
        rssapp-feed .rssapp-item-title a,
        rssapp-feed .rssapp-item-content h3,
        rssapp-feed a h3,
        rssapp-feed * h3 {
            margin: 0 0 8px 0 !important;
            margin-top: 0 !important;
            padding: 0 !important;
            line-height: 1.2 !important;
        }
        
        /* Ensure h3 links don't add extra spacing */
        #dynamicVideosContent h3 a {
            display: block !important;
            line-height: 1.2 !important;
        }
        
        /* Target RSS.app item containers to ensure proper spacing */
        rssapp-feed .rssapp-item,
        rssapp-feed .rssapp-item-content,
        rssapp-feed > div,
        rssapp-feed .rssapp-item-image,
        rssapp-feed .rssapp-item-image-wrapper {
            margin-bottom: 15px !important;
        }
        
        /* Specifically override inline styles for images with different aspect ratios (16:9, 4:3, etc.) */
        rssapp-feed img[style*="aspect-ratio"],
        rssapp-feed img[style*="width: 100%"],
        rssapp-feed img[style*="height: auto"],
        rssapp-feed .rssapp-item img[style*="aspect-ratio"],
        rssapp-feed .rssapp-item img[style*="width: 100%"],
        rssapp-feed * img[style*="margin"] {
            margin-bottom: 2px !important;
            margin-top: 0 !important;
        }

.video-item {
    border-bottom: 1px solid #333333;
    padding: 8px 0;
    margin-bottom: 8px;
}

.video-item:last-child {
    border-bottom: none;
    margin-bottom: 0;
}

.video-title {
    color: #CCCCCC;
    font-weight: 500;
    margin-bottom: 4px;
    font-size: 11px;
    line-height: 1.4;
}

.video-title a {
    color: #00FF00;
    text-decoration: none;
}

.video-title a:hover {
    text-decoration: underline;
}

.video-meta {
    color: #888888;
    font-size: 11px;
}

/* --- END CSS FROM testing_testing-3.html --- */


/* --- EXISTING CSS FROM index-7.html (merged and adjusted) --- */
/* Loading indicator styling */
.loading-indicator {
    display: none; /* flex */
    flex-direction: column; /* flex-col */
    align-items: center; /* items-center */
    justify-content: center; /* justify-center */
    padding: 2.5rem; /* p-10 */
    color: #9ca3af; /* text-gray-400 */
}
.loading-spinner {
    display: none;
    animation: spin 1s linear infinite; /* animate-spin */
    height: 2.5rem; /* h-10 */
    width: 2.5rem; /* w-10 */
    color: #60a5fa; /* text-blue-400 */
    margin-bottom: 0.75rem; /* mb-3 */
}
.loading-text {
   display: none;
    font-size: 1.125rem; /* text-lg */
    line-height: 1.75rem; /* leading-7 */
}
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Error message styling */
.error-message {
     display: none;
    background-color: #991b1b; /* bg-red-800 */
    border-width: 1px; /* border */
    border-color: #dc2626; /* border-red-600 */
    color: #fecaca; /* text-red-200 */
    padding: 0.75rem 1rem; /* py-3 px-4 */
    border-radius: 0.25rem; /* rounded */
    position: relative; /* relative */
    margin-top: 1rem; /* mt-4 */
}
.error-message strong {
    font-weight: 700; /* font-bold */
}
.error-message span {
    display: block; /* block */
}
@media (min-width: 640px) { /* sm:inline */
    .error-message span {
        display: inline;
    }
}

/* League section styling (from index-7, for general structure) */
/* .league-section { margin-bottom: 16px; } */ /* Overridden by testing_testing-3.html's 3rem */
/* .league-section:last-child { margin-bottom: 16px; } */ /* Overridden */

/* League header styling (from index-7, now applies to .league-title) */
/* .league-header { ... } */ /* Renamed to .league-title and merged */


/* Game entries wrapper (from index-7, for overall structure) */
.game-entry-wrapper {
    border-radius: 0.5rem; /* rounded-lg */
    border-width: 1px; /* border */
    border-color: #374151; /* border-gray-700 */
    overflow: hidden; /* overflow-hidden */
    background-color: #1f1f1f; /* bg-gray-800 */
    padding-bottom: 32px;
    margin-bottom: 32px;
}
.game-entry-wrapper .game-entry:not(:last-child) {
    border-bottom: 1px solid #374151; /* divide-y divide-gray-700 */
    margin-bottom: 0;
}
/* Individual game entry styling (from index-7, now applies to .game-entry) */
.game-entry {
    display: flex; /* flex */
    align-items: center; /* items-center */
    padding-top: 0; /* py-2 */
    padding-bottom: 0; /* py-2 */
    padding-left: 3px; /* px-4 */
    margin-left: 0;
    padding-right: 3px; /* px-4 */
}
.game-entry:hover {
    background-color: #374151; /* hover:bg-gray-700 */
}

/* Status cell styling */
.status-finished {
    color: #22c55e; /* text-green-500 */
}
.status-live {
    color: #ef4444; /* text-red-500 */
}
.status-scheduled {
    color: #a0a0a0; /* text-gray-400 */
}

/* Time cell styling (from index-7, now applies to .time-cell) */
/* Time cell styling */
.time-cell {
    /* font-weight: 500; /* Medium weight */
    text-align: left !important; /* Ensure left alignment */
    width: 50px; /* Fixed width for time */
    flex-shrink: 0;
    padding-right: 0 !important;
    padding-left: 0 !important;
    margin-left: 0 !important;
    color: #e0e0e0 !important; /* Changed to !important to ensure override */
    font-size: 11px !important; /* Changed font size and added !important */
}

/* Game details (teams) styling */
.game-details {
    flex-grow: 1; /* flex-grow */
    padding-left: 3px; /* padding-left */
    padding-right: 3px; /* padding-right */
    color: #e5e7eb !important; /* Changed to !important to ensure override */
}
.team-name {
    font-size: 11px !important; /* Changed font size and added !important */
    line-height: 1.2; /* Adjusted line height for tighter spacing */
    padding-top: 1px;
    padding-bottom: 1px;
    padding-left: 0 !important;
}

/* Game scores styling */
.game-scores {
    text-align: right; /* text-right */
    padding-right: 1rem; /* padding-right */
    width: 20px; /* fixed width */
    flex-shrink: 0; /* flex-shrink-0 */
    color: #e5e7eb !important; /* Changed to !important to ensure override */
}
.score-value {
    font-size: 11px !important; /* Changed font size and added !important */
    line-height: 1.2; /* Adjusted line height for tighter spacing */
    padding-top: 0.25rem;
    padding-bottom: 0.25rem;
}
/* Game channel styling (from index-7, now applies to .game-channel) */
.game-channel {
    text-align: right; /* text-right */
    width: 100px; /* fixed width */
    flex-shrink: 0; /* flex-shrink-0 */
    padding-right: 1rem; /* padding-right */
    color: #9ca3af; /* text-gray-400 */
    font-size: 0.875rem; /* text-sm */
    line-height: 1.25rem; /* leading-5 */
}

/* Custom scrollbar for overflow-y-auto */
.column.tv-listings::-webkit-scrollbar,
.games-content::-webkit-scrollbar,
.game-entry-wrapper::-webkit-scrollbar,
#league-specific-column::-webkit-scrollbar { /* Added new column */
    width: 8px;
}
.column.tv-listings::-webkit-scrollbar-thumb,
.games-content::-webkit-scrollbar-thumb,
.game-entry-wrapper::-webkit-scrollbar-thumb,
#league-specific-column::-webkit-scrollbar-thumb { /* Added new column */
    background-color: #4a4a4a; /* Darker gray */
    border-radius: 4px;
}
.column.tv-listings::-webkit-scrollbar-track,
.games-content::-webkit-scrollbar-track,
.game-entry-wrapper::-webkit-scrollbar-track,
#league-specific-column::-webkit-scrollbar-track { /* Added new column */
    background-color: #2a2a2a; /* Even darker gray */
}

/* ────── Today's MLB Games widget (scoped) ────── */
/* This section from index-7.html is now largely superseded by the new structure,
   but keeping it here for reference and in case any specific overrides are still desired.
   The new structure uses .league-section, .game-table, .game-row, .team-cell, etc. */
#tv-listings-today #todayGamesWrapper .game-row {
  display: grid;
  /* col1=time • col2=teams • col3=scores • col4=channel */
  grid-template-columns: 55px 1fr 15px 30px;
  align-items: center;
  padding: 0;
  /* border-bottom: 1px solid #333; */ /* Removed as per new game-separator logic */
  font-size: 13px;
  margin-bottom: 0;
}

#tv-listings-today #todayGamesWrapper .time {
  color: #ccc;
}
#tv-listings-today #todayGamesWrapper .time.live {
  color: #DC143C;
  font-weight: bold;
}

#tv-listings-today #todayGamesWrapper .teams {
  display: flex;
  flex-direction: column;
  padding-left: 8px;
}

#tv-listings-today #todayGamesWrapper .team-name {
  line-height: 17px;
}

#tv-listings-today #todayGamesWrapper .score-cell {
  display: flex;
  flex-direction: column;
  align-items: center;
  font-variant-numeric: tabular-nums;
}

#tv-listings-today #todayGamesWrapper .channel-cell {
  text-align: right;
  font-size: 12px;
}
#tv-listings-today #todayGamesWrapper .channel-cell a {
  color: #99f;
  text-decoration: none;
}
#tv-listings-today #todayGamesWrapper .channel-cell a:hover {
  text-decoration: underline;
}

/* Override legacy grid layout with table rows for global games table */
#tv-listings-today #todayGamesWrapper table.game-table .game-row,
#tv-listings-today #todayGamesWrapper table.game-table .game-row.game-separator {
  display: table-row !important;
  grid-template-columns: none !important;
  align-items: initial !important;
  padding: 0 !important;
  margin-bottom: 0 !important;
}
#tv-listings-today #todayGamesWrapper table.game-table .channel-cell-desktop {
  display: none !important;
}

/* ──────────────────────────────────────────────── */
  /* ────────────────────────────────────────────────────────── */
  /* Top Bars                          */
  /* ────────────────────────────────────────────────────────── */
  #topBar {
    width: 100%;
    height: 18px;
    background-color: #3c3c3c;
  }

  #topDivider {
    width: 100%;
    height: 2px;
    background-color: #151515;
  }

  #topBar,
  #topDivider {
    width: 100%;
    margin: 0 auto;
    box-sizing: border-box;
  }
  
  #topBar {
    width: 100%;
  }

  /* ────────────────────────────────────────────────────────── */
  /* Layout Containers                    */
  /* ────────────────────────────────────────────────────────── */
  .container {
    display: flex;
    width: 100%;
    max-width: min(1421px, 100vw);
    min-width: 0;
    height: calc(100vh - 20px); /* account for topBar + topDivider */
    justify-content: center;
    margin: 0 auto;
    box-sizing: border-box;
    padding: 0;
    overflow-x: hidden;
  }

  .column {
    overflow: hidden;
    padding: 0;
    display: flex;
    flex-direction: column;
  }

  .column.tv-listings {
    flex: 0 1 247px;
    min-width: 200px;
    width: min(247px, 100vw);
    max-width: 100vw;
    padding: 0;
    margin: 0;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    height: 100vh;
    max-height: 100vh;
    overflow: hidden;
  }
  
  #tv-listings-container {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
    overflow: hidden;
  }
  
  .games-content {
    flex: 1 1 0;
    display: flex;
    flex-direction: column;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    min-height: 0;
  }

  .column.tv-listings * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
.column.tv-listings .game-row,
.column.tv-listings .game-row.game-separator {
    display: table-row !important;
    grid-template-columns: none !important;
    align-items: initial !important;
}
.column.tv-listings .game-row.hidden-row,
.column.tv-listings .game-row.game-separator.hidden-row {
    display: none !important;
  }

  .main-menu {
    background-color: #151515;
    color: white;
    flex: 0 1 165px;
    min-width: 130px;
    font-size: 11px;
    padding: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  #menuList {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding-bottom: 150px;
  }

  .divider {
    flex: 0 0 4px;
    background-color: #151515;
  }

  .news {
    flex: 0 1 315px; /* reduced to accommodate 110px Standings panel */
    min-width: 220px;
    background-color: #fafaf9;
    padding: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  .news .content-section {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
  }

  .social {
    flex: 0 1 317px;
    min-width: 220px;
    background-color: #fff;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  #social-feed-container {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
  }

  .videos-column {
    flex: 1 1 0;
    min-width: 180px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  #videos-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  .videos-content {
    flex: 1;
    overflow-y: auto !important;
    overflow-x: hidden !important;
  }
  
  #league-specific-column {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow-y: auto !important;
    overflow-x: hidden !important;
  }
  
  #f1-column-content {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden !important;
  }
  
  #f1-column-content > div[style*="overflow-y"] {
    overflow-y: auto !important;
  }

  /* ────────────────────────────────────────────────────────── */
  /* Main‐Menu Styling                     */
  /* ────────────────────────────────────────────────────────── */
  #menuTopBox {
    width: 165px;
    height: 18px;
    background-color: #3c3c3c;
    display: flex;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 2;
    overflow: hidden;
  }
  
  .menu-logo-section {
    width: 10%;
    height: 100%;
    display: flex;
    align-items: center;
    padding-left: 2px;
    flex-shrink: 0;
  }
  
  .menu-logo-section img {
    height: 18px;
    display: block;
  }
  
  .menu-support-section {
    width: 90%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
  }
  
  .support-button {
    width: 100%;
    height: 100%;
    background-color: #ff2424;
    color: white;
    font-size: 10px;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    position: relative;
    transform: translateX(-100%);
    opacity: 0;
    transition: transform 0.5s ease-out, opacity 0.5s ease-out;
    z-index: 3;
  }
  
  .support-button.visible {
    transform: translateX(0);
    opacity: 1;
  }
  
  .support-button:hover {
    background-color: #e02020;
  }
  
  /* Hide support button on mobile */
  @media (max-width: 768px) {
    .menu-support-section {
      display: none;
    }
    
    .menu-logo-section {
      width: 100%;
    }
    
    #menuTopBox {
      padding-left: 2px;
    }
  }

  #menuSearch {
    width: 165px;
    height: 18px;
    box-sizing: border-box;
    margin-top: 2px;
    margin-bottom: 2px;
    background-color: #000;
    color: #fff;
    border: 1px solid #3c3c3c;
    padding: 2px 5px 2px 25px;
    font-size: 10px;
    background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjYzRjNGM0IiBmaWxsPSJub25lIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49ImJldmVsIj48Y2lyY2xlIGN4PSIxMSIgY3k9IjExIiByPSI4Ij48L2NpcmNsZT48bGluZSB4MT0iMjEiIHkxPSIyMSIgeDI9IjE2LjY1IiB5Mj0iMTYuNjUiPjwvbGluZT48L3N2Zz4=')
      no-repeat 5px center;
    background-size: 14px 14px;
  }

  #menuFilters {
    width: 165px;
    display: flex;
    margin-bottom: 10px;
  }

  .menu-filter {
    flex: 1;
    text-align: center;
    padding: 1px;
    border: 1px solid #444;
    background-color: #222;
    font-size: 11px;
    font-family: Helvetica, Arial, sans-serif;
    cursor: pointer;
    color: #fff;
  }

  .menu-filter.active {
    background-color: #3c3c3c;
    color: white;
    border-color: #3c3c3c;
  }

  .selected {
    font-weight: bold;
    background-color: #3c3c3c;
    color: white;
  }

  #menuList ul {
    padding-left: 0;
    padding-top: 10;
    margin: 0;
  }

  #menuList li {
    cursor: pointer;
    padding: 8px 0;
    vertical-align: top;
    line-height: 1;
  }

  .nested {
    margin-left: 10px;
    margin-top: 0;
    padding-top: 8px;
  }

  .nested li {
    margin-left: 10px;
  }

  #newsSubMenu {
    position: sticky;
    top: 0;
    width: 100%;
    z-index: 10;
    background-color: #3f3f3f;
    font-family: Helvetica, Arial, sans-serif;
    font-size: 10px;
    height: 18px;
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 0;
    margin: 0;
  }

  .news-menu-item {
    line-height: 18px;
    height: 18px;
    padding: 0 8px; /* Adjust horizontal only */
    display: flex;
    align-items: center;
    box-sizing: border-box;
  }
  .news-menu-item.active {
    background-color: black;
    color: white;
  }

  /* ────────────────────────────────────────────────────────── */
  /* RSS‐Feed Links                       */
  /* ────────────────────────────────────────────────────────── */
  .news .rss-feed {
    padding-left: 10px;
  }

  .rss-feed a {
    font-family: Helvetica, Arial, sans-serif;
    font-size: 11px;
    color: black;
    text-decoration: none;
  }

  .rss-feed a.clicked {
    color: lightgray;
  }

  .rss-feed ul li {
    border-bottom: 1px solid #C9C8C7;
    padding: 5px 0;
  }

  .rss-feed ul li:last-child {
    border-bottom: none;
  }

  .rss-feed h4 {
    color: black;
  }

  .rss-feed {
    background-color: #fafaf9;
  }

  .content-section {
    display: none;
    padding: 0;
  }

  .expand-button {
    background-color: #3c3c3c;
    color: white;
    border: none;
    padding: 6px 10px;
    font-size: 11px;
    cursor: pointer;
    margin-top: 8px;
  }

  .expand-button:hover {
    background-color: #555;
  }

  /* ────────────────────────────────────────────────────────── */
  /* News Column (Split Scroll Areas)          */
  /* ────────────────────────────────────────────────────────── */

 /* ────────────────────────────────────────────────────────── */
/* News Column (Split Scroll Areas) - REVISED AND CORRECTED    */
/* ────────────────────────────────────────────────────────── */

/* 1) Main News Column. Remove all padding to make content flush with edges. */
.column.news {
    flex: 0 0 315px !important;
    background-color: #fafaf9 !important;
    padding: 0 !important;
}

/* 2) Main container for both headlines and breaking news sections.
      It needs to fill the full available height of the news column minus the header. */
.news-main-container {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    padding: 0 !important;
    margin: 0 !important;
}

/* 3) The Headlines section container. It's now a horizontal tab layout. */
.headlines-section {
    flex: 0 0 60% !important;
    display: flex !important;
    flex-direction: column !important;
    border-bottom: 2px solid #d4d4d4 !important;
    min-height: auto !important;
    max-height: 60% !important;
    overflow: hidden !important;
    padding: 0 !important;
    margin: 0 !important;
}

	   .nwsl-headlines-section,
.ligue1-headlines-section,
.ligamx-headlines-section,
.uefaeuropaleague-headlines-section,
.uefaconferenceleague-headlines-section,
.uefachampionsleague-headlines-section,
.livgolf-headlines-section,
.indycar-headlines-section,
.lpgatour-headlines-section,
.trackandfield-headlines-section,
#news-MotoGP .headlines-section,
#news-UEFAChampionsLeague .headlines-section {
    flex: 1 1 auto !important;
    max-height: 100% !important;
    border-bottom: none !important;
}

.nwsl-headlines-section .news-feed-content,
.ligue1-headlines-section .news-feed-content,
.ligamx-headlines-section .news-feed-content,
.uefaeuropaleague-headlines-section .news-feed-content,
.uefaconferenceleague-headlines-section .news-feed-content,
.uefachampionsleague-headlines-section .news-feed-content,
.livgolf-headlines-section .news-feed-content,
.indycar-headlines-section .news-feed-content,
.lpgatour-headlines-section .news-feed-content,
.trackandfield-headlines-section .news-feed-content,
#news-MotoGP .headlines-section .news-feed-content,
#news-UEFAChampionsLeague .headlines-section .news-feed-content {
    flex: 1 1 auto !important;
    overflow-y: auto !important;
    padding: 0 !important;
    background: #fafaf9 !important;
    font-size: 11px !important;
    color: #111 !important;
    margin: 0 !important;
}

.nwsl-headlines-section .news-feed-content ul,
.ligue1-headlines-section .news-feed-content ul,
.ligamx-headlines-section .news-feed-content ul,
.uefaeuropaleague-headlines-section .news-feed-content ul,
.uefaconferenceleague-headlines-section .news-feed-content ul,
.livgolf-headlines-section .news-feed-content ul,
.indycar-headlines-section .news-feed-content ul,
.lpgatour-headlines-section .news-feed-content ul,
.trackandfield-headlines-section .news-feed-content ul {
    list-style: none !important;
    padding: 0 10px !important;
    margin: 0 !important;
}

.nwsl-headlines-section .news-feed-content ul li,
.ligue1-headlines-section .news-feed-content ul li,
.ligamx-headlines-section .news-feed-content ul li,
.uefaeuropaleague-headlines-section .news-feed-content ul li,
.uefaconferenceleague-headlines-section .news-feed-content ul li,
.livgolf-headlines-section .news-feed-content ul li,
.indycar-headlines-section .news-feed-content ul li,
.lpgatour-headlines-section .news-feed-content ul li,
.trackandfield-headlines-section .news-feed-content ul li {
    padding: 5px 0 !important;
    border-bottom: 1px solid #C9C8C7;
    margin: 0 !important;
}

#nwsltabs-NWSL .headlines-tab,
#ligue1tabs-Ligue1 .headlines-tab,
#ligamxtabs-LigaMX .headlines-tab,
#uefaeuropaleaguetabs-UEFAEuropaLeague .headlines-tab,
#uefaconferenceleaguetabs-UEFAConferenceLeague .headlines-tab,
#livgolftabs-LIVGolf .headlines-tab,
#indycarrtabs-IndyCar .headlines-tab,
#lpgatourtabs-LPGATour .headlines-tab,
#trackandfieldtabs-TrackAndField .headlines-tab {
    flex: 1 !important;
    text-align: center !important;
    font-size: 10px !important;
    line-height: 18px !important;
    color: #aaa !important;
    cursor: pointer !important;
    background-color: #2a2a2a !important;
    border-right: 1px solid #1f1f1f !important;
    margin: 0 !important;
    padding: 0 !important;
}

#nwsltabs-NWSL .headlines-tab:last-child,
#ligue1tabs-Ligue1 .headlines-tab:last-child,
#ligamxtabs-LigaMX .headlines-tab:last-child,
#uefaeuropaleaguetabs-UEFAEuropaLeague .headlines-tab:last-child,
#uefaconferenceleaguetabs-UEFAConferenceLeague .headlines-tab:last-child,
#livgolftabs-LIVGolf .headlines-tab:last-child,
#indycarrtabs-IndyCar .headlines-tab:last-child,
#lpgatourtabs-LPGATour .headlines-tab:last-child,
#trackandfieldtabs-TrackAndField .headlines-tab:last-child {
    border-right: none !important;
}

#nwsltabs-NWSL .headlines-tab.active,
#ligue1tabs-Ligue1 .headlines-tab.active,
#ligamxtabs-LigaMX .headlines-tab.active,
#uefaeuropaleaguetabs-UEFAEuropaLeague .headlines-tab.active,
#uefaconferenceleaguetabs-UEFAConferenceLeague .headlines-tab.active,
#livgolftabs-LIVGolf .headlines-tab.active,
#indycarrtabs-IndyCar .headlines-tab.active,
#lpgatourtabs-LPGATour .headlines-tab.active,
#trackandfieldtabs-TrackAndField .headlines-tab.active {
    background-color: #3c3c3c !important;
    color: #fff !important;
}

/* 4) The "Headlines" header bar. Ensure it has no top margin/padding issues. */
.headlines-section .news-section-header {
    position: sticky !important;
    top: 0 !important;
    z-index: 29 !important;
    background: #3c3c3c !important;
    color: #fff !important;
    font-family: Helvetica, Arial, sans-serif !important;
    font-size: 12px !important;
    height: 18px !important;
    display: flex !important;
    align-items: center !important;
    padding: 0 10px !important;
    border-bottom: 1px solid #2a2a2a !important;
    font-weight: bold !important;
    letter-spacing: 0.5px !important;
    margin: 0 !important;
}

	   /*
  This is the corrected CSS to ensure the proper layout for both the
  home page's horizontal tabs and the league pages' vertical tabs.
*/

/* 5) The horizontal tabs container (used for the Home page). */
#headlines-tabs {
    position: sticky !important;
    top: 2px !important;
    z-index: 28 !important;
    display: flex !important;
    height: 18px !important;
    background-color: #2a2a2a !important;
    margin: 0 !important;
    padding: 0 !important;
}

/* 11) New styles for the tabs themselves (Home page style). */
#headlines-tabs .headlines-tab {
    flex: 1 !important;
    text-align: center !important;
    font-size: 10px !important;
    line-height: 18px !important;
    color: #aaa !important;
    cursor: pointer !important;
    background-color: #2a2a2a !important;
    border-right: 1px solid #1f1f1f !important;
    margin: 0 !important;
    padding: 0 !important;
}

#headlines-tabs .headlines-tab:last-child {
    border-right: none !important;
}

#headlines-tabs .headlines-tab.active {
    background-color: #3c3c3c !important;
    color: #fff !important;
}

/* New styles for the vertical tabs on league pages. */
.headlines-tabs-column {
    display: flex !important;
    flex-direction: column !important; /* Forces vertical stacking */
    overflow-y: auto !important;
    background-color: #1f1f1f !important;
    width: 20% !important;
    flex-shrink: 0 !important;
    padding: 0 !important;
}
  
.headlines-tabs-column .headlines-tab {
    display: block !important;
    width: 100% !important;
    padding: 10px 2px !important;
    text-align: left !important;
    font-size: 10px !important;
    background-color: #151515 !important;
    color: white !important;
    border-bottom: 1px solid #444 !important;
    cursor: pointer !important;
    transition: background-color 0.2s !important;
    margin: 0 !important;
}

/* More specific rule to override any conflicting padding */
.headlines-tabs-column .headlines-tab[data-url] {
    padding: 10px 2px !important;
}
  
.headlines-tabs-column .headlines-tab:hover {
    background-color: #555 !important;
}
  
.headlines-tabs-column .headlines-tab.active {
    background-color: #333 !important;
    font-weight: bold !important;
}

/* Rule to make the default color of the links black */
.news-feed-content ul li a {
    color: black;
    text-decoration: none; /* Keeps the links from being underlined */
}

/* Rule for when a link has been visited (clicked) */
.news-feed-content ul li a:visited {
    color: lightgray;
}


	     /* 5a) ESPN feed-entry styling */
 /* Apply identical styling to ESPN, CBS, Yahoo and FOX feeds */
#espn-feed ul,
#cbs-feed ul,
#yahoo-feed ul,
#fox-feed ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

#espn-feed ul li,
#cbs-feed ul li,
#yahoo-feed ul li,
#fox-feed ul li {
  margin-bottom: 0.5em;
}

#espn-feed ul li a,
#cbs-feed ul li a,
#yahoo-feed ul li a,
#fox-feed ul li a {
  color: black;
  text-decoration: none;
  line-height: 1;
  word-break: break-word;
}

#espn-feed ul li a:visited,
#cbs-feed ul li a:visited,
#yahoo-feed ul li a:visited,
#fox-feed ul li a:visited {
  color: lightgray;
}
/* 6) The news feed content area. This needs to be padding-free. */
.headlines-section .news-feed-content {
    flex: 1 1 auto !important;
    overflow-y: auto !important;
    padding: 0 !important;
    background: #fafaf9 !important;
    font-size: 11px !important;
    color: #111 !important;
    margin: 0 !important;
}

/* 7) Ensure list items have padding for readability after removing container padding. */
.headlines-section .news-feed-content ul {
    list-style: none !important;
    padding: 0 10px !important;
    margin: 0 !important;
}

.headlines-section .news-feed-content ul li {
    padding: 5px 0 !important;
    border-bottom: 1px solid #C9C8C7;
    margin: 0 !important;
}

/* 8) Breaking news section. Ensure it fills the rest of the available height. */
  .breaking-section {
    flex: 1 1 40%;
    display: flex;
    flex-direction: column;
    min-height: 80px;
    max-height: 40%;
    overflow: auto !important;
  }


 /* 6) "Breaking" header pinned at top of breaking-section */
  .breaking-section .news-section-header {
    position: sticky;
    top: 0; /* directly at top of breaking-section (under headlines-section) */
    z-index: 27;
    background: #3c3c3c;
    color: #fff;
    font-family: Helvetica, Arial, sans-serif;
    font-size: 12px;
    height: 18px;
    display: flex;
    align-items: center;
    padding: 0 10px;
    border-bottom: 1px solid #ccc;
    font-weight: bold;
    letter-spacing: 0.5px;
  }

	     /* 7) Breaking │ Fantasy │ Transactions tabs pinned under "Breaking" header */
  .breaking-tabs-header {
    position: sticky;
    top: 18px; /* just under the 18px-high "Breaking" header */
    z-index: 26;
    display: flex;
    gap: 0;
    padding: 0;
    height: 18px;
    background-color: #3c3c3c;
  }


/* 10) The Breaking News content. Adjust padding. */
.breaking-section .news-feed-content {
    padding: 0 10px !important;
}

/* --- Unified Style for ALL Breaking News Sections (to match Headlines) --- */

/* This adds left/right padding to the main containers so the
   separator lines don't touch the edges of the box. */
#breaking-feed,
div[id^="breaking-content-"] {
  padding: 0 16px; /* 0 for top/bottom, 16px for left/right */
}

/* This removes the default browser styling (bullets, margin) from the list itself. */
#breaking-feed ul,
div[id^="breaking-content-"] ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

/* This styles each individual headline's row. */
#breaking-feed li,
div[id^="breaking-content-"] li {
  /* The thin, light gray separator line, perfect for dark mode */
  border-bottom: 1px solid #C9C8C7; 
  padding: 1px 0; /* Creates the vertical spacing above and below the text */
}

/* This removes the border from the very last item in the list for a cleaner look. */
#breaking-feed li:last-child,
div[id^="breaking-content-"] li:last-child {
  border-bottom: none;
}

/* This styles the actual link text. */
#breaking-feed a,
div[id^="breaking-content-"] a {
  font-family: Helvetica, Arial, sans-serif;
  font-size: 11px;
  font-weight: normal;
  color: #151515;
  text-decoration: none;   /* No underline */
  line-height: 1.4;        /* Improves readability */
  transition: color 0.2s ease; /* Adds a smooth effect on hover */
}

/* A muted gray color for links you've already visited. */
#breaking-feed a:visited,
div[id^="breaking-content-"] a:visited {
  color: #757575;
}

/* Darkens the text slightly when you hover over it for feedback. */
#breaking-feed a:hover,
div[id^="breaking-content-"] a:hover {
  color: #505050;
}

  /* ────────────────────────────────────────────────────────── */
  /* TV-Listings (Games) Styling               */
  /* ────────────────────────────────────────────────────────── */
  .column.tv-listings #live-games-container {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  /* .league-section { margin-bottom: 14px !important; } */ /* Overridden by new CSS */


  /* .league-header { ... } */ /* Overridden by new CSS .league-title */

  /* the wrapper around all the rows for a league */
  .games-list {}

  /* .game-row { ... } */ /* Overridden by new CSS .game-table and .game-row/.game-separator */

  .game-time {
    font-size: 11px;
    color: #ccc;
  
  }

  .game-time.live {
    color: #DC143C !important;
    font-weight: bold;
  }

  .game-time-final {
    padding-left: 12px !important;
    text-align: left !important; /* Make sure it's not being centered */
    color: #ccc; /* or whatever color you want for the F */
    background: none;
  }

.game-teams {
  display: flex;
  flex-direction: column;
  padding-left: 10px;   /* same as old .game-matchup's padding */
  font-size: 11px;
  color: #ccc;
  line-height: 1.2;
}

.game-teams .team {
  margin: 0;
  padding: 0;
}

  .game-channel {
    text-align: right;
    font-size: 11px;
    color: #ccc;
  }

  .games-tab {
    flex: 1;
    text-align: center;
    font-size: 10px;
    line-height: 18px;
    color: #aaa;
    cursor: pointer;
    background-color: #2a2a2a;
    border-right: 1px solid #1f1f1f;
    position: relative;
    z-index: 10;
    pointer-events: auto;
    user-select: none;
  }

  .games-tab.active {
    background-color: #3c3c3c;
    color: #fff;
  }

  .schedule-tab {
    flex: 1;
    text-align: center;
    font-size: 10px;
    line-height: 18px;
    color: #aaa;
    cursor: pointer;
    background-color: #2a2a2a;
    border-right: 1px solid #1f1f1f;
    transition: all 0.2s ease;
  }

  .schedule-tab.active {
    background-color: #3c3c3c;
    color: #fff;
  }

  .schedule-tab:hover {
    background-color: #333;
    color: #fff;
  }

  .schedule-content {
    min-height: 100px;
  }

  .games-content {
    display: none;
  }

  .games-content.active {
    display: flex;
  }

  #tv-listings-scores,
  #tv-listings-today,
  #tv-listings-live {
    padding: 5px !important;
    flex: 1 1 0;
    display: flex;
    flex-direction: column;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    min-height: 0;
  }
  
  #games {
    width: 100%;
    padding-bottom: 150px;
  }
	   
	   .winner {
  font-weight: bold;
}
	   /* --- FIX for League-Specific Column Horizontal Overflow --- */

/* Target the table cells ONLY inside the league-specific column */
#league-specific-column .game-table td {
    /* Reduce horizontal padding from 10px to 4px to save space */
    padding-left: 4px;
    padding-right: 4px;
    /* Reduce font size slightly for a better fit */
    font-size: 11px;
}

/* Target the first column (Time/Status) inside the league-specific column */
#league-specific-column .game-table td:first-child {
    /* Widen the width to 65px for better fit (was 62px) */
    width: 65px;
    min-width: 65px;
    font-size: 10px !important; /* Font size for first column - reduced from 11px to 10px */
}

/* Target the second column (Team names) inside the league-specific column */
#league-specific-column .game-table td:nth-child(2) {
    /* Reduce min-width to 245px to compensate for wider time column */
    min-width: 245px !important;
}

/* Target the last column (Score) inside the league-specific column */
#league-specific-column .game-table td:last-child {
    /* Reduce the width from 40px to 30px */
    width: 30px;
    min-width: 30px;
}


  /* ────────────────────────────────────────────────────────── */
  /* Fonts (Owners)                       */
  /* ────────────────────────────────────────────────────────── */
  @font-face {
    font-family: 'Owners';
    src: url('https://www.thporth.com/fonts/Owners-XLight.woff') format('woff');
    font-weight: 200;
    font-style: normal;
  }

  @font-face {
    font-family: 'Owners';
    src: url('https://www.thporth.com/fonts/Owners-medium.woff') format('woff');
    font-weight: 500;
    font-style: normal;
  }

  /* Owners Wide */
  @font-face {
    font-family: 'Owners Wide';
    src: url('https://www.thporth.com/fonts/OwnersWide-Light.woff') format('woff');
    font-weight: 300;
    font-style: normal;
  }

  @font-face {
    font-family: 'Owners Wide';
    src: url('https://www.thporth.com/fonts/OwnersWide-Regular.woff') format('woff');
    font-weight: 400;
    font-style: normal;
  }

  /* Owners XX Wide */
  @font-face {
    font-family: 'Owners XX Wide';
    src: url('https://www.thporth.com/fonts/OwnersXXWide-Light.woff') format('woff');
    font-weight: 300;
    font-style: normal;
  }

  @font-face {
    font-family: 'Owners XX Wide';
    src: url('https://www.thporth.com/fonts/OwnersXXWide-Regular.woff') format('woff');
    font-weight: 400;
    font-style: normal;
  }

  @font-face {
    font-family: 'Owners XX Wide';
    src: url('https://www.thporth.com/fonts/OwnersXXWide-Medium.woff') format('woff');
    font-weight: 500;
    font-style: normal;
  }

  @font-face {
    font-family: 'Owners XX Wide';
    src: url('https://www.thporth.com/fonts/OwnersXXWide-Bold.woff') format('woff');
    font-weight: 700;
    font-style: normal;
  }

  @font-face {
    font-family: 'Owners XXWideXBlack';
    src: url('https://www.thporth.com/fonts/OwnersXXWide-XBlack.woff') format('woff');
    font-weight: 950;
    font-style: normal;
  }
  
  /* Logo aspect ratio preservation */
  img[alt*="Logo"], img[alt*="NFL"], img[alt*="NBA"], img[alt*="MLB"], img[alt*="NHL"], img[alt*="Soccer"], img[alt*="Boxing"], img[alt*="Track"], img[alt*="Field"], img[alt*="UFC"], img[alt*="Tennis"], img[alt*="WNBA"], img[alt*="Formula"], img[alt*="NCAAF"], img[alt*="PGA"], img[alt*="NASCAR"], img[alt*="MotoGP"], img[alt*="LPGA"], img[alt*="LIV"], img[alt*="IndyCar"], img[alt*="NCAA"] {
    object-fit: contain !important;
    width: 12px !important;
    height: 12px !important;
    margin-right: 6px !important;
    vertical-align: middle !important;
    display: inline-block !important;
  }
</style>
	  <style>
		  /* ───────────── Header Styling ───────────── */
#resp-header {
  display: none;
  position: sticky;
  top: 0; left: 0; right: 0;
  height: 50px;
  background: #151515;
  z-index: 200;
  padding: 0 10px;
  align-items: center;
  justify-content: space-between;
}
#resp-header img#header-logo {
  height: 30px;
}
#resp-header button {
  background: none;
  border: none;
  color: white;
  font-size: 14px;
  cursor: pointer;
}
#resp-header .hamburger {
  display: block;
  width: 24px; height: 2px;
  background: white;
  position: relative;
}
#resp-header .hamburger::before,
#resp-header .hamburger::after {
  content: "";
  position: absolute;
  width: 24px; height: 2px;
  background: white;
}
#resp-header .hamburger::before { top: -6px; }
#resp-header .hamburger::after  { top:  6px; }

/* ───────────── Overlay Panels ───────────── */
.column.main-menu.open,
.column.tv-listings.open {
  position: absolute;
  top: 50px; /* header height */
  background: #151515;
  z-index: 150;
  height: calc(100vh - 50px);
  overflow-y: auto;
}
.column.main-menu.open {
  left: 0;
  width: 250px;
}
.column.tv-listings.open {
  right: 0;
  width: 250px;
}

/* ─── always honor "open" toggles, even under the smaller-screen hide rules ─── */
.column.main-menu.open {
  display: block !important;
}
.column.tv-listings.open {
  display: block !important;
}




.game-entry, .game-entry * {
  margin-top: 0 !important;
  margin-bottom: 0 !important;
  padding-top: 0 !important;
  padding-left: 0 !important;
  margin-left: 0 !important;
  padding-bottom: 0 !important;
  line-height: 1.1 !important;
}




/* ADD 10PX SPACE TO LEFT OF MAIN MENU */
.main-menu {
  margin-left: 10px !important;
}

/* ═══════════════════════════════════════════════════════════════════
   MOBILE RESPONSIVENESS - MAINTAIN DESKTOP, ADD MOBILE
   ═══════════════════════════════════════════════════════════════════ */

/* Large screens (1421px+) - Prevent content from stretching too wide */
@media (min-width: 1441px) {
  .container {
    padding: 0 20px; /* More padding on very large screens */
  }
}

/* Tablet (768px - 1024px) - Adjust column widths for better fit */
@media (max-width: 1024px) and (min-width: 768px) {
  .container {
    padding: 0 5px; /* Reduce padding on tablets */
  }
  
  .main-menu {
    flex: 0 1 165px; /* Allow shrink but prefer 165px */
  }
  
  .news {
    flex: 0 1 320px; /* Allow shrink on tablets */
  }
  
  .social {
    flex: 0 1 280px; /* Allow shrink on tablets */
  }
  
  .videos {
    flex: 1 1 180px; /* Allow videos column to grow/shrink */
  }
  
  .games {
    flex: 0 1 300px; /* Allow games column to shrink */
  }
}

/* Mobile (0-767px) - Single column with bottom toolbar */
@media (max-width: 767px) {
  /* Hide desktop elements */
  .main-menu,
  .divider {
    display: none !important;
  }
  
  /* Container becomes single column */
  .container {
    display: flex !important;
    flex-direction: column !important;
    padding: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    position: fixed !important;
    top: 20px !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 60px !important; /* Exact bottom toolbar height */
  }
  
  /* All columns full width, but only one visible at a time */
  .column {
    width: 100% !important;
    min-width: 0 !important;
    flex: 1 !important;
    margin-bottom: 0 !important;
    max-width: 100% !important;
    height: 100% !important;
    display: none !important; /* Hidden by default, shown by JS */
  }

  .column.tv-listings,
  #league-specific-column {
    width: 100% !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
    flex: 0 0 auto !important;
  }
  .column.news,
  .column.social,
  .videos-column {
    width: 100% !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
    flex: 0 0 auto !important;
  }
  
  .column.tv-listings {
    overflow-x: auto !important; /* Allows horizontal scrolling if content still overflows */
  }
  
  /* Show only the active column */
  .column.mobile-active {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
  }
  
  /* Top bar adjustments */
  #topBar {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 8px 0 !important;
  }
  
  /* Mobile logo */
  #topBar::after {
    content: "";
    background-image: url('THPORTH logo.png');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    width: 120px;
    height: 30px;
    display: block;
  }
  
  /* Space for bottom toolbar */
  body {
    padding-bottom: 80px !important;
  }
  
  /* Add bottom padding to all content columns to prevent toolbar overlap */
  .column {
    padding-bottom: 60px !important;
  }
  
  /* Remove bottom padding from news column to allow headlines to extend to breaking section */
  .column.news {
    padding-bottom: 0 !important;
  }
  
  /* Remove bottom padding from news sections within the news column */
  .column.news .news-section,
  .column.news .news-feed-content {
    padding-bottom: 0 !important;
  }
  
  /* Ensure content areas have proper spacing */
  .column .content-section,
  .column .news-main-container,
  .column .news-section,
  .column .news-feed-content,
  .column .schedule-content,
  .column .standings-content,
  .column .social-feed-container,
  .column .videos-container {
    padding-bottom: 60px !important;
  }
  
  /* Mobile News Section Height Allocation */
  .column.news .news-main-container {
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
  }
  
  /* Headlines section takes 60% of available height */
  .column.news .news-section:first-child {
    flex: 3 !important; /* 60% = 3 parts out of 5 total */
    display: flex !important;
    flex-direction: column !important;
    min-height: 0 !important;
  }
  
  /* Breaking section takes 40% of available height */
  .column.news .news-section:last-child {
    flex: 2 !important; /* 40% = 2 parts out of 5 total */
    display: flex !important;
    flex-direction: column !important;
    min-height: 0 !important;
  }
  
  /* Ensure feed content areas fill their containers */
  .column.news .news-feed-content,
  .column.news .news-content-pane {
    flex: 1 !important;
    overflow-y: auto !important;
    min-height: 0 !important;
  }
}

/* Bottom Toolbar Styling */
#mobile-bottom-toolbar {
  display: none;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 60px;
  background-color: #000;
  border-top: 1px solid #333;
  z-index: 1000;
  justify-content: center;
  align-items: center;
  gap: 1px;
}

@media (max-width: 767px) {
  #mobile-bottom-toolbar {
    display: flex !important;
  }
}

.mobile-toolbar-btn {
  flex: 1;
  height: 50px;
  background-color: #333; /* Dark gray for inactive */
  color: #ccc; /* Light text for inactive */
  border: none;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

/* Special styling for the league button (first button) */
#mobile-league-btn {
  flex: 1.5; /* Make it 1.5x as wide as other buttons (25% reduction from previous 2x) */
  flex-direction: row; /* Horizontal layout for league name and arrow */
  justify-content: space-between; /* Space between text and arrow */
  align-items: center; /* Center vertically */
  padding: 8px 12px; /* Add padding for better spacing */
  text-align: left; /* Left align the text */
}

#mobile-league-btn span:first-child {
  flex: 1; /* League name takes available space */
  text-align: left; /* Left align league name */
  line-height: 1.2; /* Better line height for multi-line text */
  word-wrap: break-word; /* Allow text to wrap */
  overflow-wrap: break-word; /* Better word wrapping */
}

#mobile-league-btn span:last-child {
  flex-shrink: 0; /* Arrow doesn't shrink */
  margin-left: 8px; /* Space between text and arrow */
}

.mobile-toolbar-btn.active {
  background-color: #ccc !important; /* Light gray for active league */
  color: #333 !important; /* Dark text for active league */
}

.mobile-toolbar-btn:not(.active):hover {
  background-color: #444;
}

/* Mobile Menu Overlay */
#mobile-league-menu {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.9);
  z-index: 2000;
  overflow-y: auto;
  padding: 20px;
}

#mobile-league-menu .menu-content {
  background-color: #151515;
  border-radius: 8px;
  padding: 20px;
  max-width: 400px;
  margin: 0 auto;
}
#mobile-league-menu .menu-header {
  color: white;
  font-size: 18px;
  font-weight: bold;
  margin-bottom: 20px;
  text-align: center;
  border-bottom: 1px solid #333;
  padding-bottom: 10px;
}

#mobile-league-menu .league-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

#mobile-league-menu .league-list li {
  padding: 12px 0;
  border-bottom: 1px solid #333;
  color: #ccc;
  cursor: pointer;
  transition: color 0.2s ease;
}

#mobile-league-menu .league-list li:hover {
  color: white;
}

#mobile-league-menu .close-btn {
  position: absolute;
  top: 15px;
  right: 20px;
  background: none;
  border: none;
  color: white;
  font-size: 24px;
  cursor: pointer;
}

/* Standings Tabs Styling - Updated to match site design */
.standings-tabs {
    display: flex;
    margin-bottom: 20px;
    background-color: #2a2a2a;
    overflow: hidden;
    width: 100%;
}

.tab-button {
    background: #2a2a2a;
    border: none;
    padding: 0;
    color: #9ca3af;
    cursor: pointer;
    font-size: 10px;
    font-weight: normal;
    line-height: 18px;
    height: 18px;
    transition: all 0.2s ease;
    flex: 1;
    text-align: center;
    width: 50%;
}

.tab-button:hover {
    color: #ffffff;
    background-color: #374151;
}

.tab-button.active {
    background-color: #2a2a2a;
    color: #ffffff;
    font-weight: bold;
    border-bottom: 2px solid #ffffff;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

.division-section {
    margin-bottom: 20px;
}

.division-header {
    color: #ffffff;
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 8px;
    padding: 8px 0;
    border-bottom: 1px solid #4a4a4a;
}

.conference-header {
    color: #ffffff;
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 12px;
    padding: 10px 0;
    border-bottom: 1px solid #4a4a4a;
}

.conference-section {
    margin-bottom: 25px;
}

.wnba-standings .conference-section:last-child {
    margin-bottom: 0;
}

/* FINAL OVERRIDE: Force 11px on all first columns of game tables - must be last */
.game-table td:first-child { font-size: 11px !important; }
.game-table td:nth-child(1) { font-size: 11px !important; }
/* League-specific column uses 10px for start time column */
#league-specific-column .game-table td:first-child { font-size: 10px !important; }
#league-specific-column .game-table td:nth-child(1) { font-size: 10px !important; }
</style>

<!-- Add this snippet above closing </head> or integrate into your existing <style> section -->

  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WWK5WV7N"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    
    <!-- Redirect mobile subdomain to main domain -->
    <script>
      // Immediate redirect for mobile subdomain
      if (window.location.hostname === 'm.thporth.com') {
        // Use replace to avoid back button issues
        window.location.replace('https://thporth.com' + window.location.pathname + window.location.search + window.location.hash);
      }
    </script>
    
    <!-- Fallback meta refresh for mobile subdomain -->
    <script>
      if (window.location.hostname === 'm.thporth.com') {
        document.write('<meta http-equiv="refresh" content="0; url=https://thporth.com' + window.location.pathname + window.location.search + window.location.hash + '">');
      }
    </script>
    
	  <header id="resp-header">
  <button id="menu-toggle" aria-label="Open menu">
    <span class="hamburger"></span>
  </button>
  <img src="thporth_AllSportsNews_logo-white.png"
       alt="THPORTH" id="header-logo"/>
  <button id="games-toggle">Games</button>
</header>
        <div id="topBar" style="position: relative;">
            <div id="responsive-tabs" style="display: none;">
                <button id="videos-tab" class="videos-tab-btn" style="display: none;">Videos</button>
                <button id="social-tab" class="videos-tab-btn" style="display: none;">Social</button>
                <button id="news-tab" class="videos-tab-btn" style="display: none;">News</button>
            </div>
        </div>
    <div id="topDivider"></div>
    
    <!-- Banner Ads Section -->
    <div id="banner-ads" style="display: flex; justify-content: center; align-items: center; background-color: #000; padding: 10px 0; width: 100%; box-sizing: border-box;">
      <div class="ad-container" style="width: 728px; height: 90px; display: flex; justify-content: center; align-items: center; transform-origin: center;">
        <script type="text/javascript">
          atOptions = {
            'key' : '452de3915164cea7c2886de2ad095172',
            'format' : 'iframe',
            'height' : 90,
            'width' : 728,
            'params' : {}
          };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/452de3915164cea7c2886de2ad095172/invoke.js"></script>
      </div>
    </div>
    
    
    <div class="container">
  
     <!-- MAIN MENU COLUMN -->
      <div class="column main-menu">
        <div id="menuTopBox">
          <div class="menu-logo-section">
          <img
            src="https://thporth.com/THPORTH%20logo.png"
            alt="Logo"
              width="54"
              height="18"
            />
          </div>
          <!-- <div class="menu-support-section">
            <a href="https://ko-fi.com/ajolly2" target="_blank" rel="noopener noreferrer" id="supportButton" class="support-button">
              SUPPORT THPORTH&nbsp;&nbsp;<img src="new-tab.png" alt="" width="10" height="10" style="height: 10px; vertical-align: top; display: inline-block;">
            </a>
          </div> -->
        </div>
        <input type="text" id="menuSearch" placeholder="Search leagues" />
        <div id="menuFilters">
          <span class="menu-filter active" data-filter="123">123</span>
          <span class="menu-filter" data-filter="az">A‑Z</span>
          <span class="menu-filter" data-filter="group">Group</span>
        </div>
        <div id="menuList">
          <!-- 123 FILTER LIST -->
          <ul id="menuList-123" style="margin-top: 0; padding-top: 0;">
            <li data-section="Home" class="selected"><img src="https://thporth.com//Screenshot%202025-09-27%20at%2009.04.02.png" alt="ALL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">ALL</li>
            <li data-section="NFL"><img src="https://www.flashscore.com/res/image/data/W6t8omXI-prCDKdX1.png" alt="NFL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NFL</li>
            <li data-section="NBA"><img src="https://static.flashscore.com/res/image/data/OhgQNlXI-nyYPIw0n.png" alt="NBA" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NBA</li>
            <li data-section="MLB"><img src="https://www.flashscore.com/res/image/data/QPJ3alWI-pS3BMXxt.png" alt="MLB" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">MLB</li>
            <li data-section="NHL"><img src="https://static.flashscore.com/res/image/data/lrwv6KTp-YJ8QXhUB.png" alt="NHL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NHL</li>
            <li data-section="FormulaOne"><img src="https://thporth.com/f1.png" alt="Formula One" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Formula One</li>
            <li data-section="NCAAF"><img src="https://static.flashscore.com/res/image/data/4G8cBECO-lb1Ym94R.png" alt="NCAAF" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAAF</li>
            <li data-section="Soccer"><img src="https://thporth.com/Soccer.png" alt="Soccer" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Soccer
              <ul class="nested">
                <li data-section="PremierLeague"><img src="https://thporth.com/premierleague.png" alt="Premier League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Premier League</li>
                <li data-section="UEFAChampionsLeague"><img src="https://thporth.com/UCL.png" alt="UEFA Champions League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UEFA Champions League</li>
                <li data-section="MLS"><img src="https://static.flashscore.com/res/image/data/CAewoRXI-IaphYoEb.png" alt="MLS" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">MLS</li>
                <li data-section="LaLiga"><img src="https://static.flashscore.com/res/image/data/6aNYx0jD-A3tOPy9B.png" alt="LaLiga" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">LaLiga</li>
                <li data-section="SerieA"><img src="https://static.flashscore.com/res/image/data/rFHMayEO-2exwJQks.png" alt="Serie A" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Serie A</li>
                <li data-section="Bundesliga"><img src="https://static.flashscore.com/res/image/data/fqltz6CO-4ATnefbq.png" alt="Bundesliga" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Bundesliga</li>
                <li data-section="FACup"><img src="https://static.flashscore.com/res/image/data/G6WqthjD-rgOxvTTi.png" alt="FA Cup" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">FA Cup</li>
                <li data-section="LigaMX"><img src="https://static.flashscore.com/res/image/data/W2jTtTGG-xUMr3lkT.png" alt="Liga MX" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Liga MX</li>
                <li data-section="NWSL"><img src="https://static.flashscore.com/res/image/data/rgWCa7U1-Icc3DbSa.png" alt="NWSL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NWSL</li>
                <li data-section="Ligue1"><img src="https://thporth.com/LIgue%201.png" alt="Ligue 1" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Ligue 1</li>
                <li data-section="UEFAEuropaLeague"><img src="https://static.flashscore.com/res/image/data/lxUusmmd-nyYh4pi6.png" alt="UEFA Europa League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UEFA Europa League</li>
                <li data-section="UEFAConferenceLeague"><img src="https://static.flashscore.com/res/image/data/6a9THkA7-fmGCnzrf.png" alt="UEFA Conference League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UEFA Conference League</li>
              </ul>
            </li>
            <li data-section="NCAAM"><img src="https://static.flashscore.com/res/image/data/UN5z4YU1-x4aPTEVr.png" alt="NCAAM" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAAM</li>
            <li data-section="NCAAW"><img src="https://static.flashscore.com/res/image/data/UN5z4YU1-x4aPTEVr.png" alt="NCAAW" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAAW</li>
            <li data-section="PGATour"><img src="https://thporth.com/PGATour.png" alt="PGA Tour" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">PGA Tour</li>
            <li data-section="UFC"><img src="https://static.flashscore.com/res/image/data/tx44OMld-rojuRsh2.png" alt="UFC" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UFC</li>
            <li data-section="Boxing"><img src="https://thporth.com/Github%20boxing.png" alt="Boxing" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Boxing</li>
            <li data-section="NASCARCupSeries"><img src="https://thporth.com/nascar.png" alt="NASCAR Cup Series" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NASCAR Cup Series</li>
            <li data-section="Tennis"><img src="https://thporth.com/atp.png" alt="Tennis" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Tennis</li>
            <li data-section="WNBA"><img src="https://thporth.com/WNBA.png" alt="WNBA" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">WNBA</li>
            <li data-section="LIVGolf"><img src="https://thporth.com/LIVGolf.png" alt="LIV Golf" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">LIV Golf</li>
            <li data-section="IndyCar"><img src="https://static.flashscore.com/res/image/data/IXFCbsU1-fHN2vRWr.png" alt="IndyCar" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">IndyCar</li>
           <!-- <li data-section="UFL">UFL</li> -->
           <!-- <li data-section="NCAABaseball"><img src="https://static.flashscore.com/res/image/data/UN5z4YU1-423yojZa.png" alt="NCAA Baseball" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAA Baseball</li> -->
           <!-- <li data-section="NCAASoftball"><img src="https://static.flashscore.com/res/image/data/UN5z4YU1-423yojZa.png" alt="NCAA Softball" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAA Softball</li> -->
            <li data-section="MotoGP"><img src="https://thporth.com/motogp.png" alt="MotoGP" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">MotoGP</li>
            <li data-section="LPGATour"><img src="https://thporth.com/LPGATour.png" alt="LPGA Tour" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">LPGA Tour</li>
           <!-- <li data-section="TrackAndField"><img src="https://github.com/kyle4news/thporth/blob/main/Screenshot%202025-09-27%20at%2005,05,08-Picsart-BackgroundRemover.png?raw=true" alt="Track & Field" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Track & Field</li> -->
            <br><br><br><br><br><br><br><br>
          </ul>
          <!-- A‑Z FILTER LIST (Complete) -->
        <ul id="menuList-az" style="display: none;">
            <li data-section="Home"><img src="https://thporth.com//Screenshot%202025-09-27%20at%2009.04.02.png" alt="ALL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">ALL</li>
           <!-- <li data-section="AFCChampionsLeagueElite">AFC Champions League Elite</li>
            <li data-section="AFL">AFL</li>
            <li data-section="AfricaCupOfNations">Africa Cup of Nations</li>
            <li data-section="ARCAMenards">ARCA Menards</li>
            <li data-section="ArgentinePrimera">Argentine Primera</li>
            <li data-section="BelgianProLeague">Belgian Pro League</li>
            <li data-section="BigBashLeague">Big Bash League</li> -->
            <li data-section="Boxing"><img src="https://thporth.com/Github%20boxing.png" alt="Boxing" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Boxing</li>
          <!--   <li data-section="Brasileirao">Brasileirão</li> -->
            <li data-section="Bundesliga"><img src="https://static.flashscore.com/res/image/data/fqltz6CO-4ATnefbq.png" alt="Bundesliga" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Bundesliga</li>
         <!--    <li data-section="CAFChampionsLeague">CAF Champions League</li>
            <li data-section="CanadianPremierLeague">Canadian Premier League</li>
            <li data-section="CarabaoCup">Carabao Cup</li>
            <li data-section="CFL">CFL</li>
            <li data-section="CONCACAFChampionsCup">Concacaf Champions Cup</li>
            <li data-section="CONCACAFGoldCup">Concacaf Gold Cup</li>
            <li data-section="CONCACAFNationsLeague">Concacaf Nations League</li>
            <li data-section="CONCACAFWGoldCup">Concacaf W Gold Cup</li>
            <li data-section="CopaDelRey">Copa del Rey</li>
            <li data-section="CopaLibertadores">Copa Libertadores</li>
            <li data-section="CopaSudamericana">Copa Sudamericana</li>
            <li data-section="CoppaItalia">Coppa Italia</li>
            <li data-section="Cricket">Cricket</li>
            <li data-section="Cycling">Cycling</li>
            <li data-section="DFBPokal">DFB-Pokal</li>
            <li data-section="EFLChampionship">EFL Championship</li>
            <li data-section="EuroLeague">EuroLeague</li> -->
            <li data-section="FACup"><img src="https://static.flashscore.com/res/image/data/G6WqthjD-rgOxvTTi.png" alt="FA Cup" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">FA Cup</li>
         <!--    <li data-section="FIFAClubWorldCup">FIFA Club World Cup</li>
            <li data-section="FigureSkating">Figure Skating</li> -->
            <li data-section="FormulaOne"><img src="https://thporth.com/f1.png" alt="Formula One" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Formula 1</li>
         <!--    <li data-section="Formula2">Formula 2</li>
            <li data-section="Formula3">Formula 3</li>
            <li data-section="Gymnastics">Gymnastics</li>
            <li data-section="HorseRacing">Horse Racing</li> -->
            <li data-section="IndyCar"><img src="https://static.flashscore.com/res/image/data/IXFCbsU1-fHN2vRWr.png" alt="IndyCar" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">IndyCar</li>
         <!--    <li data-section="KornFerryTour">Korn Ferry Tour</li> -->
            <li data-section="LaLiga"><img src="https://static.flashscore.com/res/image/data/6aNYx0jD-A3tOPy9B.png" alt="LaLiga" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">LaLiga</li>
            <li data-section="LigaMX"><img src="https://static.flashscore.com/res/image/data/W2jTtTGG-xUMr3lkT.png" alt="Liga MX" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Liga MX</li>
         <!--    <li data-section="LigaPortugal">Liga Portugal</li> -->
            <li data-section="Ligue1"><img src="https://thporth.com/LIgue%201.png" alt="Ligue 1" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Ligue 1</li>
        <!--     <li data-section="LittleLeagueSoftballWorldSeries">Little League Softball</li>
            <li data-section="LittleLeagueWorldSeries">Little League World Series</li> -->
            <li data-section="LIVGolf"><img src="https://thporth.com/LIVGolf.png" alt="LIV Golf" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">LIV Golf</li>
            <li data-section="LPGATour"><img src="https://thporth.com/LPGATour.png" alt="LPGA Tour" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">LPGA Tour</li>
        <!--     <li data-section="MajorLeagueRugby">Major League Rugby</li> -->
            <li data-section="MLB"><img src="https://www.flashscore.com/res/image/data/QPJ3alWI-pS3BMXxt.png" alt="MLB" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">MLB</li>
            <li data-section="MLS"><img src="https://static.flashscore.com/res/image/data/CAewoRXI-IaphYoEb.png" alt="MLS" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">MLS</li>
          <!--   <li data-section="MMA">MMA</li> -->
            <li data-section="MotoGP"><img src="https://thporth.com/motogp.png" alt="MotoGP" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">MotoGP</li>
            <li data-section="NASCARCupSeries"><img src="https://thporth.com/nascar.png" alt="NASCAR Cup Series" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NASCAR Cup Series</li>
            <li data-section="NBA"><img src="https://static.flashscore.com/res/image/data/OhgQNlXI-nyYPIw0n.png" alt="NBA" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NBA</li>
         <!--    <li data-section="NBAGLeague">NBA G League</li>
            <li data-section="NCAAB">NCAAB</li> -->
            <li data-section="NCAAF"><img src="https://static.flashscore.com/res/image/data/4G8cBECO-lb1Ym94R.png" alt="NCAAF" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAAF</li>
            <li data-section="NCAAM"><img src="https://static.flashscore.com/res/image/data/UN5z4YU1-x4aPTEVr.png" alt="NCAAM" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAAM</li>
            <li data-section="NCAAW"><img src="https://static.flashscore.com/res/image/data/UN5z4YU1-x4aPTEVr.png" alt="NCAAW" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAAW</li>
           <!-- <li data-section="NCAABaseball">NCAA Baseball</li> -->
        <!--     <li data-section="NCAAMensHockey">NCAA Men's Hockey</li> -->
           <!-- <li data-section="NCAASoftball">NCAA Softball</li> -->
            <li data-section="NFL"><img src="https://www.flashscore.com/res/image/data/W6t8omXI-prCDKdX1.png" alt="NFL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NFL</li>
            <li data-section="NHL"><img src="https://static.flashscore.com/res/image/data/lrwv6KTp-YJ8QXhUB.png" alt="NHL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NHL</li>
         <!--    <li data-section="NHRA">NHRA</li> -->
          <li data-section="NWSL"><img src="https://static.flashscore.com/res/image/data/rgWCa7U1-Icc3DbSa.png" alt="NWSL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NWSL</li>
          <!--  <li data-section="Olympics">Olympics</li>
            <li data-section="PGAChampions">PGA Champions</li> -->
            <li data-section="PGATour"><img src="https://thporth.com/PGATour.png" alt="PGA Tour" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">PGA Tour</li>
          <li data-section="PremierLeague"><img src="https://thporth.com/premierleague.png" alt="Premier League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Premier League</li>
         <!--    <li data-section="PremiershipRugby">Premiership Rugby</li>
            <li data-section="SaudiProLeague">Saudi Pro League</li>
            <li data-section="ScottishPremiership">Scottish Premiership</li> -->
      <li data-section="SerieA"><img src="https://static.flashscore.com/res/image/data/rFHMayEO-2exwJQks.png" alt="Serie A" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Serie A</li>
              <li data-section="Soccer"><img src="https://thporth.com/Soccer.png" alt="Soccer" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Soccer</li>
            <li data-section="Tennis"><img src="https://thporth.com/atp.png" alt="Tennis" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Tennis</li>
         <!--   <li data-section="TGL">TGL</li> -->
           <!-- <li data-section="TrackAndField">Track & Field</li> -->
<!--
            <li data-section="USOpenCup">U.S. Open Cup</li> -->
            <li data-section="UFC"><img src="https://static.flashscore.com/res/image/data/tx44OMld-rojuRsh2.png" alt="UFC" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UFC</li>
            <!-- <li data-section="UFL">UFL</li> -->
            <li data-section="UEFAChampionsLeague"><img src="https://thporth.com/UCL.png" alt="UEFA Champions League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UEFA Champions League</li>
            <li data-section="UEFAConferenceLeague"><img src="https://static.flashscore.com/res/image/data/6a9THkA7-fmGCnzrf.png" alt="UEFA Conference League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UEFA Conference League</li>
            <li data-section="UEFAEuropaLeague"><img src="https://static.flashscore.com/res/image/data/lxUusmmd-nyYh4pi6.png" alt="UEFA Europa League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UEFA Europa League</li>
        <!--      <li data-section="UEFANationsLeague">UEFA Nations League</li>
              <li data-section="UEFAWChampionsLeague">Women's UCL</li>
            <li data-section="Volleyball">Volleyball</li> -->
            <li data-section="WNBA"><img src="https://thporth.com/WNBA.png" alt="WNBA" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">WNBA</li>
           <!--   <li data-section="WomensSuperLeague">Women's Super League</li>
            <li data-section="XGames">X Games</li> -->
            <li class="spacer-line"></li>
            <li class="spacer-line"></li>
            <li class="spacer-line"></li>
          </ul>
          <!-- GROUP FILTER LIST -->
          <ul id="menuList-group" style="display: none;">
          <li data-section="Home"><span style="font-weight: bold;">ALL</span></li>            
            <li class="spacer-line"></li>
            <li><strong>FOOTBALL</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="NFL"><img src="https://www.flashscore.com/res/image/data/W6t8omXI-prCDKdX1.png" alt="NFL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NFL</li>
               <!-- <li data-section="NCAAF">NCAAF</li> -->
             <!-- <li data-section="UFL">UFL)-->
              <!-- <li data-section="CFL">CFL)-->
            </ul>
            <li class="spacer-line"></li>
            <li><strong>BASEBALL</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="MLB"><img src="https://www.flashscore.com/res/image/data/QPJ3alWI-pS3BMXxt.png" alt="MLB" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">MLB</li>
             <!-- <li data-section="NCAABaseball">NCAA Baseball</li> -->
              <!-- <li data-section="LittleLeagueWorldSeries">Little League World Series</li> -->
            </ul>
            <li class="spacer-line"></li>
            <li><strong>BASKETBALL</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="NBA"><img src="https://static.flashscore.com/res/image/data/OhgQNlXI-nyYPIw0n.png" alt="NBA" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NBA</li>
              <li data-section="WNBA"><img src="https://thporth.com/WNBA.png" alt="WNBA" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">WNBA</li>
              <li data-section="NCAAM"><img src="https://static.flashscore.com/res/image/data/UN5z4YU1-x4aPTEVr.png" alt="NCAAM" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAAM</li>
              <li data-section="NCAAW"><img src="https://static.flashscore.com/res/image/data/UN5z4YU1-x4aPTEVr.png" alt="NCAAW" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NCAAW</li>
             <!--  <li data-section="NBAGLeague">NBA G League</li> -->
             <!--  <li data-section="EuroLeague">EuroLeague</li> -->
            </ul>
            <li class="spacer-line"></li>
            <li><strong>SOCCER</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="PremierLeague"><img src="https://thporth.com/premierleague.png" alt="Premier League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Premier League</li>
              <li data-section="UEFAChampionsLeague"><img src="https://thporth.com/UCL.png" alt="UEFA Champions League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UEFA Champions League</li>
              <li data-section="MLS"><img src="https://static.flashscore.com/res/image/data/CAewoRXI-IaphYoEb.png" alt="MLS" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">MLS</li>
              <li data-section="LaLiga"><img src="https://static.flashscore.com/res/image/data/6aNYx0jD-A3tOPy9B.png" alt="LaLiga" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">LaLiga</li>
              <li data-section="SerieA"><img src="https://static.flashscore.com/res/image/data/rFHMayEO-2exwJQks.png" alt="Serie A" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Serie A</li>
              <li data-section="Bundesliga"><img src="https://static.flashscore.com/res/image/data/fqltz6CO-4ATnefbq.png" alt="Bundesliga" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Bundesliga</li>
              <li data-section="FACup"><img src="https://static.flashscore.com/res/image/data/G6WqthjD-rgOxvTTi.png" alt="FA Cup" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">FA Cup</li>
              <li data-section="LigaMX"><img src="https://static.flashscore.com/res/image/data/W2jTtTGG-xUMr3lkT.png" alt="Liga MX" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Liga MX</li>
              <li data-section="NWSL"><img src="https://static.flashscore.com/res/image/data/rgWCa7U1-Icc3DbSa.png" alt="NWSL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NWSL</li>
              <li data-section="Ligue1"><img src="https://thporth.com/LIgue%201.png" alt="Ligue 1" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Ligue 1</li>
              <li data-section="UEFAEuropaLeague"><img src="https://static.flashscore.com/res/image/data/lxUusmmd-nyYh4pi6.png" alt="UEFA Europa League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UEFA Europa League</li>
              <li data-section="UEFAConferenceLeague"><img src="https://static.flashscore.com/res/image/data/6a9THkA7-fmGCnzrf.png" alt="UEFA Conference League" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UEFA Conference League</li>
             <!--  <li class="soccer-more-toggle" style="cursor: pointer; color: #bebebe;" onclick="toggleSoccerMore()">More…</li> -->
            </ul>
            <!-- <div id="soccer-more" style="display: none;">
              <ul style="padding-left: 10px;">
                <li data-section="CarabaoCup">Carabao Cup</li>
                <li data-section="UEFANationsLeague">UEFA Nations League</li>
                <li data-section="CONCACAFNationsLeague">Concacaf Nations League</li>
                <li data-section="SaudiProLeague">Saudi Pro League</li>
                <li data-section="EFLChampionship">EFL Championship</li>
                <li data-section="CopaDelRey">Copa del Rey</li>
                <li data-section="FIFAClubWorldCup">FIFA Club World Cup</li>
                <li data-section="Brasileirao">Brasileirão</li>
                <li data-section="AFCChampionsLeagueElite">AFC Champions League Elite</li>
                <li data-section="CopaLibertadores">Copa Libertadores</li>
                <li data-section="CONCACAFGoldCup">Concacaf Gold Cup</li>
                <li data-section="CONCACAFWGoldCup">Concacaf W Gold Cup</li>
                <li data-section="CopaSudamericana">Copa Sudamericana</li>
                <li data-section="CanadianPremierLeague">Canadian Premier League</li>
                <li data-section="CoppaItalia">Coppa Italia</li>
                <li data-section="DFBPokal">DFB-Pokal</li>
                <li data-section="ScottishPremiership">Scottish Premiership</li>
                <li data-section="UEFAWChampionsLeague">Women's UCL</li>
                <li data-section="CAFChampionsLeague">CAF Champions League</li>
                <li data-section="AfricaCupOfNations">Africa Cup of Nations</li>
                <li data-section="CONCACAFChampionsCup">Concacaf Champions Cup</li>
                <li data-section="ArgentinePrimera">Argentine Primera</li>
                <li data-section="BelgianProLeague">Belgian Pro League</li>
                <li data-section="WomensSuperLeague">Women's Super League</li>
                <li data-section="LigaPortugal">Liga Portugal</li>
                <li data-section="USOpenCup">U.S. Open Cup</li>
              </ul>
            </div> -->
            <li class="spacer-line"></li>
            <li><strong>HOCKEY</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="NHL"><img src="https://static.flashscore.com/res/image/data/lrwv6KTp-YJ8QXhUB.png" alt="NHL" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NHL</li>
             <!--  <li data-section="NCAAMensHockey">NCAA Men's Hockey</li> -->
            </ul>
            <li class="spacer-line"></li>
            <li><strong>MOTORSPORTS</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="FormulaOne"><img src="https://thporth.com/f1.png" alt="Formula One" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Formula 1</li>
              <li data-section="NASCARCupSeries"><img src="https://thporth.com/nascar.png" alt="NASCAR Cup Series" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">NASCAR Cup Series</li>
              <li data-section="IndyCar"><img src="https://static.flashscore.com/res/image/data/IXFCbsU1-fHN2vRWr.png" alt="IndyCar" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">IndyCar</li>
              <li data-section="MotoGP"><img src="https://thporth.com/motogp.png" alt="MotoGP" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">MotoGP</li>
           <!--    <li data-section="NHRA">NHRA</li>
              <li data-section="NASCARXfinitySeries">NASCAR Xfinity Series</li>
              <li data-section="NASCARTruckSeries">NASCAR Truck Series</li>
              <li data-section="Formula2">Formula 2</li>
              <li data-section="Formula3">Formula 3</li>
              <li data-section="ARCAMenards">ARCA Menards</li> -->
            </ul>
            <li class="spacer-line"></li>
            <li><strong>GOLF</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="PGATour"><img src="https://thporth.com/PGATour.png" alt="PGA Tour" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">PGA Tour</li>
              <li data-section="LIVGolf"><img src="https://thporth.com/LIVGolf.png" alt="LIV Golf" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">LIV Golf</li>
           <!--    <li data-section="TGL">TGL</li> -->
              <li data-section="LPGATour"><img src="https://thporth.com/LPGATour.png" alt="LPGA Tour" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">LPGA Tour</li>
         <!--      <li data-section="PGAChampions">PGA Champions</li>
              <li data-section="DPWorldTour">DP World Tour</li>
              <li data-section="KornFerryTour">Korn Ferry Tour</li> -->
            </ul>
            <li class="spacer-line"></li>
            <li><strong>FIGHTING</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="UFC"><img src="https://static.flashscore.com/res/image/data/tx44OMld-rojuRsh2.png" alt="UFC" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">UFC</li>
              <li data-section="Boxing"><img src="https://thporth.com/Github%20boxing.png" alt="Boxing" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Boxing</li>
            <!--   <li data-section="MMA">MMA</li> -->
            </ul>
            <li class="spacer-line"></li>
           <!--  <li><strong>TENNIS</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="ATP">ATP</li>
              <li data-section="WTA">WTA</li>
            </ul> 
            <li class="spacer-line"></li> -->
           <!-- <li><strong>SOFTBALL</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="NCAASoftball">NCAA Softball</li>
               <li data-section="LittleLeagueSoftballWorldSeries">Little League Softball</li>
            </ul>
            <li class="spacer-line"></li> -->
           <!--  <li><strong>RUGBY</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="RugbyUnion">Rugby Union</li>
              <li data-section="PremiershipRugby">Premiership Rugby</li>
              <li data-section="MajorLeagueRugby">Major League Rugby</li>
            </ul>
            <li class="spacer-line"></li>
            <li><strong>CRICKET</strong></li>
            <ul style="padding-left: 10px;">
              <li data-section="BigBashLeague">Big Bash League</li>
            </ul> 
            <li class="spacer-line"></li> -->
            <li><strong>OTHER</strong></li>
            <ul style="padding-left: 10px;">
<!--
              <li data-section="AFL">AFL</li>
              <li data-section="Cycling">Cycling</li>
              <li data-section="FigureSkating">Figure Skating</li>
              <li data-section="Gymnastics">Gymnastics</li>
              <li data-section="HorseRacing">Horse Racing</li>
              <li data-section="Olympics">Olympics</li>
              <li data-section="Volleyball">Volleyball</li>
              <li data-section="XGames">XGames</li>
            -->
              <li data-section="Tennis"><img src="https://thporth.com/atp.png" alt="Tennis" style="width: 12px; height: 12px; margin-right: 6px; vertical-align: top; display: inline-block;" width="12" height="12">Tennis</li>
             <!-- <li data-section="TrackAndField">Track & Field</li> -->
              <li class="spacer-line"></li>
              <li class="spacer-line"></li>
              <li class="spacer-line"></li>
            </ul>
          </ul>
        </div>
      </div>


      <!-- Divider between main menu and standings -->
<div class="divider"></div>

<!-- ─── TV-LISTINGS COLUMN (Default View) ──────────────────────────────────────── -->
<div class="column tv-listings" id="games-column" style="background-color: #1f1f1f;">
  <div id="tv-listings-container" style="display: flex; flex-direction: column;">
    <div id="games-header" style="
        position: sticky; top: 0; width: 100%; height: 18px;
        background-color: #3c3c3c; font-family: Helvetica, Arial, sans-serif;
        font-size: 10px; display: flex; align-items: center;
        padding-left: 1px; z-index: 11; border-bottom: 1px solid #1f1f1f;
      ">
      <strong>Games</strong>
    </div>

    <div id="games-tabs" style="display: flex; height: 18px; background-color: #2a2a2a;">
      <div class="games-tab" data-tab="scores">SCORES</div>
      <div class="games-tab active" data-tab="today">TODAY</div>
      <div id="live-filter-toggle" class="games-tab"><span style="display: inline-block; width: 3px; height: 3px; background-color: #ff0000; border-radius: 50%; margin-right: 4px; margin-left: 2px; vertical-align: middle; transform: translateY(-2px);"></span>LIVE</div>
    </div>
    <div id="tv-listings-scores" class="games-content">
      <div id="scoresWrapper">
        <div id="scoresLoading" class="loading-indicator hidden">
          <svg class="loading-spinner" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <p class="loading-text">Loading yesterday's scores...</p>
        </div>
        <div id="scoresErrorMessage" class="error-message hidden" role="alert">
          <strong>Error!</strong>
          <span id="scoresErrorText"></span>
        </div>
        <div id="dynamicScoresContent"></div>
      </div>
    </div>
    <div id="tv-listings-today" class="games-content active">
      <div id="games"></div>
      <div id="error" class="error"></div>
    </div>
    </div>

  <div id="f1-column-content" style="display: none; height: 100%; flex-direction: column; background-color: #1f1f1f; color: #ffffff;">
      <!-- League Header -->
      <div id="f1-league-header" style="position: sticky; top: 0; width: 100%; height: 18px; background-color: #3c3c3c; font-family: Helvetica, Arial, sans-serif; font-size: 10px; display: flex; align-items: center; padding-left: 10px; z-index: 11; border-bottom: 1px solid #1f1f1f; font-weight: bold;">
          Formula One
      </div>
      
      <!-- Main Tabs: Schedule | Standings -->
      <div id="f1-main-tabs" style="display: flex; height: 18px; background-color: #2a2a2a; overflow: hidden; flex-shrink: 0; gap: 2px; margin-top: 2px;">
          <div class="f1-main-tab" data-f1-main-tab="schedule" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #ccc;">SCHEDULE</div>
          <div class="f1-main-tab active" data-f1-main-tab="standings" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #fff; color: #000; font-weight: bold;">STANDINGS</div>
      </div>
  
      <!-- Schedule Tab Content -->
      <div id="f1-schedule-tab-content" class="f1-main-tab-content" style="display: none; height: calc(100% - 36px); flex-direction: column;">
          <!-- Schedule Sub-Tabs (Yesterday, Today, Upcoming) -->
          <div id="f1-schedule-tabs" style="display: flex; height: 18px; background-color: #2a2a2a; margin-top: 2px; margin-bottom: 1px; overflow: hidden; flex-shrink: 0; width: 100%; gap: 2px;">
              <!-- <div class="f1-schedule-tab" data-f1-schedule-tab="yesterday" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #ccc;">Yesterday</div> -->
              <div class="f1-schedule-tab" data-f1-schedule-tab="today" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #ccc;">Today</div>
              <div class="f1-schedule-tab active" data-f1-schedule-tab="upcoming" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #fff; border-bottom: 2px solid #fff;">Upcoming</div>
</div>
  
          <!-- Schedule Content Panes -->
          <div style="flex: 1; overflow-y: auto;">
              <div id="f1-yesterday-content" class="f1-schedule-content-pane" style="display: none; padding: 1rem;">
                  <p style="color: #9ca3af;">No Formula 1 events yesterday.</p>
              </div>
              <div id="f1-today-content" class="f1-schedule-content-pane" style="display: none; padding: 1rem;">
                  <p style="color: #9ca3af;">No Formula 1 events today.</p>
              </div>
              <div id="f1-upcoming-content" class="f1-schedule-content-pane" style="display: block; padding: 1rem; font-size: 0.875rem;">
                  <div id="f1-schedule-container">
                      <p style="color: #9ca3af;">Loading schedule...</p>
                  </div>
              </div>
          </div>
      </div>
  
      <!-- Standings Tab Content (active by default) -->
      <div id="f1-standings-tab-content" class="f1-main-tab-content" style="display: block; height: calc(100% - 36px); flex-direction: column;">
          <!-- Standings Sub-Tabs (Driver, Constructor) -->
          <div id="f1-standings-tabs" style="display: flex; height: 18px; background-color: #2a2a2a; margin-top: 2px; margin-bottom: 1px; overflow: hidden; flex-shrink: 0; width: 100%; gap: 2px;">
              <div class="f1-standings-tab active" data-f1-standings-tab="driver" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #fff; border-bottom: 2px solid #fff;">Driver</div>
              <div class="f1-standings-tab" data-f1-standings-tab="constructor" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #ccc;">Constructor</div>
          </div>
          
          <!-- Standings Content Panes -->
          <div style="flex: 1; overflow-y: auto; padding: 0.5rem;">
              <div id="f1-driver-standings-content" class="f1-standings-content-pane">
              <div id="driver-loading" style="text-align: center; padding: 20px; color: #9ca3af;">Loading driver standings...</div>
              <div id="driver-error" style="display: none; color: #ef4444; text-align: center; padding: 20px;"></div>
              <table id="driver-table" style="width: 100%; border-collapse: collapse; font-size: 11px; display: none;">
                <thead>
                  <tr style="text-align: left;">
                    <th style="padding: 6px 4px; width: 25px;">#</th>
                    <th style="padding: 6px 4px;">Driver</th>
                    <th style="padding: 6px 4px; text-align: right;">Pts</th>
                              <th style="padding: 6px 4px; text-align: right;">Wins</th>
                  </tr>
                </thead>
                <tbody id="driver-tbody"></tbody>
              </table>
            </div>
              <div id="f1-constructor-standings-content" class="f1-standings-content-pane" style="display: none;">
              <div id="constructor-loading" style="text-align: center; padding: 20px; color: #9ca3af;">Loading constructor standings...</div>
              <div id="constructor-error" style="display: none; color: #ef4444; text-align: center; padding: 20px;"></div>
              <table id="constructor-table" style="width: 100%; border-collapse: collapse; font-size: 11px; display: none;">
                <thead>
                  <tr style="text-align: left;">
                    <th style="padding: 6px 4px; width: 25px;">#</th>
                              <th style="padding: 6px 4px;">Constructor</th>
                    <th style="padding: 6px 4px; text-align: right;">Pts</th>
                              <th style="padding: 6px 4px; text-align: right;">Wins</th>
                  </tr>
                </thead>
                <tbody id="constructor-tbody"></tbody>
              </table>
            </div>
          </div>
      </div>
  </div>
  </div>
<br><br><br><br><br><br><br><br>
<!-- ─── LEAGUE-SPECIFIC COLUMN (New, Initially Hidden) ────────────────────────── -->
<div class="column" id="league-specific-column" style="display: none; flex: 0 1 250px; min-width: 200px; background-color: #1f1f1f; color: #ffffff; padding: 0; overflow-x: hidden;">
    <!-- Header will be dynamically set -->
    <div id="league-specific-header" style="position: sticky; top: 0; width: 100%; height: 18px; background-color: #3c3c3c; font-family: Helvetica, Arial, sans-serif; font-size: 10px; display: flex; align-items: center; padding-left: 10px; z-index: 11; border-bottom: 1px solid #1f1f1f; font-weight: bold;"></div>
    
            <!-- Main Tabs: Schedule | Standings (Stats hidden for now) -->
            <div id="main-tabs" style="display: flex; height: 18px; background-color: #2a2a2a; overflow: hidden; flex-shrink: 0;">
                <div class="main-tab active" data-main-tab="schedule" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; border-right: 1px solid #1f1f1f; background-color: #fff; color: #000; font-weight: bold;">SCHEDULE</div>
                <div class="main-tab" data-main-tab="standings" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #ccc;">STANDINGS</div>
                <!-- Stats tab hidden for now - keeping functionality intact -->
                <div class="main-tab" data-main-tab="stats" style="display: none; flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #ccc;">STATS</div>
            </div>

    <!-- Schedule Tab Content (active by default) -->
    <div id="schedule-tab-content" class="main-tab-content" style="display: block; height: calc(100% - 18px); flex-direction: column;">
        <!-- Schedule Sub-Tabs (Today/Upcoming) - Full Column Width -->
        <div id="schedule-tabs" style="display: flex; height: 18px; background-color: #2a2a2a; margin-bottom: 1px; overflow: hidden; flex-shrink: 0; width: 100%;">
            <div class="schedule-tab active" data-schedule-tab="today" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; border-right: 1px solid #1f1f1f; background-color: #2a2a2a; color: #fff; border-bottom: 2px solid #fff;">Today</div>
            <!-- <div class="schedule-tab" data-schedule-tab="yesterday" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; border-right: 1px solid #1f1f1f; background-color: #2a2a2a; color: #ccc;">Yesterday</div> -->
            <div class="schedule-tab" data-schedule-tab="upcoming" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #ccc;">Upcoming</div>
        </div>
        
        <!-- Schedule Content with padding -->
        <div style="padding: 0 0 1rem 0; flex: 1; display: flex; flex-direction: column;">
            <div id="league-schedule-today-content" class="schedule-content" style="display: block; flex: 1; overflow-y: auto; flex-direction: column; padding-bottom: 150px;">
                <!-- Tennis ATP/WTA sub-tabs for Today (only shown for Tennis) -->
                <div id="tennis-today-tabs" style="display: none; height: 18px; background-color: #2a2a2a; overflow: hidden; flex-shrink: 0; gap: 2px; margin-bottom: 2px;">
                    <div class="tennis-today-subtab active" data-tennis-today-tab="atp" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #fff; border-bottom: 2px solid #fff;">ATP</div>
                    <div class="tennis-today-subtab" data-tennis-today-tab="wta" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #ccc;">WTA</div>
                </div>
                <div id="tennis-today-atp-content" class="tennis-today-content" style="display: none; flex: 1; overflow-y: auto; padding-bottom: 150px;"><p style="color: #9ca3af;">Loading ATP schedule...</p></div>
                <div id="tennis-today-wta-content" class="tennis-today-content" style="display: none; flex: 1; overflow-y: auto; padding-bottom: 150px;"><p style="color: #9ca3af;">Loading WTA schedule...</p></div>
                <div id="league-schedule-today-default-content" style="flex: 1; overflow-y: auto; padding-bottom: 150px;"><p style="color: #9ca3af;">Loading today's schedule...</p></div>
            </div>
            <div id="league-schedule-yesterday-content" class="schedule-content" style="display: none; flex: 1; overflow-y: auto; padding-bottom: 150px;"><p style="color: #9ca3af;">Loading yesterday's scores...</p></div>
            <div id="league-schedule-upcoming-content" class="schedule-content" style="display: none; flex: 1; overflow-y: auto; flex-direction: column; padding-bottom: 150px;">
                <!-- Tennis ATP/WTA sub-tabs (only shown for Tennis) -->
                <div id="tennis-upcoming-tabs" style="display: none; height: 18px; background-color: #2a2a2a; overflow: hidden; flex-shrink: 0; gap: 2px; margin-bottom: 2px;">
                    <div class="tennis-upcoming-subtab active" data-tennis-tab="atp" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #fff; border-bottom: 2px solid #fff;">ATP</div>
                    <div class="tennis-upcoming-subtab" data-tennis-tab="wta" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #ccc;">WTA</div>
                </div>
                <div id="tennis-upcoming-atp-content" class="tennis-upcoming-content" style="display: none; flex: 1; overflow-y: auto; padding-bottom: 150px;"><p style="color: #9ca3af;">Loading ATP schedule...</p></div>
                <div id="tennis-upcoming-wta-content" class="tennis-upcoming-content" style="display: none; flex: 1; overflow-y: auto; padding-bottom: 150px;"><p style="color: #9ca3af;">Loading WTA schedule...</p></div>
                <div id="league-schedule-upcoming-default-content" style="flex: 1; overflow-y: auto; padding-bottom: 150px;"><p style="color: #9ca3af;">Loading upcoming schedule...</p></div>
            </div>
        </div>
    </div>

    <!-- Standings Tab Content (hidden by default) -->
    <div id="standings-tab-content" class="main-tab-content" style="display: none; padding: 5px; height: calc(100% - 18px); flex-direction: column; overflow-y: auto;">
        <!-- NCAA Standings Sub-Tabs (CFP for NCAAF only, Top 25, Standings) - only for NCAAF, NCAAM, NCAAW -->
        <div id="ncaa-standings-tabs" style="display: none; height: 18px; background-color: #2a2a2a; margin-bottom: 1px; overflow: hidden; flex-shrink: 0; width: 100%; gap: 2px;">
            <div class="ncaa-standings-tab active" data-ncaa-standings-tab="cfp" id="ncaa-cfp-tab" style="display: none; flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #fff; border-bottom: 2px solid #fff;">CFP</div>
            <div class="ncaa-standings-tab" data-ncaa-standings-tab="top25" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #ccc;">Top 25</div>
            <div class="ncaa-standings-tab" data-ncaa-standings-tab="standings" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #2a2a2a; color: #ccc;">Standings</div>
        </div>
        
        <!-- CFP Content (only for NCAAF) -->
        <div id="league-cfp-content" class="ncaa-standings-sub-content" style="display: none; flex: 1; overflow-y: auto; padding-bottom: 150px;"><p style="color: #9ca3af;">CFP rankings coming soon...</p></div>
        
        <!-- Top 25 Content (active by default for NCAA leagues) -->
        <div id="league-top25-content" class="ncaa-standings-sub-content" style="display: none; flex: 1; overflow-y: auto; padding-bottom: 150px;"><p style="color: #9ca3af;">Loading Top 25...</p></div>
        
        <!-- Standings Content (for conference standings) -->
        <div id="league-standings-content" style="flex: 1; padding-bottom: 150px;"><p style="color: #9ca3af;">Loading standings...</p></div>
    </div>

    <!-- Stats Tab Content (hidden by default) -->
    <div id="stats-tab-content" class="main-tab-content" style="display: none; height: calc(100% - 18px); flex-direction: column; overflow: hidden;">
        <!-- Stats Sub-Tabs (Player/Team) -->
        <div id="stats-sub-tabs" style="display: flex; height: 18px; background-color: #000; margin-bottom: 1px; overflow: hidden; flex-shrink: 0; width: 100%;">
            <div class="stats-sub-tab active" data-stats-sub-tab="player" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; border-right: 1px solid #1f1f1f; background-color: #000; color: #fff; border-bottom: 1px solid #fff;">Player</div>
            <div class="stats-sub-tab" data-stats-sub-tab="team" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; background-color: #000; color: #fff;">Team</div>
        </div>
        
        <!-- Player Stats Content (active by default) -->
        <div id="player-stats-content" class="stats-sub-content" style="display: flex; flex: 1; height: calc(100% - 18px); overflow: hidden;">
            <!-- Left Column: Category Menu (20% width) -->
            <div id="player-category-menu" class="stats-category-menu" style="width: 20%; background-color: #1f1f1f; border-right: 1px solid #1f1f1f; overflow-y: auto; padding-bottom: 150px; flex-shrink: 0;">
                <div class="stats-category-item active" data-category="batting" style="padding: 8px 2px; cursor: pointer; border-bottom: 1px solid #fff; background-color: #000; color: #fff; font-weight: bold; font-size: 9px; margin-bottom: 1px;">Batting</div>
                <div class="stats-category-item" data-category="pitching" style="padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;">Pitching</div>
                <div class="stats-category-item" data-category="fielding" style="padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;">Fielding</div>
                <div class="stats-category-item" data-category="advanced" style="padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;">Advanced</div>
            </div>
            
            <!-- Right Column: Stats Display (80% width) -->
            <div id="player-stats-display" class="stats-display" style="width: 80%; background-color: #000; overflow-y: auto; padding: 1rem; padding-bottom: 150px;">
                <div id="player-stats-content-area" style="color: #9ca3af;">Player statistics will be loaded here...</div>
            </div>
        </div>
        
        <!-- Team Stats Content (hidden by default) -->
        <div id="team-stats-content" class="stats-sub-content" style="display: none; flex: 1; height: calc(100% - 18px); overflow: hidden;">
            <!-- Left Column: Category Menu (20% width) -->
            <div id="team-category-menu" class="stats-category-menu" style="width: 20%; background-color: #1f1f1f; border-right: 1px solid #1f1f1f; overflow-y: auto; padding-bottom: 150px; flex-shrink: 0;">
                <div class="stats-category-item active" data-category="standings" style="padding: 8px 2px; cursor: pointer; border-bottom: 1px solid #fff; background-color: #000; color: #fff; font-weight: bold; font-size: 9px; margin-bottom: 1px;">Standings</div>
                <div class="stats-category-item" data-category="offense" style="padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;">Offense</div>
                <div class="stats-category-item" data-category="defense" style="padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;">Defense</div>
                <div class="stats-category-item" data-category="pitching" style="padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;">Pitching</div>
            </div>
            
            <!-- Right Column: Stats Display (80% width) -->
            <div id="team-stats-display" class="stats-display" style="width: 80%; background-color: #000; overflow-y: auto; padding: 1rem; padding-bottom: 150px;">
                <div id="team-stats-content-area" style="color: #9ca3af;">Team statistics will be loaded here...</div>
            </div>
        </div>
    </div>

</div>


      <!-- DIVIDER BETWEEN STANDINGS AND NEWS -->
      <div class="divider"></div>


      <!-- NEWS PANEL -->
      <div class="column news" style="height: 100%;">
        <!-- News header -->
        <div class="news-header" style="width: 100%; height: 18px;
            background-color: #3c3c3c; font-family: Helvetica, Arial, sans-serif;
            font-size: 10px; display: flex; align-items: center;
            padding-left: 1px; z-index: 11; border-bottom: 1px solid #1f1f1f;">News</div>

        <!-- Home News Section (Headlines + Breaking) -->
      <div id="news-Home" class="content-section" style="display: block; height: calc(100% - 18px);">
  <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
    <!-- Headlines Section -->
    <div class="news-section headlines-section" style="flex: 0 0 60%; min-height: 0;">
      <div class="news-section-header">Headlines</div>
      <div id="headlines-tabs">
        <div class="headlines-tab active" data-source="espn">ESPN</div>
        <div class="headlines-tab" data-source="cbs">CBS</div>
        <div class="headlines-tab" data-source="yahoo">Yahoo</div>
        <div class="headlines-tab" data-source="fox">FOX</div>
      </div>
      <div class="news-feed-content" id="espn-feed" style="display: block;">Loading ESPN...</div>
      <div class="news-feed-content" id="cbs-feed" style="display:none;">Loading CBS...</div>
      <div class="news-feed-content" id="yahoo-feed" style="display:none;">Loading Yahoo...</div>
      <div class="news-feed-content" id="fox-feed" style="display:none;">Loading FOX...</div>
    </div>
    <!-- Breaking/Fantasy/Transactions Tabs Section -->
    <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
      <div class="news-section-header breaking-tabs-header">
        <span class="news-tab active" data-tab="breaking">Breaking</span>
        <span class="news-tab" data-tab="fantasy">Fantasy</span>
        <span class="news-tab" data-tab="transactions">Transactions</span>
      </div>
      <div class="news-feed-content" id="breaking-feed" style="display: block;">Loading breaking news...</div>
      <div class="news-feed-content" id="fantasy-feed" style="display:none;">Loading fantasy news...</div>
      <div class="news-feed-content" id="transactions-feed" style="display:none;">Loading transactions...</div>
    </div>
  </div>
</div>

      <div id="news-MLB" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
       
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
               
                <div id="headlines-tabs-MLB" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/mlb-rss.xml">MLB.com</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/espn-mlb-rss.xml">ESPN</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/cbs-mlb-rss.xml">CBS Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-mlb-rss.xml">Yahoo</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/foxsports-mlb-api.xml">FOX Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/fangraphs-rss.xml">FanGraphs</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/athletic-mlb.xml">MLBTR</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-mlb.xml">Reddit</div>
                </div>
               
                <div id="headlines-content-MLB" class="news-feed-content" style="width: 80%; overflow-y: auto;">
                   
                </div>
            </div>
        </div>
       
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss.app/feeds/AYtjYuHSzf8VXPWV.xml">Breaking</span>
                <span class="news-tab" data-tab="fantasy" data-url="YOUR_MLB_FANTASY_FEED_URL">Fantasy</span>
                <span class="news-tab" data-tab="transactions" data-url="YOUR_MLB_TRANSACTIONS_FEED_URL">Transactions</span>
            </div>
            <div class="news-content-pane" id="breaking-content-MLB" style="display: block;">
            </div>
            <div class="news-content-pane" id="fantasy-content-MLB" style="display:none;">
            </div>
            <div class="news-content-pane" id="transactions-content-MLB" style="display:none;">
            </div>
        </div>
    </div>
</div>

<div id="news-NBA" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-NBA" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/talkbasket-wnba.xml">TalkBasket</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/espn-nba-rss.xml">ESPN</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/cbs-nba-rss.xml">CBS Sports</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-nba-rss.xml">Yahoo</div>
                    <div class="headlines-tab" data-url="https://rss.app/feeds/pXNlalfRqrlyVml6.xml">NBA.com</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/foxsports-nba-api.xml">FOX Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-nba.xml">Reddit</div>
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/si-nba.xml">SI</div> -->
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/bleacherreport-nba.xml">B/R</div> -->
                </div>
                <div id="headlines-content-NBA" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-nba.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-NBA" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-NFL" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-NFL" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/nfl-com.xml">NFL.com</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/espn-nfl-rss.xml">ESPN</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/nbcsports-profootballtalk.xml">PFT</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/cbs-nfl-rss.xml">CBS Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/si-nfl.xml">SI</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/foxsports-nfl-api.xml">FOX Sports</div>
                    <div class="headlines-tab" data-url="https://rss.app/feeds/LCbkYBU74yt9AnT5.xml">B/R</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-nfl-rss.xml">Yahoo</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-nfl.xml">Reddit</div>
                </div>
                <div id="headlines-content-NFL" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-nfl.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-NFL" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-NHL" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-NHL" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/nhl-com-news.xml">NHL.com</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/espn-nhl-rss.xml">ESPN</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/cbs-nhl-rss.xml">CBS Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/hockeywriters.xml">The Hockey Writers</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-nhl-rss.xml">Yahoo</div>
      				<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/hockeynews.xml">The Hockey News</div>
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/athletic-nhl.xml">The Athletic</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-nhl.xml">Reddit</div>
          
				</div>
                <div id="headlines-content-NHL" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-nhl.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-NHL" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-Soccer" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-Soccer" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/espn-soccer-rss.xml">ESPN FC</div>
					<div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/onefootball-home.xml">OneFootball</div>
					<div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/sportsmole-rss.xml">Sports Mole</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/goal-com.xml">Goal</div>
					<div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-soccer-rss.xml">Yahoo</div>
					<div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/skysports-football.xml">Sky Sports</div>
					<div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/guardian-soccer-rss.xml">The Guardian</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/bbc-football-rss.xml">BBC</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/worldsoccertalk.xml">World Soccer Talk</div>
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/as-com-soccer.xml">AS</div> -->
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/transfermarkt-rss.xml">Transfermarkt</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/fourfourtwo.xml">FourFourTwo</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/cbs-soccer-rss.xml">CBS Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/foxsports-soccer-bundle.xml">FOX Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-soccer.xml">Reddit</div>
                </div>
                <div id="headlines-content-Soccer" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-soccer.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-Soccer" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-UEFAChampionsLeague" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section uefachampionsleague-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <div class="news-feed-content" id="headlines-feed-UEFAChampionsLeague" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
        </div>
    </div>
</div>

<div id="news-PremierLeague" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-PremierLeague" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/si-premierleague.xml">SI</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-premierleague.xml">OneFootball</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/sportsmole-premierleague.xml">Sports Mole</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/skysports-premierleague.xml">Sky</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/bbc-premierleague.xml">BBC</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/footballtalk-premierleague.xml">Football Talk</div>
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/sportingnews-premierleague.xml">Sporting News</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/daily-mail-premierleague.xml">Daily Mail</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/talksport-premierleague.xml">talkSPORT</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/sportbible-premierleague.xml">SPORTbible</div>
					<div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/teamtalk-premierleague.xml">TEAMTalk</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-premierleague.xml">Reddit</div>
                </div>
                <div id="headlines-content-PremierLeague" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-premierleague.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-PremierLeague" style="display: block;"></div>
        </div>
    </div>
</div>
<div id="news-MLS" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-MLS" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss.app/feeds/XgOB7BUJbxy6FsjC.xml">MLSSoccer.com</div>
                    <div class="headlines-tab" data-url="https://rss.app/feeds/Vm7I9MyjMh4OSzGQ.xml">Google News</div>
                    <div class="headlines-tab" data-url="https://rss.app/feeds/oBHEA0YkjVDtsGqd.xml">FLM</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-mls.xml">Reddit</div>
                    
                </div>
                <div id="headlines-content-MLS" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-mls.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-MLS" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-LaLiga" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-LaLiga" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <!-- <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/si-laliga.xml">SI</div> -->
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/football-espana-laliga.xml">Fb-España</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/soccernews-laliga.xml">Soccernews</div>
					 <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/sportsmole-laliga.xml">Sports Mole</div>
                    <!-- <div class="headlines-tab" data-url="https://rss.app/feeds/Oj48mcyrNfIxbqp9.xml">Google News</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-laliga.xml">Reddit</div>
                </div>
                <div id="headlines-content-LaLiga" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-laliga.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-LaLiga" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-SerieA" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-SerieA" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/cultofcalcio-seriea.xml">Cult of Calcio</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/football-italia.xml">FootItalia</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-seriea-rss.xml">OneFootball</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-seriea.xml">Reddit</div>
                   
                </div>
                <div id="headlines-content-SerieA" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-seriea.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-SerieA" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-Bundesliga" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-Bundesliga" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/bulinews.xml">Bulinews</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/getfootballnewsgermany-bundesliga.xml">GGFN</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/bundesliga-com.xml">Bundesliga.com</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-bundesliga.xml">Reddit</div>
                
                </div>
                <div id="headlines-content-Bundesliga" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-bundesliga.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-Bundesliga" style="display: block;"></div>
        </div>
    </div>
</div>

		  <div id="news-LigaMX" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section ligamx-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <div id="ligamxtabs-LigaMX" class="headlines-tabs" style="display:flex; border-bottom:1px solid #374151; flex:0 0 auto;">
        <div class="headlines-tab active" data-source="headlines" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-ligamx.xml">Headlines</div>
        <!-- <div class="headlines-tab" data-source="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-ligamx.xml">Breaking</div> -->
        <div class="headlines-tab" data-source="reddit" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-ligamx.xml">Reddit</div>
      </div>

      <div class="news-feed-content" id="headlines-feed-LigaMX" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
      <!-- <div class="news-feed-content" id="breaking-feed-LigaMX" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div> -->
      <div class="news-feed-content" id="reddit-feed-LigaMX" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
    </div>
  </div>
</div>

<div id="news-FACup" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section" style="flex: 1 1 auto; min-height: 0;">
            <div id="news-content-FACup" class="news-feed-content" style="overflow-y: auto; height: 100%;">
                <div class="news-section-header">
                    <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-facup.xml">News</span>
                </div>
                <div class="news-content-pane" id="breaking-content-FACup" style="display: block;"></div>
                </div>
        </div>
    </div>
</div>

<div id="news-NWSL" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section nwsl-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <div id="nwsltabs-NWSL" class="headlines-tabs" style="display:flex; border-bottom:1px solid #374151; flex:0 0 auto;">
        <div class="headlines-tab active" data-source="headlines" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-nwsl.xml">Headlines</div>
        <div class="headlines-tab" data-source="reddit" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-nwsl.xml">Reddit</div>
      </div>

      <div class="news-feed-content" id="headlines-feed-NWSL" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
      <div class="news-feed-content" id="reddit-feed-NWSL" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
    </div>
  </div>
</div>

<div id="news-Ligue1" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section ligue1-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <div class="news-feed-content" id="headlines-feed-Ligue1" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
    </div>
  </div>
</div>

<div id="news-UEFAEuropaLeague" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section uefaeuropaleague-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <div id="uefaeuropaleaguetabs-UEFAEuropaLeague" class="headlines-tabs" style="display:flex; border-bottom:1px solid #374151; flex:0 0 auto;">
        <div class="headlines-tab active" data-source="headlines" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-europaleague.xml">Headlines</div>
        <!-- <div class="headlines-tab" data-source="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-europaleague.xml">Breaking</div> -->
        <div class="headlines-tab" data-source="reddit" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-europaleague.xml">Reddit</div>
      </div>

      <div class="news-feed-content" id="headlines-feed-UEFAEuropaLeague" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
      <div class="news-feed-content" id="breaking-feed-UEFAEuropaLeague" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
      <div class="news-feed-content" id="reddit-feed-UEFAEuropaLeague" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
    </div>
  </div>
</div>

<div id="news-UEFAConferenceLeague" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section uefaconferenceleague-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <!-- <div id="uefaconferenceleaguetabs-UEFAConferenceLeague" class="headlines-tabs" style="display:flex; border-bottom:1px solid #374151; flex:0 0 auto;">
        <div class="headlines-tab active" data-source="headlines" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-europaconferenceleague.xml">Headlines</div>
        <div class="headlines-tab" data-source="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-europaconferenceleague.xml">Breaking</div>
      </div> -->
      <div class="news-feed-content" id="headlines-feed-UEFAConferenceLeague" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
      <!-- <div class="news-feed-content" id="breaking-feed-UEFAConferenceLeague" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div> -->
    </div>
  </div>
</div>

<div id="news-FormulaOne" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-FormulaOne" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/formula1-latest.xml">F1.com</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/racer-f1.xml">Racer</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/motorsport-all.xml">Motorsport</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/the-race.xml">The Race</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/autosport-f1.xml">Autosport</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/planetf1.xml">Planet F1</div>
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/racefans-f1.xml">RaceFans</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-formula1.xml">Reddit</div>
				
                </div>
                <div id="headlines-content-FormulaOne" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-f1.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-FormulaOne" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-NCAAF" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-NCAAF" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/espn-ncf-rss.xml">ESPN</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/on3-cfb.xml">On3</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/foxsports-cfb-api.xml">FOX Sports</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/cbs-collegefootball-rss.xml">CBS Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-collegefootball-rss.xml">Yahoo</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/saturdaydownsouth.xml">SDS</div>
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/bleacherreport-cfb.xml">B/R</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/si-cfb.xml">SI</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/sportingnews-cfb.xml">Sporting News</div>
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/collegefootballnews.xml">CFN</div> -->
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/247sports-cfb.xml">247 Sports</div> -->
					<!-- <div class="headlines-tab" data-url="https://rss.app/feeds/ydzB00a4yYWWhOJE.xml">The Athletic</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-cfb.xml">Reddit</div>
                </div>
                <div id="headlines-content-NCAAF" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-ncaafootball.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-NCAAF" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-PGATour" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-PGATour" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
					<div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/pgatour-headlines.xml">Headlines</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/golf-com.xml">Golf.com</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/si-golf.xml">SI</div>
                    <!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/golfdigest.xml">Golf Digest</div> -->
                    <!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/golfmonthly.xml">Golf Monthly</div> -->
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/golfwrx.xml">GolfWRX</div> -->
 					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/golfweek.xml">Golfweek</div>
                    <!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/pgatour-com.xml">PGATour.com</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-golf.xml">Reddit</div>
                </div>
                <div id="headlines-content-PGATour" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-pgatour.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-PGATour" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-UFC" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-UFC" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/mmajunkie.xml">MMA Junkie</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/mmafighting.xml">MMA Fighting</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/tapology.xml">Tapology</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/ufc-com.xml">UFC.com</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/mma-core.xml">MMA-Core</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/sherdog.xml">Sherdog</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/mmamania.xml">MMA Mania</div>
                    <!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/si-ufc.xml">SI</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-ufc.xml">Reddit</div>
                </div>
                <div id="headlines-content-UFC" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-ufc.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-UFC" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-Boxing" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-Boxing" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/bbc-boxing.xml">BBC</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/boxingnews-online.xml">Boxing News</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/ringmagazine-rss.xml">Ring</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/boxingscene.xml">Boxing Scene</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/boxingnews24.xml">Boxing News 24</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/boxing247.xml">Boxing 24/7</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/badlefthook.xml">Bad Left Hook</div>
					<!-- <div class="headlines-tab" data-url="https://rss.app/feeds/t5VOWN5DnuNwIVYF.xml">Headlines</div> -->
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-boxing.xml">Reddit</div>

					

                </div>
                <div id="headlines-content-Boxing" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-boxing.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-Boxing" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-NASCARCupSeries" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-NASCARCupSeries" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/motorsport-nascar.xml">Motorsport</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/jayski-rss.xml">Jayski</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/racingexperts-rss.xml">Racing Experts</div>
					<div class="headlines-tab" data-url="https://rss.app/feeds/tYnJ3vf80OY9CXes.xml">Headlines</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-nascar.xml">Reddit</div>
                </div>
                <div id="headlines-content-NASCARCupSeries" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-nascar.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-NASCARCupSeries" style="display: block;"></div>
        </div>
    </div>
</div>
<div id="news-Tennis" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-Tennis" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/tennis-com.xml">Tennis.com</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/tennisgazette.xml">Tennis Gazette</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/espn-tennis-rss.xml">ESPN</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-tennis-rss.xml">Yahoo</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/bbc-tennis-rss.xml">BBC</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-tennis.xml">Reddit</div>
                </div>
                <div id="headlines-content-Tennis" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-tennis.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-Tennis" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-WNBA" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-WNBA" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
					<div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-wnba-rss.xml">Yahoo</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yardbarker-wnba.xml">WNBA.com</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/foxsports-wnba.xml">FOX Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-wnba.xml">Reddit</div>
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/si-wnba.xml">SI</div> -->
                    <!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/athletic-wnba.xml">The Athletic</div> -->
                </div>
                <div id="headlines-content-WNBA" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-wnba.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-WNBA" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-LIVGolf" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section livgolf-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <div id="livgolftabs-LIVGolf" class="headlines-tabs" style="display:flex; border-bottom:1px solid #374151; flex:0 0 auto;">
        <div class="headlines-tab active" data-source="headlines" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-livgolf.xml">Headlines</div>
        <div class="headlines-tab" data-source="reddit" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-livgolf.xml">Reddit</div>
      </div>
      <div class="news-feed-content" id="headlines-feed-LIVGolf" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
      <div class="news-feed-content" id="reddit-feed-LIVGolf" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
    </div>
  </div>
</div>

<div id="news-IndyCar" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section indycar-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <div id="indycarrtabs-IndyCar" class="headlines-tabs" style="display:flex; border-bottom:1px solid #374151; flex:0 0 auto;">
        <div class="headlines-tab active" data-source="headlines" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-indycar.xml">Headlines</div>
        <div class="headlines-tab" data-source="reddit" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-indycar.xml">Reddit</div>
      </div>
      <div class="news-feed-content" id="headlines-feed-IndyCar" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
      <div class="news-feed-content" id="reddit-feed-IndyCar" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
    </div>
  </div>
</div>

<div id="news-NCAAM" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; height: calc(100% - 18px);">
                <div id="headlines-tabs-NCAAM" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/ncaa-com-ncaam.xml">NCAA</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/espn-ncb-rss.xml">ESPN</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/cbs-ncaam-rss.xml">CBS Sports</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-collegebasketball.xml">Reddit</div>
                </div>
                <div id="headlines-content-NCAAM" class="news-feed-content" style="width: 80%; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="news-section breaking-section" style="flex: 1 1 40%; min-height: 0;">
            <div class="news-section-header breaking-tabs-header">
                <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-ncaabasketball.xml">Breaking</span>
            </div>
            <div class="news-content-pane" id="breaking-content-NCAAM" style="display: block;"></div>
        </div>
    </div>
</div>

<div id="news-NCAAW" class="content-section" style="display: none; height: calc(100% - 18px);"> 
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;"> 
        <div class="news-section" style="flex: 1 1 auto; min-height: 0;"> 
            <div id="news-content-NCAAW" class="news-feed-content" style="overflow-y: auto; height: 100%;"> 
                <div class="news-section-header"> 
                    <span class="news-tab active" data-tab="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/ncaa-com-ncaaw.xml">News</span>
                    <span class="news-tab" data-tab="reddit" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-ncaaw.xml">Reddit</span>
                </div> 
                <div class="news-content-pane" id="breaking-content-NCAAW" style="display: block;"></div>
                <div class="news-content-pane" id="reddit-content-NCAAW" style="display: none;"></div>
            </div> 
        </div> 
    </div> 
</div>

<div id="news-NCAABaseball" class="content-section" style="display: none; height: calc(100% - 18px);"> 
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;"> 
        <div class="news-section" style="flex: 1 1 auto; min-height: 0;"> 
            <div id="news-content-NCAABaseball" class="news-feed-content" style="overflow-y: auto; height: 100%;"> 
                <div class="news-section-header"> 
                    <span class="news-tab active" data-tab="breaking" data-url="https://rss.app/feeds/t7vZR372K7n5ceeg.xml">Headlines</span> 
                </div> 
                <div class="news-content-pane" id="breaking-content-NCAABaseball" style="display: block;"></div> 
            </div> 
        </div> 
    </div> 
</div>

<div id="news-NCAASoftball" class="content-section" style="display: none; height: calc(100% - 18px);"> 
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;"> 
        <div class="news-section" style="flex: 1 1 auto; min-height: 0;"> 
            <div id="news-content-NCAASoftball" class="news-feed-content" style="overflow-y: auto; height: 100%;"> 
                <div class="news-section-header"> 
                    <span class="news-tab active" data-tab="breaking" data-url="https://rss.app/feeds/tRKTEhHvoInenyd4.xml">Headlines</span> 
                </div> 
                <div class="news-content-pane" id="breaking-content-NCAASoftball" style="display: block;"></div> 
            </div> 
        </div> 
    </div> 
</div>

<div id="news-MotoGP" class="content-section" style="display: none; height: calc(100% - 18px);">
    <div class="news-main-container" style="display: flex; flex-direction: column; height: 100%;">
        <div class="news-section headlines-section" style="flex: 1 1 auto; min-height: 0; height: 100%; display: flex; flex-direction: column;">
            <div class="news-section-header">Headlines</div>
            <div style="display: flex; flex: 1 1 auto; min-height: 0;">
                <div id="headlines-tabs-MotoGP" class="headlines-tabs-column" style="width: 20%; flex-shrink: 0; height: 100%;">
                    <div class="headlines-tab active" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/autosport-motogp.xml">Autosport</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/motorsport-motogp.xml">Motorsport</div>
					<div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/motogpnews-rss.xml">MotoGP News</div>
                    <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/reddit-motogp.xml">Reddit</div>
					<!-- <div class="headlines-tab" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/motogp-com.xml">MotoGP.com</div> -->
                </div>
                <div id="headlines-content-MotoGP" class="news-feed-content" style="width: 80%; overflow-y: auto; height: 100%;"></div>
            </div>
        </div>
    </div>
</div>

<div id="news-LPGATour" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section lpgatour-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <!-- <div id="lpgatourtabs-LPGATour" class="headlines-tabs" style="display:flex; border-bottom:1px solid #374151; flex:0 0 auto;">
        <div class="headlines-tab active" data-source="headlines" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-lpga.xml">Headlines</div>
        <div class="headlines-tab" data-source="breaking" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-lpga.xml">Breaking</div>
      </div> -->
      <div class="news-feed-content" id="headlines-feed-LPGATour" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
      <!-- <div class="news-feed-content" id="breaking-feed-LPGATour" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div> -->
    </div>
  </div>
</div>

<div id="news-TrackAndField" class="content-section" style="display:none; height:100%; overflow:hidden;">
  <div class="news-main-container" style="display:flex; flex-direction:column; height:100%; min-height:0;">
    <div class="news-section trackandfield-headlines-section" style="display:flex; flex-direction:column; flex:1 1 auto; min-height:0;">
      <div id="trackandfieldtabs-TrackAndField" class="headlines-tabs" style="display:flex; border-bottom:1px solid #374151; flex:0 0 auto;">
        <div class="headlines-tab active" data-source="headlines" data-url="https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/trackandfieldnews.xml">Headlines</div>
        <div class="headlines-tab" data-source="breaking" data-url="https://rss.app/feeds/VqavgJOoX0LKkfkb.xml">Breaking</div>
      </div>
      <div class="news-feed-content" id="headlines-feed-TrackAndField" style="display:block; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
      <div class="news-feed-content" id="breaking-feed-TrackAndField" style="display:none; flex:1 1 0; min-height:0; overflow:auto; position:relative;"></div>
    </div>
  </div>
</div>
	  </div>

      <!-- DIVIDER BETWEEN NEWS PANEL AND SOCIAL PANEL -->
      <div class="divider"></div>

      <!-- SOCIAL PANEL -->
      <div class="column social" style="padding: 0; margin: 0;">
        <div
          id="socialHeader"
          style="position: sticky; top: 0; width: 100%; height: 18px; background-color: #3c3c3c; font-family: Helvetica, Arial, sans-serif; font-size: 10px; display: flex; align-items: center; padding-left: 10px; z-index: 11;"
        ><strong>Social</strong>
        </div>
        <!-- Single dynamic container for social feeds -->
       <div id="social-feed-container"></div>
</div>

        <!-- DIVIDER -->
        <div class="divider"></div>

        <!-- VIDEOS COLUMN -->
        <div class="column videos-column" id="videos-column" style="background-color: #000000;">
      <div id="videos-container" style="display: flex; flex-direction: column; height: 100%;">
        <div id="videos-header" style="
            position: sticky; top: 0; width: 100%; height: 18px;
            background-color: #3c3c3c; font-family: Helvetica, Arial, sans-serif;
            font-size: 10px; display: flex; align-items: center;
            padding-left: 1px; z-index: 11; border-bottom: 1px solid #1f1f1f;
          ">
          <strong>Media</strong>
        </div>

            <!-- Videos tabs (only shown for pages with two tabs) -->
            <div id="videos-tabs" style="display: none; height: 18px; background-color: #2a2a2a; position: sticky; top: 18px; z-index: 10;">
          <div class="videos-tab active" data-tab="highlights">HIGHLIGHTS</div>
          <div class="videos-tab" data-tab="all-videos">ALL VIDEOS</div>
        </div>

        <!-- Videos content -->
        <div id="videos-content" class="videos-content">
          <div id="videosWrapper">
            <div id="videosLoading" class="loading-indicator hidden">
              <svg class="loading-spinner" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <p class="loading-text">Loading videos...</p>
            </div>
            <div id="videosErrorMessage" class="error-message hidden" role="alert">
              <strong>Error!</strong>
              <span id="videosErrorText"></span>
            </div>
            <div id="dynamicVideosContent"></div>
          </div>
        </div>
      </div>
</div>

 <!-- DIVIDER BETWEEN SOCIAL PANEL AND MEDIA CENTER PANEL -->
      <div class="divider"></div>

    <!-- Mobile Toolbar (hidden by default) -->
    <!-- Mobile Bottom Toolbar -->
    <div id="mobile-bottom-toolbar">
        <button class="mobile-toolbar-btn" id="mobile-league-btn">
            <span>ALL</span>
            <span style="font-size: 10px;">▲</span>
        </button>
        <button class="mobile-toolbar-btn active" id="mobile-news-btn">News</button>
        <button class="mobile-toolbar-btn" id="mobile-social-btn">Social</button>
        <button class="mobile-toolbar-btn" id="mobile-games-btn">Games</button>
        <button class="mobile-toolbar-btn" id="mobile-videos-btn">Media</button>
    </div>

    <!-- Mobile Menu Overlay (hidden on desktop) -->
    <div id="mobile-menu-overlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.8); z-index: 2000; transform: translateX(-100%); transition: transform 0.3s ease;">
        <div id="mobile-menu-content" style="width: 100%; height: 100%; background-color: #151515; overflow-y: auto; padding: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px;">
                <h2 style="color: #00ff00; margin: 0;">Select League</h2>
                <button id="mobile-menu-close" style="background: none; border: none; color: #ccc; font-size: 24px; cursor: pointer;">&times;</button>
            </div>
            <div id="mobile-menu-list" style="color: #ccc;">
                <!-- Menu items will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Mobile League Selection Menu -->
    <div id="mobile-league-menu">
        <div class="menu-content">
            <button class="close-btn">&times;</button>
            <div class="menu-header">Select League</div>
            <ul class="league-list" id="mobile-league-list">
                <!-- Will be populated by JavaScript -->
            </ul>
        </div>
    </div>

      

        
<!-- Overlay -->
<div id="fullTableOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.95); z-index: 1000; overflow: auto;">
  <div style="max-width: 1000px; margin: 40px auto; background-color: #fff; padding: 20px; color: black; border-radius: 10px;">
    <button style="float: right; margin-top: -10px; margin-right: -10px; background: none; border: none; font-size: 20px; cursor: pointer; color: #000;" onclick="document.getElementById('fullTableOverlay').style.display = 'none';">&times;</button>
    <h2 style="text-align: center;">Full Premier League Table</h2>
    <table id="fullTable" style="width: 100%; border-collapse: collapse; font-size: 12px; background-color: #fafaf9; color: #000;">
      <thead>
        <tr>
          <th>Pos</th><th>Team</th><th>Played</th><th>Won</th><th>Drawn</th><th>Lost</th><th>GF</th><th>GA</th><th>GD</th><th>Pts</th>
        </tr>
      </thead>
      <tbody id="fullBody"></tbody>
    </table>
  </div>
</div>



<script src="https://widget.rss.app/v1/feed.js" async></script>

  <script>
 // Map of league to an array of RSS.app feed IDs (for cycling)
 const rssFeeds = {
   Home: [
     "_dQv2W26Lxax1n3sC",
     "4kPf5TwmnRhc9JOI",
"DxhOq5IvdSWmuCOQ"
     // Add more Home feeds here if needed
   ],
   MLB: ["ujM61O6ZzDQ7sOrb"],
   NBA: ["KDHaD7kKFdoZKNKv"],
   NFL: ["uvYTDMyn9nIYp068"],
   NHL: ["FkhRHZBH8WxhSWqp"],
   UFC: ["qzbgRcN4Qbr7VV0a"],
   Boxing: ["F2n8AUgzsvLsTadA"],
   NASCARCupSeries: ["AHhwgLGIFW2bn8zL"],
   Tennis: ["VeaGgNXCdeNdgl5l"],
   WNBA: ["DDsbnQvTkj4SNtgY"],
   LIVGolf: ["4lGhahA1b9JU9QZw"],
   IndyCar: ["oP6JlgisMb451EVK"],
   NCAAM: ["nSxcJn3Ke9aIPqkw"],
   NCAAW: ["8V2qb8WK1CMdeBfd"],
   NCAABaseball: ["6wO4p6CY027kWz5C"],
   NCAASoftball: ["WhV6lzzXj1FYOxln"],
   MotoGP: ["tNL3DAMLhpRv30tg"],
   LPGATour: ["MfbotBtAVnTL3I8j"],
   UEFAChampionsLeague: ["UMleWQY5zVMDG3RE"],
   PremierLeague: ["d972MWUX8N4NiXWc"],
   MLS: ["J2tGf8v6qaD6GjFC"],
   Bundesliga: ["pqS6JLI45o7NYCkr"],
   LaLiga: ["8ZkcLZl1mdrw2loE"],
   SerieA: ["vFegYItzKVnhgmre"],
   Soccer: ["S2jMmGyBQoDlvZ4D"],
   FACup: ["Lyr6iaRy8Fq04PKN"],
   LigaMX: ["jak4RrwNxI4UyoHb"],
   NWSL: ["wL801782ohBuXGyb"],
   Ligue1: ["2yFpSRvAMKYuQUZV"],
   UEFAEuropaLeague: ["p3fm4LjBWgp1WWr1"],
   UEFAConferenceLeague: ["9ThCZix939tiPtXy"],
   FormulaOne: ["8CRDFN299eMRIrYT"],
   NCAAF: ["MgdJ7SfrtcBRmv21"],
   PGATour: ["cySoiRoRnUqrXnoa"],
   TrackAndField: ["hcIJ3xkcewSGD4Yq"]
 };

 // Track which feed is currently loaded for each section
 let currentFeedSection = null;

 // Get the next feed ID for a section, cycling through available feeds
 function getNextFeedId(section) {
   const feeds = rssFeeds[section];
   if (!feeds || feeds.length === 0) return null;
   const key = "rssapp_feed_index_" + section;
   let idx = parseInt(localStorage.getItem(key) || "0", 10);
   idx = (idx + 1) % feeds.length;
   localStorage.setItem(key, idx);
   return feeds[idx];
 }

function loadSocialFeed(section) {
  try {
    const container = document.getElementById("social-feed-container");
    if (!container) {
      console.warn('Social feed container not found');
      return;
    }
    if (currentFeedSection === section) return;
    container.innerHTML = "";
    const feedId = getNextFeedId(section);
    if (feedId) {
      // Check if feedId is a URL (custom RSS feed) or an ID (RSS.app widget)
      if (feedId.startsWith('http://') || feedId.startsWith('https://')) {
        // Custom RSS feed URL - load directly
        loadCustomRSSFeed(feedId, container);
      } else {
        // RSS.app widget ID - use RSS.app widget
        try {
          const feedTag = document.createElement("rssapp-feed");
          feedTag.setAttribute("id", feedId);
          container.appendChild(feedTag);

          // Remove any previous RSS.app script from container
          const oldScript = container.querySelector('script[data-rssapp]');
          if (oldScript) oldScript.remove();

          // Only add the RSS.app script once to document head (not container)
          if (!document.querySelector('script[src="https://widget.rss.app/v1/feed.js"]')) {
            const script = document.createElement("script");
            script.src = "https://widget.rss.app/v1/feed.js";
            script.async = true;
            script.setAttribute('data-rssapp', 'true');
            script.onerror = function() {
              console.error('Failed to load RSS.app widget script');
              container.innerHTML = '<div style="padding: 10px; font-size: 12px; color: #ef4444;">Error loading social feed.</div>';
            };
            document.head.appendChild(script);
          }
        } catch (error) {
          console.error('Error creating RSS.app widget:', error);
          container.innerHTML = '<div style="padding: 10px; font-size: 12px; color: #ef4444;">Error loading social feed.</div>';
        }
      }
    } else {
      container.innerHTML =
        "<div style='padding: 10px; font-size: 12px;'>No social feed available for this section.</div>";
    }
    currentFeedSection = section;
  } catch (error) {
    console.error('Error in loadSocialFeed:', error);
    const container = document.getElementById("social-feed-container");
    if (container) {
      container.innerHTML = '<div style="padding: 10px; font-size: 12px; color: #ef4444;">Error loading social feed.</div>';
    }
  }
}

// Load custom RSS feed from our RSS service

// Load multiple RSS feeds, combine, sort by date, and display
async function loadMultipleRSSFeeds(feedUrls, container) {
  container.innerHTML = '<div style="padding: 10px; font-size: 12px; color: #9ca3af;">Loading feeds...</div>';
  
  try {
    // Fetch all feeds in parallel
    const feedPromises = feedUrls.map(url => 
      fetch(url)
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status} for ${url}`);
          }
          return response.text();
        })
        .then(xml => ({ url, xml, success: true }))
        .catch(error => {
          console.error(`Error fetching feed ${url}:`, error);
          return { url, xml: null, success: false, error: error.message };
        })
    );
    
    const feedResults = await Promise.all(feedPromises);
    
    // Parse all feeds and collect items
    const allItems = [];
    const parser = new DOMParser();
    
    feedResults.forEach(({ url, xml, success }) => {
      if (!success || !xml) return;
      
      try {
        const xmlDoc = parser.parseFromString(xml, 'text/xml');
        const parserError = xmlDoc.querySelector('parsererror');
        if (parserError) {
          console.error(`Failed to parse feed ${url}`);
          return;
        }
        
        // Extract items (support both RSS and Atom)
        let items = xmlDoc.getElementsByTagName('item');
        if (items.length === 0) {
          items = xmlDoc.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'entry');
          if (items.length === 0) {
            items = xmlDoc.getElementsByTagName('entry');
          }
        }
        
        items = Array.from(items);
        
        items.forEach(item => {
          const isAtom = item.localName === 'entry' || item.tagName === 'entry' || item.tagName?.toLowerCase() === 'entry';
          
          // Get title
          let title = 'No title';
          const titleNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'title')[0];
          const titleRSS = item.getElementsByTagName('title')[0];
          if (titleNS) {
            title = titleNS.textContent || 'No title';
          } else if (titleRSS) {
            title = titleRSS.textContent || 'No title';
          }
          
          // Get link
          let link = '#';
          if (isAtom) {
            const links = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'link');
            for (let i = 0; i < links.length; i++) {
              const rel = links[i].getAttribute('rel');
              if (!rel || rel === 'alternate') {
                link = links[i].getAttribute('href') || '#';
                break;
              }
            }
            if (link === '#') {
              const linksFallback = item.getElementsByTagName('link');
              for (let i = 0; i < linksFallback.length; i++) {
                const rel = linksFallback[i].getAttribute('rel');
                if (!rel || rel === 'alternate') {
                  link = linksFallback[i].getAttribute('href') || '#';
                  break;
                }
              }
            }
          } else {
            const linkEl = item.getElementsByTagName('link')[0];
            link = linkEl?.textContent || '#';
          }
          
          // Get date
          let pubDate = '';
          const publishedNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'published')[0];
          const updatedNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'updated')[0];
          const pubDateRSS = item.getElementsByTagName('pubDate')[0];
          const publishedRSS = item.getElementsByTagName('published')[0];
          const updatedRSS = item.getElementsByTagName('updated')[0];
          
          if (publishedNS) {
            pubDate = publishedNS.textContent || '';
          } else if (updatedNS) {
            pubDate = updatedNS.textContent || '';
          } else if (pubDateRSS) {
            pubDate = pubDateRSS.textContent || '';
          } else if (publishedRSS) {
            pubDate = publishedRSS.textContent || '';
          } else if (updatedRSS) {
            pubDate = updatedRSS.textContent || '';
          }
          
          // Get thumbnail
          let thumbnail = '';
          const mediaNS = 'http://search.yahoo.com/mrss/';
          const mediaGroupNS = item.getElementsByTagNameNS(mediaNS, 'group')[0];
          if (mediaGroupNS) {
            const thumbNS = mediaGroupNS.getElementsByTagNameNS(mediaNS, 'thumbnail')[0];
            if (thumbNS) {
              thumbnail = thumbNS.getAttribute('url') || '';
            }
          }
          if (!thumbnail) {
            const thumbDirectNS = item.getElementsByTagNameNS(mediaNS, 'thumbnail')[0];
            if (thumbDirectNS) {
              thumbnail = thumbDirectNS.getAttribute('url') || '';
            }
          }
          if (!thumbnail) {
            const mediaGroup = item.getElementsByTagName('media:group')[0];
            if (mediaGroup) {
              const thumb = mediaGroup.getElementsByTagName('media:thumbnail')[0];
              if (thumb) {
                thumbnail = thumb.getAttribute('url') || '';
              }
            }
          }
          
          // Get description
          let description = '';
          const summaryNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'summary')[0];
          const contentNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'content')[0];
          const descRSS = item.getElementsByTagName('description')[0];
          
          if (summaryNS) {
            description = summaryNS.textContent || '';
          } else if (contentNS) {
            description = contentNS.textContent || '';
          } else if (descRSS) {
            description = descRSS.textContent || '';
          }
          
          // Get channel/author information
          let channelName = '';
          let channelUrl = '';
          let channelId = '';
          const authorEl = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'author')[0] || item.getElementsByTagName('author')[0];
          if (authorEl) {
            const nameEl = authorEl.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'name')[0] || authorEl.getElementsByTagName('name')[0];
            const uriEl = authorEl.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'uri')[0] || authorEl.getElementsByTagName('uri')[0];
            if (nameEl) channelName = nameEl.textContent || '';
            if (uriEl) channelUrl = uriEl.textContent || '';
          }
          
          // Get YouTube-specific metadata
          const ytNS = 'http://www.youtube.com/xml/schemas/2015';
          const channelIdEl = item.getElementsByTagNameNS(ytNS, 'channelId')[0] || item.getElementsByTagName('yt:channelId')[0];
          if (channelIdEl) {
            channelId = channelIdEl.textContent || '';
          }
          
          // Get video ID
          let videoId = '';
          const videoIdEl = item.getElementsByTagNameNS(ytNS, 'videoId')[0] || item.getElementsByTagName('yt:videoId')[0];
          if (videoIdEl) {
            videoId = videoIdEl.textContent || '';
          } else {
            // Extract from link as fallback
            const videoIdMatch = link.match(/[?&]v=([^&]+)/);
            if (videoIdMatch) {
              videoId = videoIdMatch[1];
            } else {
              // Try extracting from id tag (format: yt:video:VIDEO_ID)
              const idEl = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'id')[0] || item.getElementsByTagName('id')[0];
              if (idEl) {
                const idText = idEl.textContent || '';
                const idMatch = idText.match(/yt:video:(.+)/);
                if (idMatch) videoId = idMatch[1];
              }
            }
          }
          
          // Get view count from media:community
          let viewCount = '';
          if (mediaGroupNS) {
            const communityEl = mediaGroupNS.getElementsByTagNameNS(mediaNS, 'community')[0];
            if (communityEl) {
              const statsEl = communityEl.getElementsByTagNameNS(mediaNS, 'statistics')[0];
              if (statsEl) {
                viewCount = statsEl.getAttribute('views') || '';
              }
            }
          }
          
          // Get updated date (separate from published date)
          let updatedDate = '';
          if (updatedNS) {
            updatedDate = updatedNS.textContent || '';
          } else if (updatedRSS) {
            updatedDate = updatedRSS.textContent || '';
          }
          
          allItems.push({
            title,
            link,
            pubDate,
            thumbnail,
            description,
            channelName,
            channelUrl,
            channelId,
            videoId,
            viewCount,
            updatedDate
          });
        });
      } catch (error) {
        console.error(`Error parsing feed ${url}:`, error);
      }
    });
    
    // Remove duplicates by link
    const seenLinks = new Set();
    const uniqueItems = allItems.filter(item => {
      if (seenLinks.has(item.link)) {
        return false;
      }
      seenLinks.add(item.link);
      return true;
    });
    
    // Sort by date (newest first)
    uniqueItems.sort((a, b) => {
      const dateA = a.pubDate ? new Date(a.pubDate).getTime() : 0;
      const dateB = b.pubDate ? new Date(b.pubDate).getTime() : 0;
      return dateB - dateA; // Descending order (newest first)
    });
    
    // Limit to 100 items
    const displayItems = uniqueItems.slice(0, 100);
    
    // Build HTML
    let html = '<div style="padding: 10px;">';
    displayItems.forEach(item => {
      let formattedDate = '';
      if (item.pubDate) {
        try {
          const date = new Date(item.pubDate);
          formattedDate = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        } catch (e) {
          formattedDate = item.pubDate;
        }
      }
      
      let videoContent = '';
      if (item.thumbnail) {
        videoContent = `<a href="${item.link}" target="_blank" rel="noopener noreferrer"><img src="${item.thumbnail}" class="video-thumbnail" style="width: 100% !important; max-width: 400px !important; height: 225px !important; min-height: 225px !important; max-height: 225px !important; object-fit: cover !important; aspect-ratio: 16/9 !important; margin: 0 0 8px 0 !important; padding: 0 !important; border-radius: 4px !important; display: block !important; vertical-align: top !important; cursor: pointer;" alt="${item.title}" /></a>`;
      }
      
      html += `
        <div class="video-item" style="margin-bottom: 30px; padding-bottom: 30px; border-bottom: 1px solid #333;" 
             data-video-id="${item.videoId || ''}" 
             data-channel-name="${item.channelName || ''}" 
             data-channel-id="${item.channelId || ''}" 
             data-view-count="${item.viewCount || ''}" 
             data-pub-date="${item.pubDate || ''}" 
             data-updated-date="${item.updatedDate || ''}">
          <h3 style="margin: 0 0 8px 0; padding: 0; font-size: 14px; font-weight: normal; line-height: 1.2;">
            <a href="${item.link}" target="_blank" rel="noopener noreferrer" style="color: #fff; text-decoration: none; display: block;">${item.title}</a>
          </h3>
          ${videoContent}
          <div style="font-size: 11px; color: #9ca3af; margin: 0; padding: 0; line-height: 1.4;">
            ${formattedDate ? `<div>${formattedDate}</div>` : ''}
            ${item.channelName ? `<div>${item.channelName}</div>` : ''}
          </div>
        </div>
      `;
    });
    html += '</div>';
    
    container.innerHTML = html;
  } catch (error) {
    console.error('Error loading multiple RSS feeds:', error);
    container.innerHTML = '<div style="padding: 10px; font-size: 12px; color: #ef4444;">Error loading feeds.</div>';
  }
}

function loadCustomRSSFeed(feedUrl, container) {
  // Check if feedUrl is an array (multiple feeds)
  if (Array.isArray(feedUrl)) {
    return loadMultipleRSSFeeds(feedUrl, container);
  }
  
  container.innerHTML = '<div style="padding: 10px; font-size: 12px; color: #9ca3af;">Loading feed...</div>';
  
  // Use CORS proxy or direct fetch if same domain
  fetch(feedUrl)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return response.text();
    })
    .then(xml => {
      // Parse RSS XML and display
      const parser = new DOMParser();
      const xmlDoc = parser.parseFromString(xml, 'text/xml');
      
      // Check for parsing errors
      const parserError = xmlDoc.querySelector('parsererror');
      if (parserError) {
        throw new Error('Failed to parse RSS feed');
      }
      
      // Extract feed items (support both RSS <item> and Atom <entry>)
      // Handle namespaces for Atom feeds (YouTube uses Atom with namespaces)
      // IMPORTANT: querySelector doesn't work well with namespaced XML, use getElementsByTagNameNS
      let items = xmlDoc.getElementsByTagName('item');
      if (items.length === 0) {
        // Try Atom format (<entry>) - MUST use getElementsByTagNameNS for namespaced XML
        items = xmlDoc.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'entry');
        if (items.length === 0) {
          // Try without namespace (some parsers strip namespaces)
          items = xmlDoc.getElementsByTagName('entry');
        }
        if (items.length === 0) {
          // Last resort: search all elements
          const allElements = xmlDoc.getElementsByTagName('*');
          items = Array.from(allElements).filter(el => {
            const localName = el.localName || el.tagName?.toLowerCase();
            return localName === 'entry' || localName === 'item';
          });
        }
      }
      
      // Convert NodeList to Array for easier manipulation
      items = Array.from(items);
      
      if (items.length === 0) {
        console.error('No items found in feed. XML structure:', xml.substring(0, 1000));
        console.error('XML Namespaces:', Array.from(xmlDoc.documentElement.attributes).map(a => `${a.name}="${a.value}"`).join(', '));
        container.innerHTML = '<div style="padding: 10px; font-size: 12px; color: #9ca3af;">No items in feed.</div>';
        return;
      }
      
      console.log(`Found ${items.length} items in feed`);
      
      // Build HTML for feed items
      let html = '<div style="padding: 10px;">';
      items.forEach((item, index) => {
        if (index >= 100) return; // Limit to 100 items (increased from 20)
        
        // Handle both RSS and Atom formats
        const isAtom = item.localName === 'entry' || item.tagName === 'entry' || item.tagName?.toLowerCase() === 'entry';
        
        // Get title - MUST use getElementsByTagNameNS for namespaced XML
        let title = 'No title';
        const titleNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'title')[0];
        const titleRSS = item.getElementsByTagName('title')[0];
        if (titleNS) {
          title = titleNS.textContent || 'No title';
        } else if (titleRSS) {
          title = titleRSS.textContent || 'No title';
        }
        
        // Get link - Atom uses <link href="...">, RSS uses <link>text</link>
        let link = '#';
        if (isAtom) {
          // Atom: link is an element with href attribute
          const links = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'link');
          for (let i = 0; i < links.length; i++) {
            const rel = links[i].getAttribute('rel');
            if (!rel || rel === 'alternate') {
              link = links[i].getAttribute('href') || '#';
              break;
            }
          }
          // Fallback: try regular getElementsByTagName
          if (link === '#') {
            const linksFallback = item.getElementsByTagName('link');
            for (let i = 0; i < linksFallback.length; i++) {
              const rel = linksFallback[i].getAttribute('rel');
              if (!rel || rel === 'alternate') {
                link = linksFallback[i].getAttribute('href') || '#';
                break;
              }
            }
          }
        } else {
          // RSS: link is text content
          const linkEl = item.getElementsByTagName('link')[0];
          link = linkEl?.textContent || '#';
        }
        
        // Get description/summary/content - MUST use getElementsByTagNameNS
        let description = '';
        const summaryNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'summary')[0];
        const contentNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'content')[0];
        const descRSS = item.getElementsByTagName('description')[0];
        const summaryRSS = item.getElementsByTagName('summary')[0];
        const contentRSS = item.getElementsByTagName('content')[0];
        
        if (summaryNS) {
          description = summaryNS.textContent || '';
        } else if (contentNS) {
          description = contentNS.textContent || '';
        } else if (descRSS) {
          description = descRSS.textContent || '';
        } else if (summaryRSS) {
          description = summaryRSS.textContent || '';
        } else if (contentRSS) {
          description = contentRSS.textContent || '';
        }
        
        // Get date - MUST use getElementsByTagNameNS
        let pubDate = '';
        const publishedNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'published')[0];
        const updatedNS = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'updated')[0];
        const pubDateRSS = item.getElementsByTagName('pubDate')[0];
        const publishedRSS = item.getElementsByTagName('published')[0];
        const updatedRSS = item.getElementsByTagName('updated')[0];
        
        if (publishedNS) {
          pubDate = publishedNS.textContent || '';
        } else if (updatedNS) {
          pubDate = updatedNS.textContent || '';
        } else if (pubDateRSS) {
          pubDate = pubDateRSS.textContent || '';
        } else if (publishedRSS) {
          pubDate = publishedRSS.textContent || '';
        } else if (updatedRSS) {
          pubDate = updatedRSS.textContent || '';
        }
        
        // Get thumbnail - YouTube uses media:group with media:thumbnail
        // MUST use getElementsByTagNameNS for media namespace
        let thumbnail = '';
        const mediaNS = 'http://search.yahoo.com/mrss/';
        
        // Try media:group first (YouTube format)
        const mediaGroupNS = item.getElementsByTagNameNS(mediaNS, 'group')[0];
        if (mediaGroupNS) {
          const thumbNS = mediaGroupNS.getElementsByTagNameNS(mediaNS, 'thumbnail')[0];
          if (thumbNS) {
            thumbnail = thumbNS.getAttribute('url') || '';
          }
        }
        
        // Fallback: try media:thumbnail directly
        if (!thumbnail) {
          const thumbDirectNS = item.getElementsByTagNameNS(mediaNS, 'thumbnail')[0];
          if (thumbDirectNS) {
            thumbnail = thumbDirectNS.getAttribute('url') || '';
          }
        }
        
        // Fallback: try regular getElementsByTagName (for non-namespaced)
        if (!thumbnail) {
          const mediaGroup = item.getElementsByTagName('media:group')[0];
          if (mediaGroup) {
            const thumb = mediaGroup.getElementsByTagName('media:thumbnail')[0];
            if (thumb) {
              thumbnail = thumb.getAttribute('url') || '';
            }
          }
        }
        
        // Last resort: try enclosure or other image sources
        if (!thumbnail) {
          const enclosure = item.getElementsByTagName('enclosure')[0];
          if (enclosure && enclosure.getAttribute('type')?.startsWith('image')) {
            thumbnail = enclosure.getAttribute('url') || '';
          }
        }
        
        // If no thumbnail found in media elements, try extracting from description HTML
        if (!thumbnail && description) {
          try {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = description;
            const imgTag = tempDiv.querySelector('img');
            if (imgTag) {
              thumbnail = imgTag.getAttribute('src') || '';
            }
          } catch (e) {
            // If parsing fails, try regex as fallback
            const imgMatch = description.match(/<img[^>]+src=["']([^"']+)["']/i);
            if (imgMatch) {
              thumbnail = imgMatch[1];
            }
          }
        }
        
        // Get channel/author information
        let channelName = '';
        let channelUrl = '';
        let channelId = '';
        const authorEl = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'author')[0] || item.getElementsByTagName('author')[0];
        if (authorEl) {
          const nameEl = authorEl.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'name')[0] || authorEl.getElementsByTagName('name')[0];
          const uriEl = authorEl.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'uri')[0] || authorEl.getElementsByTagName('uri')[0];
          if (nameEl) channelName = nameEl.textContent || '';
          if (uriEl) channelUrl = uriEl.textContent || '';
        }
        
        // Get YouTube-specific metadata
        const ytNS = 'http://www.youtube.com/xml/schemas/2015';
        const channelIdEl = item.getElementsByTagNameNS(ytNS, 'channelId')[0] || item.getElementsByTagName('yt:channelId')[0];
        if (channelIdEl) {
          channelId = channelIdEl.textContent || '';
        }
        
        // Get video ID
        let videoId = '';
        const videoIdEl = item.getElementsByTagNameNS(ytNS, 'videoId')[0] || item.getElementsByTagName('yt:videoId')[0];
        if (videoIdEl) {
          videoId = videoIdEl.textContent || '';
        } else {
          // Extract from link as fallback
          const videoIdMatch = link.match(/[?&]v=([^&]+)/);
          if (videoIdMatch) {
            videoId = videoIdMatch[1];
          } else {
            // Try extracting from id tag (format: yt:video:VIDEO_ID)
            const idEl = item.getElementsByTagNameNS('http://www.w3.org/2005/Atom', 'id')[0] || item.getElementsByTagName('id')[0];
            if (idEl) {
              const idText = idEl.textContent || '';
              const idMatch = idText.match(/yt:video:(.+)/);
              if (idMatch) videoId = idMatch[1];
            }
          }
        }
        
        // Get view count and engagement metrics from media:community
        let viewCount = '';
        if (mediaGroupNS) {
          const communityEl = mediaGroupNS.getElementsByTagNameNS(mediaNS, 'community')[0];
          if (communityEl) {
            const statsEl = communityEl.getElementsByTagNameNS(mediaNS, 'statistics')[0];
            if (statsEl) {
              viewCount = statsEl.getAttribute('views') || '';
            }
          }
        }
        
        // Get updated date (separate from published date)
        let updatedDate = '';
        if (updatedNS) {
          updatedDate = updatedNS.textContent || '';
        } else if (updatedRSS) {
          updatedDate = updatedRSS.textContent || '';
        }
        
        // Format date
        let formattedDate = '';
        if (pubDate) {
          try {
            const date = new Date(pubDate);
            formattedDate = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
          } catch (e) {
            formattedDate = pubDate;
          }
        }
        
        // Clean description - remove any HTML images since we're using the thumbnail
        let cleanDescription = description;
        if (description) {
          try {
            // Remove img tags from description to avoid duplicate/conflicting images
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = description;
            const images = tempDiv.querySelectorAll('img');
            images.forEach(img => img.remove());
            cleanDescription = tempDiv.textContent || tempDiv.innerText || '';
          } catch (e) {
            // If parsing fails, use regex to remove img tags
            cleanDescription = description.replace(/<img[^>]*>/gi, '').replace(/<br\s*\/?>/gi, ' ').trim();
          }
        }
        
        // Build video HTML - make thumbnail clickable to open video in new tab
        let videoContent = '';
        if (thumbnail) {
          // Thumbnail is clickable to open video in new tab
          videoContent = `<a href="${link}" target="_blank" rel="noopener noreferrer"><img src="${thumbnail}" class="video-thumbnail" style="width: 100% !important; max-width: 400px !important; height: 225px !important; min-height: 225px !important; max-height: 225px !important; object-fit: cover !important; aspect-ratio: 16/9 !important; margin: 0 0 8px 0 !important; padding: 0 !important; border-radius: 4px !important; display: block !important; vertical-align: top !important; cursor: pointer;" alt="${title}" /></a>`;
        }
        
        html += `
          <div class="video-item" style="margin-bottom: 30px; padding-bottom: 30px; border-bottom: 1px solid #333;" 
               data-video-id="${videoId}" 
               data-channel-name="${channelName}" 
               data-channel-id="${channelId}" 
               data-view-count="${viewCount}" 
               data-pub-date="${pubDate}" 
               data-updated-date="${updatedDate}">
            <h3 style="margin: 0 0 8px 0; padding: 0; font-size: 14px; font-weight: normal; line-height: 1.2;">
              <a href="${link}" target="_blank" rel="noopener noreferrer" style="color: #fff; text-decoration: none; display: block;">${title}</a>
            </h3>
            ${videoContent}
            <div style="font-size: 11px; color: #9ca3af; margin: 0; padding: 0; line-height: 1.4;">
              ${formattedDate ? `<div>${formattedDate}</div>` : ''}
              ${channelName ? `<div>${channelName}</div>` : ''}
            </div>
          </div>
        `;
      });
      html += '</div>';
      
      container.innerHTML = html;
    })
    .catch(error => {
      console.error('Error loading RSS feed:', error);
      container.innerHTML = `<div style="padding: 10px; font-size: 12px; color: #ef4444;">Error loading feed: ${error.message}</div>`;
    });
}

 document.addEventListener("DOMContentLoaded", () => {
   // Load default feed (Home) on page load
   loadSocialFeed("Home");

   // Bind lazy loading to menu item clicks
   document.querySelectorAll("#menuList li[data-section]").forEach(item => {
     item.addEventListener("click", () => {
       const section = item.dataset.section;
       currentFeedSection = null; // Reset so a new feed loads
       loadSocialFeed(section);
     });
   });
 });
</script>

      <script>
        function showDiscussionSection(section) {
 // Hide all discussion content sections
 document.querySelectorAll("#discussion-panel .content-section").forEach(el => {
   el.style.display = "none";
 });
 // Show the discussion section for the given menu item
 const target = document.getElementById("discussion-" + section);
 if (target) {
   target.style.display = "block";
 }
}
      </script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
        // --- NEW: FALLBACK URLs FOR THE HOME PAGE ---
        const HOME_PAGE_FEEDS = {
            breaking: "https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/home-breaking.xml",
            fantasy: "https://fantasynews.cbssports.com/rss/headlines/",
            transactions: "https://www.espn.com/espn/rss/mlb/news"
        };

        // --- GRAB ELEMENTS FOR COLUMN SWITCHING ---
        const gamesColumn = document.getElementById('games-column');
        const leagueSpecificColumn = document.getElementById('league-specific-column');
        const f1Content = document.getElementById('f1-column-content');
        const gamesContent = document.getElementById('tv-listings-container');

        // Helper function to fetch and render an XML feed
        function fetchFeed(containerSelector, feedUrl) {
            const container = document.querySelector(containerSelector);
            if (!container) return;
            // Display loading message
            container.innerHTML = '<p style="padding: 10px; color: #9ca3af;">Loading feed...</p>';
            fetch(feedUrl)
                .then(res => {
                    if (!res.ok) {
                        throw new Error(`HTTP error! status: ${res.status}`);
                    }
                    return res.text();
                })
                .then(str => {
                    if (!str || str.trim() === '') {
                        throw new Error('Empty response from feed');
                    }
                    const parser = new DOMParser();
                    const xml = parser.parseFromString(str, "application/xml");
                    // Check for parsing errors
                    const parseError = xml.querySelector("parsererror");
                    if (parseError) {
                        throw new Error('Failed to parse XML feed');
                    }
                    const items = Array.from(xml.querySelectorAll("item"));
                    if (items.length > 0) {
                        const ul = document.createElement("ul");
                        ul.style.margin = "0";
                        ul.style.padding = "0";
                        ul.style.listStyle = "none";
                        items.forEach(item => {
                            const title = item.querySelector("title")?.textContent || "No title";
                            const link = item.querySelector("link")?.textContent || "#";
                            const li = document.createElement("li");
                            li.style.marginBottom = "0.5em";
                            const a = document.createElement("a");
                            a.href = link;
                            a.target = "_blank";
                            a.textContent = title;
                            li.appendChild(a);
                            ul.appendChild(li);
                        });
                        container.innerHTML = "";
                        container.appendChild(ul);
                        ul.querySelectorAll("a").forEach(link => {
                            link.addEventListener("click", () => {
                                link.classList.add("clicked");
                            });
                        });
                    } else {
                        container.innerHTML = "<p style='padding: 10px;'>No items found in feed.</p>";
                    }
                })
                .catch(error => {
                    console.error("Error loading feed:", error);
                    console.error("Feed URL:", feedUrl);
                    container.innerHTML = `<p style='padding: 10px; color: #ef4444;'>Error loading feed: ${error.message || 'Unknown error'}</p>`;
                });
        }

        // --- Load Breaking feed IMMEDIATELY (before other initialization) ---
        const breakingFeedContainer = document.getElementById('breaking-feed');
        const breakingFeedUrl = HOME_PAGE_FEEDS.breaking;
        if (breakingFeedContainer && breakingFeedUrl) {
            fetchFeed('#breaking-feed', breakingFeedUrl);
        }

        // --- Initial Feed Loads for Home Page (Headlines) ---
        const feedMap = {
            espn: "https://www.espn.com/espn/rss/news",
            cbs: "https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/cbs-headlines-rss.xml",
            yahoo: "https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/yahoo-sports-rss.xml",
            fox: "https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/foxsports-home-api.xml"
        };
        Object.entries(feedMap).forEach(([source, url]) => {
            fetchFeed(`#${source}-feed`, url);
        });

        // --- Main Menu and Page Switching Logic ---
        let selectedSection = "Home";
        document.querySelectorAll("#menuList li").forEach(item => {
            item.addEventListener("click", e => {
                if (item.classList.contains("spacer-line") || item.classList.contains("soccer-more-toggle") || item.querySelector("strong")) {
                    e.stopPropagation();
                    return;
                }
                e.stopPropagation();
                
                // Scroll to top when navigating to a new page
                window.scrollTo(0, 0);
                
                // Scroll all columns to top EXCEPT the menu column
                document.querySelectorAll('.column').forEach(col => {
                    if (!col.classList.contains('menu')) {
                        col.scrollTop = 0;
                    }
                });
                
                if (item.dataset.section) {
                    selectedSection = item.dataset.section;
                }
                document.querySelectorAll("#menuList li[data-section]").forEach(li => li.classList.remove("selected"));
                item.classList.add("selected");
                
                // Scroll the selected item into view in the menu
                item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                const section = item.dataset.section;

                if (section === 'Home') {
                    gamesColumn.style.display = 'block';
                    leagueSpecificColumn.style.display = 'none';
                    gamesContent.style.display = 'flex';
                    f1Content.style.display = 'none';

                    // Ensure TODAY tab reloads (and resets Live filter) when returning to Home
                    const todayTab = document.querySelector('.games-tab[data-tab="today"]');
                    if (todayTab) {
                        todayTab.click();
                    }

                    const espnTab = document.querySelector('#headlines-tabs .headlines-tab[data-source="espn"]');
                    if (espnTab) {
                        espnTab.click();
                    }
                } else if (section === 'FormulaOne') {
                    // Formula One has its own special column structure
                    gamesColumn.style.display = 'block';
                    leagueSpecificColumn.style.display = 'none';
                    f1Content.style.display = 'flex';
                    gamesContent.style.display = 'none';
                } else {
                    gamesColumn.style.display = 'none';
                    leagueSpecificColumn.style.display = 'block';
                    f1Content.style.display = 'none';
                    loadLeagueSpecificData(section);
                    
                    // Update the standings tab text based on the league
                    updateStandingsTabText(section);
                }

                document.querySelectorAll(".news .content-section, #social-feed-container .content-section").forEach(s => s.style.display = "none");

                const news = document.getElementById("news-" + section);
                const social = document.getElementById("social-" + section);
                if (news) {
                    news.style.display = "block";
                    const newsSubMenu = document.getElementById("newsSubMenu");
                    if (newsSubMenu) newsSubMenu.style.display = section === "Home" ? "flex" : "none";
                    const container = document.querySelector(".news");
                    if (container) container.scrollTop = 0;
                    loadHeadlinesAndBreakingFeeds(section);
                }
                if (social) social.style.display = "block";
            });
        });

       // --- UPDATED: NEW CODE FOR MENU FILTERS ---
    document.getElementById("menuFilters").addEventListener("click", e => {
        const clickedFilter = e.target.closest(".menu-filter");
        if (!clickedFilter) return;

        // Find the currently selected league (before we change the filter)
        const currentSelectedLi = document.querySelector("#menuList li.selected");
        const selectedSection = currentSelectedLi ? currentSelectedLi.dataset.section : null;

        // Remove active class from all filters
        document.querySelectorAll("#menuFilters .menu-filter").forEach(filter => {
            filter.classList.remove("active");
        });
        // Add active class to the clicked filter
        clickedFilter.classList.add("active");

        const filterId = clickedFilter.dataset.filter;

        // Hide all menu lists and remove the 'selected' class from ALL li items
        // This is important to prevent duplicates when switching back and forth
        document.querySelectorAll("#menuList > ul").forEach(list => {
            list.style.display = "none";
            list.querySelectorAll("li").forEach(li => li.classList.remove("selected"));
        });

        // Show the list that matches the data-filter
        const targetList = document.getElementById(`menuList-${filterId}`);
        if (targetList) {
            targetList.style.display = "block";

            // If a league was previously selected, find it in the new list and select it
            if (selectedSection) {
                const newSelectedLi = targetList.querySelector(`li[data-section="${selectedSection}"]`);
                if (newSelectedLi) {
                    newSelectedLi.classList.add("selected");
                }
            }
        }
    });


        function loadHeadlinesAndBreakingFeeds(section) {
            const newsSection = document.getElementById(`news-${section}`);
            if (!newsSection) return;

            const defaultHeadlinesTab = newsSection.querySelector('.headlines-tab[data-url]');
            if (defaultHeadlinesTab) defaultHeadlinesTab.click();
            
            const defaultBreakingTab = newsSection.querySelector('.news-tab[data-tab="breaking"]');
            if (defaultBreakingTab) defaultBreakingTab.click();
        }

        // --- UNIFIED CLICK HANDLER FOR ALL NEWS TABS ---

        // Vertical Headlines Tabs (League-Specific)
        document.querySelectorAll('.headlines-tabs-column').forEach(container => {
            container.addEventListener('click', (event) => {
                const clickedTab = event.target.closest('.headlines-tab[data-url]');
                if (clickedTab) {
                    container.querySelectorAll('.headlines-tab').forEach(tab => tab.classList.remove('active'));
                    clickedTab.classList.add('active');
                    fetchFeed(`#headlines-content-${selectedSection}`, clickedTab.dataset.url);
                }
            });
        });
        // Horizontal News Tabs (Breaking, etc.) - HANDLES BOTH HOME & LEAGUE PAGES
        document.querySelectorAll(".news").forEach(newsContainer => {
            newsContainer.addEventListener('click', (event) => {
                const clickedTab = event.target.closest('.news-tab');
                if (!clickedTab) return;

                const tabType = clickedTab.dataset.tab;
                const dynamicUrl = clickedTab.dataset.url;

                clickedTab.parentElement.querySelectorAll('.news-tab').forEach(tab => tab.classList.remove('active'));
                clickedTab.classList.add('active');

                if (dynamicUrl) {
                    // Logic for League Pages
                    const newsSection = clickedTab.closest('.content-section');
                    if (!newsSection) return;
                    newsSection.querySelectorAll('.news-content-pane').forEach(pane => pane.style.display = 'none');
                    const sectionId = newsSection.id.replace('news-', '');
                    const contentPane = newsSection.querySelector(`#${tabType}-content-${sectionId}`);
                    if (contentPane) {
                        contentPane.style.display = 'block';
                        fetchFeed(`#${contentPane.id}`, dynamicUrl);
                    }
                } else {
                    // Fallback Logic for Home Page
                    document.querySelectorAll('#news-Home .news-content-pane').forEach(pane => pane.style.display = 'none');
                    const targetPaneId = `${tabType}-feed`;
                    const targetPane = document.getElementById(targetPaneId);
                    const fallbackUrl = HOME_PAGE_FEEDS[tabType];
                    if (targetPane && fallbackUrl) {
                        targetPane.style.display = 'block';
                        fetchFeed(`#${targetPaneId}`, fallbackUrl);
                    }
                }
            });
        });

        // Other original listeners (scroll, search, etc.)
        const feeds = ["feed-ESPN", "feed-CBS", "feed-FOX", "feed-Yahoo"];
        const newsPanel = document.querySelector(".news");
        newsPanel.addEventListener("scroll", () => {
            const newsSubMenu = document.getElementById("newsSubMenu");
            if (!newsSubMenu) return;
            const top = newsPanel.getBoundingClientRect().top;
            const offset = newsSubMenu.offsetHeight + 50;
            let active = 0;
            for (let i = 0; i < feeds.length; i++) {
                const el = document.getElementById(feeds[i]);
                if (!el) continue;
                const h4 = el.querySelector("h4");
                if (!h4) continue;
                if (h4.getBoundingClientRect().top > top + offset) break;
                active = i;
            }
            const feedName = feeds[active].replace("feed-", "").toLowerCase();
            document.querySelectorAll(".news-menu-item").forEach(item => {
                item.classList.toggle("active", item.dataset.feed.toLowerCase() === feedName);
            });
        });

        document.getElementById("menuSearch").addEventListener("keyup", function () {
            const query = this.value.toLowerCase();
            const activeFilterElem = document.querySelector(".menu-filter.active");
            if (!activeFilterElem) return;
            const activeFilter = activeFilterElem.dataset.filter;
            const activeList = document.getElementById("menuList-" + activeFilter);
            if (activeList) {
                activeList.querySelectorAll("li").forEach(li => {
                    li.style.display = li.textContent.toLowerCase().includes(query) ? "" : "none";
                });
            }
        });

        window.toggleSoccerMore = function () {
            const section = document.getElementById("soccer-more");
            const toggle = document.querySelector(".soccer-more-toggle");
            const expanded = section.style.display === "block";
            section.style.display = expanded ? "none" : "block";
            toggle.textContent = expanded ? "More…" : "Less…";
        };

        // Also click the tab to ensure UI state is correct
        const homeBreakingTab = document.querySelector('#news-Home .news-tab[data-tab="breaking"]');
        if (homeBreakingTab) {
            homeBreakingTab.click();
        }
    });
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    // ── A) Grab all four tab elements and define their order ──
    const tabs    = Array.from(document.querySelectorAll(".headlines-tab"));
    const sources = ["espn", "cbs", "yahoo", "fox"];

    // ── B) Keep track of which feeds already have a scroll listener ──
    const scrollListeners = {};

    // ── C) Function to attach a "scroll to bottom" watcher on a feed ──
    function attachScrollWatcher(src) {
      const feedEl = document.getElementById(src + "-feed");
      // If there's no such element or we've already wired it, do nothing
      if (!feedEl || scrollListeners[src]) return;

      const onScroll = () => {
        // When scrolled to (or within 1px of) bottom, auto‐advance:
        if (feedEl.scrollHeight - feedEl.scrollTop - feedEl.clientHeight <= 1) {
          const idx     = sources.indexOf(src);
          const nextIdx = idx + 1;
          if (nextIdx < sources.length) {
            const nextTab = document.querySelector(
              `.headlines-tab[data-source="${sources[nextIdx]}"]`
            );
            if (nextTab) nextTab.click();
          }
        }
      };

      feedEl.addEventListener("scroll", onScroll);
      scrollListeners[src] = onScroll;
    }

    // ── D) Function to activate (highlight) exactly one tab + feed ──
    function activateSource(src) {
      // 1) Toggle "active" class on tabs
      tabs.forEach(t => t.classList.toggle(
        "active",
        t.getAttribute("data-source") === src
      ));

      // 2) Hide all four feed‐divs, then show only the chosen one
      sources.forEach(s => {
        const div = document.getElementById(s + "-feed");
        if (div) {
          div.style.display = (s === src) ? "block" : "none";
        }
      });

      // 3) After switching, (re‐)attach the scroll watcher to the newly visible feed
      attachScrollWatcher(src);
    }

    // ── E) Add click listeners to each .headlines-tab ──
    tabs.forEach(tab => {
      tab.addEventListener("click", () => {
        const src = tab.getAttribute("data-source"); // "espn" / "cbs" / etc.
        activateSource(src);
      });
    });

    // ── F) On initial load, activate ESPN by default ──
    activateSource("espn");
  });
</script>
	 

	  <script>
  /**
   * Turn a raw headline into a normalized array of words.
   * - Lowercase
   * - Remove punctuation
   * - Split on whitespace
   * - Filter out empty tokens
   */
  function headlineToWordArray(str) {
    return str
      .toLowerCase()
      .replace(/[^\w\s]/g, "")   // strip any non‐alphanumeric (keeps letters/numbers/spaces)
      .split(/\s+/)              // split on whitespace
      .filter(word => word.length > 0);
  }

  /**
   * Compute Jaccard similarity of two arrays of words:
   * |Intersection(words1, words2)| / |Union(words1, words2)|
   */
  function jaccardSimilarity(wordsA, wordsB) {
    const setA = new Set(wordsA);
    const setB = new Set(wordsB);
    let intersectionCount = 0;
    for (let w of setA) {
      if (setB.has(w)) intersectionCount++;
    }
    const unionCount = setA.size + setB.size - intersectionCount;
    if (unionCount === 0) return 0;
    return intersectionCount / unionCount;
  }

  /**
   * Remove any post element whose headline is "too similar" to one already kept.
   * We keep track of word‐sets of all headlines we've accepted, then for each new one
   * we measure its Jaccard similarity against all "seen" sets. If any overlap ≥ threshold, we remove it.
   */
  function removeNearDuplicateHeadlines() {
    const container = document.getElementById("my-rss-widget");
    if (!container) return;

    // Grab every <a> under #my-rss-widget (RSS.app normally puts each item in an <a>).
    const links = Array.from(container.querySelectorAll("a"));

    // Array of word‐sets we have accepted so far
    const seenWordSets = [];
    // Threshold of Jaccard similarity above which we consider two headlines "duplicates"
    const SIMILARITY_THRESHOLD = 0.65;

    links.forEach(link => {
      const rawText = link.textContent || "";
      const words = headlineToWordArray(rawText);
      // Compare against each seen word‐set:
      let isDuplicate = false;
      for (let seenWords of seenWordSets) {
        const similarity = jaccardSimilarity(words, seenWords);
        if (similarity >= SIMILARITY_THRESHOLD) {
          isDuplicate = true;
          break;
        }
      }

      if (isDuplicate) {
        // Remove this entire "item." Climb up until you hit a direct child of #my-rss-widget:
        let el = link;
        while (el && el.parentElement && el.parentElement.id !== "my-rss-widget") {
          el = el.parentElement;
        }
        if (el && el.parentElement === container) {
          container.removeChild(el);
        }
      } else {
        // Not a duplicate: add this word‐array to seenWordSets
        seenWordSets.push(words);
      }
    });
  }

  /**
   * Observe #my-rss-widget until at least one <a> appears, then run the fuzzy dedupe.
   * Also run a fallback after 3 seconds in case feed loads slowly.
   */
  document.addEventListener("DOMContentLoaded", () => {
    const container = document.getElementById("my-rss-widget");
    if (!container) return;

    const observer = new MutationObserver((mutations, obs) => {
      // If at least one <a> is present, RSS.app has rendered items
      if (container.querySelector("a")) {
        removeNearDuplicateHeadlines();
        obs.disconnect();
      }
    });

    observer.observe(container, { childList: true, subtree: true });

    // Fallback in case feed injection is delayed
    setTimeout(removeNearDuplicateHeadlines, 3000);
  });
</script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    
    // --- PART 1: Logic to switch between Games and F1 column content ---
    const leftMenu = document.getElementById('menuList');
    const gamesContent = document.getElementById('tv-listings-container');
    const f1Content = document.getElementById('f1-column-content');

    if (leftMenu && gamesContent && f1Content) {
        leftMenu.addEventListener('click', function(event) {
            const clickedItem = event.target.closest('li[data-section]');
            if (!clickedItem) return;

            const section = clickedItem.dataset.section;

                gamesContent.style.display = 'flex';
                f1Content.style.display = 'none';
        });
    }

    // --- PART 2: Logic for the F1 Main tabs (Schedule | Standings) ---
    const f1MainTabsContainer = document.getElementById('f1-main-tabs');
    const f1MainTabContents = document.querySelectorAll('.f1-main-tab-content');
    
    let driverStandingsLoaded = false;
    let constructorStandingsLoaded = false;
    if (typeof window.f1ScheduleLastUserSelection === 'undefined') {
        window.f1ScheduleLastUserSelection = null;
    }
    
    // Load the default tab's data immediately when the F1 panel is shown
    const f1MenuItem = document.querySelector('li[data-section="FormulaOne"]');
    if (f1MenuItem) {
        f1MenuItem.addEventListener('click', () => {
            // Check which tab is active by default
            const activeMainTab = document.querySelector('.f1-main-tab.active');
            const activeTabType = activeMainTab ? activeMainTab.dataset.f1MainTab : 'standings';
            
            setTimeout(() => {
                if (activeTabType === 'standings') {
                    // Standings tab is active by default - load driver standings
                    if (!driverStandingsLoaded && typeof loadDriverStandings === 'function') {
                        loadDriverStandings();
                        driverStandingsLoaded = true;
                    }
                } else {
                    // Schedule tab - load schedule
                    window.f1ScheduleLastUserSelection = null;
                    if (window.updateF1Schedule) {
                        window.updateF1Schedule();
                    }
                }
            }, 100);
        }, { once: true });
    }
    
    // Also check on initial page load if FormulaOne section is already visible
    setTimeout(() => {
        const formulaOneSection = document.getElementById('league-specific-column');
        const leagueHeader = document.getElementById('league-specific-header');
        if (formulaOneSection && leagueHeader && leagueHeader.innerText === 'Formula One') {
            const activeMainTab = document.querySelector('.f1-main-tab.active');
            const activeTabType = activeMainTab ? activeMainTab.dataset.f1MainTab : 'standings';
            
            if (activeTabType === 'standings' && !driverStandingsLoaded && typeof loadDriverStandings === 'function') {
                loadDriverStandings();
                driverStandingsLoaded = true;
            }
        }
    }, 500);
    
    // Watch for when FormulaOne section becomes visible and load standings if Standings tab is active
    const leagueSpecificColumn = document.getElementById('league-specific-column');
    const leagueHeader = document.getElementById('league-specific-header');
    if (leagueSpecificColumn && leagueHeader) {
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                    const isVisible = leagueSpecificColumn.style.display !== 'none';
                    const isFormulaOne = leagueHeader.innerText === 'Formula One';
                    
                    if (isVisible && isFormulaOne) {
                        const activeMainTab = document.querySelector('.f1-main-tab.active');
                        const activeTabType = activeMainTab ? activeMainTab.dataset.f1MainTab : 'standings';
                        
                        if (activeTabType === 'standings' && !driverStandingsLoaded && typeof loadDriverStandings === 'function') {
                            setTimeout(() => {
                                loadDriverStandings();
                                driverStandingsLoaded = true;
                            }, 100);
                        }
                    }
                }
            });
        });
        
        observer.observe(leagueSpecificColumn, { attributes: true, attributeFilter: ['style'] });
        observer.observe(leagueHeader, { childList: true, characterData: true, subtree: true });
    }

    if (f1MainTabsContainer) {
        f1MainTabsContainer.addEventListener('click', function(event) {
            const clickedTab = event.target.closest('.f1-main-tab');
            if (!clickedTab) return;

            const targetTab = clickedTab.dataset.f1MainTab;
            
            // Deactivate all main tabs
            f1MainTabsContainer.querySelectorAll('.f1-main-tab').forEach(tab => {
                tab.style.backgroundColor = '#2a2a2a';
                tab.style.color = '#ccc';
                tab.style.fontWeight = 'normal';
                tab.classList.remove('active');
            });

            // Hide all main tab contents
            f1MainTabContents.forEach(content => {
                content.style.display = 'none';
            });

            // Activate the clicked tab and its content
            clickedTab.style.backgroundColor = '#fff';
            clickedTab.style.color = '#000';
            clickedTab.style.fontWeight = 'bold';
            clickedTab.classList.add('active');
            
            const targetContent = document.getElementById(`f1-${targetTab}-tab-content`);
            if (targetContent) {
                targetContent.style.display = 'flex';
            }
            
            // Load standings data when Standings tab is clicked
            if (targetTab === 'standings' && !driverStandingsLoaded) {
                loadDriverStandings();
                driverStandingsLoaded = true;
            }
        });
    }
    
    // F1 Schedule sub-tabs handler (Yesterday, Today, Upcoming)
    const f1ScheduleTabsContainer = document.getElementById('f1-schedule-tabs');
    const f1ScheduleContentPanes = document.querySelectorAll('.f1-schedule-content-pane');
    
    function setF1ScheduleActiveTab(targetTab, isUserInitiated = false) {
        if (!f1ScheduleTabsContainer) return;
        const validTabs = ['today', 'upcoming']; // 'yesterday' removed - restore as: ['today', 'yesterday', 'upcoming']
        if (!validTabs.includes(targetTab)) {
            targetTab = 'upcoming';
        }

        f1ScheduleTabsContainer.querySelectorAll('.f1-schedule-tab').forEach(tab => {
            tab.style.borderBottom = 'none';
            tab.style.color = '#ccc';
            tab.classList.remove('active');
        });

        f1ScheduleContentPanes.forEach(pane => {
            if (pane) pane.style.display = 'none';
        });

        const activeTabEl = f1ScheduleTabsContainer.querySelector(`.f1-schedule-tab[data-f1-schedule-tab="${targetTab}"]`);
        if (activeTabEl) {
            activeTabEl.style.borderBottom = '2px solid #fff';
            activeTabEl.style.color = '#fff';
            activeTabEl.classList.add('active');
        }

        const activePane = document.getElementById(`f1-${targetTab}-content`);
        if (activePane) {
            activePane.style.display = 'block';
        }

        if (isUserInitiated) {
            window.f1ScheduleLastUserSelection = targetTab;
        }
    }

    window.setF1ScheduleActiveTab = setF1ScheduleActiveTab;

    if (f1ScheduleTabsContainer) {
        f1ScheduleTabsContainer.addEventListener('click', function(event) {
            const clickedTab = event.target.closest('.f1-schedule-tab');
            if (!clickedTab) return;

            const targetTab = clickedTab.dataset.f1ScheduleTab;
            
            setF1ScheduleActiveTab(targetTab, true);
            
            if (targetTab === 'upcoming' && typeof window.updateF1Schedule === 'function') {
                window.updateF1Schedule();
            }
        });
    }
    
    // F1 Standings sub-tabs handler (Driver, Constructor)
    const f1StandingsTabsContainer = document.getElementById('f1-standings-tabs');
    const f1StandingsContentPanes = document.querySelectorAll('.f1-standings-content-pane');
    
    if (f1StandingsTabsContainer) {
        f1StandingsTabsContainer.addEventListener('click', function(event) {
            const clickedTab = event.target.closest('.f1-standings-tab');
            if (!clickedTab) return;

            const targetTab = clickedTab.dataset.f1StandingsTab;
            
            // Deactivate all standings sub-tabs
            f1StandingsTabsContainer.querySelectorAll('.f1-standings-tab').forEach(tab => {
                tab.style.borderBottom = 'none';
                tab.style.color = '#ccc';
                tab.classList.remove('active');
            });

            // Hide all standings content panes
            f1StandingsContentPanes.forEach(pane => {
                pane.style.display = 'none';
            });

            // Activate the clicked tab and its content
            clickedTab.style.borderBottom = '2px solid #fff';
            clickedTab.style.color = '#fff';
            clickedTab.classList.add('active');
            
            const targetPane = document.getElementById(`f1-${targetTab}-standings-content`);
            if (targetPane) {
                targetPane.style.display = 'block';
            }
            
            // Load data if it hasn't been loaded yet
            if (targetTab === 'driver' && !driverStandingsLoaded) {
                loadDriverStandings();
                driverStandingsLoaded = true; 
            } else if (targetTab === 'constructor' && !constructorStandingsLoaded) {
                loadConstructorStandings();
                constructorStandingsLoaded = true;
            }
        });
    }
});
</script>

<script>
// Google Sheets Configuration - Using published CSV URLs (no API key needed)
const GOOGLE_SHEETS_CONFIG = {
    DRIVER_STANDINGS_URL: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS6rs6yvXAh-KktOOVGGY6knFMjR11W75yfcq7iReQCjl-uc9hHwT3yMpZ01GqAlYwsY0VYVTADrPiR/pub?output=csv',
    CONSTRUCTOR_STANDINGS_URL: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQcpOkjKy5bcEPAZRofXpGGyf0_VkfIBIDDrlgUIiSuznqdUfDRAqmy_EAcVN3K1-y_F6wr78TbH6U8/pub?output=csv'
};

// Function to fetch data from published Google Sheets CSV
async function fetchFromGoogleSheetsCSV(url) {
    try {
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        const csvText = await response.text();
        // Parse CSV data using a regular expression for newlines
        const rows = csvText.split(/\r?\n/).map(row => row.split(',').map(cell => cell.trim().replace(/^\"|\"$/g, '')));
        return rows.filter(row => row.length > 1 && row[0] !== ''); // Ensure row has content
    } catch (error) {
        console.error('Error fetching from Google Sheets CSV:', error);
        throw error;
    }
}

function buildStandardStandingsTable(rows) {
    if (!rows || rows.length < 2) {
        return '<p style="color: #9ca3af;">No standings data available.</p>';
    }

    const headers = rows[0];
    let tableHtml = '<table style="width: 100%; border-collapse: collapse; color: #ffffff; font-size: 11px;">';
    tableHtml += '<thead><tr>';
    headers.forEach(header => {
        tableHtml += `<th style="padding: 6px 4px; text-align: left; border-bottom: 1px solid #4a4a4a; color: #ccc;">${header}</th>`;
    });
    tableHtml += '</tr></thead><tbody>';

    for (let i = 1; i < rows.length; i++) {
        if (!rows[i] || rows[i].length < 2) continue;
        const rowStyle = i % 2 === 0 ? 'background-color: #262626;' : 'background-color: #1b1b1b;';
        tableHtml += `<tr style="${rowStyle}">`;
        rows[i].forEach(cell => {
            tableHtml += `<td style="padding: 6px 4px;">${cell || ''}</td>`;
        });
        tableHtml += '</tr>';
    }

    tableHtml += '</tbody></table>';
    return tableHtml;
}

function buildGroupedStandingsHtml(rows) {
    if (!rows || rows.length < 2) return '';

    const headers = rows[0].map(header => (header || '').trim());
    const groupIndex = headers.findIndex(header => {
        const normalized = header.toLowerCase();
        return normalized.includes('classification') || normalized.includes('division');
    });

    if (groupIndex === -1) return '';

    const columnHeaders = headers.filter((_, idx) => idx !== groupIndex);
    if (columnHeaders.length === 0) return '';

    const groupedData = {};
    for (let i = 1; i < rows.length; i++) {
        const row = rows[i];
        if (!row || row.length <= groupIndex) continue;
        const groupName = (row[groupIndex] || '').trim();
        if (!groupName) continue;
        if (!groupedData[groupName]) groupedData[groupName] = [];
        groupedData[groupName].push(row);
    }

    const groupKeys = Object.keys(groupedData);
    if (groupKeys.length === 0) return '';

    let groupedHtml = '';
    groupKeys.forEach(groupName => {
        groupedHtml += `<div style="margin-bottom: 25px;">`;
        groupedHtml += `<table style="width: 100%; border-collapse: collapse; font-size: 11px;">`;
        groupedHtml += `<thead>`;
        groupedHtml += `<tr><th colspan="${columnHeaders.length}" style="padding: 8px 4px; text-align: left; background-color: #1f1f1f; color: #ffffff; font-size: 13px; font-weight: bold; border-bottom: 1px solid #4a4a4a;">${groupName}</th></tr>`;
        groupedHtml += `<tr>`;
        columnHeaders.forEach(header => {
            groupedHtml += `<th style="padding: 6px 4px; text-align: left; border-bottom: 1px solid #4a4a4a; color: #ccc;">${header}</th>`;
        });
        groupedHtml += `</tr></thead><tbody>`;

        groupedData[groupName].forEach((row, index) => {
            const rowStyle = index % 2 === 0 ? 'background-color: #262626;' : 'background-color: #1b1b1b;';
            groupedHtml += `<tr style="${rowStyle}">`;
            row.forEach((cell, cellIndex) => {
                if (cellIndex === groupIndex) return;
                groupedHtml += `<td style="padding: 6px 4px; color: #ffffff;">${(cell || '').trim()}</td>`;
            });
            groupedHtml += `</tr>`;
        });

        groupedHtml += `</tbody></table></div>`;
    });

    return groupedHtml;
}

// Function to format driver name as "O. Piastri" (first initial + last name)
function formatDriverName(fullName) {
    if (!fullName) return '';
    const parts = fullName.trim().split(' ');
    if (parts.length >= 2) {
        const firstInitial = parts[0].charAt(0).toUpperCase() + '.';
        const lastName = parts.slice(1).join(' ');
        return `${firstInitial} ${lastName}`;
    }
    return fullName;
}

// Function to get team name from Firestore driver data (we'll need to add this field)
function getTeamNameFromDriver(driver) {
    // The scraper stores driver info, but we need team name
    // For now, we'll extract it from the API data structure
    // The team name should be in the driver's team object if available
    return driver.Team || driver.team || driver.teamName || '';
}

// Function to load driver standings from Firestore
async function loadDriverStandings() {
    const loadingDiv = document.getElementById('driver-loading');
    const errorDiv = document.getElementById('driver-error');
    const table = document.getElementById('driver-table');
    const tbody = document.getElementById('driver-tbody');
    try {
        loadingDiv.style.display = 'block';
        errorDiv.style.display = 'none';
        table.style.display = 'none';
        
        // Get Firestore db instance
        let firestoreDb;
        if (typeof db !== 'undefined' && db) {
            firestoreDb = db;
        } else if (typeof firebase !== 'undefined' && firebase.firestore) {
            firestoreDb = firebase.firestore();
        } else {
            throw new Error('Firestore database not initialized');
        }
        
        // Fetch from Firestore
        const snapshot = await firestoreDb.collection('F1DriverStandings').get();
        
        if (snapshot.empty) {
            throw new Error('No driver standings found in Firestore');
        }
        
        const drivers = [];
        snapshot.forEach(doc => {
            const data = doc.data();
            drivers.push({
                Rank: data.Rank || 0,
                Driver: data.Driver || '',
                Points: data.Points || '0',
                Wins: data.Wins || '0',
                Team: data.Team || '' // We need to add team to scraper or get from API
            });
        });
        
        // Sort by rank
        drivers.sort((a, b) => parseInt(a.Rank) - parseInt(b.Rank));
        
        tbody.innerHTML = '';
        drivers.forEach(driver => {
                const tr = document.createElement('tr');
                tr.style.borderTop = '1px solid #374151';
            const driverName = formatDriverName(driver.Driver);
            const teamName = driver.Team || '';
            
                tr.innerHTML = `
                <td style="padding: 6px 4px;">${driver.Rank}</td>
                <td style="padding: 6px 4px;">
                    <div style="color: #fff;">${driverName}</div>
                    ${teamName ? `<div style="color: #9ca3af; font-size: 10px; margin-top: 2px;">${teamName}</div>` : ''}
                </td>
                <td style="padding: 6px 4px; text-align: right; font-weight: bold;">${driver.Points}</td>
                <td style="padding: 6px 4px; text-align: right;">${driver.Wins}</td>
                `;
                tbody.appendChild(tr);
        });
        
        loadingDiv.style.display = 'none';
        table.style.display = 'table';
    } catch (error) {
        loadingDiv.style.display = 'none';
        errorDiv.style.display = 'block';
        errorDiv.textContent = `Error loading driver standings: ${error.message}`;
        console.error('Error loading driver standings:', error);
    }
}

// Function to load constructor standings from Firestore
async function loadConstructorStandings() {
    const loadingDiv = document.getElementById('constructor-loading');
    const errorDiv = document.getElementById('constructor-error');
    const table = document.getElementById('constructor-table');
    const tbody = document.getElementById('constructor-tbody');
    try {
        loadingDiv.style.display = 'block';
        errorDiv.style.display = 'none';
        table.style.display = 'none';
        
        // Get Firestore db instance
        let firestoreDb;
        if (typeof db !== 'undefined' && db) {
            firestoreDb = db;
        } else if (typeof firebase !== 'undefined' && firebase.firestore) {
            firestoreDb = firebase.firestore();
        } else {
            throw new Error('Firestore database not initialized');
        }
        
        // Fetch from Firestore
        const snapshot = await firestoreDb.collection('F1ConstructorStandings').get();
        
        if (snapshot.empty) {
            throw new Error('No constructor standings found in Firestore');
        }
        
        const constructors = [];
        snapshot.forEach(doc => {
            const data = doc.data();
            constructors.push({
                Rank: data.Rank || 0,
                Constructor: data.Constructor || '',
                Points: data.Points || '0',
                Wins: data.Wins || '0'
            });
        });
        
        // Sort by rank
        constructors.sort((a, b) => parseInt(a.Rank) - parseInt(b.Rank));
        
        tbody.innerHTML = '';
        constructors.forEach(constructor => {
                const tr = document.createElement('tr');
                tr.style.borderTop = '1px solid #374151';
            
                tr.innerHTML = `
                <td style="padding: 6px 4px;">${constructor.Rank}</td>
                <td style="padding: 6px 4px;">${constructor.Constructor}</td>
                <td style="padding: 6px 4px; text-align: right; font-weight: bold;">${constructor.Points}</td>
                <td style="padding: 6px 4px; text-align: right;">${constructor.Wins}</td>
                `;
                tbody.appendChild(tr);
        });
        
        loadingDiv.style.display = 'none';
        table.style.display = 'table';
    } catch (error) {
        loadingDiv.style.display = 'none';
        errorDiv.style.display = 'block';
        errorDiv.textContent = `Error loading constructor standings: ${error.message}`;
        console.error('Error loading constructor standings:', error);
    }
}

// Initial load when F1 section is shown
document.addEventListener('DOMContentLoaded', function () {
    // You may want to call loadDriverStandings() here if F1 is the default tab
});
</script>

	  <script>
document.addEventListener('DOMContentLoaded', function () {
    const scheduleContainer = document.getElementById('f1-schedule-container');

    // Fetches F1 schedule data from Firestore.
    async function fetchF1ScheduleData() {
        try {
            // Ensure Firebase is initialized - try to use global db first, otherwise initialize Firebase
            let firestoreDb = typeof db !== 'undefined' ? db : null;
            if (!firestoreDb && typeof firebase !== 'undefined') {
                try {
                    if (firebase.apps && firebase.apps.length === 0) {
                        // Firebase not initialized - get config from the main script or use fallback
                        // The main script should initialize Firebase, but if it hasn't, we'll try
                        firestoreDb = firebase.firestore();
                    } else {
                        firestoreDb = firebase.firestore();
                    }
                } catch (e) {
                    console.error('F1 Schedule: Error accessing Firestore:', e);
                }
            }
            
            if (!firestoreDb) {
                console.error('F1 Schedule: Firestore database not available');
                scheduleContainer.innerHTML = `<p style="color: #ef4444;">Error loading schedule.</p>`;
                return [];
            }

            const { DateTime } = luxon;
            const snapshot = await firestoreDb.collection('FormulaOne').get();
            
            console.log(`F1 Schedule: Found ${snapshot.size} documents in Firestore`);
            
            if (snapshot.empty) {
                console.log('F1 Schedule: Firestore collection is empty');
                return [];
            }

            const events = [];
            snapshot.forEach(doc => {
                const data = doc.data();
                
                // Extract fields from Firestore document
                const home = data['home'] || '';
                const away = data['away'] || '';
                const channel = data['channel'] || '';
                const dateStr = (data['date'] || '').trim(); // Format: YYYY-MM-DD
                const timeStr = (data['time'] || '').trim(); // Format: H:MM:SS AM/PM or H:MM AM/PM
                
                console.log(`F1 Schedule: Processing document - home: ${home}, away: ${away}, date: "${dateStr}", time: "${timeStr}"`);
                
                if (!dateStr || !timeStr) {
                    console.log('F1 Schedule: Skipping document - missing date or time', { home, away, dateStr, timeStr });
                    return; // Skip if missing date or time
                }

                // Parse date (YYYY-MM-DD) and time
                // Handle both formats: "2:00:00 PM" and "2:00 PM"
                const timeStrClean = timeStr.replace(/:\d{2}$/, '').trim(); // Remove seconds if present
                
                console.log(`F1 Schedule: After cleaning - timeStrClean: "${timeStrClean}"`);
                
                try {
                    // Combine date and time, then parse
                    // Firestore dates are in YYYY-MM-DD format
                    const dateParts = dateStr.split('-');
                    if (dateParts.length !== 3) {
                        console.log('F1 Schedule: Invalid date format', dateStr);
                        return;
                    }
                    
                    const year = parseInt(dateParts[0]);
                    const month = parseInt(dateParts[1]);
                    const day = parseInt(dateParts[2]);
                    
                    // Parse time string (e.g., "2:00 PM" or "2:00:00 PM")
                    // More flexible regex to handle variations
                    const timeMatch = timeStrClean.match(/^(\d{1,2}):(\d{2})(?::\d{2})?\s*(AM|PM)$/i);
                    if (!timeMatch) {
                        console.error('F1 Schedule: Invalid time format - regex did not match', {
                            timeStrClean: timeStrClean,
                            timeStrOriginal: timeStr,
                            charCodes: timeStrClean.split('').map(c => c.charCodeAt(0))
                        });
                        return;
                    }
                    
                    let hours = parseInt(timeMatch[1]);
                    const minutes = parseInt(timeMatch[2]);
                    const ampm = timeMatch[3].toUpperCase();
                    
                    const originalHours = hours;
                    if (ampm === 'PM' && hours !== 12) hours += 12;
                    if (ampm === 'AM' && hours === 12) hours = 0;
                    
                    console.log(`F1 Schedule: Parsing time - original: ${originalHours}:${minutes} ${ampm}, converted to 24h: ${hours}:${minutes}`);
                    
                    // Create DateTime in America/New_York timezone (EST/EDT)
                    const startDateTime = DateTime.fromObject({
                        year: year,
                        month: month,
                        day: day,
                        hour: hours,
                        minute: minutes
                    }, { zone: 'America/New_York' });
                    
                    if (!startDateTime.isValid) {
                        console.error('F1 Schedule: Invalid DateTime created', { year, month, day, hours, minutes, invalidReason: startDateTime.invalidReason });
                        return;
                    }
                    
                    console.log(`F1 Schedule: Created DateTime - ${startDateTime.toISO()}, local display: ${startDateTime.setZone('local').toFormat('h:mm a')}`);
                    
                    // For end time, assume 3 hours duration for races, 1 hour for practice/qualifying
                    let durationHours = 1;
                    if (away.toLowerCase().includes('race')) {
                        durationHours = 3;
                    } else if (away.toLowerCase().includes('qualifying') || away.toLowerCase().includes('sprint')) {
                        durationHours = 1.5;
                    }
                    
                    const endDateTime = startDateTime.plus({ hours: durationHours });
                    
                    events.push({
                    start: startDateTime,
                    end: endDateTime,
                        eventHead: home,
                        eventSub: away,
                        channel: channel
                    });
                } catch (parseError) {
                    console.error('F1 Schedule: Error parsing date/time for F1 event:', parseError, data);
                }
            });

            console.log(`F1 Schedule: Successfully parsed ${events.length} events`);
            
            return events.sort((a, b) => a.start.toMillis() - b.start.toMillis());
        } catch (error) {
            console.error('F1 Schedule: Error fetching from Firestore:', error);
            scheduleContainer.innerHTML = `<p style="color: #ef4444;">Error loading schedule.</p>`;
            return [];
        }
    }

    // Renders the schedule split between Today and Upcoming tabs
    function renderF1Schedule(events) {
        const scheduleContainer = document.getElementById('f1-schedule-container');
        const todayContent = document.getElementById('f1-today-content');
        // const yesterdayContent = document.getElementById('f1-yesterday-content'); // Commented out

        if (!events || events.length === 0) {
            todayContent.innerHTML = `<p style="color: #9ca3af; padding: 1rem;">No Formula 1 events today.</p>`;
            scheduleContainer.innerHTML = `<p style="color: #9ca3af;">No upcoming schedule found.</p>`;
            // if (yesterdayContent) {
            //     yesterdayContent.innerHTML = `<p style="color: #9ca3af;">No Formula 1 events yesterday.</p>`;
            // }
            if (!window.f1ScheduleLastUserSelection && typeof window.setF1ScheduleActiveTab === 'function') {
                window.setF1ScheduleActiveTab('upcoming');
            }
            return;
        }

        const { DateTime } = luxon;
        const now = DateTime.now().setZone('local');
        const todayStart = now.startOf('day');
        const tomorrowStart = todayStart.plus({ days: 1 });
        const yesterdayStart = todayStart.minus({ days: 1 });

        const todayEvents = [];
        const yesterdayEvents = [];
        const upcomingEvents = [];

        events.forEach(event => {
            const localStart = event.start.setZone('local');
            if (localStart >= todayStart && localStart < tomorrowStart) {
                todayEvents.push(event);
            } else if (localStart >= yesterdayStart && localStart < todayStart) {
                yesterdayEvents.push(event);
            } else if (localStart >= tomorrowStart) {
                upcomingEvents.push(event);
            }
        });

        if (todayEvents.length > 0) {
            todayEvents.sort((a, b) => a.start.toMillis() - b.start.toMillis());

            let todayHtml = '<div class="f1-today-list">';
            todayEvents.forEach(event => {
                const startTime = event.start.setZone('local').toFormat('h:mm a');
                todayHtml += `
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #333;">
                        <div style="flex-grow: 1; color: white; font-size: 11px;">
                            <div style="font-weight: bold;">${event.eventHead}</div>
                            <div style="color: #9ca3af; font-size: 10px;">${event.eventSub}</div>
                        </div>
                        <div style="color: white; font-size: 11px; font-weight: bold;">${startTime}</div>
                    </div>
                `;
            });
            todayHtml += '</div>';
            todayContent.innerHTML = todayHtml;
        } else {
            todayContent.innerHTML = `<p style="color: #9ca3af; padding: 1rem;">No Formula 1 events today.</p>`;
        }

        // Yesterday tab functionality commented out
        /*
        if (yesterdayContent) {
            if (yesterdayEvents.length > 0) {
                yesterdayEvents.sort((a, b) => a.start.toMillis() - b.start.toMillis());
                let yesterdayHtml = '<div class="f1-yesterday-list">';
                yesterdayEvents.forEach(event => {
                    const startTime = event.start.setZone('local').toFormat('h:mm a');
                    yesterdayHtml += `
                        <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #333;">
                            <div style="flex-grow: 1; color: #e5e7eb; font-size: 11px;">
                                <div style="font-weight: bold; color: #fff;">${event.eventHead}</div>
                                <div style="color: #9ca3af; font-size: 10px;">${event.eventSub}</div>
                            </div>
                            <div style="color: #9ca3af; font-size: 11px;">${startTime}</div>
                        </div>
                    `;
                });
                yesterdayHtml += '</div>';
                yesterdayContent.innerHTML = yesterdayHtml;
            } else {
                yesterdayContent.innerHTML = `<p style="color: #9ca3af;">No Formula 1 events yesterday.</p>`;
            }
        }
        */

        if (upcomingEvents.length === 0 && todayEvents.length === 0) {
            scheduleContainer.innerHTML = `<p style="color: #9ca3af;">The season may have concluded.</p>`;
        } else if (upcomingEvents.length === 0) {
            scheduleContainer.innerHTML = `<p style="color: #9ca3af;">No upcoming events found.</p>`;
        } else {
            const groupedByDate = upcomingEvents.reduce((acc, event) => {
                const localStart = event.start.setZone('local');
                const dateKey = localStart.toFormat('yyyy-MM-dd');
                if (!acc[dateKey]) acc[dateKey] = [];
            acc[dateKey].push(event);
            return acc;
        }, {});
        
        let html = '';
            const sortedDates = Object.keys(groupedByDate).sort();

            sortedDates.forEach(dateKey => {
                const dateObj = DateTime.fromISO(dateKey);
                const dateHeader = dateObj.toFormat('MMMM d');
                html += `<div style="background-color: #2a2a2a; color: white; padding: 1px 8px; margin: 10px 0 5px 0; font-size: 11px; font-weight: bold;">${dateHeader}</div>`;

            groupedByDate[dateKey].forEach(event => {
                    const localStart = event.start.setZone('local');
                    const timeDisplay = localStart.toFormat('h:mm a');
                html += `
                        <div style="display: flex; justify-content: space-between; padding: 6px 8px; border-bottom: 1px solid #333; font-size: 11px;">
                            <div style="flex-grow: 1; color: white;">
                                <div style="font-weight: bold;">${event.eventHead}</div>
                                <div style="color: #9ca3af; font-size: 10px;">${event.eventSub}</div>
                            </div>
                            <div style="color: #ccc; font-weight: normal; margin-left: 10px; min-width: 50px; text-align: right;">${timeDisplay}</div>
                        </div>
                `;
            });
            });

            scheduleContainer.innerHTML = html || `<p style="color: #9ca3af;">No upcoming events found.</p>`;
        }

        const hasTodayEvents = todayEvents.length > 0;
        // const hasYesterdayEvents = yesterdayEvents.length > 0; // Commented out
        if (!window.f1ScheduleLastUserSelection && typeof window.setF1ScheduleActiveTab === 'function') {
            if (hasTodayEvents) {
                window.setF1ScheduleActiveTab('today');
            } else {
                // else if (hasYesterdayEvents) { window.setF1ScheduleActiveTab('yesterday'); } // Commented out
                window.setF1ScheduleActiveTab('upcoming');
            }
        }
    }

    // Main function to update the schedule
    async function updateSchedule() {
        const events = await fetchF1ScheduleData();
        renderF1Schedule(events);
    }
    
    // Make updateSchedule available globally
    window.updateF1Schedule = updateSchedule;
    
    // Auto-load schedule if the Upcoming tab is already visible
    const upcomingContent = document.getElementById('f1-upcoming-content');
    if (upcomingContent && upcomingContent.style.display !== 'none') {
        // Wait a bit for Firebase to initialize
        setTimeout(() => {
    updateSchedule();
        }, 500);
    }
});
</script>
<script>
// --- FINAL UNIFIED SCRIPT for ALL Game, Schedule, and Standings Logic ---
document.addEventListener('DOMContentLoaded', function () {

    // --- 1. CONFIGURATION ---
  const LEAGUE_DATA_CONFIG = {
  'NFL': { leagueId: 'USA: NFL', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSoXI911JBowIVpsOtYo7Jk0WwwNlujQ76rR4lgDAqxGWLa_q67gOXI0DyKsC4YkKIfbSYqerHp17-m/pub?gid=1628205730&single=true&output=csv', upcomingCollectionName: 'NFL' },
  'NBA': { leagueId: 'USA: NBA', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vStADlwOOQG4uJvUPl8bpUdShU2aoO7oCyOFBxWScG5KUYe-pkrh4fqiuVVExGjCdFhl1ZBjsjtg7e-/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'NBA' },
  'MLB': { leagueId: 'USA: MLB', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRQHOSDTxfJ554E0MhgZPfmnarCUunnYmxDBSZ78APQ3QfvPWBnn1i68JPSuNCNByd1IzYEbj-6AVAZ/pub?gid=1312763847&single=true&output=csv', upcomingCollectionName: 'MLB' },
  'NHL': { leagueId: 'USA: NHL', standingsUrl: 'YOUR_NHL_STANDINGS_CSV_URL_HERE', upcomingCollectionName: 'NHL' },
  'MLS': { leagueId: 'USA: MLS', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSQ-fXiJCsMWxpSzu9x_vE7DhdtHBBpL54Ue3vnPnk21OeTsGwZoQnJK7FNAZkT9Nfj8Ox8tuV21pwp/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'MLS' },
  'PremierLeague': { leagueId: 'England: Premier League', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT8lEnnlz6Uhb47U4yOnsSUOcsfBS3TrpEXri3g6S2Yj2FUkq1rSSgE4SveKPoAJQsu6U2kkfdGtmhO/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'PremierLeague' },
  'LaLiga': { leagueId: 'Spain: LaLiga', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS8ZGW33Hc9fDIq8mJZZqVj8GJdm3p08Jug6e5fTP0-KBtGpFB6BIXgDKkvHqyHnJRKZ9Ba24I3hekV/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'LaLiga' },
  'SerieA': { leagueId: 'Italy: Serie A', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRaaFrDXpcgY4EiGwkYfT0zodrVA1GJU2A6qcrc1GcLxkPjHh43ksM3T4c4p5nFdqKJoj96eEpUKST3/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'SerieA' },
  'Bundesliga': { leagueId: 'Germany: Bundesliga', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTwpzErtNqiT5mq4kII0P1OxnY41WAgyY4fi7kiThIgNSgf6lr3kslZ9OBAP3-I2YJ4_aA0p0LNjsaH/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'Bundesliga' },
  'Ligue1': { leagueId: 'France: Ligue 1', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRD-758CxWtSSl1PCJRdVREjXqhrxTBjYBtnxx4ot8wUdEGfw7ONCzQNfTIdvntZoi1Kme0F7Nkt4Wa/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'Ligue1' },
  'NCAAF': { leagueId: 'USA: NCAA', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRiThcO5BjAuw3818zbgA9WxlLQFK8T3n5LCPxAihwjANmnxme5ynsLG2EyD2RyPvACe4wGlY36ekF7/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'NCAAF' },
  'WNBA': { leagueId: 'USA: WNBA', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSMWPTh0lOh89-qkXYbx63Vs8FQ7gUoT0333Pa9ZgPg4WWBMgB-xERDMM_U2yIUgS3TSPOXOD5M7sVl/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'WNBA' },
  'Soccer': { leagueId: 'WORLD: SOCCER', standingsUrl: 'YOUR_SOCCER_STANDINGS_CSV_URL_HERE', upcomingCollectionName: 'Soccer' },
  'UEFAChampionsLeague': { leagueId: 'Europe: Champions League - League phase', standingsUrl: 'YOUR_UEFACHAMPIONSLEAGUE_STANDINGS_CSV_URL_HERE', upcomingCollectionName: 'UEFAChampionsLeague' },
  'AFCChampionsLeague': { leagueId: 'Asia: AFC Elite', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT8lEnnlz6Uhb47U4yOnsSUOcsfBS3TrpEXri3g6S2Yj2FUkq1rSSgE4SveKPoAJQsu6U2kkfdGtmhO/pub?gid=3&single=true&output=csv', upcomingCollectionName: 'AFCChampionsLeague' },
  'FACup': { leagueId: 'ENGLAND: FA CUP', standingsUrl: 'YOUR_FACUP_STANDINGS_CSV_URL_HERE', upcomingCollectionName: 'FACup' },
  'LigaMX': { leagueId: 'MEXICO: LIGA MX', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSL_7HJC0jqhF1jy4tiIrrh5RLewsiH9RezMKDx6TpZtz2JHB8D7Dlx7yyZRWZ7rU5txoTasyiHk7M4/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'LigaMX' },
  'NWSL': { leagueId: 'USA: NWSL Women', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQJn_hnVeNfnXsDpeer_hgh6dxOcL2VOJzHKsE8cv-OTaX8EzWRYIGNLqLztvuAeuJbM4oEElA-LoiU/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'NWSL' },
  'UEFAEuropaLeague': { leagueId: 'Europe: Europa League', standingsUrl: 'YOUR_UEFAEUROPALEAGUE_STANDINGS_CSV_URL_HERE', upcomingCollectionName: 'UEFAEuropaLeague' },
  'UEFAConferenceLeague': { leagueId: 'Europe: Conference League', standingsUrl: 'YOUR_UEFACONFERENCELEAGUE_STANDINGS_CSV_URL_HERE', upcomingCollectionName: 'UEFAConferenceLeague' },
  'FormulaOne': { leagueId: 'WORLD: FORMULA ONE', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS0ZCePqjVW1racqCCco2b780uxVWrdWV-CSMwkrJbFwgXCsfOdqniDeTmpb53YCkuS2EyUq0JQA9Ab/pub?gid=665565463&single=true&output=csv', upcomingCollectionName: 'FormulaOne' },
  'PGATour': { leagueId: 'PGA Tour', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRh72gyQFguMGj0RkHvy-WrAH3EBpOMdikyKIjrOfSs5aAYYlE7NjbRJsBa7gkkJ4gV_nUUYSbCje2L/pub?gid=786471151&single=true&output=csv', upcomingCollectionName: 'PGATour' },
  'UFC': { leagueId: 'WORLD: UFC', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS2Z0QfXw34ib6V0gmcdqVvu6gwy8vHnD6cF3xMhJGZJHpU_s0vwC0h7phvbV0joe4tdVDGHiJ1kBfX/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'UFC' },
  'Boxing': { leagueId: 'WORLD: BOXING', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRthmvN_N-bKFQdsc5V_Otx92FF5qwjYkI9YXHoKgKyV5jvfmb6skABo0Ncbh1x0ehEU-4Je3w_KPmb/pub?gid=1100984840&single=true&output=csv', upcomingCollectionName: 'Boxing' },
  'NASCARCupSeries': { leagueId: 'USA: NASCAR CUP SERIES', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRzMLdfLfGydr1dpjhS8hr1PLCBod_Jm-J9ABvGaeyhttkAep5HAtWfB5hGeCaLHteZBapJMhNExe0l/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'NASCARCupSeries' },
  'Tennis': { leagueId: 'WORLD: TENNIS', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ74Qw3ZgBqRAKd_HVAnGLI9zDqk_JILTBTtlrFKI8oCosRHnLQZ9Nu8BIAVYdLq932wzE8oz3UNCIP/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'Tennis' },
  'LIVGolf': { leagueId: 'WORLD: LIV GOLF', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTZ7zf4PAme33oOeQ5NFNVE3W1OXJDJ2-qN0_TKLYaditRtpsa7yfxGY3lsGJQxZLQxhIKGzAH7NgBo/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'LIVGolf' },
  'IndyCar': { leagueId: 'USA: INDYCAR', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQWqPs7Krfm7U1_bU2MShMSgAGF5RIXqIVUZ6vQO2XWz0waDHd48eiawVeOwXwAkeZBdoNA1X4Mkzs3/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'IndyCar' },
  'NCAAM': { leagueId: 'USA: NCAA', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRWwuY4T7aQXTeW_8WDncuzDZUAIr9JDhV2MjP4ZFAM0EjuUWgpKBb2sWjI9gZxvqCxnON9JTN7lo2i/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'NCAAM', desiredSport: 'Basketball' },
  'NCAAW': { leagueId: 'USA: NCAA Women', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRDKX76cBl2tx7s_rW20e2TzKX-uvA6UsPBjsv_UXhhoE8zVmUFJvDaopCxEhaDWyaOtL4wDWSVE6H7/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'NCAAW', desiredSport: 'Basketball' },
  'NCAABaseball': { leagueId: 'USA: NCAA BASEBALL', standingsUrl: 'YOUR_NCAABASEBALL_STANDINGS_CSV_URL_HERE', upcomingCollectionName: 'NCAABaseball' },
  'NCAASoftball': { leagueId: 'USA: NCAA SOFTBALL', standingsUrl: 'YOUR_NCAASOFTBALL_STANDINGS_CSV_URL_HERE', upcomingCollectionName: 'NCAASoftball' },
  'WorldCupU17': { leagueId: 'World: World Cup U17', standingsUrl: '', upcomingCollectionName: 'WorldCupU17' },
  'WorldCupU17PlayOffs': { leagueId: 'World: World Cup U17 - Play Offs', standingsUrl: '', upcomingCollectionName: 'WorldCupU17PlayOffs' },
  'MotoGP': { leagueId: 'WORLD: MOTOGP', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSqOmundPRaLEu2Jcgt3KBdTRX6jy-Nmkb89fuJC_SfntbZVF_Y-tNehFSnZwqdmK2O3GJR3UlHFXms/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'MotoGP' },
  'LPGATour': { leagueId: 'LPGA Tour', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSgv4aRqL4dKgbADnZNH1e_oR8rgnbGOY9roEzXNVas0C6nlkx3RggqK7RCq0Cl148yFD0DfxAxtK4q/pub?gid=0&single=true&output=csv', upcomingCollectionName: 'LPGATour' },
  'TrackAndField': { leagueId: 'WORLD: TRACK AND FIELD', standingsUrl: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRbnsEETRJkJlYNokKws_nlk6-OfyJKg8aoq8AldZZgRcdV5YtuQ1kdINCKvR2H-XQZJVxRxcZaKOq2/pub?gid=2060167316&single=true&output=csv', upcomingCollectionName: 'TrackAndField' }
};
    // Hardcoded upcoming schedules (manually maintained)
    const HARDCODED_UPCOMING_SCHEDULES = {
        'Ligue1': [
            { date: '2026-01-02', time: '2:45 PM', home: 'Toulouse', away: 'Lens', channel: 'beIN' },
            { date: '2026-01-03', time: '11:00 AM', home: 'Monaco', away: 'Olympique Lyonnais', channel: 'beIN' },
            { date: '2026-01-03', time: '1:00 PM', home: 'Nice', away: 'Strasbourg', channel: 'beIN' },
            { date: '2026-01-03', time: '3:05 PM', home: 'Lille', away: 'Rennes', channel: 'beIN' },
            { date: '2026-01-04', time: '11:15 AM', home: 'Brest', away: 'Auxerre', channel: 'beIN' },
            { date: '2026-01-04', time: '11:15 AM', home: 'Le Havre', away: 'Angers SCO', channel: 'beIN' },
            { date: '2026-01-04', time: '11:15 AM', home: 'Lorient', away: 'Metz', channel: 'beIN' },
            { date: '2026-01-16', time: '1:00 PM', home: 'Monaco', away: 'Lorient', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-16', time: '3:00 PM', home: 'PSG', away: 'Lille', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-17', time: '11:00 AM', home: 'Lens', away: 'Auxerre', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-17', time: '1:00 PM', home: 'Toulouse', away: 'Nice', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-17', time: '3:05 PM', home: 'Angers SCO', away: 'Olympique Marseille', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-18', time: '9:00 AM', home: 'Strasbourg', away: 'Metz', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-18', time: '11:15 AM', home: 'Nantes', away: 'Paris', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-18', time: '11:15 AM', home: 'Rennes', away: 'Le Havre', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-18', time: '2:45 PM', home: 'Olympique Lyonnais', away: 'Brest', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-23', time: '2:00 PM', home: 'Auxerre', away: 'PSG', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-24', time: '11:00 AM', home: 'Rennes', away: 'Lorient', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-24', time: '1:00 PM', home: 'Le Havre', away: 'Monaco', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-24', time: '3:05 PM', home: 'Olympique Marseille', away: 'Lens', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-25', time: '9:00 AM', home: 'Nantes', away: 'Nice', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-25', time: '11:15 AM', home: 'Brest', away: 'Toulouse', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-25', time: '11:15 AM', home: 'Metz', away: 'Olympique Lyonnais', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-25', time: '11:15 AM', home: 'Paris', away: 'Angers SCO', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-25', time: '2:45 PM', home: 'Lille', away: 'Strasbourg', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-30', time: '2:45 PM', home: 'Lens', away: 'Le Havre', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-31', time: '11:00 AM', home: 'Paris', away: 'Olympique Marseille', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-31', time: '1:00 PM', home: 'Lorient', away: 'Nantes', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-01-31', time: '3:05 PM', home: 'Monaco', away: 'Rennes', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-02-01', time: '9:00 AM', home: 'Olympique Lyonnais', away: 'Lille', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-02-01', time: '11:15 AM', home: 'Angers SCO', away: 'Metz', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-02-01', time: '11:15 AM', home: 'Nice', away: 'Brest', channel: 'Disney+ Premium Caribbean' },
            { date: '2026-02-01', time: '11:15 AM', home: 'Toulouse', away: 'Auxerre', channel: 'Disney+ Premium Caribbean' }
        ],
        'LigaMX': [
            { date: '2026-01-09', time: '10:00 PM', home: 'Atlas', away: 'Puebla', channel: 'ViX' },
            { date: '2026-01-09', time: '10:00 PM', home: 'Mazatlán', away: 'Juárez', channel: 'ViX' },
            { date: '2026-01-09', time: '10:00 PM', home: 'Tijuana', away: 'América', channel: 'ViX' },
            { date: '2026-01-10', time: '6:00 PM', home: 'Guadalajara', away: 'Pachuca', channel: '' },
            { date: '2026-01-10', time: '8:00 PM', home: 'León', away: 'Cruz Azul', channel: '' },
            { date: '2026-01-10', time: '8:00 PM', home: 'Santos Laguna', away: 'Necaxa', channel: 'ViX' },
            { date: '2026-01-10', time: '10:00 PM', home: 'Monterrey', away: 'Toluca', channel: 'ViX' },
            { date: '2026-01-11', time: '1:00 PM', home: 'Pumas UNAM', away: 'Querétaro', channel: '' },
            { date: '2026-01-11', time: '8:00 PM', home: 'Atlético San Luis', away: 'Tigres UANL', channel: '' },
            { date: '2026-01-13', time: '8:00 PM', home: 'Necaxa', away: 'Monterrey', channel: 'ViX' },
            { date: '2026-01-13', time: '8:00 PM', home: 'Pachuca', away: 'León', channel: '' },
            { date: '2026-01-13', time: '8:00 PM', home: 'Puebla', away: 'Mazatlán', channel: 'ViX' },
            { date: '2026-01-13', time: '10:00 PM', home: 'Cruz Azul', away: 'Atlas', channel: '' },
            { date: '2026-01-13', time: '10:00 PM', home: 'Juárez', away: 'Guadalajara', channel: '' },
            { date: '2026-01-14', time: '8:00 PM', home: 'América', away: 'Atlético San Luis', channel: '' },
            { date: '2026-01-14', time: '8:00 PM', home: 'Querétaro', away: 'Tijuana', channel: 'ViX' },
            { date: '2026-01-14', time: '10:00 PM', home: 'Tigres UANL', away: 'Pumas UNAM', channel: '' },
            { date: '2026-01-14', time: '10:00 PM', home: 'Toluca', away: 'Santos Laguna', channel: '' },
            { date: '2026-01-16', time: '10:00 PM', home: 'Mazatlán', away: 'Monterrey', channel: 'ViX' },
            { date: '2026-01-17', time: '6:00 PM', home: 'Guadalajara', away: 'Querétaro', channel: '' },
            { date: '2026-01-17', time: '6:00 PM', home: 'Necaxa', away: 'Atlas', channel: 'ViX' },
            { date: '2026-01-17', time: '8:00 PM', home: 'Tigres UANL', away: 'Toluca', channel: '' },
            { date: '2026-01-17', time: '10:00 PM', home: 'Cruz Azul', away: 'Puebla', channel: '' },
            { date: '2026-01-17', time: '10:00 PM', home: 'Tijuana', away: 'Atlético San Luis', channel: 'ViX' },
            { date: '2026-01-18', time: '1:00 PM', home: 'Pumas UNAM', away: 'León', channel: '' },
            { date: '2026-01-18', time: '6:00 PM', home: 'Santos Laguna', away: 'Juárez', channel: 'ViX' },
            { date: '2026-01-18', time: '8:00 PM', home: 'Pachuca', away: 'América', channel: '' },
            { date: '2026-01-30', time: '8:00 PM', home: 'Puebla', away: 'Toluca', channel: 'ViX' },
            { date: '2026-01-30', time: '10:00 PM', home: 'Juárez', away: 'Cruz Azul', channel: '' },
            { date: '2026-01-30', time: '10:00 PM', home: 'Pumas UNAM', away: 'Santos Laguna', channel: '' },
            { date: '2026-01-31', time: '6:00 PM', home: 'Atlas', away: 'Mazatlán', channel: 'ViX' },
            { date: '2026-01-31', time: '8:00 PM', home: 'León', away: 'Tigres UANL', channel: '' },
            { date: '2026-01-31', time: '8:00 PM', home: 'Monterrey', away: 'Tijuana', channel: 'ViX' },
            { date: '2026-01-31', time: '10:00 PM', home: 'América', away: 'Necaxa', channel: '' },
            { date: '2026-02-01', time: '6:00 PM', home: 'Querétaro', away: 'Pachuca', channel: 'ViX' },
            { date: '2026-02-01', time: '8:00 PM', home: 'Atlético San Luis', away: 'Guadalajara', channel: '' },
            { date: '2026-02-06', time: '8:00 PM', home: 'Necaxa', away: 'Atlético San Luis', channel: 'ViX' },
            { date: '2026-02-06', time: '8:00 PM', home: 'Tigres UANL', away: 'Santos Laguna', channel: '' },
            { date: '2026-02-06', time: '10:00 PM', home: 'Mazatlán', away: 'Guadalajara', channel: 'ViX' },
            { date: '2026-02-06', time: '10:00 PM', home: 'Tijuana', away: 'Puebla', channel: 'ViX' }
        ],
        'FACup': [
            { date: '2026-01-09', time: '2:30 PM', home: 'Milton Keynes Dons', away: 'Oxford United', channel: 'ESPN Select' },
            { date: '2026-01-09', time: '2:30 PM', home: 'Port Vale', away: 'Fleetwood Town', channel: 'ESPN Select' },
            { date: '2026-01-09', time: '2:30 PM', home: 'Preston North End', away: 'Wigan Athletic', channel: 'ESPN Select' },
            { date: '2026-01-09', time: '2:30 PM', home: 'Wrexham', away: 'Nottingham Forest', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '7:15 AM', home: 'Cheltenham Town', away: 'Leicester City', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '7:15 AM', home: 'Everton', away: 'Sunderland', channel: 'ESPN2' },
            { date: '2026-01-10', time: '7:15 AM', home: 'Macclesfield', away: 'Crystal Palace', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '7:15 AM', home: 'Wolverhampton Wanderers', away: 'Shrewsbury Town', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Boreham Wood', away: 'Burton Albion', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Burnley', away: 'Millwall', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Doncaster Rovers', away: 'Southampton', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Fulham', away: 'Middlesbrough', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Ipswich Town', away: 'Blackpool', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Manchester City', away: 'Exeter City', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Newcastle United', away: 'AFC Bournemouth', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Salford City', away: 'Swindon Town', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Sheffield Wednesday', away: 'Brentford', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '10:00 AM', home: 'Stoke City', away: 'Coventry City', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '12:45 PM', home: 'Bristol City', away: 'Watford', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '12:45 PM', home: 'Cambridge United', away: 'Birmingham City', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '12:45 PM', home: 'Grimsby Town', away: 'Weston-super-Mare', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '12:45 PM', home: 'Tottenham Hotspur', away: 'Aston Villa', channel: 'ESPN Select' },
            { date: '2026-01-10', time: '3:00 PM', home: 'Charlton Athletic', away: 'Chelsea', channel: 'ESPN Select' },
            { date: '2026-01-11', time: '7:00 AM', home: 'Derby County', away: 'Leeds United', channel: 'ESPN Select' },
            { date: '2026-01-11', time: '9:00 AM', home: 'Portsmouth', away: 'Arsenal', channel: 'ESPN2' },
            { date: '2026-01-11', time: '9:30 AM', home: 'Hull City', away: 'Blackburn Rovers', channel: 'ESPN Select' },
            { date: '2026-01-11', time: '9:30 AM', home: 'Norwich City', away: 'Walsall', channel: 'ESPN Select' },
            { date: '2026-01-11', time: '9:30 AM', home: 'Sheffield United', away: 'Mansfield Town', channel: 'ESPN Select' },
            { date: '2026-01-11', time: '9:30 AM', home: 'Swansea City', away: 'West Bromwich Albion', channel: 'ESPN Select' },
            { date: '2026-01-11', time: '9:30 AM', home: 'West Ham United', away: 'Queens Park Rangers', channel: 'ESPN Select' },
            { date: '2026-01-11', time: '11:30 AM', home: 'Manchester United', away: 'Brighton & Hove Albion', channel: 'ESPN Select' },
            { date: '2026-01-12', time: '2:45 PM', home: 'Liverpool', away: 'Barnsley', channel: 'ESPN Select' }
        ],
        'Bundesliga': [
            { date: '2026-01-09', time: '2:30 PM', home: 'Eintracht Frankfurt', away: 'Borussia Dortmund', channel: 'ESPN2' },
            { date: '2026-01-10', time: '9:30 AM', home: '1. FC Heidenheim 1846', away: 'FC Cologne', channel: 'ESPN+' },
            { date: '2026-01-10', time: '9:30 AM', home: '1. FC Union Berlin', away: 'Mainz', channel: 'ESPN+' },
            { date: '2026-01-10', time: '9:30 AM', home: 'SC Freiburg', away: 'Hamburg SV', channel: 'ESPN+' },
            { date: '2026-01-10', time: '9:30 AM', home: 'St. Pauli', away: 'RB Leipzig', channel: 'ESPN+' },
            { date: '2026-01-10', time: '9:30 AM', home: 'Werder Bremen', away: 'TSG Hoffenheim', channel: 'ESPN+' },
            { date: '2026-01-10', time: '12:30 PM', home: 'Bayer Leverkusen', away: 'VfB Stuttgart', channel: 'ESPN+' },
            { date: '2026-01-11', time: '9:30 AM', home: 'Borussia Mönchengladbach', away: 'FC Augsburg', channel: 'ESPN+' },
            { date: '2026-01-11', time: '11:30 AM', home: 'Bayern Munich', away: 'VfL Wolfsburg', channel: 'ESPN+' },
            { date: '2026-01-14', time: '12:30 PM', home: 'VfL Wolfsburg', away: 'St. Pauli', channel: 'ESPN+' },
            { date: '2026-01-14', time: '2:30 PM', home: 'FC Cologne', away: 'Bayern Munich', channel: 'ESPN+' },
            { date: '2026-01-14', time: '2:30 PM', home: 'RB Leipzig', away: 'SC Freiburg', channel: 'ESPN+' },
            { date: '2026-01-14', time: '2:30 PM', home: 'TSG Hoffenheim', away: 'Borussia Mönchengladbach', channel: 'ESPN+' },
            { date: '2026-01-15', time: '2:30 PM', home: 'FC Augsburg', away: '1. FC Union Berlin', channel: 'ESPN+' },
            { date: '2026-01-16', time: '2:30 PM', home: 'Werder Bremen', away: 'Eintracht Frankfurt', channel: 'ESPN+' },
            { date: '2026-01-17', time: '9:30 AM', home: 'Borussia Dortmund', away: 'St. Pauli', channel: 'ESPN+' },
            { date: '2026-01-17', time: '9:30 AM', home: 'FC Cologne', away: 'Mainz', channel: 'ESPN+' },
            { date: '2026-01-17', time: '9:30 AM', home: 'Hamburg SV', away: 'Borussia Mönchengladbach', channel: 'ESPN+' },
            { date: '2026-01-17', time: '9:30 AM', home: 'TSG Hoffenheim', away: 'Bayer Leverkusen', channel: 'ESPN+' },
            { date: '2026-01-17', time: '9:30 AM', home: 'VfL Wolfsburg', away: '1. FC Heidenheim 1846', channel: 'ESPN+' },
            { date: '2026-01-17', time: '12:30 PM', home: 'RB Leipzig', away: 'Bayern Munich', channel: 'ESPN+' },
            { date: '2026-01-18', time: '9:30 AM', home: 'VfB Stuttgart', away: '1. FC Union Berlin', channel: 'ESPN+' },
            { date: '2026-01-18', time: '11:30 AM', home: 'FC Augsburg', away: 'SC Freiburg', channel: 'ESPN+' },
            { date: '2026-01-23', time: '2:30 PM', home: 'St. Pauli', away: 'Hamburg SV', channel: 'ESPN+' },
            { date: '2026-01-24', time: '9:30 AM', home: '1. FC Heidenheim 1846', away: 'RB Leipzig', channel: 'ESPN+' },
            { date: '2026-01-24', time: '9:30 AM', home: 'Bayer Leverkusen', away: 'Werder Bremen', channel: 'ESPN+' },
            { date: '2026-01-24', time: '9:30 AM', home: 'Bayern Munich', away: 'FC Augsburg', channel: 'ESPN+' },
            { date: '2026-01-24', time: '9:30 AM', home: 'Eintracht Frankfurt', away: 'TSG Hoffenheim', channel: 'ESPN+' },
            { date: '2026-01-24', time: '9:30 AM', home: 'Mainz', away: 'VfL Wolfsburg', channel: 'ESPN+' },
            { date: '2026-01-24', time: '12:30 PM', home: '1. FC Union Berlin', away: 'Borussia Dortmund', channel: 'ESPN+' }
        ],
        'LaLiga': [
            { date: '2026-01-02', time: '3:00 PM', home: 'Rayo Vallecano', away: 'Getafe', channel: 'ESPN+' },
            { date: '2026-01-03', time: '8:00 AM', home: 'Celta Vigo', away: 'Valencia', channel: 'ESPN+' },
            { date: '2026-01-03', time: '10:15 AM', home: 'Osasuna', away: 'Athletic Club', channel: 'ESPN+' },
            { date: '2026-01-03', time: '12:30 PM', home: 'Elche', away: 'Villarreal', channel: 'ESPN+' },
            { date: '2026-01-03', time: '3:00 PM', home: 'Espanyol', away: 'Barcelona', channel: 'ESPN+' },
            { date: '2026-01-09', time: '3:00 PM', home: 'Getafe', away: 'Real Sociedad', channel: 'ESPN+' },
            { date: '2026-01-10', time: '8:00 AM', home: 'Real Oviedo', away: 'Real Betis', channel: 'ESPN+' },
            { date: '2026-01-10', time: '10:15 AM', home: 'Villarreal', away: 'Alavés', channel: 'ESPN+' },
            { date: '2026-01-10', time: '12:30 PM', home: 'Girona', away: 'Osasuna', channel: 'ESPN+' },
            { date: '2026-01-10', time: '3:00 PM', home: 'Valencia', away: 'Elche', channel: 'ESPN+' },
            { date: '2026-01-11', time: '8:00 AM', home: 'Rayo Vallecano', away: 'Mallorca', channel: 'ESPN+' },
            { date: '2026-01-11', time: '10:15 AM', home: 'Levante', away: 'Espanyol', channel: 'ESPN+' },
            { date: '2026-01-12', time: '3:00 PM', home: 'Sevilla', away: 'Celta Vigo', channel: 'ESPN+' },
            { date: '2026-01-16', time: '3:00 PM', home: 'Espanyol', away: 'Girona', channel: 'ESPN+' },
            { date: '2026-01-17', time: '8:00 AM', home: 'Real Madrid', away: 'Levante', channel: 'ESPN+' },
            { date: '2026-01-17', time: '10:15 AM', home: 'Mallorca', away: 'Athletic Club', channel: 'ESPN+' },
            { date: '2026-01-17', time: '12:30 PM', home: 'Osasuna', away: 'Real Oviedo', channel: 'ESPN+' },
            { date: '2026-01-17', time: '3:00 PM', home: 'Real Betis', away: 'Villarreal', channel: 'ESPN+' },
            { date: '2026-01-18', time: '8:00 AM', home: 'Getafe', away: 'Valencia', channel: 'ESPN+' },
            { date: '2026-01-18', time: '10:15 AM', home: 'Atlético Madrid', away: 'Alavés', channel: 'ESPN+' },
            { date: '2026-01-18', time: '12:30 PM', home: 'Celta Vigo', away: 'Rayo Vallecano', channel: 'ESPN+' },
            { date: '2026-01-18', time: '3:00 PM', home: 'Real Sociedad', away: 'Barcelona', channel: 'ESPN+' },
            { date: '2026-01-19', time: '3:00 PM', home: 'Elche', away: 'Sevilla', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Alavés', away: 'Real Betis', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Atlético Madrid', away: 'Mallorca', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Barcelona', away: 'Real Oviedo', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Girona', away: 'Getafe', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Levante', away: 'Elche', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Rayo Vallecano', away: 'Osasuna', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Real Sociedad', away: 'Celta Vigo', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Sevilla', away: 'Athletic Club', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Valencia', away: 'Espanyol', channel: 'ESPN+' },
            { date: '2026-01-25', time: 'TBD', home: 'Villarreal', away: 'Real Madrid', channel: 'ESPN+' }
        ],
        'NFL': [
            { date: '2025-12-27', time: '4:30 PM', away: 'Houston Texans', home: 'Los Angeles Chargers', channel: 'NFL Net' },
            { date: '2025-12-27', time: '8:00 PM', away: 'Baltimore Ravens', home: 'Green Bay Packers', channel: 'Peacock' },
            { date: '2025-12-28', time: '1:00 PM', away: 'Pittsburgh Steelers', home: 'Cleveland Browns', channel: 'CBS' },
            { date: '2025-12-28', time: '1:00 PM', away: 'New England Patriots', home: 'New York Jets', channel: 'FOX' },
            { date: '2025-12-28', time: '1:00 PM', away: 'New Orleans Saints', home: 'Tennessee Titans', channel: 'CBS' },
            { date: '2025-12-28', time: '1:00 PM', away: 'Jacksonville Jaguars', home: 'Indianapolis Colts', channel: 'FOX' },
            { date: '2025-12-28', time: '1:00 PM', away: 'Tampa Bay Buccaneers', home: 'Miami Dolphins', channel: 'FOX' },
            { date: '2025-12-28', time: '1:00 PM', away: 'Seattle Seahawks', home: 'Carolina Panthers', channel: 'CBS' },
            { date: '2025-12-28', time: '1:00 PM', away: 'Arizona Cardinals', home: 'Cincinnati Bengals', channel: 'FOX' },
            { date: '2025-12-28', time: '4:05 PM', away: 'New York Giants', home: 'Las Vegas Raiders', channel: 'CBS' },
            { date: '2025-12-28', time: '4:25 PM', away: 'Philadelphia Eagles', home: 'Buffalo Bills', channel: 'FOX' },
            { date: '2025-12-28', time: '8:20 PM', away: 'Chicago Bears', home: 'San Francisco 49ers', channel: 'NBC' },
            { date: '2025-12-29', time: '8:15 PM', away: 'Los Angeles Rams', home: 'Atlanta Falcons', channel: 'ESPN' },
            { date: '2026-01-04', time: 'TBD', away: 'New Orleans Saints', home: 'Atlanta Falcons', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'New York Jets', home: 'Buffalo Bills', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Detroit Lions', home: 'Chicago Bears', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Cleveland Browns', home: 'Cincinnati Bengals', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Los Angeles Chargers', home: 'Denver Broncos', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Kansas City Chiefs', home: 'Las Vegas Raiders', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Arizona Cardinals', home: 'Los Angeles Rams', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Green Bay Packers', home: 'Minnesota Vikings', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Miami Dolphins', home: 'New England Patriots', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Dallas Cowboys', home: 'New York Giants', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Washington Commanders', home: 'Philadelphia Eagles', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Baltimore Ravens', home: 'Pittsburgh Steelers', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Seattle Seahawks', home: 'San Francisco 49ers', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Carolina Panthers', home: 'Tampa Bay Buccaneers', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Tennessee Titans', home: 'Jacksonville Jaguars', channel: '' },
            { date: '2026-01-04', time: 'TBD', away: 'Indianapolis Colts', home: 'Houston Texans', channel: '' }
        ],
        'NCAAW': [
            { date: '2025-12-28', time: '12:00 PM', away: 'Providence', home: 'South Carolina', channel: 'SEC Network' },
            { date: '2025-12-28', time: '12:00 PM', away: 'Wofford', home: 'Georgia Tech', channel: 'ACC Network' },
            { date: '2025-12-28', time: '12:00 PM', away: 'Illinois', home: 'Purdue', channel: 'BTN' },
            { date: '2025-12-28', time: '1:00 PM', away: 'New Haven', home: 'New Hampshire', channel: 'ESPN+' },
            { date: '2025-12-28', time: '1:00 PM', away: 'Xavier', home: 'Seton Hall', channel: 'ESPN+' },
            { date: '2025-12-28', time: '1:00 PM', away: 'Dallas', home: 'Sam Houston', channel: 'ESPN+' },
            { date: '2025-12-28', time: '1:00 PM', away: 'Wilberforce', home: 'Ohio', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'SE Louisiana', home: 'Texas', channel: 'SEC Network' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Furman', home: 'Florida', channel: 'SECN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Hofstra', home: 'Kentucky', channel: 'SECN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Stetson', home: 'Miami', channel: 'ACC Network' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Coppin State', home: 'George Washington', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Arcadia University', home: 'Saint Joseph\'s', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Dartmouth', home: 'Vermont', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Brewton-Parker', home: 'West Georgia', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Rutgers', home: 'Michigan State', channel: 'B1G+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'UCLA', home: 'Ohio State', channel: 'BTN' },
            { date: '2025-12-28', time: '2:00 PM', away: 'LaGrange', home: 'Georgia State', channel: 'ESPN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Stonehill', home: 'Vanderbilt', channel: 'SECN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Kansas City', home: 'Missouri', channel: 'SECN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Samford', home: 'Mississippi State', channel: 'SECN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Rust College', home: 'Memphis', channel: 'ESPN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Arkansas State', home: 'Arkansas', channel: 'SECN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Alcorn State', home: 'Ole Miss', channel: 'SECN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Pepperdine', home: 'Washington State', channel: 'ESPN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Berry', home: 'Austin Peay', channel: 'ESPN+' },
            { date: '2025-12-28', time: '4:00 PM', away: 'Alabama State', home: 'LSU', channel: 'SEC Network' },
            { date: '2025-12-28', time: '4:00 PM', away: 'Cornell', home: 'Stanford', channel: 'ACC Extra' },
            { date: '2025-12-28', time: '4:00 PM', away: 'Duke', home: 'Syracuse', channel: 'ACC Network' },
            { date: '2025-12-28', time: '4:00 PM', away: 'Penn State', home: 'Iowa', channel: 'BTN' },
            { date: '2025-12-28', time: '4:00 PM', away: 'UConn', home: 'Butler', channel: 'TNT' },
            { date: '2025-12-28', time: '4:00 PM', away: 'Seattle U', home: 'Pacific', channel: 'ESPN+' },
            { date: '2025-12-28', time: '4:00 PM', away: 'San Diego', home: 'Santa Clara', channel: 'ESPN+' },
            { date: '2025-12-28', time: '4:30 PM', away: 'Kentucky Christian', home: 'Morehead State', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Cal Poly', home: 'California', channel: 'ACC Extra' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Creighton', home: 'Georgetown', channel: 'truTV' },
            { date: '2025-12-28', time: '5:00 PM', away: 'La Sierra', home: 'Cal State Fullerton', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Loyola Marymount', home: 'Gonzaga', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Portland', home: 'Saint Mary\'s', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Oregon State', home: 'San Francisco', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Grand Canyon', home: 'San José State', channel: 'MWN' },
            { date: '2025-12-29', time: '12:00 PM', away: 'Charleston Southern', home: 'Georgia', channel: 'SECN+' },
            { date: '2025-12-29', time: '12:00 PM', away: 'Wheaton College (MA)', home: 'Brown', channel: 'ESPN+' },
            { date: '2025-12-29', time: '12:00 PM', away: 'Howard', home: 'Army', channel: 'ESPN+' },
            { date: '2025-12-29', time: '1:00 PM', away: 'Delaware', home: 'Harvard', channel: 'ESPN+' },
            { date: '2025-12-29', time: '1:00 PM', away: 'Rochester University (MI)', home: 'Detroit Mercy', channel: 'ESPN+' },
            { date: '2025-12-29', time: '1:00 PM', away: 'Hampton', home: 'Eastern Kentucky', channel: 'ESPN+' },
            { date: '2025-12-29', time: '1:00 PM', away: 'Drake', home: 'UIC', channel: 'ESPN+' },
            { date: '2025-12-29', time: '2:00 PM', away: 'Sacred Heart', home: 'Marist', channel: 'ESPN+' },
            { date: '2025-12-29', time: '2:00 PM', away: 'Mount St. Mary\'s', home: 'Merrimack', channel: 'ESPN+' },
            { date: '2025-12-29', time: '2:00 PM', away: 'Columbia', home: 'Florida Gulf Coast', channel: 'ESPN+' },
            { date: '2025-12-29', time: '2:00 PM', away: 'NJIT', home: 'Delaware State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '2:00 PM', away: 'Jackson State', home: 'Auburn', channel: 'SECN+' },
            { date: '2025-12-29', time: '2:00 PM', away: 'Nelson', home: 'Abilene Christian', channel: 'ESPN+' },
            { date: '2025-12-29', time: '2:00 PM', away: 'Northern Iowa', home: 'Valparaiso', channel: 'ESPN+' },
            { date: '2025-12-29', time: '3:00 PM', away: 'Quinnipiac', home: 'Saint Peter\'s', channel: 'ESPN+' },
            { date: '2025-12-29', time: '3:00 PM', away: 'USC', home: 'Nebraska', channel: 'B1G+' },
            { date: '2025-12-29', time: '3:00 PM', away: 'Northern Illinois', home: 'St. Thomas-Minnesota', channel: 'Midco Sports Plus' },
            { date: '2025-12-29', time: '4:00 PM', away: 'Oakland', home: 'Robert Morris', channel: 'ESPN+' },
            { date: '2025-12-29', time: '4:00 PM', away: 'Youngstown State', home: 'Cleveland State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '4:00 PM', away: 'Wisconsin', home: 'Maryland', channel: 'B1G+' },
            { date: '2025-12-29', time: '4:00 PM', away: 'Rider', home: 'Iona', channel: 'ESPN+' },
            { date: '2025-12-29', time: '4:00 PM', away: 'Ottawa (KS)', home: 'Lindenwood', channel: 'ESPN+' },
            { date: '2025-12-29', time: '5:00 PM', away: 'Stephen F. Austin', home: 'East Texas A&M', channel: 'ESPN+' },
            { date: '2025-12-29', time: '5:00 PM', away: 'New Orleans', home: 'UT Rio Grande Valley', channel: 'ESPN+' },
            { date: '2025-12-29', time: '6:00 PM', away: 'Nicholls', home: 'Texas A&M-Corpus Christi', channel: 'ESPN+' },
            { date: '2025-12-29', time: '6:00 PM', away: 'Pittsburgh', home: 'Notre Dame', channel: 'ACC Network' },
            { date: '2025-12-29', time: '6:00 PM', away: 'Brevard', home: 'UNC Asheville', channel: 'ESPN+' },
            { date: '2025-12-29', time: '6:00 PM', away: 'Minnesota', home: 'Indiana', channel: 'B1G+' },
            { date: '2025-12-29', time: '6:00 PM', away: 'Columbia College (SC)', home: 'Coastal Carolina', channel: 'ESPN+' },
            { date: '2025-12-29', time: '6:00 PM', away: 'St. Joseph\'S Brookyn', home: 'UMass Lowell', channel: 'ESPN+' },
            { date: '2025-12-29', time: '6:30 PM', away: 'Milwaukee', home: 'IU Indianapolis', channel: 'ESPN+' },
            { date: '2025-12-29', time: '6:30 PM', away: 'Carolina University', home: 'App State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'McNeese', home: 'Incarnate Word', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Fairfield', home: 'Manhattan', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Northern Kentucky', home: 'Purdue Fort Wayne', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Life University', home: 'Kennesaw State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'SMU', home: 'Virginia', channel: 'ACC Extra' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Villanova', home: 'DePaul', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Dillard', home: 'Louisiana', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Saint Mary\'S (Mn)', home: 'North Dakota State', channel: 'Midco Sports Plus' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Columbia International', home: 'UNC Wilmington', channel: 'FloSports' },
            { date: '2025-12-29', time: '7:00 PM', away: 'E. New Mexico', home: 'New Mexico State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Murray State', home: 'Evansville', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Belmont', home: 'Southern Illinois', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:30 PM', away: 'St. John\'s', home: 'Marquette', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:30 PM', away: 'Indiana State', home: 'Illinois State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'UT Arlington', home: 'Tarleton State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'North Carolina', home: 'Boston College', channel: 'ACC Network' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Huston-Tillotson', home: 'Texas State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:30 PM', away: 'Utah Tech', home: 'Southern Utah', channel: 'ESPN+' },
            { date: '2025-12-29', time: '9:00 PM', away: 'Utah Valley', home: 'California Baptist', channel: 'ESPN+' },
            { date: '2025-12-29', time: '9:00 PM', away: 'Bushnell', home: 'Eastern Washington', channel: 'ESPN+' },
            { date: '2025-12-29', time: '9:00 PM', away: 'Hope International', home: 'Long Beach State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '9:00 PM', away: 'Michigan', home: 'Oregon', channel: 'FS1' },
            { date: '2025-12-29', time: '9:00 PM', away: 'University of The Southwest', home: 'UTEP', channel: 'ESPN+' },
            { date: '2025-12-30', time: '12:00 PM', away: 'William Woods', home: 'Southeast Missouri State', channel: 'ESPN+' },
            { date: '2025-12-30', time: '1:00 PM', away: 'Florida National', home: 'Florida International', channel: 'ESPN+' },
            { date: '2025-12-30', time: '1:00 PM', away: 'St. Joseph\'S Brookyn', home: 'Dartmouth', channel: 'ESPN+' },
            { date: '2025-12-30', time: '2:00 PM', away: 'Montreat', home: 'Western Carolina', channel: 'ESPN+' },
            { date: '2025-12-30', time: '2:00 PM', away: 'Tulane', home: 'UTSA', channel: 'ESPN+' },
            { date: '2025-12-30', time: '3:00 PM', away: 'College Of St Mary', home: 'South Dakota', channel: 'Summit League Network' },
            { date: '2025-12-30', time: '3:00 PM', away: 'Morgan State', home: 'Towson', channel: 'FloSports' },
            { date: '2025-12-30', time: '4:00 PM', away: 'Bowling Green', home: 'Eastern Michigan', channel: 'ESPN+' },
            { date: '2025-12-30', time: '4:00 PM', away: 'Newberry', home: 'North Carolina A&T', channel: 'FloSports' },
            { date: '2025-12-30', time: '4:00 PM', away: 'UC Merced', home: 'UC Riverside', channel: 'ESPN+' },
            { date: '2025-12-30', time: '4:00 PM', away: 'San Diego', home: 'Pacific', channel: 'ESPN+' },
            { date: '2025-12-30', time: '6:00 PM', away: 'Southern Wesleyan', home: 'Chattanooga', channel: 'ESPN+' },
            { date: '2025-12-30', time: '6:00 PM', away: 'SUNY Geneseo', home: 'Le Moyne', channel: 'NEC Front Row' },
            { date: '2025-12-30', time: '6:00 PM', away: 'UAB', home: 'East Carolina', channel: 'ESPN+' },
            { date: '2025-12-30', time: '6:00 PM', away: 'Richmond', home: 'Rhode Island', channel: 'ESPN+' },
            { date: '2025-12-30', time: '6:30 PM', away: 'Tennessee State', home: 'Tennessee Tech', channel: 'ESPN+' },
            { date: '2025-12-30', time: '6:30 PM', away: 'Bethune-Cookman', home: 'Jacksonville', channel: 'ESPN+' },
            { date: '2025-12-30', time: '6:30 PM', away: 'Notre Dame Of Maryland University', home: 'UMBC', channel: 'ESPN+' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Green Bay', home: 'Wright State', channel: 'ESPN+' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Brevard', home: 'Furman', channel: 'ESPN+' },
            { date: '2025-12-30', time: '7:00 PM', away: 'North Texas', home: 'Florida Atlantic', channel: 'ESPN+' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Rice', home: 'South Florida', channel: 'ESPN+' },
            { date: '2025-12-30', time: '7:00 PM', away: 'NC Wesleyan', home: 'Elon', channel: 'FloSports' },
            { date: '2025-12-30', time: '7:30 PM', away: 'Wichita State', home: 'Tulsa', channel: 'ESPN+' },
            { date: '2025-12-30', time: '8:00 PM', away: 'Oregon State', home: 'Saint Mary\'s', channel: 'ESPN+' },
            { date: '2025-12-30', time: '9:00 PM', away: 'Pepperdine', home: 'Gonzaga', channel: 'ESPN+' },
            { date: '2025-12-30', time: '9:00 PM', away: 'Loyola Marymount', home: 'Washington State', channel: 'ESPN+' },
            { date: '2025-12-30', time: '9:00 PM', away: 'Portland', home: 'San Francisco', channel: 'ESPN+' },
            { date: '2025-12-30', time: '9:00 PM', away: 'Seattle U', home: 'Santa Clara', channel: 'ESPN+' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Ball State', home: 'Akron', channel: 'ESPN+' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Miami (OH)', home: 'Kent State', channel: 'ESPN+' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Radford', home: 'Presbyterian', channel: 'ESPN+' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Ohio State', home: 'Purdue', channel: 'BTN' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Dayton', home: 'George Mason', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Ohio', home: 'Central Michigan', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Western Michigan', home: 'Massachusetts', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'American University', home: 'Loyola Maryland', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Holy Cross', home: 'Bucknell', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Georgetown', home: 'Seton Hall', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Lehigh', home: 'Army', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'George Washington', home: 'St. Bonaventure', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'La Salle', home: 'Fordham', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Saint Louis', home: 'Duquesne', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Salem University', home: 'Youngstown State', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Colorado State', home: 'Grand Canyon', channel: 'MWN' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Northern Iowa', home: 'UIC', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'New Orleans', home: 'Texas A&M-Corpus Christi', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'SE Louisiana', home: 'Incarnate Word', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Stephen F. Austin', home: 'Northwestern State', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Buffalo', home: 'Toledo', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'UNC Asheville', home: 'High Point', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Navy', home: 'Boston University', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Gardner-Webb', home: 'Winthrop', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'UCLA', home: 'Penn State', channel: 'Peacock' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Iowa State', home: 'Houston', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Cincinnati', home: 'Kansas State', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'VCU', home: 'Saint Joseph\'s', channel: 'ESPN+' },
            { date: '2025-12-31', time: '3:00 PM', away: 'McNeese', home: 'Houston Christian', channel: 'ESPN+' },
            { date: '2025-12-31', time: '3:00 PM', away: 'Nicholls', home: 'UT Rio Grande Valley', channel: 'ESPN+' },
            { date: '2025-12-31', time: '3:00 PM', away: 'South Carolina Upstate', home: 'Charleston Southern', channel: 'ESPN+' },
            { date: '2025-12-31', time: '3:00 PM', away: 'UConn', home: 'Providence', channel: 'Peacock' },
            { date: '2025-12-31', time: '3:00 PM', away: 'Baylor', home: 'Oklahoma State', channel: 'ESPN+' },
            { date: '2025-12-31', time: '3:00 PM', away: 'Memphis', home: 'Charlotte', channel: 'ESPN+' },
            { date: '2025-12-31', time: '3:00 PM', away: 'Davidson', home: 'Loyola Chicago', channel: 'ESPN+' },
            { date: '2025-12-31', time: '3:00 PM', away: 'San José State', home: 'Utah State', channel: 'MWN' },
            { date: '2025-12-31', time: '3:30 PM', away: 'Lamar', home: 'East Texas A&M', channel: 'ESPN+' },
            { date: '2025-12-31', time: '4:00 PM', away: 'Arizona State', home: 'Utah', channel: 'ESPN+' },
            { date: '2025-12-31', time: '4:00 PM', away: 'Air Force', home: 'San Diego State', channel: 'MWN' },
            { date: '2025-12-31', time: '4:00 PM', away: 'Nevada', home: 'Boise State', channel: 'MWN' },
            { date: '2025-12-31', time: '6:00 PM', away: 'Omaha', home: 'Kansas City', channel: 'Midco Sports Plus' },
            { date: '2025-12-31', time: '6:00 PM', away: 'Lafayette', home: 'Colgate', channel: 'ESPN+' },
            { date: '2025-12-31', time: '7:00 PM', away: 'UCF', home: 'Texas Tech', channel: 'ESPN+' },
            { date: '2025-12-31', time: '9:00 PM', away: 'TCU', home: 'BYU', channel: 'ESPN+' },
            { date: '2025-12-31', time: '9:00 PM', away: 'Arizona', home: 'Colorado', channel: 'ESPN+' }
        ],
        'NCAAM': [
            { date: '2025-12-28', time: '12:00 PM', away: 'Arcadia', home: 'Saint Joseph\'s', channel: 'ESPN+' },
            { date: '2025-12-28', time: '1:00 PM', away: 'Worcester State', home: 'Bryant', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Liberty', home: 'Florida International', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Mount Marty College', home: 'South Dakota', channel: 'Midco Sports Plus' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Harvard', home: 'Colgate', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Le Moyne', home: 'Boston College', channel: 'ACC Extra' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Columbia', home: 'North Florida', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'UL Monroe', home: 'Kansas State', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Winthrop', home: 'Texas Tech', channel: 'TNT' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Fort Lauderdale', home: 'Florida Gulf Coast', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Pfeiffer', home: 'High Point', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Union (KY)', home: 'Wofford', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Dakota State', home: 'North Dakota', channel: 'Summit League Network' },
            { date: '2025-12-28', time: '2:00 PM', away: 'North Central (MN)', home: 'St. Thomas-Minnesota', channel: 'Midco Sports Plus' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Alice Lloyd College', home: 'Morehead State', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:00 PM', away: 'Baptist (Fl)', home: 'Mercer', channel: 'ESPN+' },
            { date: '2025-12-28', time: '2:30 PM', away: 'Shenandoah', home: 'Radford', channel: 'ESPN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Principia College', home: 'Saint Louis', channel: 'ESPN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Cal State Fullerton', home: 'SMU', channel: 'ACC Extra' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Northern Colorado', home: 'Colorado', channel: 'ESPN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Averett', home: 'Longwood', channel: 'ESPN+' },
            { date: '2025-12-28', time: '3:00 PM', away: 'Norfolk State', home: 'Louisiana', channel: 'ESPN+' },
            { date: '2025-12-28', time: '4:00 PM', away: 'Charleston Southern', home: 'Richmond', channel: 'ESPN+' },
            { date: '2025-12-28', time: '4:00 PM', away: 'Truett-McConnell', home: 'Presbyterian', channel: 'ESPN+' },
            { date: '2025-12-28', time: '4:00 PM', away: 'University of The Southwest', home: 'New Mexico State', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Pennsylvania', home: 'George Mason', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Pacific Union', home: 'UC Davis', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Washington State', home: 'Portland', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:00 PM', away: 'Columbia College (SC)', home: 'Georgia State', channel: 'ESPN+' },
            { date: '2025-12-28', time: '5:30 PM', away: 'Fisk', home: 'Austin Peay', channel: 'ESPN+' },
            { date: '2025-12-28', time: '6:00 PM', away: 'Old Dominion', home: 'Maryland', channel: 'BTN' },
            { date: '2025-12-28', time: '6:00 PM', away: 'Pacific', home: 'San Diego', channel: 'ESPN+' },
            { date: '2025-12-28', time: '6:00 PM', away: 'Santa Clara', home: 'Oregon State', channel: 'ESPN+' },
            { date: '2025-12-28', time: '6:00 PM', away: 'McPherson', home: 'Kansas City', channel: 'Midco Sports Plus' },
            { date: '2025-12-28', time: '7:00 PM', away: 'Florida A&M', home: 'Georgia Tech', channel: 'ACC Extra' },
            { date: '2025-12-28', time: '7:00 PM', away: 'Stanton', home: 'UC San Diego', channel: 'ESPN+' },
            { date: '2025-12-28', time: '7:00 PM', away: 'Saint Mary\'s', home: 'Loyola Marymount', channel: 'ESPN+' },
            { date: '2025-12-28', time: '8:00 PM', away: 'Omaha', home: 'Oregon', channel: 'BTN' },
            { date: '2025-12-28', time: '8:00 PM', away: 'Gonzaga', home: 'Pepperdine', channel: 'ESPN+' },
            { date: '2025-12-28', time: '8:00 PM', away: 'San Francisco', home: 'Seattle U', channel: 'ESPN+' },
            { date: '2025-12-29', time: '1:00 PM', away: 'North Carolina Central', home: 'Penn State', channel: 'BTN' },
            { date: '2025-12-29', time: '2:00 PM', away: 'Missouri State', home: 'Delaware', channel: 'ESPN+' },
            { date: '2025-12-29', time: '2:00 PM', away: 'Merrimack', home: 'Sacred Heart', channel: 'ESPN+' },
            { date: '2025-12-29', time: '3:00 PM', away: 'Southern', home: 'Illinois', channel: 'BTN' },
            { date: '2025-12-29', time: '4:00 PM', away: 'Marist', home: 'Quinnipiac', channel: 'ESPN+' },
            { date: '2025-12-29', time: '4:00 PM', away: 'Arlington Baptist', home: 'Baylor', channel: 'ESPN+' },
            { date: '2025-12-29', time: '4:00 PM', away: 'Elmira', home: 'Binghamton', channel: 'ESPN+' },
            { date: '2025-12-29', time: '4:00 PM', away: 'Illinois Tech', home: 'UIC', channel: 'ESPN+' },
            { date: '2025-12-29', time: '4:00 PM', away: 'SUNY-Canton', home: 'NJIT', channel: 'ESPN+' },
            { date: '2025-12-29', time: '4:30 PM', away: 'Georgia College', home: 'South Florida', channel: 'ESPN+' },
            { date: '2025-12-29', time: '5:00 PM', away: 'Towson', home: 'William & Mary', channel: 'FloSports' },
            { date: '2025-12-29', time: '5:00 PM', away: 'UMass Lowell', home: 'Iowa', channel: 'BTN' },
            { date: '2025-12-29', time: '6:00 PM', away: 'UMBC', home: 'Coppin State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '6:00 PM', away: 'Dartmouth', home: 'Florida', channel: 'SEC Network' },
            { date: '2025-12-29', time: '6:30 PM', away: 'Detroit Mercy', home: 'Youngstown State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Western Kentucky', home: 'Jacksonville State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Northeastern', home: 'Elon', channel: 'FloSports' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Stony Brook', home: 'Hampton', channel: 'FloSports' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Campbell', home: 'Hofstra', channel: 'FloSports' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Drexel', home: 'Charleston', channel: 'FloSports' },
            { date: '2025-12-29', time: '7:00 PM', away: 'UNC Wilmington', home: 'North Carolina A&T', channel: 'CBSSN' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Long Island University', home: 'Georgia', channel: 'SECN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Manhattan', home: 'Rider', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Iona', home: 'Mount St. Mary\'s', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'IU Indianapolis', home: 'Cleveland State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Northern Kentucky', home: 'Robert Morris', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Oakland', home: 'Wright State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Lipscomb', home: 'Cincinnati', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Earlham College', home: 'Ball State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Kent State', home: 'Purdue', channel: 'B1G+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Saint Peter\'s', home: 'Fairfield', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'McNeese', home: 'Michigan', channel: 'B1G+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Cornell', home: 'Michigan State', channel: 'FS1' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Delaware State', home: 'Rutgers', channel: 'BTN' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Belmont', home: 'Indiana State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:00 PM', away: 'Southern Illinois', home: 'Murray State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:30 PM', away: 'UTEP', home: 'Louisiana Tech', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:30 PM', away: 'Stephen F. Austin', home: 'East Texas A&M', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:30 PM', away: 'New Orleans', home: 'UT Rio Grande Valley', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:30 PM', away: 'Lamar', home: 'Northwestern State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '7:30 PM', away: 'Alabama State', home: 'Mississippi State', channel: 'SECN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Tarleton State', home: 'UT Arlington', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'California Baptist', home: 'Utah Valley', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Jackson State', home: 'TCU', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Yale', home: 'Alabama', channel: 'SECN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Bethune-Cookman', home: 'Oklahoma State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Purdue Fort Wayne', home: 'Milwaukee', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Houston Christian', home: 'Iowa State', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Middle Tennessee', home: 'Houston', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Benedictine (AZ)', home: 'Northern Arizona', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Mississippi Valley State', home: 'Oklahoma', channel: 'SECN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'James Madison', home: 'Arkansas', channel: 'SECN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Prairie View A&M', home: 'Texas A&M', channel: 'SECN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Southern Miss', home: 'LSU', channel: 'SECN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Alcorn State', home: 'Ole Miss', channel: 'SEC Network' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Evansville', home: 'Bradley', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Valparaiso', home: 'Northern Iowa', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:00 PM', away: 'Mobile', home: 'South Alabama', channel: 'ESPN+' },
            { date: '2025-12-29', time: '8:30 PM', away: 'Nicholls', home: 'Texas A&M-Corpus Christi', channel: 'ESPN+' },
            { date: '2025-12-29', time: '9:00 PM', away: 'Southern Utah', home: 'Utah Tech', channel: 'ESPN+' },
            { date: '2025-12-29', time: '9:00 PM', away: 'Fairleigh Dickinson', home: 'Minnesota', channel: 'BTN' },
            { date: '2025-12-29', time: '9:00 PM', away: 'South Dakota State', home: 'Arizona', channel: 'ESPN+' },
            { date: '2025-12-29', time: '9:00 PM', away: 'Illinois State', home: 'Drake', channel: 'ESPN+' },
            { date: '2025-12-29', time: '10:00 PM', away: 'La Sierra', home: 'UNLV', channel: 'MWN' },
            { date: '2025-12-29', time: '10:00 PM', away: 'Queens University', home: 'Auburn', channel: 'SEC Network' },
            { date: '2025-12-29', time: '11:00 PM', away: 'Utah', home: 'Washington', channel: 'FS1' },
            { date: '2025-12-30', time: '1:00 PM', away: 'Wofford', home: 'Western Carolina', channel: 'ESPN+' },
            { date: '2025-12-30', time: '1:00 PM', away: 'Vermont', home: 'Princeton', channel: 'ESPN+' },
            { date: '2025-12-30', time: '2:00 PM', away: 'Maine-Fort Kent', home: 'Maine', channel: 'ESPN+' },
            { date: '2025-12-30', time: '3:00 PM', away: 'Ohio', home: 'Central Michigan', channel: 'ESPN+' },
            { date: '2025-12-30', time: '4:00 PM', away: 'Howard', home: 'Northwestern', channel: 'BTN' },
            { date: '2025-12-30', time: '6:00 PM', away: 'East Tennessee State', home: 'The Citadel', channel: 'ESPN+' },
            { date: '2025-12-30', time: '6:00 PM', away: 'SE Louisiana', home: 'Incarnate Word', channel: 'ESPN+' },
            { date: '2025-12-30', time: '6:00 PM', away: 'UAlbany', home: 'South Carolina', channel: 'SEC Network' },
            { date: '2025-12-30', time: '6:30 PM', away: 'Western Michigan', home: 'Toledo', channel: 'ESPN+' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Miami (OH)', home: 'Bowling Green', channel: 'ESPN+' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Pittsburgh', home: 'Miami', channel: 'ACC Network' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Florida State', home: 'North Carolina', channel: 'ESPN2' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Milwaukee', home: 'Wisconsin', channel: 'BTN' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Seton Hall', home: 'Marquette', channel: 'FS1' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Temple', home: 'Charlotte', channel: 'ESPN+' },
            { date: '2025-12-30', time: '7:00 PM', away: 'Duquesne', home: 'Davidson', channel: 'ESPN+' },
            { date: '2025-12-30', time: '7:30 PM', away: 'Massachusetts', home: 'Eastern Michigan', channel: 'ESPN+' },
            { date: '2025-12-30', time: '8:00 PM', away: 'Buffalo', home: 'Northern Illinois', channel: 'ESPN+' },
            { date: '2025-12-30', time: '8:00 PM', away: 'South Carolina State', home: 'Tennessee', channel: 'SEC Network' },
            { date: '2025-12-30', time: '8:00 PM', away: 'Arkansas Tech', home: 'Arkansas State', channel: 'ESPN+' },
            { date: '2025-12-30', time: '8:30 PM', away: 'Tennessee State', home: 'Tennessee Tech', channel: 'ESPN+' },
            { date: '2025-12-30', time: '9:00 PM', away: 'Louisville', home: 'California', channel: 'ACC Network' },
            { date: '2025-12-30', time: '9:00 PM', away: 'Notre Dame', home: 'Stanford', channel: 'ESPN2' },
            { date: '2025-12-30', time: '9:00 PM', away: 'Butler', home: 'Creighton', channel: 'FS1' },
            { date: '2025-12-30', time: '9:00 PM', away: 'New Hampshire', home: 'Nebraska', channel: 'BTN' },
            { date: '2025-12-30', time: '9:00 PM', away: 'Utah State', home: 'Fresno State', channel: 'MWN' },
            { date: '2025-12-30', time: '9:00 PM', away: 'Saint Mary\'s', home: 'Pepperdine', channel: 'ESPN+' },
            { date: '2025-12-30', time: '9:30 PM', away: 'Gonzaga', home: 'San Diego', channel: 'ESPN+' },
            { date: '2025-12-30', time: '10:00 PM', away: 'Lincoln University (CA)', home: 'Long Beach State', channel: 'ESPN+' },
            { date: '2025-12-30', time: '10:00 PM', away: 'San Diego State', home: 'San José State', channel: 'CBSSN' },
            { date: '2025-12-30', time: '10:00 PM', away: 'Pacific', home: 'Loyola Marymount', channel: 'ESPN+' },
            { date: '2025-12-30', time: '10:00 PM', away: 'San Francisco', home: 'Oregon State', channel: 'ESPN+' },
            { date: '2025-12-30', time: '10:00 PM', away: 'Santa Clara', home: 'Portland', channel: 'ESPN+' },
            { date: '2025-12-30', time: '10:00 PM', away: 'Washington State', home: 'Seattle U', channel: 'ESPN+' },
            { date: '2025-12-30', time: '11:00 PM', away: 'New Mexico', home: 'Boise State', channel: 'FS1' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Lamar', home: 'East Texas A&M', channel: 'ESPN+' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Mercer', home: 'Furman', channel: 'ESPN+' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Johnson & Wales (RI)', home: 'Brown', channel: 'ESPN+' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Wake Forest', home: 'NC State', channel: 'ESPN2' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Army', home: 'Lehigh', channel: 'ESPN+' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Tulane', home: 'East Carolina', channel: 'ESPNU' },
            { date: '2025-12-31', time: '12:00 PM', away: 'Loyola Chicago', home: 'Rhode Island', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'South Alabama', home: 'Louisiana', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Boston University', home: 'Navy', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'Loyola Maryland', home: 'American University', channel: 'ESPN+' },
            { date: '2025-12-31', time: '1:00 PM', away: 'UTSA', home: 'Florida Atlantic', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'App State', home: 'Old Dominion', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Texas State', home: 'Troy', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Stony Brook', home: 'William & Mary', channel: 'CBSSN' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Campbell', home: 'Monmouth', channel: 'FloSports' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Charleston', home: 'Elon', channel: 'FloSports' },
            { date: '2025-12-31', time: '2:00 PM', away: 'NJIT', home: 'Pennsylvania', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Penn St Abington', home: 'Columbia', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Clemson', home: 'Syracuse', channel: 'ESPN2' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Virginia', home: 'Virginia Tech', channel: 'ACC Network' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Charleston Southern', home: 'Gardner-Webb', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'High Point', home: 'UNC Asheville', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Radford', home: 'South Carolina Upstate', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Bucknell', home: 'Holy Cross', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Rice', home: 'Tulsa', channel: 'ESPNU' },
            { date: '2025-12-31', time: '2:00 PM', away: 'Fordham', home: 'Dayton', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'George Mason', home: 'La Salle', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:00 PM', away: 'St. Bonaventure', home: 'VCU', channel: 'ESPN+' },
            { date: '2025-12-31', time: '2:30 PM', away: 'Towson', home: 'Hampton', channel: 'FloSports' },
            { date: '2025-12-31', time: '3:00 PM', away: 'Northeastern', home: 'North Carolina A&T', channel: 'FloSports' },
            { date: '2025-12-31', time: '3:00 PM', away: 'Winthrop', home: 'Longwood', channel: 'ESPN+' },
            { date: '2025-12-31', time: '3:00 PM', away: 'Colgate', home: 'Lafayette', channel: 'ESPN+' },
            { date: '2025-12-31', time: '4:00 PM', away: 'Georgia State', home: 'Marshall', channel: 'ESPN+' },
            { date: '2025-12-31', time: '4:00 PM', away: 'Kansas City', home: 'Denver', channel: 'Midco Sports Plus' },
            { date: '2025-12-31', time: '4:00 PM', away: 'Georgia Tech', home: 'Duke', channel: 'ACC Network' },
            { date: '2025-12-31', time: '4:00 PM', away: 'Wichita State', home: 'UAB', channel: 'ESPNU' },
            { date: '2025-12-31', time: '4:00 PM', away: 'North Texas', home: 'Memphis', channel: 'ESPN2' },
            { date: '2025-12-31', time: '4:00 PM', away: 'George Washington', home: 'Richmond', channel: 'ESPN+' },
            { date: '2025-12-31', time: '4:00 PM', away: 'Saint Joseph\'s', home: 'Saint Louis', channel: 'ESPN+' },
            { date: '2025-12-31', time: '4:30 PM', away: 'New Orleans', home: 'Texas A&M-Corpus Christi', channel: 'ESPN+' },
            { date: '2025-12-31', time: '4:30 PM', away: 'Stephen F. Austin', home: 'Northwestern State', channel: 'ESPN+' },
            { date: '2025-12-31', time: '5:00 PM', away: 'South Dakota', home: 'North Dakota State', channel: 'Midco Sports Plus' },
            { date: '2025-12-31', time: '5:00 PM', away: 'UConn', home: 'Xavier', channel: 'Peacock' },
            { date: '2025-12-31', time: '5:30 PM', away: 'Nicholls', home: 'UT Rio Grande Valley', channel: 'ESPN+' },
            { date: '2025-12-31', time: '6:00 PM', away: 'DePaul', home: 'Villanova', channel: 'FS1' },
            { date: '2025-12-31', time: '7:00 PM', away: 'Drexel', home: 'UNC Wilmington', channel: 'CBSSN' },
            { date: '2025-12-31', time: '8:00 PM', away: 'St. John\'s', home: 'Georgetown', channel: 'FS1' }
        ]
    };

    const LEAGUE_DISPLAY_ORDER = ["FEATURED", "MLB", "NFL", "Ryder Cup", "U.S. Open - Men's", "U.S. Open - Women's", "NBA", "NHL", "Premier League", "USMNT", "Formula 1", "NCAAF", "Boxing", "UFC", "ATP Finals (Singles)", "ATP Finals (Doubles)", "UEFA Champions League", "PGA Tour", "DP World Tour", "LPGA Tour", "PGA Champions", "NCAAM", "NCAAW", "LIV Golf", "ATP", "WTA", "MLS", "FA Cup", "LaLiga", "Bundesliga", "Serie A", "NCAA Women's Volleyball", "Ligue 1", "WNBA", "MotoGP", "NBA Preseason", "UEFA Europa League", "UEFA Conference League", "NWSL", "UEFA Qualifiers", "CONCACAF Qualifiers", "AFC Qualifiers", "Davis Cup (Singles)", "Davis Cup (Doubles)", "Campeones Cup", "Carabao Cup", "Copa del Rey", "Leagues Cup", "FIBA AmeriCup", "Liga MX", "Coppa Italia", "Copa Libertadores", "Copa Sudamericana", "DFB-Pokal", "Saudi Pro League", "CFL", "EFL Championship", "LPF Playoffs", "Argentine Primera", "AFCON", "Super Lig", "Italian Super Cup", "Liga Portugal", "Brasileirão", "Belgian Pro League", "Scottish Premiership", "Eredivisie", "AFC Champions League", "Women's UCL", "FIFA U-17 World Cup", "Women's Cricket World Cup", "FIFA U-20 World Cup", "CAF Qualifiers", "NHL Preseason", "Scottish Cup", "Women's Super League", "ICC Test Series", "ODI", "T20 International", "USL Championship", "OHL", "NCAA Men's Hockey", "International Friendly", "Club Friendly", "Coupe de France", "England: League One", "England: League Two", "England: National League", "2. Bundesliga", "Serie B", "Greek Super League", "LaLiga 2"]; 

    const LEAGUE_LIVE_SCORES_MAP = {
        // NFL: "https://www.nfl.com/scores",
        MLB: "https://www.mlb.com/score",
        // NHL: "https://www.nhl.com/scores",
        NCAAF: "https://www.espn.com/college-football/scoreboard",
        // NCAAM: "https://www.espn.com/mens-college-basketball/scoreboard",
        // NCAAW: "https://www.espn.com/womens-college-basketball/scoreboard",
        // NBA: "https://www.nba.com/games",
        MLS: "https://www.mlssoccer.com/schedule/scores#competition=all&club=all",
        // LaLiga: "https://www.laliga.com/en-US/laliga-easports/results",
        "FA Cup": "https://www.fotmob.com/leagues/132/matches/fa-cup",
        // Bundesliga: "https://www.bundesliga.com/en/bundesliga/matchday",
        // "Premier League": "https://www.premierleague.com/en/matches",
        "Liga MX": "https://www.fotmob.com/leagues/230/matches/liga-mx",
        "UEFA Champions League": "https://www.fotmob.com/leagues/42/matches/champions-league",
        "Formula 1": "https://www.formula1.com/en/timing/f1-live-lite",
        "Argentine Primera": "https://www.livescore.com/en/football/argentina/primera-division/",
        "ICC Test Series": "https://www.espncricinfo.com/live-cricket-score",
        // "Serie A": "https://www.fotmob.com/leagues/55/matches/serie",
        "Ligue 1": "https://www.fotmob.com/leagues/53/matches/ligue-1",
        "UEFA Europa League": "https://www.fotmob.com/leagues/73/matches/europa-league",
        "Boxing": "https://box.live/fight-results",
        "UEFA Conference League": "https://www.fotmob.com/leagues/10216/matches/conference-league",
        NWSL: "https://www.fotmob.com/leagues/9134/matches/nwsl",
        "Women's UCL": "https://www.fotmob.com/leagues/9375/matches/womens-champions-league",
        "FIFA U-17 World Cup": "https://www.flashscore.com/football/world/world-cup-u17/",
        Brasileirão: "https://www.fotmob.com/leagues/268/matches/serie",
        "CONCACAF Qualifiers": "https://www.fotmob.com/leagues/10198/fixtures/world-cup-qualification-concacaf",
        "UEFA Qualifiers": "https://www.fotmob.com/leagues/10195/fixtures/world-cup-qualification-uefa",
        "CAF Qualifiers": "https://www.fotmob.com/leagues/10196/fixtures/world-cup-qualification-caf",
        "AFC Qualifiers": "https://www.fotmob.com/leagues/10197/fixtures/world-cup-qualification-afc",
        OHL: "https://chl.ca/ohl/scores/",
        "International Friendly": "https://www.fotmob.com/leagues/114/fixtures/friendlies",
        "Club Friendly": "https://www.fotmob.com/leagues/489/fixtures/club-friendlies",
        "ATP": "https://www.atptour.com/en/scores/current",
        "Davis Cup (Singles)": "https://www.daviscup.com/en/live-centre",
        "Davis Cup (Doubles)": "https://www.daviscup.com/en/live-centre",
        "Boxing": "https://box.live/fight-results",
        "USMNT": "https://www.fotmob.com/teams/6713/fixtures/usa",
        "AFC Asian Cup Qualifiers": "https://www.fotmob.com/leagues/10609/fixtures/asian-cup-qualification-playoff?group=by-round",
        "NCAA Men's Hockey": "https://www.ncaa.com/scoreboard/icehockey-men/d1",
        "EFL Championship": "https://www.fotmob.com/leagues/48/fixtures/championship",
        // "Belgian Pro League": "https://www.fotmob.com/leagues/40/fixtures/first-division",
        // "Super Lig": "https://www.fotmob.com/leagues/71/fixtures/super-lig",
        "PGA Tour": "https://www.pgatour.com/leaderboard",
        "LPGA Tour": "https://www.golflive24.com/lpga-tour/"
    };

    function normalizeNcaaTeamName(name) {
        if (!name || typeof name !== 'string') return '';
        return name
            .normalize('NFD')
            .replace(/[\u0300-\u036f]/g, '')
            .toLowerCase()
            .replace(/saint/g, 'st')
            .replace(/state/g, 'st')
            .replace(/[^a-z0-9]/g, '');
    }

    // Helper function to create a Set from team names
    function createImportantTeamsSet(names) {
        const set = new Set();
        names.forEach(name => set.add(normalizeNcaaTeamName(name)));
        return set;
    }

    // Important teams for NCAAM (Men's Basketball)
    const IMPORTANT_NCAAM_TEAMS = (() => {
        const names = [
            "Air Force",
            "Alabama",
            "Arizona",
            "Arizona St",
            "Arkansas",
            "Auburn",
            "Boston College",
            "Baylor",
            "Boise St",
            "BYU",
            "California",
            "Cincinnati",
            "Charlotte",
            "Clemson",
            "Colorado",
            "Colorado St",
            "Creighton",
            "DePaul",
            "Duke",
            "East Carolina",
            "FAU",
            "Florida",
            "Florida St",
            "Fresno St",
            "Georgetown",
            "Georgia",
            "Georgia Tech",
            "Grand Canyon",
            "Houston",
            "Illinois",
            "Indiana",
            "Iowa",
            "Iowa State",
            "Kansas",
            "Kansas St",
            "Kentucky",
            "LSU",
            "Louisville",
            "Marquette",
            "Maryland",
            "Memphis",
            "Michigan",
            "Michigan St",
            "Minnesota",
            "Mississippi St",
            "Missouri",
            "NC State",
            "Nevada",
            "New Mexico",
            "North Carolina",
            "North Texas",
            "Northwestern",
            "Notre Dame",
            "Ohio State",
            "Oklahoma",
            "Oklahoma St",
            "Ole Miss",
            "Penn State",
            "Pitt",
            "Providence",
            "Rice",
            "Rutgers",
            "San Diego St",
            "San José St",
            "SMU",
            "South Carolina",
            "South Florida",
            "St John's",
            "Stanford",
            "Syracuse",
            "TCU",
            "Temple",
            "Tennessee",
            "Texas",
            "Texas A&M",
            "Texas Tech",
            "Tulane",
            "Tulsa",
            "UAB",
            "UCF",
            "UCLA",
            "UNLV",
            "USC",
            "Utah",
            "Utah State",
            "Vanderbilt",
            "Villanova",
            "Virginia",
            "Virginia Tech",
            "Wake Forest",
            "Washington",
            "West Virginia",
            "Wisconsin",
            "Wichita St",
            "Xavier"
        ];
        return createImportantTeamsSet(names);
    })();

    // Important teams for NCAAW (Women's Basketball)
    const IMPORTANT_NCAAW_TEAMS = (() => {
        const names = [
            // Add your important NCAAW teams here
            // For now, using same list as NCAAM - you can customize this
            "Air Force",
            "Alabama",
            "Arizona",
            "Arizona St",
            "Arkansas",
            "Auburn",
            "Boston College",
            "Baylor",
            "Boise St",
            "BYU",
            "California",
            "Cincinnati",
            "Charlotte",
            "Clemson",
            "Colorado",
            "Colorado St",
            "Creighton",
            "DePaul",
            "Duke",
            "East Carolina",
            "FAU",
            "Florida",
            "Florida St",
            "Fresno St",
            "Georgetown",
            "Georgia",
            "Georgia Tech",
            "Grand Canyon",
            "Houston",
            "Illinois",
            "Indiana",
            "Iowa",
            "Iowa State",
            "Kansas",
            "Kansas St",
            "Kentucky",
            "LSU",
            "Louisville",
            "Marquette",
            "Maryland",
            "Memphis",
            "Michigan",
            "Michigan St",
            "Minnesota",
            "Mississippi St",
            "Missouri",
            "NC State",
            "Nevada",
            "New Mexico",
            "North Carolina",
            "North Texas",
            "Northwestern",
            "Notre Dame",
            "Ohio State",
            "Oklahoma",
            "Oklahoma St",
            "Ole Miss",
            "Penn State",
            "Pitt",
            "Providence",
            "Rice",
            "Rutgers",
            "San Diego St",
            "San José St",
            "SMU",
            "South Carolina",
            "South Florida",
            "St John's",
            "Stanford",
            "Syracuse",
            "TCU",
            "Temple",
            "Tennessee",
            "Texas",
            "Texas A&M",
            "Texas Tech",
            "Tulane",
            "Tulsa",
            "UAB",
            "UCF",
            "UCLA",
            "UNLV",
            "USC",
            "Utah",
            "Utah State",
            "Vanderbilt",
            "Villanova",
            "Virginia",
            "Virginia Tech",
            "Wake Forest",
            "Washington",
            "West Virginia",
            "Wisconsin",
            "Wichita St",
            "Xavier"
        ];
        return createImportantTeamsSet(names);
    })();

    // Important teams for NCAAF (Football)
    const IMPORTANT_NCAAF_TEAMS = (() => {
        const names = [
            "GA Tech",
            "Virginia",
            "Pittsburgh",
            "Southern Methodist",
            "Duke",
            "Miami (FL)",
            "Louisville",
            "Wake Forest",
            "California",
            "Clemson",
            "NC State",
            "North Carolina",
            "Virginia Tech",
            "Stanford",
            "Florida State",
            "Syracuse",
            "Boston Coll",
            "Navy",
            "North Texas",
            "USF",
            "Tulane",
            "East Carolina",
            "Memphis",
            "Army",
            "Temple",
            "FAU",
            "UTSA",
            "Rice",
            "UAB",
            "Tulsa",
            "Charlotte",
            "Texas Tech",
            "Brigham Young",
            "Cincinnati",
            "Houston",
            "Utah",
            "Arizona State",
            "Arizona",
            "TCU",
            "Baylor",
            "Kansas State",
            "Iowa State",
            "Kansas",
            "West Virginia",
            "UCF",
            "Colorado Buffaloes",
            "OK State",
            "Indiana",
            "Ohio State",
            "Oregon",
            "USC",
            "Michigan",
            "Iowa",
            "Nebraska",
            "Minnesota",
            "Illinois",
            "Washington",
            "Northwestern",
            "UCLA",
            "Rutgers",
            "Maryland",
            "Wisconsin",
            "Penn St",
            "Mich St",
            "Purdue",
            "Notre Dame",
            "Connecticut",
            "Wash St",
            "Oregon State",
            "Texas A&M",
            "Alabama",
            "Georgia",
            "Ole Miss",
            "Texas",
            "Vanderbilt",
            "Oklahoma",
            "Tennessee",
            "Missouri",
            "LSU",
            "Florida Gators",
            "Kentucky",
            "Mississippi St",
            "Auburn",
            "S Carolina",
            "Arkansas"
        ];
        return createImportantTeamsSet(names);
    })();

    function isImportantNcaaTeamName(name, leagueKey) {
        if (!leagueKey) return false;
        
        let teamSet;
        if (leagueKey === 'NCAAM') {
            teamSet = IMPORTANT_NCAAM_TEAMS;
        } else if (leagueKey === 'NCAAW') {
            teamSet = IMPORTANT_NCAAW_TEAMS;
        } else if (leagueKey === 'NCAAF') {
            teamSet = IMPORTANT_NCAAF_TEAMS;
        } else {
            return false;
        }
        
        return teamSet.has(normalizeNcaaTeamName(name));
    }

    function isImportantNcaaGame(homeTeamName, awayTeamName, leagueKey, gameData) {
        if (!leagueKey || (leagueKey !== 'NCAAM' && leagueKey !== 'NCAAW' && leagueKey !== 'NCAAF')) return false;
        
        if (isImportantNcaaTeamName(homeTeamName, leagueKey) || isImportantNcaaTeamName(awayTeamName, leagueKey)) {
            return true;
        }

        const homeRank = getTop25Rank(homeTeamName, leagueKey);
        const awayRank = getTop25Rank(awayTeamName, leagueKey);
        if ((homeRank !== null && homeRank !== undefined) || (awayRank !== null && awayRank !== undefined)) {
            return true;
        }

        const rankFields = [
            gameData?.HomeTop25Rank,
            gameData?.homeTop25Rank,
            gameData?.HomeTop25,
            gameData?.homeTop25,
            gameData?.AwayTop25Rank,
            gameData?.awayTop25Rank,
            gameData?.AwayTop25,
            gameData?.awayTop25
        ];

        const isRankedValue = (value) => {
            if (value === null || value === undefined) return false;
            if (typeof value === 'number') {
                return value > 0 && value <= 25;
            }
            const normalized = String(value).trim().toUpperCase();
            if (!normalized || normalized === 'NR' || normalized === 'N/A' || normalized === 'UNRANKED' || normalized === '-' || normalized === '--') {
                return false;
            }
            const parsed = parseInt(normalized, 10);
            return !isNaN(parsed) && parsed > 0 && parsed <= 25;
        };

        return rankFields.some(isRankedValue);
    }
    
    // Leagues that should be collapsed by default on the home page
    const COLLAPSED_LEAGUES = [
    "A-League",
    "AFC Asian Cup Qualifiers",
    "CAF Qualifiers", 
    "England: League One",
    "England: League Two",
    "NHL Preseason", 
    "Women's Super League", 
    "ICC Test Series", 
    "ODI",
    "T20 International", 
    "USL Championship", 
    "OHL", 
    "NCAA Men's Hockey", 
    "Club Friendly",
    "International Friendly",
    "ATP Finals (Doubles)",
    "Coupe de France",
    "2. Bundesliga",
    "Greek Super League",
    "LaLiga 2",
    "Serie B",
    "England: National League"
    ];

    // --- 2. FIREBASE INITIALIZATION (SINGLETON) + CACHING ---
    if (!firebase.apps.length) {
        const firebaseConfig = {
            apiKey: "AIzaSyD3bw8d4q2oO2qpbgGiUG6Qnlf4aABK3Bc",
            authDomain: "flashlive-daily-scraper.firebaseapp.com",
            projectId: "flashlive-daily-scraper",
            storageBucket: "flashlive-daily-scraper.appspot.com",
            messagingSenderId: "124291936014",
            appId: "1:124291936014:web:acadcaa791d6046849315f"
        };
        firebase.initializeApp(firebaseConfig);
    }
    const db = firebase.firestore();
    const gamesCollectionRef = db.collection("artifacts/flashlive-daily-scraper/public/data/sportsGames");

    // --- CACHING SYSTEM ---
    const cache = {
        data: new Map(),
        timestamps: new Map(),
        CACHE_DURATION: 5 * 60 * 1000, // 5 minutes cache
        
        set(key, data) {
            this.data.set(key, data);
            this.timestamps.set(key, Date.now());
        },
        
        get(key) {
            const timestamp = this.timestamps.get(key);
            if (!timestamp || Date.now() - timestamp > this.CACHE_DURATION) {
                this.data.delete(key);
                this.timestamps.delete(key);
                return null;
            }
            return this.data.get(key);
        },
        
        clear() {
            this.data.clear();
            this.timestamps.clear();
        }
    };


    // --- PERIODIC REFRESH SYSTEM ---
    // Refresh data every 3 minutes instead of real-time listeners
    let refreshInterval;
    
    function startPeriodicRefresh() {
        // Clear existing interval if any
        if (refreshInterval) clearInterval(refreshInterval);
        
        refreshInterval = setInterval(() => {
            cache.clear(); // Clear cache to force fresh data on next request
            
            // Only refresh if user is actively viewing the page
            if (!document.hidden) {
                // Refresh current league data if on a league page
                const currentLeague = document.querySelector('.main-menu li.selected')?.dataset.section;
                if (currentLeague && currentLeague !== 'Home') {
                    const leagueInfo = LEAGUE_DATA_CONFIG[currentLeague];
                    if (leagueInfo) {
                        const { DateTime } = luxon;
                        const todayStr = DateTime.now().setZone('America/New_York').toISODate();
                        getCachedGames(leagueInfo.leagueId, todayStr); // Pre-cache fresh data
                    }
                }
            }
        }, 3 * 60 * 1000); // 3 minutes
    }
    
    // Stop refresh when user leaves page
    document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
            if (refreshInterval) {
                clearInterval(refreshInterval);
                refreshInterval = null;
            }
        } else {
            startPeriodicRefresh();
        }
    });
    
    // Start periodic refresh
    startPeriodicRefresh();

    // --- 3. ELEMENT REFERENCES ---
    const leagueHeader = document.getElementById('league-specific-header');
    const scheduleContent = document.getElementById('league-schedule-content');
    const standingsContent = document.getElementById('league-standings-content');
    
    // --- 4. OPTIMIZED FIRESTORE FUNCTIONS ---
    
    // Cached version of Firestore queries to reduce costs
    async function getCachedGames(leagueId, gameDate) {
        const cacheKey = `games_${leagueId}_${gameDate}`;
        let cachedData = cache.get(cacheKey);
        
        if (cachedData) {
            return cachedData;
        }
        
        try {
            const leagueIdLower = (leagueId || '').toLowerCase();
            // Try exact match first
            let snapshot = await gamesCollectionRef
                .where('League', '==', leagueId)
                .where('gameDate', '==', gameDate)
                .get();
            
            // If no exact match, try case-insensitive search
            if (snapshot.empty) {
                console.log(`No exact match for leagueId: ${leagueId}, trying case-insensitive search...`);
                const allGamesSnapshot = await gamesCollectionRef
                    .where('gameDate', '==', gameDate)
                    .get();
                
                const gamesData = allGamesSnapshot.docs
                    .map(doc => doc.data())
                    .filter(game => {
                    if (leagueIdLower.includes('formula one') || leagueIdLower.includes('formula 1') || leagueIdLower === 'formulaone') {
                        return isFormulaOneGame(game);
                    }
                    const gameLeague = (game.League || '').toLowerCase();
                    return gameLeague.includes(leagueIdLower) || leagueIdLower.includes(gameLeague);
                    });
                
                cache.set(cacheKey, gamesData);
                return gamesData;
            }
            
            const gamesData = snapshot.docs.map(doc => doc.data());
        if (leagueIdLower.includes('formula one') || leagueIdLower.includes('formula 1') || leagueIdLower === 'formulaone') {
            cache.set(cacheKey, gamesData.filter(isFormulaOneGame));
            return cache.get(cacheKey) || [];
        }
            cache.set(cacheKey, gamesData);
            return gamesData;
        } catch (error) {
            console.error('Error fetching games:', error);
            return [];
        }
    }

    // Cached version for upcoming games
    async function getCachedUpcomingGames(collectionName) {
        const cacheKey = `upcoming_${collectionName}`;
        let cachedData = cache.get(cacheKey);
        
        if (cachedData) {
            return cachedData;
        }
        
        try {
            const snapshot = await db.collection(collectionName).get();
            const upcomingData = snapshot.docs.map(doc => doc.data());
            cache.set(cacheKey, upcomingData);
            return upcomingData;
        } catch (error) {
            console.error('Error fetching upcoming games:', error);
            return [];
        }
    }

    // Batch function to reduce multiple queries
    async function getBatchedLeagueData(leagueId, gameDate, upcomingCollection) {
        const promises = [];
        
        // Batch today's games and upcoming games together
        promises.push(getCachedGames(leagueId, gameDate));
        if (upcomingCollection) {
            promises.push(getCachedUpcomingGames(upcomingCollection));
        }
        
        try {
            const results = await Promise.all(promises);
            return {
                todayGames: results[0] || [],
                upcomingGames: results[1] || []
            };
        } catch (error) {
            console.error('Error in batch request:', error);
            return { todayGames: [], upcomingGames: [] };
        }
    }

    // --- 5. HELPER FUNCTIONS ---
    function getLeagueDisplayName(name, sport) {
        // Special handling for USA: NCAA - check sport to determine if it's football, hockey, or basketball
        if (name === "USA: NCAA") {
            if (sport === "Hockey") {
                return "NCAA Men's Hockey";
            } else if (sport === "American Football") {
                return "NCAAF";
            } else if (sport === "Basketball") {
                return "NCAAM";
            }
        }
        
        // Special handling for USA: NCAA Women - check sport to determine display name
        if (name === "USA: NCAA Women") {
            if (sport === "Basketball") {
                return "NCAAW";
            }
        }
        
        // Special handling for Formula 1 - any league name containing "Formula 1" becomes "Formula 1"
        if (name && name.includes("Formula 1")) {
            return "Formula 1";
        }
        
        // Special handling for UEFA Europa League - any league name containing "Europa League" becomes "UEFA Europa League"
        if (name && (name.includes("Europa League") || name === "Europa League")) {
            return "UEFA Europa League";
        }
        
        // Special handling for UEFA Conference League - any league name containing "Conference League" becomes "UEFA Conference League"
        if (name && (name.includes("Conference League") || name === "Conference League")) {
            return "UEFA Conference League";
        }
        
        // Fuzzy logic matching for ATP Finals - check if name contains "Finals" AND "ATP" AND "(Singles)" or "(Doubles)"
        if (name && name.includes("Finals") && name.includes("ATP")) {
            if (name.includes("(Singles)")) {
                return "ATP Finals (Singles)";
            }
            if (name.includes("(Doubles)")) {
                return "ATP Finals (Doubles)";
            }
        }
        
        // Fuzzy logic matching for Davis Cup - check if name contains "World: Davis Cup"
        if (name && name.includes("World: Davis Cup")) {
            if (name.includes("Doubles")) {
                return "Davis Cup (Doubles)";
            } else {
                return "Davis Cup (Singles)";
            }
        }
        
        // Special handling for CAF Nations League - must come before qualification check
        if (name && (name.includes("CAF Nations League") || name === "CAF Nations League" || name === "Africa: CAF Nations League")) {
            return "AFCON";
        }
        
        // Special handling for qualification leagues - use prefix matching
        if (name && name.includes("Africa: World Cup - Qualification")) {
            return "CAF Qualifiers";
        }
        if (name && name.includes("Asia: World Cup - Qualification")) {
            return "AFC Qualifiers";
        }
        if (name && name.includes("Asia: Asian Cup - Qualification")) {
            return "AFC Asian Cup Qualifiers";
        }
        if (name && name.includes("Europe: World Cup - Qualification")) {
            return "UEFA Qualifiers";
        }
        if (name && name.includes("North & Central America: World Cup - Qualification")) {
            return "CONCACAF Qualifiers";
        }
        
        const map = { "USA: WNBA": "WNBA", "USA: MLB": "MLB", "USA: NFL": "NFL", "Europe: Champions League - League phase": "UEFA Champions League", "USA: NBA": "NBA", "USA: MLS": "MLS", "USA: NHL": "NHL", "USA: NHL - Pre-season": "NHL Preseason", "USA: NCAA": "NCAAF", "USA: MLS - Play Offs": "MLS", "USA: US Open ATP, hard": "U.S. Open - Men's", "USA: US Open WTA, hard": "U.S. Open - Women's", "ENGLAND: PREMIER LEAGUE": "Premier League", "USA: NWSL Women": "NWSL", "USA: NWSL Women - Play Offs": "NWSL", "World: Club Friendly": "Club Friendly", "USA: Cleveland WTA, hard": "WTA", "Germany: DFB Pokal": "DFB-Pokal", "Italy: Coppa Italia": "Coppa Italia", "France: Coupe de France": "Coupe de France", "Italy: Serie A": "Serie A", "Turkey: Super Lig": "Super Lig", "Spain: LaLiga": "LaLiga", "Spain: Copa del Rey": "Copa del Rey", "Mexico: Liga MX": "Liga MX", "Mexico: Liga MX - Apertura": "Liga MX", "Mexico: Liga MX - Clausura": "Liga MX", "Mexico: Liga MX - Apertura - Play In": "Liga MX", "Mexico: Liga MX - Apertura - Play Offs": "Liga MX", "England: EFL Cup": "Carabao Cup", "EFL Cup": "Carabao Cup", "England: FA Cup": "FA Cup", "England: Premier League": "Premier League", "Europe: Champions League - Qualification": "UEFA Champions League", "Brazil: Serie A Betano": "Brasileirão", "Belgium: Jupiler Pro League": "Belgian Pro League", "South America: Copa Libertadores - Play Offs": "Copa Libertadores", "Asia: AFC Asian Cup - Qualification - Third round": "AFC Asian Cup Qualifiers", "North & Central America: Leagues Cup - Play Offs": "Leagues Cup", "CopaSudamericana": "Copa Sudamericana", "South America: Copa Sudamericana": "Copa Sudamericana", "South America: Copa Sudamericana - Play Offs": "Copa Sudamericana", "World: AmeriCup": "FIBA AmeriCup", "Europe: Champions League Women - Qualification - Second stage": "Women's UCL", "Europe: Europa League - Qualification": "UEFA Europa League", "Europe: Europa League - League phase": "UEFA Europa League", "Europe: Conference League - Qualification": "UEFA Conference League", "Europe: Conference League - League phase": "UEFA Conference League", "Europe: Champions League Women - League phase": "Women's UCL", "Germany: Bundesliga": "Bundesliga", "Saudi Arabia: Saudi Professional League": "Saudi Pro League", "France: Ligue 1": "Ligue 1", "Canada: CFL": "CFL", "USA: WNBA - Play Offs": "WNBA", "England: Championship": "EFL Championship", "World: Ryder Cup": "Ryder Cup", "Netherlands: Eredivisie": "Eredivisie", "England: WSL": "Women's Super League", "Argentina: Torneo Betano - Clausura": "Argentine Primera", "Argentina: Torneo Betano - Apertura": "Argentine Primera", "Argentina: Torneo Betano - Clausura - Play Offs": "LPF Playoffs", "Scotland: Scottish Cup": "Scottish Cup", "Portugal: Liga Portugal": "Liga Portugal", "Scotland: Premiership": "Scottish Premiership", "World: World Cup U20": "FIFA U-20 World Cup", "North & Central America: Campeones Cup": "Campeones Cup", "World: ICC World Cup Women": "Women's Cricket World Cup", "World: Test Series": "ICC Test Series", "World: One Day International": "ODI", "World: Twenty20 International": "T20 International", "USA: NBA - Pre-season": "NBA Preseason", "USA: USL Championship": "USL Championship", "World: World Cup U20 - Play Offs": "FIFA U-20 World Cup", "USA: MLB - Play Offs": "MLB", "Canada: OHL": "OHL", "USA: NCAA Hockey": "NCAA Men's Hockey", "World: Friendly International": "International Friendly", "World: World Cup U17": "FIFA U-17 World Cup", "World: World Cup U17 - Play Offs": "FIFA U-17 World Cup", "World: Finals - Turin ATP - Play Offs, hard (indoor)": "ATP Finals (Singles)", "World: Finals - Turin ATP Doubles - Play Offs, hard (indoor)": "ATP Finals (Doubles)", "World: Finals - Turin ATP, hard (indoor)": "ATP Finals (Singles)", "World: Finals - Turin ATP Doubles, hard (indoor)": "ATP Finals (Doubles)", "Asia: AFC Elite": "AFC Champions League", "AFC Champions League": "AFC Champions League", "Germany: 2. Bundesliga": "2. Bundesliga", "Africa: CAF Nations League": "AFCON", "Greece: Super League": "Greek Super League", "Spain: LaLiga 2": "LaLiga 2", "Italy: Serie B": "Serie B", "England: National League": "England: National League", "Australia: A-League Men": "A-League" };
        return map[name] || name;
    }

    // Function to match league names based on partial matches
    function getLeagueKeyFromDatabaseName(databaseLeagueName) {
        const leagueMatches = {
            // UEFA Champions League variations
            'UEFAChampionsLeague': ['Europe: Champions League', 'Champions League'],
            // AFC Champions League variations
            'AFCChampionsLeague': ['Asia: AFC Elite', 'AFC Champions League'],
            // UEFA Europa League variations  
            'UEFAEuropaLeague': ['Europe: Europa League', 'Europa League', 'UEFA Europa League'],
            // UEFA Conference League variations
            'UEFAConferenceLeague': ['Europe: Conference League', 'Conference League', 'UEFA Conference League'],
            'UEFAWChampionsLeague': ['Europe: Champions League Women', 'Champions League Women'],
            // Premier League variations
            'PremierLeague': ['England: Premier League', 'Premier League'],
            // LaLiga variations
            'LaLiga': ['Spain: LaLiga', 'LaLiga'],
            // Serie A variations
            'SerieA': ['Italy: Serie A', 'Serie A'],
            // Bundesliga variations
            'Bundesliga': ['Germany: Bundesliga', 'Bundesliga'],
            // Ligue 1 variations
            'Ligue1': ['France: Ligue 1', 'Ligue 1'],
            // MLS variations
            'MLS': ['USA: MLS', 'MLS'],
            // NFL variations
            'NFL': ['USA: NFL', 'NFL'],
            // NBA variations
            'NBA': ['USA: NBA', 'NBA'],
            // MLB variations
            'MLB': ['USA: MLB', 'MLB'],
            // NHL variations
            'NHL': ['USA: NHL', 'NHL'],
            // WNBA variations
            'WNBA': ['USA: WNBA', 'WNBA'],
            // NCAAF variations
            'NCAAF': ['USA: NCAA', 'NCAA'],
            // NWSL variations
            'NWSL': ['USA: NWSL Women', 'NWSL'],
            // Liga MX variations
            'LigaMX': ['Mexico: Liga MX', 'Liga MX', 'Mexico: Liga MX - Apertura - Play In', 'Mexico: Liga MX - Apertura - Play Offs'],
            // Saudi Pro League variations
            'SaudiProLeague': ['Saudi Arabia: Saudi Professional League', 'Saudi Pro League'],
            // Brasileirão variations
            'Brasileirao': ['Brazil: Serie A Betano', 'Serie A Betano'],
            // Copa Libertadores variations
            'CopaLibertadores': ['South America: Copa Libertadores', 'Copa Libertadores'],
            // Copa Sudamericana variations
            'CopaSudamericana': ['South America: Copa Sudamericana', 'Copa Sudamericana'],
            // Leagues Cup variations
            'LeaguesCup': ['North & Central America: Leagues Cup', 'Leagues Cup'],
            // DFB-Pokal variations
            'DFBPokal': ['Germany: DFB Pokal', 'DFB Pokal'],
            // Coppa Italia variations
            'CoppaItalia': ['Italy: Coppa Italia', 'Coppa Italia'],
            // Coupe de France variations
            'CoupeDeFrance': ['France: Coupe de France', 'Coupe de France'],
            // Carabao Cup variations (formerly EFL Cup)
            'CarabaoCup': ['England: EFL Cup', 'EFL Cup', 'Carabao Cup'],
            // Super Lig variations
            'SuperLig': ['Turkey: Super Lig', 'Super Lig'],
            // Eredivisie variations
            'Eredivisie': ['Netherlands: Eredivisie', 'Eredivisie'],
            // Liga Portugal variations
            'LigaPortugal': ['Portugal: Liga Portugal', 'Liga Portugal'],
            // Scottish Premiership variations
            'ScottishPremiership': ['Scotland: Premiership', 'Scottish Premiership'],
            // Scottish Cup variations
            'ScottishCup': ['Scotland: Scottish Cup', 'Scottish Cup'],
            // FIFA U-17 World Cup variations
            'WorldCupU17': ['World: World Cup U17', 'World Cup U17'],
            'WorldCupU17PlayOffs': ['World: World Cup U17 - Play Offs', 'World Cup U17 - Play Offs'],
            // Women's Super League variations
            'WomensSuperLeague': ['England: WSL', 'WSL', 'Women\'s Super League'],
            // Argentine Primera variations
            'ArgentinePrimeraDivision': ['Argentina: Torneo Betano', 'Argentine Primera'],
            // LPF Playoffs variations
            'LPFPlayoffs': ['Argentina: Torneo Betano - Clausura - Play Offs', 'LPF Playoffs'],
            // EFL Championship variations
            'EFLChampionship': ['England: Championship', 'EFL Championship'],
            // Formula One variations
            'FormulaOne': ['Formula 1', 'Formula One', 'World: Formula 1', 'World: Formula One', 'WORLD: FORMULA ONE'],
            // Tennis variations (for Davis Cup to show on Tennis page)
            'Tennis': ['World: Davis Cup', 'Davis Cup', 'Davis Cup (Singles)', 'Davis Cup (Doubles)']
        };

        // Check for exact matches first
        for (const [leagueKey, patterns] of Object.entries(leagueMatches)) {
            for (const pattern of patterns) {
                if (databaseLeagueName === pattern) {
                    return leagueKey;
                }
            }
        }

        // Check for partial matches (but avoid overlaps like NBA vs WNBA)
        for (const [leagueKey, patterns] of Object.entries(leagueMatches)) {
            for (const pattern of patterns) {
                // More specific matching to avoid NBA vs WNBA overlap
                if (pattern === 'NBA' && databaseLeagueName === 'USA: NBA') {
                    return leagueKey;
                } else if (pattern === 'WNBA' && databaseLeagueName === 'USA: WNBA') {
                    return leagueKey;
                } else if (pattern !== 'NBA' && pattern !== 'WNBA' && databaseLeagueName.includes(pattern)) {
                    return leagueKey;
                }
            }
        }
        return null;
    }
    
    // League-specific team name display mappings
    const TEAM_DISPLAY_MAP = {
        // MLB
        MLB: {
            "Arizona Diamondbacks": "Diamondbacks",
            "Atlanta Braves": "Braves",
            "Baltimore Orioles": "Orioles",
            "Boston Red Sox": "Red Sox",
            "Chicago Cubs": "Cubs",
            "Chicago White Sox": "White Sox",
            "Cincinnati Reds": "Reds",
            "Cleveland Guardians": "Guardians",
            "Colorado Rockies": "Rockies",
            "Detroit Tigers": "Tigers",
            "Houston Astros": "Astros",
            "Kansas City Royals": "Royals",
            "Los Angeles Angels": "Angels",
            "Los Angeles Dodgers": "Dodgers",
            "Miami Marlins": "Marlins",
            "Milwaukee Brewers": "Brewers",
            "Minnesota Twins": "Twins",
            "New York Mets": "Mets",
            "New York Yankees": "Yankees",
            "Athletics": "Athletics",
            "Philadelphia Phillies": "Phillies",
            "Pittsburgh Pirates": "Pirates",
            "San Diego Padres": "Padres",
            "San Francisco Giants": "Giants",
            "Seattle Mariners": "Mariners",
            "St. Louis Cardinals": "Cardinals",
            "Tampa Bay Rays": "Rays",
            "Texas Rangers": "Rangers",
            "Toronto Blue Jays": "Blue Jays",
            "Washington Nationals": "Nationals"
        },
        // NFL
        NFL: {
            "Arizona Cardinals": "Cardinals",
            "Atlanta Falcons": "Falcons",
            "Baltimore Ravens": "Ravens",
            "Buffalo Bills": "Bills",
            "Carolina Panthers": "Panthers",
            "Chicago Bears": "Bears",
            "Cincinnati Bengals": "Bengals",
            "Cleveland Browns": "Browns",
            "Dallas Cowboys": "Cowboys",
            "Denver Broncos": "Broncos",
            "Detroit Lions": "Lions",
            "Green Bay Packers": "Packers",
            "Houston Texans": "Texans",
            "Indianapolis Colts": "Colts",
            "Jacksonville Jaguars": "Jaguars",
            "Kansas City Chiefs": "Chiefs",
            "Las Vegas Raiders": "Raiders",
            "Los Angeles Chargers": "Chargers",
            "Los Angeles Rams": "Rams",
            "Miami Dolphins": "Dolphins",
            "Minnesota Vikings": "Vikings",
            "New England Patriots": "Patriots",
            "New Orleans Saints": "Saints",
            "New York Giants": "Giants",
            "New York Jets": "Jets",
            "Philadelphia Eagles": "Eagles",
            "Pittsburgh Steelers": "Steelers",
            "San Francisco 49ers": "49ers",
            "Seattle Seahawks": "Seahawks",
            "Tampa Bay Buccaneers": "Buccaneers",
            "Tennessee Titans": "Titans",
            "Washington Commanders": "Commanders"
        },
        // NBA
        NBA: {
            "Atlanta Hawks": "Hawks",
            "Boston Celtics": "Celtics",
            "Brooklyn Nets": "Nets",
            "Charlotte Hornets": "Hornets",
            "Chicago Bulls": "Bulls",
            "Cleveland Cavaliers": "Cavaliers",
            "Dallas Mavericks": "Mavericks",
            "Denver Nuggets": "Nuggets",
            "Detroit Pistons": "Pistons",
            "Golden State Warriors": "Warriors",
            "Houston Rockets": "Rockets",
            "Indiana Pacers": "Pacers",
            "Los Angeles Clippers": "Clippers",
            "Los Angeles Lakers": "Lakers",
            "Memphis Grizzlies": "Grizzlies",
            "Miami Heat": "Heat",
            "Milwaukee Bucks": "Bucks",
            "Minnesota Timberwolves": "Timberwolves",
            "New Orleans Pelicans": "Pelicans",
            "New York Knicks": "Knicks",
            "Oklahoma City Thunder": "Thunder",
            "Orlando Magic": "Magic",
            "Philadelphia 76ers": "76ers",
            "Phoenix Suns": "Suns",
            "Portland Trail Blazers": "Trail Blazers",
            "Sacramento Kings": "Kings",
            "San Antonio Spurs": "Spurs",
            "Toronto Raptors": "Raptors",
            "Utah Jazz": "Jazz",
            "Washington Wizards": "Wizards"
        },
        // NHL
        NHL: {
            "Anaheim Ducks": "Ducks",
            "Arizona Coyotes": "Coyotes",
            "Boston Bruins": "Bruins",
            "Buffalo Sabres": "Sabres",
            "Calgary Flames": "Flames",
            "Carolina Hurricanes": "Hurricanes",
            "Chicago Blackhawks": "Blackhawks",
            "Colorado Avalanche": "Avalanche",
            "Columbus Blue Jackets": "Blue Jackets",
            "Dallas Stars": "Stars",
            "Detroit Red Wings": "Red Wings",
            "Edmonton Oilers": "Oilers",
            "Florida Panthers": "Panthers",
            "Los Angeles Kings": "Kings",
            "Utah Mammoth": "Mammoth",
            "Minnesota Wild": "Wild",
            "Montreal Canadiens": "Canadiens",
            "Nashville Predators": "Predators",
            "New Jersey Devils": "Devils",
            "New York Islanders": "Islanders",
            "New York Rangers": "Rangers",
            "Ottawa Senators": "Senators",
            "Philadelphia Flyers": "Flyers",
            "Pittsburgh Penguins": "Penguins",
            "San Jose Sharks": "Sharks",
            "Seattle Kraken": "Kraken",
            "St. Louis Blues": "Blues",
            "Tampa Bay Lightning": "Lightning",
            "Toronto Maple Leafs": "Maple Leafs",
            "Vancouver Canucks": "Canucks",
            "Vegas Golden Knights": "Vegas",
            "Washington Capitals": "Capitals",
            "Winnipeg Jets": "Jets"
        },
        // WNBA
        WNBA: {
            "Atlanta Dream": "Dream",
            "Chicago Sky": "Sky",
            "Connecticut Sun": "Sun",
            "Dallas Wings": "Wings",
            "Indiana Fever": "Fever",
            "Las Vegas Aces": "Aces",
            "Los Angeles Sparks": "Sparks",
            "Minnesota Lynx": "Lynx",
            "New York Liberty": "Liberty",
            "Phoenix Mercury": "Mercury",
            "Seattle Storm": "Storm",
            "Washington Mystics": "Mystics"
        },
        // CFL
        CFL: {
            "BC Lions": "BC",
            "Calgary Stampeders": "Calgary",
            "Edmonton Elks": "Edmonton",
            "Hamilton Tiger-Cats": "Hamilton",
            "Montreal Alouettes": "Montreal",
            "Ottawa Redblacks": "Ottawa",
            "Saskatchewan Roughriders": "Saskatchewan",
            "Toronto Argonauts": "Toronto",
            "Winnipeg Blue Bombers": "Winnipeg"
        },
        // NWSL
        NWSL: {
            "Kansas City Current": "KC Current",
            "Kansas City Current W": "KC Current",
            "Washington Spirit": "Spirit",
            "Washington Spirit W": "Spirit",
            "Orlando Pride": "Pride",
            "Orlando Pride W": "Pride",
            "Seattle Reign": "Reign",
            "Seattle Reign W": "Reign",
            "San Diego Wave": "Wave",
            "San Diego Wave W": "Wave",
            "Portland Thorns": "Thorns",
            "Portland Thorns W": "Thorns",
            "Gotham": "Gotham FC",
            "Gotham W": "Gotham FC",
            "NJ/NY Gotham FC": "Gotham FC",
            "Racing Louisville": "Louisville",
            "Racing Louisville W": "Louisville",
            "Racing Louisville FC": "Louisville",
            "North Carolina Courage": "NC Courage",
            "North Carolina Courage W": "NC Courage",
            "Houston Dash": "Dash",
            "Houston Dash W": "Dash",
            "Angel City": "Angel City",
            "Angel City W": "Angel City",
            "Utah Royals": "Royals",
            "Utah Royals W": "Royals",
            "Bay FC": "Bay FC",
            "Bay FC W": "Bay FC",
            "Chicago": "Stars",
            "Chicago W": "Stars",
            "Chicago Stars": "Stars"
        },
        // Premier League
        PremierLeague: {
            "Arsenal": "Arsenal",
            "Manchester City": "Man City",
            "Liverpool": "Liverpool",
            "AFC Bournemouth": "Bournemouth",
            "Bournemouth": "Bournemouth",
            "Tottenham": "Tottenham",
            "Chelsea": "Chelsea",
            "Sunderland": "Sunderland",
            "Manchester Utd": "Man United",
            "Crystal Palace": "Palace",
            "Brighton": "Brighton",
            "Aston Villa": "Aston Villa",
            "Brentford": "Brentford",
            "Newcastle": "Newcastle",
            "Fulham": "Fulham", 
            "Everton": "Everton",
            "Leeds": "Leeds",
            "Burnley": "Burnley",
            "West Ham": "West Ham",
            "Nottingham": "Forest",
            "Wolverhampton Wanderers": "Wolves",
        },
        // EFL Championship
        EFLChampionship: {
            "Middlesbrough": "M'brough",
            "Preston North End": "Preston",
            "Charlton Athletic": "Charlton",
            "Queens Park Rangers": "QPR",
            "QPR": "QPR",
            "Blackburn Rovers": "Blackburn",
            "Blackburn": "Blackburn",
            "Sheffield Wednesday": "Sheff Wed",
            "Sheff Wed": "Sheff Wed",
            "Sheffield United": "Sheffield Utd",
            "Sheffield Utd": "Sheffield Utd",
            "Birmingham City": "B'ham City",
            "B'ham City": "B'ham City",
            "West Bromwich Albion": "West Brom",
        },
        // Bundesliga
        Bundesliga: {
            "Bayern Munich": "Bayern",
            "Bayern München": "Bayern",
            "Bayern": "Bayern",
            "FC Bayern Munich": "Bayern",
            "FC Bayern München": "Bayern",
            "RB Leipzig": "RB Leipzig",
            "Borussia Dortmund": "Dortmund",
            "Dortmund": "Dortmund",
            "BVB Dortmund": "Dortmund",
            "VfB Stuttgart": "Stuttgart",
            "Stuttgart": "Stuttgart",
            "Bayer Leverkusen": "Leverkusen",
            "Leverkusen": "Leverkusen",
            "1. FC Köln": "FC Köln",
            "FC Köln": "FC Köln",
            "FC Cologne": "FC Köln",
            "Köln": "FC Köln",
            "Eintracht Frankfurt": "Frankfurt",
            "Frankfurt": "Frankfurt",
            "1899 Hoffenheim": "Hoffenheim",
            "Hoffenheim": "Hoffenheim",
            "TSG Hoffenheim": "Hoffenheim",
            "Werder Bremen": "Werder",
            "Werder": "Werder",
            "SV Werder Bremen": "Werder",
            "1. FC Union Berlin": "Union",
            "Union Berlin": "Union",
            "FC Union Berlin": "Union",
            "Union": "Union",
            "SC Freiburg": "Freiburg",
            "Freiburg": "Freiburg",
            "VfL Wolfsburg": "Wolfsburg",
            "Wolfsburg": "Wolfsburg",
            "Hamburger SV": "Hamburg",
            "Hamburg SV": "Hamburg",
            "Hamburg": "Hamburg",
            "Hamburger": "Hamburg",
            "Hambruger SV": "Hamburg",
            "FC Koln": "FC Köln",
            "FC Augsburg": "Augsburg",
            "Augsburg": "Augsburg",
            "FC St. Pauli": "St. Pauli",
            "St. Pauli": "St. Pauli",
            "Borussia Mönchengladbach": "M'gladbach",
            "Mönchengladbach": "M'gladbach",
            "Gladbach": "M'gladbach",
            "Borussia M'gladbach": "M'gladbach",
            "B. Monchengladbach": "M'gladbach",
            "1. FSV Mainz 05": "Mainz",
            "Mainz 05": "Mainz",
            "Mainz": "Mainz",
            "1. FC Heidenheim": "Heidenheim",
            "1. FC Heidenheim 1846": "Heidenheim",
            "FC Heidenheim 1846": "Heidenheim",
            "Heidenheim": "Heidenheim",
            "FC Heidenheim": "Heidenheim"
        },
        // Liga MX
        LigaMX: {
            "Cruz Azul": "Cruz Azúl",
            "Cruz Azúl": "Cruz Azúl",
            "Toluca": "Toluca",
            "Club América": "Club América",
            "Club America": "Club América",
            "América": "Club América",
            "America": "Club América",
            "Tigres UANL": "Tigres UANL",
            "Tigres": "Tigres UANL",
            "Monterrey": "Monterrey",
            "CF Monterrey": "Monterrey",
            "Guadalajara": "Guadalajara",
            "Guadalajara Chivas": "Guadalajara",
            "Chivas Guadalajara": "Guadalajara",
            "Juárez": "Juárez",
            "Juarez": "Juárez",
            "FC Juárez": "Juárez",
            "FC Juarez": "Juárez",
            "Pachuca": "Pachuca",
            "Club Tijuana": "Club Tijuana",
            "Tijuana": "Club Tijuana",
            "Xolos Tijuana": "Club Tijuana",
            "Santos Laguna": "Santos Laguna",
            "Santos": "Santos Laguna",
            "Atlas": "Atlas",
            "San Luis": "San Luis",
            "Atlético San Luis": "San Luis",
            "Atl. San Luis": "San Luis",
            "Atletico San Luis": "San Luis",
            "Necaxa": "Necaxa",
            "Club Necaxa": "Necaxa",
            "Pumas UNAM": "Pumas UNAM",
            "UNAM Pumas": "Pumas UNAM",
            "Pumas": "Pumas UNAM",
            "Querétaro": "Querétaro",
            "Queretaro": "Querétaro",
            "Gallos Blancos Querétaro": "Querétaro",
            "Mazatlán": "Mazatlán",
            "Mazatlan": "Mazatlán",
            "Mazatlán FC": "Mazatlán",
            "Mazatlan FC": "Mazatlán",
            "León": "León",
            "Leon": "León",
            "Club León": "León",
            "Club Leon": "León",
            "Puebla": "Puebla",
            "Puebla FC": "Puebla"
        },
        // Argentine Primera
        ArgentinePrimeraDivision: {
            "Unión de Santa Fe": "Santa Fe",
            "Union de Santa Fe": "Santa Fe",
            "Unión Santa Fe": "Santa Fe",
            "Union Santa Fe": "Santa Fe",
            "Santa Fe": "Santa Fe",
            "Belgrano de Córdoba": "CA Belgrano",
            "Belgrano de Cordoba": "CA Belgrano",
            "Club Belgrano": "CA Belgrano",
            "Belgrano": "CA Belgrano",
            "Central Cordoba": "C. Córdoba",
            "Barracas Central": "Barracas",
            "Barracas": "Barracas",
            "Estudiantes de La Plata": "Estudiantes",
            "Estudiantes L.P.": "Estudiantes",
            "Estudiantes LP": "Estudiantes",
            "Estudiantes": "Estudiantes",
            "Boca Juniors": "Boca Juniors",
            "Boca": "Boca Juniors",
            "Defensa y Justicia": "Def. y Justicia",
            "Def y Justicia": "Def. y Justicia",
            "Argentinos Juniors": "Argentinos",
            "Sarmiento Junin": "Sarmiento",
            "Argentinos": "Argentinos",
            "Belgrano": "Belgrano",
            "Club Atlético Tigre": "Tigre",
            "Tigre": "Tigre",
            "Racing Club": "Racing Club",
            "Racing": "Racing Club",
            "Banfield": "Banfield",
            "Huracán": "Huracán",
            "Huracan": "Huracán",
            "Club Atlético Huracán": "Huracán",
            "Independiente Rivadavia": "Ind. Rivadavia",
            "Ind. Rivadavia": "Ind. Rivadavia",
            "Independiente Riv": "Ind. Rivadavia",
            "Aldosivi": "Aldosivi",
            "Club Aldosivi": "Aldosivi",
            "Newell's Old Boys": "Newells",
            "Newells Old Boys": "Newells",
            "Newell's": "Newells",
            "Newells": "Newells",
            "Rosario Central": "Rosario",
            "Rosario": "Rosario",
            "Deportivo Riestra": "Dep. Riestra",
            "Dep. Riestra": "Dep. Riestra",
            "Riestra": "Dep. Riestra",
            "Lanús": "Lanús",
            "Lanus": "Lanús",
            "Club Atlético Lanús": "Lanús",
            "Vélez Sarsfield": "V. Sarsfield",
            "Velez Sarsfield": "V. Sarsfield",
            "Vélez": "V. Sarsfield",
            "Velez": "V. Sarsfield",
            "San Lorenzo": "San Lorenzo",
            "San Lorenzo de Almagro": "San Lorenzo",
            "River Plate": "River Plate",
            "River": "River Plate",
            "San Martín": "San Martín",
            "San Martin": "San Martín",
            "San Martín de San Juan": "San Martín",
            "San Martin S.J.": "San Martín",
            "San Martín de Tucumán": "San Martín",
            "Talleres de Córdoba": "Talleres",
            "Talleres de Cordoba": "Talleres",
            "Talleres": "Talleres",
            "Atlético Tucumán": "At.. Tucumán",
            "Atletico Tucuman": "At.. Tucumán",
            "Atl. Tucumán": "At.. Tucumán",
            "At Tucuman": "At.. Tucumán",
            "Sarmiento": "Sarmiento",
            "Sarmiento de Junín": "Sarmiento",
            "Instituto de Córdoba": "Instituto",
            "Instituto de Cordoba": "Instituto",
            "Instituto": "Instituto",
            "Gimnasia y Esgrima La Plata": "Gimnasia",
            "Gimnasia La Plata": "Gimnasia",
            "Gimnasia": "Gimnasia",
            "Independiente": "Independiente",
            "Club Atlético Independiente": "Independiente",
            "Club Atlético Platense": "Platense",
            "Platense": "Platense",
            "Godoy Cruz": "Godoy Cruz",
            "Godoy Cruz Antonio Tomba": "Godoy Cruz"
        },
        // Eredivisie
        Eredivisie: {
            "Feyenoord Rotterdam": "Feyenoord",
            "Feyenoord": "Feyenoord",
            "PSV Eindhoven": "PSV",
            "PSV": "PSV",
            "AZ Alkmaar": "AZ",
            "AZ": "AZ",
            "Ajax": "Ajax",
            "AFC Ajax": "Ajax",
            "FC Groningen": "Groningen",
            "Groningen": "Groningen",
            "FC Utrecht": "Utrecht",
            "Utrecht": "Utrecht",
            "Sparta Rotterdam": "Rotterdam",
            "Rotterdam": "Rotterdam",
            "NEC Nijmegen": "Nijmegen",
            "Nijmegen": "Nijmegen",
            "FC Twente": "Twente",
            "Twente": "Twente",
            "Heerenveen": "Heerenven",
            "SC Heerenveen": "Heerenven",
            "Go Ahead Eagles": "G.A. Eagles",
            "G.A. Eagles": "G.A. Eagles",
            "Go Ahead Eagles Deventer": "G.A. Eagles",
            "Fortuna Sittard": "Sittard",
            "Sittard": "Sittard",
            "NAC Breda": "NAC Breda",
            "NAC": "NAC Breda",
            "FC Volendam": "Volendam",
            "Volendam": "Volendam",
            "Excelsior": "Excelsior",
            "Excelsior Rotterdam": "Excelsior",
            "PEC Zwolle": "Zwolle",
            "Zwolle": "Zwolle",
            "Telstar": "Telstar",
            "SC Telstar": "Telstar",
            "Heracles": "Heracles",
            "Heracles Almelo": "Heracles"
        },
        // Women's Super League
        WomensSuperLeague: {
            "Chelsea": "Chelsea",
            "Chelsea FC Women": "Chelsea",
            "Manchester City": "Man City",
            "Man City": "Man City",
            "Manchester City Women": "Man City",
            "Manchester United": "Man United",
            "Man United": "Man United",
            "Manchester United Women": "Man United",
            "Manchester Utd": "Man United",
            "Manchesterd United": "Man United",
            "Tottenham Hotspur": "Tottenham",
            "Tottenham": "Tottenham",
            "Tottenham Hotspur Women": "Tottenham",
            "Arsenal": "Arsenal",
            "Arsenal Women": "Arsenal",
            "London City Lionesses": "London",
            "London": "London",
            "Brighton & Hove Albion": "Brighton",
            "Brighton": "Brighton",
            "Brighton & Hove Albion Women": "Brighton",
            "Aston Villa": "Aston Villa",
            "Aston Villa Women": "Aston Villa",
            "Everton": "Everton",
            "Everton Women": "Everton",
            "Leicester City": "Leicester",
            "Leicester": "Leicester",
            "Leicester City Women": "Leicester",
            "Liverpool": "Liverpool",
            "Liverpool Women": "Liverpool",
            "West Ham United": "West Ham",
            "West Ham": "West Ham",
            "West Ham United Women": "West Ham"
        },
        // OHL (Ontario Hockey League)
        OHL: {
            "Windsor Spitfires": "Spitfires",
            "Spitfires": "Spitfires",
            "Kitchener Rangers": "Rangers",
            "Rangers": "Rangers",
            "Owen Sound Attack": "Attack",
            "Attack": "Attack",
            "Sault Ste. Marie Greyhounds": "Greyhounds",
            "Greyhounds": "Greyhounds",
            "London Knights": "Knights",
            "Knights": "Knights",
            "Flint Firebirds": "Firebirds",
            "Firebirds": "Firebirds",
            "Saginaw Spirit": "Spirit",
            "Spirit": "Spirit",
            "Guelph Storm": "Storm",
            "Storm": "Storm",
            "Sarnia Sting": "Sting",
            "Sting": "Sting",
            "Erie Otters": "Otters",
            "Otters": "Otters",
            "Hamilton Bulldogs": "Bulldogs",
            "Bulldogs": "Bulldogs",
            "Brantford Bulldogs": "Bulldogs",
            "Niagara IceDogs": "IceDogs",
            "IceDogs": "IceDogs",
            "Ottawa 67's": "67s",
            "Ottawa 67s":"67s",
            "67's": "67s",
            "67s": "67s",
            "Barrie Colts": "Colts",
            "Colts": "Colts",
            "Peterborough Petes": "Petes",
            "Petes": "Petes",
            "Kingston Frontenacs": "Frotenacs",
            "Frontenacs": "Frotenacs",
            "Frotenacs": "Frotenacs",
            "North Bay Battalion": "Battalion",
            "Battalion": "Battalion",
            "Mississauga Steelheads": "Steelheads",
            "Steelheads": "Steelheads",
            "Oshawa Generals": "Generals",
            "Generals": "Generals",
            "Sudbury Wolves": "Wolves",
            "Wolves": "Wolves"
        },
        // LaLiga
        LaLiga: {
            "Real Madrid": "Real Madrid",
            "Barcelona": "Barcelona",
            "FC Barcelona": "Barcelona",
            "Villarreal": "Villarreal",
            "Villarreal CF": "Villarreal",
            "Atletico Madrid": "Atlético",
            "Atlético Madrid": "Atleti",
            "Espanyol": "Espanyol",
            "RCD Espanyol": "Espanyol",
            "Getafe": "Getafe",
            "Getafa": "Getafe",
            "Getafe CF": "Getafe",
            "Real Betis": "Real Betis",
            "Betis": "Real Betis",
            "Deportivo Alavés": "Alavés",
            "Alavés": "Alavés",
            "Alaves": "Alavés",
            "Elche": "Elche",
            "Elche CF": "Elche",
            "Rayo Vallecano": "R. Vallecano",
            "Rayo": "R. Vallecano",
            "Athletic Club": "Athletic Club",
            "Athletic Bilbao": "Athletic Club",
            "Athletic": "Athletic Club",
            "Celta Vigo": "Celta Vigo",
            "Celta": "Celta Vigo",
            "RC Celta": "Celta Vigo",
            "Sevilla": "Sevilla",
            "Sevilla FC": "Sevilla",
            "Real Sociedad": "Real Sociedad",
            "Sociedad": "Real Sociedad",
            "Osasuna": "Osasuna",
            "CA Osasuna": "Osasuna",
            "Mallorca": "Mallorca",
            "RCD Mallorca": "Mallorca",
            "Levante": "Levante",
            "Levante UD": "Levante",
            "Valencia": "Valencia",
            "Valencia CF": "Valencia",
            "Real Oviedo": "Oviedo",
            "Oviedo": "Oviedo",
            "R. Oviedo": "Oviedo",
            "Girona": "Girona",
            "Girona FC": "Girona"
        },
        // MLS
        MLS: {
            "Philadelphia Union": "Union",
            "FC Cincinnati": "Cincinnati",
            "Inter Miami CF": "Miami",
            "Inter Miami": "Miami",
            "Charlotte FC": "Charlotte",
            "Charlotte": "Charlotte",
            "New York City FC": "NYCFC",
            "New York City": "NYCFC",
            "NYCFC": "NYCFC",
            "Nashville SC": "Nashville",
            "Nashville": "Nashville",
            "Columbus Crew": "Columbus",
            "Chicago Fire FC": "Chicago",
            "Chicago Fire": "Chicago",
            "Orlando City SC": "Orlando",
            "Orlando City": "Orlando",
            "New York Red Bulls": "Red Bulls",
            "NY Red Bulls": "Red Bulls",
            "New England Revolution": "Revolution",
            "Revolution": "Revolution",
            "Toronto FC": "Toronto",
            "CF Montréal": "Montréal",
            "CF Montreal": "Montréal",
            "Atlanta United FC": "Atlanta",
            "Atlanta United": "Atlanta",
            "Atlanta Utd": "Atlanta",
            "D.C. United": "DC United",
            "DC United": "DC United",
            "San Diego FC": "San Diego",
            "Vancouver Whitecaps": "Vancouver",
            "Vancouver Whitecaps FC": "Vancouver",
            "Los Angeles FC": "LAFC",
            "LAFC": "LAFC",
            "Minnesota United FC": "MNUFC",
            "Minnesota United": "MNUFC",
            "Seattle Sounders FC": "Seattle",
            "Seattle Sounders": "Seattle",
            "Austin FC": "Austin",
            "FC Dallas": "Dallas",
            "Portland Timbers": "Portland",
            "Portland Timbers FC": "Portland",
            "Real Salt Lake": "Salt Lake",
            "San Jose Earthquakes": "San José",
            "Colorado Rapids": "Colorado",
            "Houston Dynamo FC": "Houston",
            "Houston Dynamo": "Houston",
            "St. Louis CITY SC": "St Louis",
            "St. Louis City SC": "St Louis",
            "St. Louis City": "St Louis",
            "Los Angeles Galaxy": "LA Galaxy",
            "LA Galaxy": "LA Galaxy",
            "Sporting Kansas City": "Sporting",
            "Sporting KC": "Sporting"
        },
        // NCAAM
        NCAAM: {
            "American University": "American",
            "Oklahoma State": "OK State",
            "Arkansas Baptist": "Ark Baptist",
            "NC Greensboro": "UNC-Greensb",
            "South Alabama": "S Alabama",
            "NC Wilmington": "UNC Wilm",
            "Missouri Southern State": "MO So. State",
            "Penn State-York": "Penn St-York",
            "UMBC Retrievers": "UMBC",
            "Converse Valkyries": "Converse",
            "East Tennessee St": "E TN St",
            "E Tenn State": "E TN St",
            "Caldwell College": "Caldwell",
            "Georgia Southern": "GA Southern",
            "EWU Phantoms": "East West U",
            "SIU-Edwardsville": "SIU-E",
            "Siu Edwardsville": "SIU-E",
            "South Carolina": "S Carolina",
            "Southeast Missouri State": "SE MO St",
            "Northern Arizona": "N Arizona",
            "Penn State Hazleton": "PS Hazleton",
            "Montana-Western": "MT-Western",
            "Mount St. Mary's": "Mt St Mary's",
            "St. Joseph's (Brooklyn)": "St. Joseph's",
            "N. Carolina A&T": "NC A&T",
            "West Coast Baptist": "W Coast Bapt",
            "Utah Valley State": "Utah Valley St",
            "CBS Ambassadors": "CBS",
            "College Of Biblical Studies": "CBS",
            "San Diego State": "San Diego St",
            "IU Indianapolis": "IU Indy",
            "South Dakota State": "S Dakota St",
            "Crown College": "Crown Coll.",
            "St. Thomas-Minnesota": "St Thomas",
            "Eastern Washington": "EWU",
            "Massachusetts": "UMass",
            "Arkansas-Pine Bluff": "AR-Pine Bluff",
            "Salish Kootenai": "S Kootenai",
            "Bethesda University": "Bethesda",
            "San Diego Toreros": "San Diego",
            "San Francisco State": "SF State",
            "UC Santa Barbara": "UCSB",
            "New Mexico State": "NM State",
            "Maine Black Bears": "Maine",
            "Humboldt State": "Humboldt",
            "Dominican Penguins": "Dominican",
            "Sacramento State": "Sac State",
            "Long Beach State": "LB State",
            "Gilbert Buccaneers": "Park U",
            "Louisiana Tech": "LA Tech",
            "RIT Tigers": "RIT",
            "Middle Tenn. St.": "Mid TN St",
            "Carolina University": "Carolina U",
            "Saint Josephs Hawks": "St Joseph's",
            "Queens Royals": "Queens",
            "Southern Indiana": "So. Indiana",
            "UTSA Roadrunners": "UTSA",
            "Regent University": "Regent",
            "Southern Virginia": "So. Virginia",
            "Miss. Valley St.": "MS Valley St",
            "MUW Owls": "MUW",
            "Dallas Univ.": "Dallas U",
            "Prairie View A&M": "Prairie View",
            "Dickinson Red Devils": "Dickinson",
            "Brigham Young": "BYU",
            "San Jose State": "San Jose St",
            "Southern Univ.": "Southern",
            "Md.-East. Shore": "MD E. Shore",
            "Delaware State": "Delaware St",
            "Washington & Lee": "Wash & Lee",
            "James Madison": "JMU",
            "South Dakota Coyotes": "S. Dakota",
            "South Dakota St.": "S Dakota St",
            "South Dakota State": "S Dakota St",
            "Texas A&M SA Jaguars": "TX A&M-SA",
            "East Texas A&M": "E. TX A&M",
            "Appalachian State": "App State",
            "Richmond Spiders": "Richmond",
            "Southern Jaguars": "Southern",
            "North Dakota St": "N Dakota St",
            "North Dakota State": "N Dakota St",
            "Northwest Indian": "NW Indian",
            "North Alabama": "N Alabama",
            "North Carolina": "UNC",
            "Long Beach State": "LB State",
            "Ottawa Spirit": "Ottowa (AZ)",
            "Pacific Lutheran": "Pac. Lutheran",
            "East. Washington": "EWU",
            "Loyola Marymount": "Loyola Mary.",
            "Boston University": "Boston U",
            "Boston College": "Boston Coll",
            "Colorado State": "Colorado St",
            "Colorado State Rams": "Colorado St",
            "Coppin State": "Coppin St",
            "Eastern Kentucky": "E Kentucky",
            "Fairleigh Dickinson": "Fairleigh D",
            "George Washington": "G Washington",
            "Montana State": "Montana St",
            "Nicholls State": "Nicholls St",
            "North Florida": "N Florida",
            "Northern Kentucky": "N Kentucky",
            "South Florida": "USF",
            "Southern Illinois": "So Illinois",
            "St. Bonaventure": "St. Bon",
            "Westminster UT": "Westminster",
            "Wisc. Milwaukee": "Wisc.-Milw.",
            "Loyola Chicago": "Loyola CHI",
            "Florida International": "FIU",
            "San Jose State": "San Jose St",
            "Michigan State": "Mich St",
            "Kentucky Christian": "KY Christian",
            "Bryant University": "Bryant",
            "University of the Cumberlands (KY)": "Cumberlands",
            "Western Carolina": "W Carolina",
            "Texas A&M-CC": "TX A&M-CC",
            "Central Arkansas": "C Arkansas",
            "Loyola Maryland": "Loyola Mary.",
            "Central Connecticut State": "C CT State",
            "Western Michigan": "W Michigan",
            "Cleveland State": "Cleve St",
            "Long Beach St": "LB State",
            "Incarnate Word": "Inc. Word",
            "Loras Duhawks": "Loras",
            "Tennessee State": "TN State",
            "CS Monterey Bay": "CS Monterrey",
            "St. Mary's (TX)": "St Mary's TX",
            "Trinity College of Jacksonville": "Trinity (Jax)",
            "Saint John's (MN)": "St John's MN",
            "Alaska Anchorage": "AK-Anch",
            "Queens University": "Queens",
            "Gardner-Webb": "Gard-Webb",
            "Dallas Christian": "Dallas Christ",
            "Texas A&M-Corpus Christi": "TX A&M-CC",
            "Dakota Wesleyan": "Dak Wesley",
            "Western Kentucky": "W Kentucky",
            "Morehead State": "Morehead St",
            "Kennesaw State": "Ken'saw St",
            "Rhodes Lynx": "Rhodes",
            "VCU Rams": "VCU",
            "Memphis Tigers": "Memphis",
            "Louisiana Monroe": "UL-Monroe",
            "Tennessee Tech": "TN Tech",
            "Coastal Georgia": "Coastal GA",
            "Southwest Adventist": "SW Adventist",
            "Florida Atlantic": "FAU",
            "Western Illinois": "W Illinois",
            "Alabama State": "Ala St",
            "CSU Bakersfield": "CSU-B'field",
            "Eastern Oregon": "E Oregon",
            "Stephen F. Austin": "S.F. Austin",
            "UCF Knights": "UCF",
            "Illinois (Chi.)": "UIC",
            "Illinois State": "Illinois St",
            "Mercyhurst Lakers": "Mercyhurst",
            "Miami (Ohio)": "Miami (OH)",
            "Nobel Knights": "Nobel",
            "Rockford University": "Rockford",
            "Florida Gulf Coast": "FGCU",
            "Cal State Bakersfield": "CS Bakersfield",
            "Mississippi Valley State": "MS Valley St",
            "Bethune-Cookman": "Beth-Cook",
            "Tennessee Southern": "TN Southern",
            "Washington College (MD)": "Wash Coll",
            "California Baptist": "CA Baptist",
            "Purdue Fort Wayne": "Purdue FW",
            "Rutgers-Camden": "Rutgers-Cam",
            "North Carolina Central": "NC Central",
            "Charleston Southern": "Charleston",
            "Eastern Illinois": "E Illinois",
            "George Mason": "Geo Maso",
            "Northern Illinois": "N Illinois",
            "SMU Mustangs": "SMU",
            "SMU": "SMU",
            "Vermont State - Johnson": "VT St-Johnson",
            "VTSU Johnson": "VTSU-Johns.",
            "University of Puget Sound": "Puget Sound",
            "Puget Sound": "Puget Sound",
            "North Carolina A&T": "NC A&T",
            "Maryland Eastern Shore": "MD E Shore",
            "Mount Marty College": "Mt Marty",
            "Houston Christian": "Hou Christian",
            "Grand Canyon": "GCU",
            "Virginia-Lynchburg": "VA-Lynch",
            "East Tennessee State": "E TN St",
            "William & Mary": "Wm & Mary",
            "SUNY-Maritime": "SUNY-Mari",
            "Eastern Michigan": "E Michigan",
            "UNC Greensboro": "UNC G'boro",
            "Indiana University East": "IU East",
            "Long Island University": "LIU",
            "Saint Mary of the Woods College": "St Mary Woods",
            "Central Michigan": "C Michigan",
            "Arkansas State": "Ark St",
            "Washington State": "Wash St",
            "Manhattan Christian": "Manhatt Chr",
            "Abilene Christian": "Abilene Chr",
            "Columbia College (SC)": "Columbia SC",
            "Columbia (SC)": "Columbia SC",
            "Evergreen State": "Evergreen St",
            "UT Rio Grande Valley": "UTRGV",
            "Warren Wilson": "Warr Wilson",
            "Cal State Northridge": "CS-Northridge",
            "Cal State Fullerton": "Fullerton",
            "North Texas": "N Texas",
            "San José State": "San José St",
            "Northwestern State": "NW State",
            "Cleary University": "Cleary",
            "Central Connecticut": "Central CT",
            "West Virginia": "W Virginia",
            "Southern Wesleyan": "S Wesleyan",
            "South Carolina State": "So Car St",
            "Texas Southern": "TX Southern",
            "Miami (OH)-Middletown": "MIA (OH)-Middletown",
            "Bowling Green": "Bowl Green",
            "Ohio Wesleyan": "OH Wesleyan",
            "Mississippi State": "MS State",
            "Northern Colorado": "N Colorado",
            "East-West University": "East-West",
            "York College Nebraska": "York (NE)",
            "Colorado-Colorado Springs": "CO-Col Springs",
            "Cal State East Bay": "CS East Bay",
            "Middle Tennessee": "Middle TN",
            "Southwestern Christian": "SW Christian",
            "Kansas Christian": "KS Christian",
            "New Hampshire": "New Hamp",
            "Youngstown State": "Youngstown St",
            "Brewton-Parker": "Brewt-Parker",
            "South Carolina Upstate": "SC Upstate",
            "Mid-Atlantic Christian": "Mid-Atl Christian",
            "Georgian Court University": "Georgian Ct",
            "Agnes Scott College": "Agnes Scott",
            "Wesleyan College (GA)": "Wesleyan (GA)",
            "Jacksonville State": "Jax State",
            "Simmons College (KY)": "Simmons (KY)",
            "Sacramento State": "Sac State",
            "Wayne State (MI)": "Wayne St (MI)",
            "Alabama State": "AL State",
            "Colorado Christian": "CO Christian",
            "Vanderbilt Commodores": "Vanderbilt",
            "Lehman College": "Lehman",
            "Notre Dame (MD)": "N Dame (MD)",
            "Youngstown St": "Youngstown",
            "Simpson University (CA)": "Simpson",
            "Coastal Carolina": "Coastal Car",
            "Lourdes University": "Lourdes",
            "Harris-Stowe State": "Harris-Stowe",
            "UNC Wilmington": "UNC-Wilm",
            "Southern-New Orleans": "Southern (NO)",
            "Mid-Atl Christian": "Mid-Atl Christ.",
            "Southwestern Adventist": "SW Adventist",
            "Maine-Fort Kent": "Maine-Ft Kent",
            "Judson University": "Judson",
            "Wisconsin-Lutheran": "WI-Luthern",
            "Dickinson State (ND)": "Dickinson St",
            "Gwynedd-Mercy": "Gwynn-Mercy",
            "Central Baptist College": "Cent Baptist",
            "Lindsey Wilson": "Lind Wilson",
            "CS Bakersfield": "CS-Bakersf",
            "Western Oregon": "W Oregon"
        },
        // NCAAF
        NCAAF: {
            // FBS Teams - Remove all mascots
            "Air Force Falcons": "Air Force",
            "Akron Zips": "Akron",
            "Alabama Crimson Tide": "Alabama",
            "Appalachian State Mountaineers": "App State",
            "Arizona State Sun Devils": "Arizona St",
            "Arizona Wildcats": "Arizona",
            "Arkansas Razorbacks": "Arkansas",
            "Arkansas State Red Wolves": "Arkansas St",
            "Army Black Knights": "Army",
            "Auburn Tigers": "Auburn",
            "Ball State Cardinals": "Ball State",
            "Baylor Bears": "Baylor",
            "Boise State Broncos": "Boise State",
            "Boston College Eagles": "Boston College",
            "Bowling Green Falcons": "Bowling Green",
            "Buffalo Bulls": "Buffalo",
            "BYU Cougars": "BYU",
            "California Golden Bears": "California",
            "Central Michigan Chippewas": "Central Michigan",
            "Charlotte 49ers": "Charlotte",
            "Cincinnati Bearcats": "Cincinnati",
            "Clemson Tigers": "Clemson",
            "Coastal Carolina Chanticleers": "Coastal Carolina",
            "Colorado Buffaloes": "Colorado",
            "Colorado State Rams": "Colorado State",
            "Duke Blue Devils": "Duke",
            "East Carolina Pirates": "East Carolina",
            "Eastern Michigan Eagles": "Eastern Michigan",
            "FIU Panthers": "FIU",
            "Florida Atlantic Owls": "Florida Atlantic",
            "Florida Gators": "Florida",
            "Florida State Seminoles": "Florida State",
            "Fresno State Bulldogs": "Fresno State",
            "Georgia Bulldogs": "Georgia",
            "Georgia Southern Eagles": "Georgia Southern",
            "Georgia State Panthers": "Georgia State",
            "Georgia Tech Yellow Jackets": "GA Tech",
            "Hawai'i Rainbow Warriors": "Hawai'i",
            "Houston Cougars": "Houston",
            "Illinois Fighting Illini": "Illinois",
            "Indiana Hoosiers": "Indiana",
            "Iowa Hawkeyes": "Iowa",
            "Iowa State Cyclones": "Iowa State",
            "Jacksonville State Gamecocks": "Jacksonville State",
            "James Madison Dukes": "James Madison",
            "Kansas Jayhawks": "Kansas",
            "Kansas State Wildcats": "Kansas State",
            "Kent State Golden Flashes": "Kent State",
            "Kennesaw State Owls": "Kennesaw State",
            "Kentucky Wildcats": "Kentucky",
            "Liberty Flames": "Liberty",
            "Louisiana Ragin' Cajuns": "Louisiana",
            "Louisiana Tech Bulldogs": "Louisiana Tech",
            "Louisiana-Monroe Warhawks": "Louisiana-Monroe",
            "Louisville Cardinals": "Louisville",
            "LSU Tigers": "LSU",
            "Marshall Thundering Herd": "Marshall",
            "Maryland Terrapins": "Maryland",
            "Memphis Tigers": "Memphis",
            "Miami Hurricanes": "Miami",
            "Miami (OH) RedHawks": "Miami (OH)",
            "Michigan State Spartans": "Michigan State",
            "Michigan Wolverines": "Michigan",
            "Middle Tennessee Blue Raiders": "Middle Tennessee",
            "Minnesota Golden Gophers": "Minnesota",
            "Mississippi State Bulldogs": "Mississippi State",
            "Missouri Tigers": "Missouri",
            "Navy Midshipmen": "Navy",
            "NC State Wolfpack": "NC State",
            "Nebraska Cornhuskers": "Nebraska",
            "Nevada Wolf Pack": "Nevada",
            "New Mexico Lobos": "New Mexico",
            "New Mexico State Aggies": "New Mexico State",
            "North Carolina Tar Heels": "North Carolina",
            "North Texas Mean Green": "North Texas",
            "Northern Illinois Huskies": "Northern Illinois",
            "Northwestern Wildcats": "Northwestern",
            "Notre Dame Fighting Irish": "Notre Dame",
            "Ohio Bobcats": "Ohio",
            "Ohio State Buckeyes": "Ohio State",
            "Oklahoma Sooners": "Oklahoma",
            "Oklahoma State Cowboys": "Oklahoma State",
            "Old Dominion Monarchs": "Old Dominion",
            "Ole Miss Rebels": "Ole Miss",
            "Oregon Ducks": "Oregon",
            "Oregon State Beavers": "Oregon State",
            "Penn State Nittany Lions": "Penn State",
            "Pittsburgh Panthers": "Pittsburgh",
            "Purdue Boilermakers": "Purdue",
            "Rice Owls": "Rice",
            "Rutgers Scarlet Knights": "Rutgers",
            "Sam Houston Bearkats": "Sam Houston",
            "San Diego State Aztecs": "San Diego St",
            "San José State Spartans": "San José State",
            "SMU Mustangs": "SMU",
            "South Alabama Jaguars": "South Alabama",
            "South Carolina Gamecocks": "South Carolina",
            "South Florida Bulls": "South Florida",
            "Southern Miss Golden Eagles": "Southern Miss",
            "Stanford Cardinal": "Stanford",
            "Syracuse Orange": "Syracuse",
            "TCU Horned Frogs": "TCU",
            "Temple Owls": "Temple",
            "Tennessee Volunteers": "Tennessee",
            "Texas A&M Aggies": "Texas A&M",
            "Texas Longhorns": "Texas",
            "Texas State Bobcats": "Texas State",
            "Texas Tech Red Raiders": "Texas Tech",
            "Toledo Rockets": "Toledo",
            "Troy Trojans": "Troy",
            "Tulane Green Wave": "Tulane",
            "Tulsa Golden Hurricane": "Tulsa",
            "UAB Blazers": "UAB",
            "UCF Knights": "UCF",
            "UCLA Bruins": "UCLA",
            "UConn Huskies": "UConn",
            "UL Monroe Warhawks": "UL Monroe",
            "UMass Minutemen": "UMass",
            "UNLV Rebels": "UNLV",
            "USC Trojans": "USC",
            "Utah State Aggies": "Utah State",
            "Utah Utes": "Utah",
            "UTEP Miners": "UTEP",
            "UTSA Roadrunners": "UTSA",
            "Vanderbilt Commodores": "Vanderbilt",
            "Virginia Cavaliers": "Virginia",
            "Virginia Tech Hokies": "Virginia Tech",
            "Wake Forest Demon Deacons": "Wake Forest",
            "Washington Huskies": "Washington",
            "Washington State Cougars": "Washington State",
            "West Virginia Mountaineers": "West Virginia",
            "Western Kentucky Hilltoppers": "Western Kentucky",
            "Western Michigan Broncos": "Western Michigan",
            "Wisconsin Badgers": "Wisconsin",
            "Wyoming Cowboys": "Wyoming",
            
            // FCS and Other Division Teams - Remove all mascots
            "Abilene Christian Wildcats": "Abilene Christian",
            "Albany Great Danes": "Albany",
            "Alcorn State Braves": "Alcorn State",
            "Austin Peay Governors": "Austin Peay",
            "Bethune-Cookman Wildcats": "Bethune-Cookman",
            "Brown Bears": "Brown",
            "Bryant Bulldogs": "Bryant",
            "Bucknell Bison": "Bucknell",
            "Butler Bulldogs": "Butler",
            "Cal Poly Mustangs": "Cal Poly",
            "Campbell Fighting Camels": "Campbell",
            "Central Arkansas Bears": "Central Arkansas",
            "Central Connecticut Blue Devils": "Central Connecticut",
            "Charleston Southern Buccaneers": "Charleston Southern",
            "Chattanooga Mocs": "Chattanooga",
            "Colgate Raiders": "Colgate",
            "Columbia Lions": "Columbia",
            "Cornell Big Red": "Cornell",
            "Dartmouth Big Green": "Dartmouth",
            "Davidson Wildcats": "Davidson",
            "Delaware Fightin' Blue Hens": "Delaware",
            "Delaware State Hornets": "Delaware State",
            "Drake Bulldogs": "Drake",
            "Duquesne Dukes": "Duquesne",
            "East Tennessee State Buccaneers": "East Tennessee State",
            "Eastern Illinois Panthers": "Eastern Illinois",
            "Eastern Kentucky Colonels": "Eastern Kentucky",
            "Eastern Washington Eagles": "Eastern Washington",
            "Elon Phoenix": "Elon",
            "Fordham Rams": "Fordham",
            "Furman Paladins": "Furman",
            "Gardner-Webb Runnin' Bulldogs": "Gardner-Webb",
            "Georgetown Hoyas": "Georgetown",
            "Grambling Tigers": "Grambling",
            "Hampton Pirates": "Hampton",
            "Harvard Crimson": "Harvard",
            "Holy Cross Crusaders": "Holy Cross",
            "Howard Bison": "Howard",
            "Idaho State Bengals": "Idaho State",
            "Idaho Vandals": "Idaho",
            "Illinois State Redbirds": "Illinois State",
            "Incarnate Word Cardinals": "Incarnate Word",
            "Indiana State Sycamores": "Indiana State",
            "Jackson State Tigers": "Jackson State",
            "Lafayette Leopards": "Lafayette",
            "Lamar Cardinals": "Lamar",
            "Lehigh Mountain Hawks": "Lehigh",
            "Lindenwood Lions": "Lindenwood",
            "Maine Black Bears": "Maine",
            "Marist Red Foxes": "Marist",
            "McNeese Cowboys": "McNeese",
            "Mercer Bears": "Mercer",
            "Missouri State Bears": "Missouri State",
            "Monmouth Hawks": "Monmouth",
            "Montana Grizzlies": "Montana",
            "Montana State Bobcats": "Montana State",
            "Morehead State Eagles": "Morehead State",
            "Morgan State Bears": "Morgan State",
            "Murray State Racers": "Murray State",
            "New Hampshire Wildcats": "New Hampshire",
            "Nicholls Colonels": "Nicholls",
            "Norfolk State Spartans": "Norfolk State",
            "North Alabama Lions": "North Alabama",
            "North Carolina A&T Aggies": "North Carolina A&T",
            "North Carolina Central Eagles": "North Carolina Central",
            "North Dakota Fighting Hawks": "North Dakota",
            "North Dakota State Bison": "North Dakota State",
            "Northeastern Huskies": "Northeastern",
            "Northern Arizona Lumberjacks": "Northern Arizona",
            "Northern Colorado Bears": "Northern Colorado",
            "Northern Iowa Panthers": "Northern Iowa",
            "Northwestern State Demons": "Northwestern State",
            "Penn Quakers": "Penn",
            "Portland State Vikings": "Portland State",
            "Prairie View A&M Panthers": "Prairie View A&M",
            "Presbyterian Blue Hose": "Presbyterian",
            "Princeton Tigers": "Princeton",
            "Rhode Island Rams": "Rhode Island",
            "Richmond Spiders": "Richmond",
            "Robert Morris Colonials": "Robert Morris",
            "Sacramento State Hornets": "Sacramento State",
            "Sacred Heart Pioneers": "Sacred Heart",
            "Samford Bulldogs": "Samford",
            "San Diego Toreros": "San Diego",
            "SE Louisiana Lions": "SE Louisiana",
            "South Carolina State Bulldogs": "South Carolina State",
            "South Dakota Coyotes": "South Dakota",
            "South Dakota State Jackrabbits": "South Dakota State",
            "Southeast Missouri State Redhawks": "Southeast Missouri State",
            "Southern Illinois Salukis": "Southern Illinois",
            "Southern Jaguars": "Southern",
            "Southern Utah Thunderbirds": "Southern Utah",
            "St. Thomas Tommies": "St. Thomas",
            "Stephen F. Austin Lumberjacks": "Stephen F. Austin",
            "Stetson Hatters": "Stetson",
            "Stony Brook Seawolves": "Stony Brook",
            "Tarleton State Texans": "Tarleton State",
            "Tennessee State Tigers": "Tennessee State",
            "Tennessee Tech Golden Eagles": "Tennessee Tech",
            "Texas Southern Tigers": "Texas Southern",
            "The Citadel Bulldogs": "The Citadel",
            "Towson Tigers": "Towson",
            "UC Davis Aggies": "UC Davis",
            "UT Martin Skyhawks": "UT Martin",
            "Valparaiso Beacons": "Valparaiso",
            "Villanova Wildcats": "Villanova",
            "VMI Keydets": "VMI",
            "Wagner Seahawks": "Wagner",
            "Weber State Wildcats": "Weber State",
            "Western Carolina Catamounts": "Western Carolina",
            "Western Illinois Leathernecks": "Western Illinois",
            "William & Mary Tribe": "William & Mary",
            "Wofford Terriers": "Wofford",
            "Yale Bulldogs": "Yale",
            "Youngstown State Penguins": "Youngstown State",
            
            // Short name variants without mascots (for data that comes without mascots)
            "Massachusetts": "UMass",
            "Brigham Young": "BYU",
            "IU Indianapolis": "IU Indy"
        },
        // NCAAW
        NCAAW: {
            "SMU Mustangs": "SMU",
            "Oklahoma Sooners": "Oklahoma",
            "Southern Illinois": "So Illinois",
            "Tennessee Volunteers": "Tennessee",
            "Richmond Spiders": "Richmond",
            "Cincinnati Bearcats": "Cincinnati",
            "New Haven Chargers": "New Haven",
            "MD-E. Shore": "MD E. Shore",
            "Mercyhurst Lakers": "Mercyhurst",
            "Appalachian State": "App State",
            "California Baptist": "Cal Baptist",
            "Central Michigan": "C Michigan",
            "Central Michigan Chippewas": "C Michigan",
            "Coastal Carolina": "Coastal Car",
            "Colorado Buffaloes": "Colorado",
            "Cleveland State": "Cleve. St",
            "Michigan State": "Michigan St",
            "Albany Great Danes": "UAlbany",
            "Kennesaw State": "Kennesaw St",
            "Youngstown State": "Youngstown",
            "Eastern Kentucky": "E Kentucky",
            "Mount St. Mary's": "Mt St Mary's",
            "Florida Atlantic": "FAU",
            "RIT Tigers": "RIT",
            "Middle Tenn. St.": "Mid TN St",
            "Florida Mem.": "FL Memorial",
            "Furman Paladins": "Furman",
            "Lipscomb Bisons": "Lipscomb",
            "Montana Griz": "Montana",
            "Central Connecticut State": "C. Conn. St",
            "Fairleigh Dickinson": "Fairleigh D",
            "Washington Huskies": "Washington",
            "San Jose State": "San Jose St",
            "UNC Greensboro": "UNC-G'boro",
            "UNC Wilmington": "UNC Wilm.",
            "Central Arkansas": "C Arkansas",
            "South Carolina Upstate": "SC Upstate",
            "Virginia Cavaliers": "Virginia",
            "Carolina University": "Carolina U",
            "Saint Josephs Hawks": "St Joseph's",
            "Queens Royals": "Queens",
            "Southern Indiana": "So. Indiana",
            "UTSA Roadrunners": "UTSA",
            "Regent University": "Regent",
            "Southern Virginia": "So. Virginia",
            "Miss. Valley St.": "MS Valley St",
            "MUW Owls": "MUW",
            "Dallas Univ.": "Dallas U",
            "Prairie View A&M": "Prairie View",
            "Dickinson Red Devils": "Dickinson",
            "Arlington Baptist Patriots": "Arl. Bapt.",
            "California State-Stanislaus Warriors": "CSU Stanis.",
            "Md.-East. Shore": "MD E. Shore",
            "Delaware State": "Delaware St",
            "Washington & Lee": "Wash & Lee",
            "James Madison": "JMU",
            "South Dakota Coyotes": "S. Dakota",
            "Texas A&M SA Jaguars": "TX A&M-SA",
            "East Texas A&M": "E. TX A&M",
            "North Dakota St": "N Dakota St",
            "North Dakota State": "N Dakota St",
            "Florida Gators": "Florida",
            "Ohio Bobcats": "Ohio",
            "Florida State": "Florida St",
            "Iowa Hawkeyes": "Iowa",
            "Northwest Indian": "NW Indian",
            "North Alabama": "N Alabama",
            "Long Beach State": "LB State",
            "Northern Kentucky": "N Kentucky",
            "Incarnate Word": "Inc. Word",
            "Tennessee State": "TN State",
            "CS Monterey Bay": "CS Monterrey",
            "St. Mary's (TX)": "St Mary's TX",
            "Trinity College of Jacksonville": "Trinity (Jax)",
            "Saint John's (MN)": "St John's MN",
            "Alaska Anchorage": "AK-Anch",
            "Pittsburgh-Johnstown": "Pitt-Johns.",
            "Ottawa Spirit": "Ottowa (AZ)",
            "Pacific Lutheran": "Pac. Lutheran",
            "East. Washington": "EWU",
            "Eastern Washington": "EWU",
            "IU Indianapolis": "IU Indy",
            "South Dakota State": "S Dakota St",
            "Crown College": "Crown Coll.",
            "St. Thomas-Minnesota": "St Thomas",
            "Massachusetts": "UMass",
            "College Of Biblical Studies": "CBS",
            "Arkansas-Pine Bluff": "AR-Pine Bluff",
            "Salish Kootenai": "S Kootenai",
            "Loyola Marymount": "Loyola Mary.",
            "N. Carolina At&T": "NC A&T",
            "NC State": "NC State",
            "Notre Dame": "Notre Dame",
            "Purdue": "Purdue",
            "Boston": "Boston University",
            "Hofstra": "Hofstra",
            "Tulane": "Tulane",
            "Tulsa": "Tulsa",
            "Houston": "Houston",
            "UC Irvine Anteaters": "UC Irvine",
            "Nebraska": "Nebraska",
            "Boise State": "Boise State",
            "Iowa State": "Iowa State",
            "Louisville": "Louisville",
            "Southern Univ.": "Southern",
            "St. Peters": "St. Peter's",
            "Illinois Fighting Illini": "Illinois",
            "SE Missouri State": "SE MO State",
            "Southeast Missouri State": "SE MO St",
            "Tennessee Tech": "TN Tech",
            "Western Michigan": "W Michigan",
            "Northern Arizona": "N Arizona",
            "Penn State Hazleton": "PS Hazleton",
            "Montana-Western": "MT-Western",
            "SIU-Edwardsville": "SIU-E",
            "South Carolina": "S Carolina",
            "Providence Friars": "Providence",
            "Houston Christian": "Hou Christian",
            "LSU Tigers": "LSU",
            "Michigan Wolverines": "Michigan",
            "Westminster UT": "Westminster",
            "William & Mary": "Wm & Mary",
            "Colorado State": "Colorado St",
            "Arkansas State": "Arkansas St",
            "Arkansas Razorbacks": "Arkansas",
            "Bethune-Cookman": "Beth-Cook",
            "Seattle U Redhawks": "Seattle U",
            "Seattle U": "Seattle U",
            "UC Santa Barbara": "UC-SB",
            "UC-SB": "UC-SB",
            "Western Carolina": "W Carolina",
            "Wisconsin Badgers": "Wisconsin",
            "Wisconsin": "Wisconsin",
            "Eastern Illinois": "E Illinois",
            "Memphis Tigers": "Memphis",
            "Memphis": "Memphis",
            "Carroll College": "Carrol Coll.",
            "USC Trojans": "USC",
            "Frostburg State Bobcats": "Frostburg St",
            "Merrimack Warriors": "Merrimack",
            "Bethesda University": "Bethesda",
            "Saint Marys Gaels": "Saint Mary's",
            "Northern New Mexico": "N New Mexico",
            "Northern Colorado": "N Colorado",
            "Westminster Blue Jays": "Westminster",
            "Western Illinois": "W Illinois",
            "Houston Cougars": "Houston",
            "North Carolina": "UNC",
            "Towson Tigers": "Towson",
            "American University": "American",
            "Alabama": "Alabama",
            "Alabama A&M": "Ala A&M",
            "Auburn": "Auburn",
            "Bard College": "Bard",
            "Benedictine (AZ)": "Benedictine",
            "Cal Poly": "Cal Poly",
            "California Golden Bears": "California",
            "Chicago State": "Chicago St",
            "Delaware": "Delaware",
            "DePaul": "DePaul",
            "East. Washington": "E Wash",
            "Erskine": "Erskine",
            "George Washington": "G Wash",
            "Georgia State": "GA State",
            "Grand Canyon": "GCU",
            "Harvard Crimson": "Harvard",
            "Howard": "Howard",
            "Indiana East": "Indiana E",
            "Lindenwood": "Lindenwood",
            "Longwood": "Longwood",
            "LSU Tigers": "LSU",
            "Maine Black Bears": "Maine",
            "New Haven Chargers": "New Haven",
            "Northwestern": "Northwestern",
            "Oral Roberts": "Oral Roberts",
            "Prairie View A&M": "P View A&M",
            "Presbyterian College": "Presbyterian",
            "Sam Houston St.": "Sam Houston",
            "San Diego": "San Diego",
            "San Diego State": "San Diego St",
            "South Carolina State": "So Car St",
            "South Carolina Upstate": "SC Upstate",
            "Southern Wesleyan": "S Wesleyan",
            "Texas Southern": "TX Southern",
            "Southern Indiana": "So Indiana",
            "Stephen F. Austin": "S.F. Austin",
            "Montana State": "Montana St",
            "Florida Gulf Coast": "FGCU",
            "Coastal Georgia": "Coastal GA",
            "Georgia Southern": "GA Southern",
            "Vermont State - Johnson": "VT St-Johnson",
            "Queens University": "Queens",
            "Gardner-Webb": "Gard-Webb",
            "Dallas Christian": "Dallas Christ",
            "Texas A&M-Corpus Christi": "TX A&M-CC",
            "Dakota Wesleyan": "Dak Wesley",
            "SIU Edwardsville": "SIU-Edwardsville",
            "Stonehill Skyhawks": "Stonehill",
            "Texas State Bobcats": "TX State",
            "Tulane Green Wave": "Tulane",
            "Tulsa Golden Hurricane": "Tulsa",
            "UTRGV": "UTRGV",
            "UMKC": "UMKC",
            "Utah Valley Wolverines": "Utah Valley",
            "VCU": "VCU",
            "Colorado State": "Colorado St",
            "Louisiana Monroe": "LA-Monroe",
            "Georgia Southwestern": "Georgia SW",
            "Charleston Southern": "Charleston",
            "South Alabama": "S Alabama",
            "George Mason": "Geo Mason",
            "New Hampshire": "New Hamp",
            "North American": "N American",
            "Loyola Chicago": "Loyola CHI",
            "Morehead State": "Morehead St",
            "Boston University": "Boston U",
            "Louisiana Tech": "LA Tech",
            "St. Bonaventure": "St. Bon.",
            "Western Kentucky": "W Kentucky",
            "North Carolina A&T": "NC A&T",
            "Maryland Eastern Shore": "MD E Shore",
            "Mount Marty College": "Mt Marty",
            "Virginia-Lynchburg": "VA-Lynch",
            "East Tennessee State": "E TN St",
            "SUNY-Maritime": "SUNY-Mari",
            "Eastern Michigan": "E Michigan",
            "UNC Greensboro": "UNC G'boro",
            "Indiana University East": "IU East",
            "Long Island University": "LIU",
            "Saint Mary of the Woods College": "St Mary Woods",
            "Central Michigan": "C Michigan",
            "Arkansas State": "Ark St",
            "Washington State": "Wash St",
            "Manhattan Christian": "Manhatt Chr",
            "Abilene Christian": "Abilene Chr",
            "Columbia College (SC)": "Columbia SC",
            "Columbia (SC)": "Columbia SC",
            "Evergreen State": "Evergreen St",
            "North Carolina Central": "NC Central",
            "UT Rio Grande Valley": "UTRGV",
            "Warren Wilson": "Warr Wilson",
            "Cal State Northridge": "CS-Northridge",
            "Cal State Fullerton": "Fullerton",
            "North Texas": "N Texas",
            "San José State": "San José St",
            "Northwestern State": "NW State",
            "Cleary University": "Cleary",
            "Central Connecticut": "Central CT",
            "West Virginia": "W Virginia",
            "North Dakota St": "N Dakota St",
            "North Dakota State": "N Dakota St",
            "Northern Kentucky": "N Kentucky",
            "Incarnate Word": "Inc. Word",
            "Tennessee State": "TN State",
            "CS Monterey Bay": "CS Monterrey",
            "St. Mary's (TX)": "St Mary's TX",
            "Trinity College of Jacksonville": "Trinity (Jax)",
            "Saint John's (MN)": "St John's MN",
            "Alaska Anchorage": "AK-Anch",
            "Miami (OH)-Middletown": "MIA (OH)-Middletown",
            "Bowling Green": "Bowl Green",
            "Ohio Wesleyan": "OH Wesleyan",
            "Mississippi State": "MS State",
            "East-West University": "East-West",
            "York College Nebraska": "York (NE)",
            "Colorado-Colorado Springs": "CO-Col Springs",
            "Cal State East Bay": "CS East Bay",
            "Cal State Bakersfield": "CS Bakersfield",
            "Middle Tennessee": "Middle TN",
            "New Mexico State": "NM State",
            "Southwestern Christian": "SW Christian",
            "Kansas Christian": "KS Christian",
            "New Hampshire": "New Hamp",
            "Youngstown State": "Youngstown St",
            "Brewton-Parker": "Brewt-Parker",
            "South Carolina Upstate": "SC Upstate",
            "Mid-Atlantic Christian": "Mid-Atl Christian",
            "Georgian Court University": "Georgian Ct",
            "Agnes Scott College": "Agnes Scott",
            "Wesleyan College (GA)": "Wesleyan (GA)",
            "Jacksonville State": "Jax State",
            "Mississippi Valley State": "MS Valley St",
            "Simmons College (KY)": "Simmons (KY)",
            "Sacramento State": "Sac State",
            "Wayne State (MI)": "Wayne St (MI)",
            "Alabama State": "AL State",
            "Colorado Christian": "CO Christian",
            "Vanderbilt Commodores": "Vanderbilt",
            "Lehman College": "Lehman",
            "Notre Dame (MD)": "N Dame (MD)",
            "Youngstown St": "Youngstown",
            "Florida International": "FIU",
            "Boston College": "Boston Coll",
            "Purdue Fort Wayne": "Purdue FW",
            "Simpson University (CA)": "Simpson",
            "Coastal Carolina": "Coastal Car",
            "Lourdes University": "Lourdes",
            "Harris-Stowe State": "Harris-Stowe",
            "UNC Wilmington": "UNC-Wilm",
            "Southern-New Orleans": "Southern (NO)",
            "Mid-Atl Christian": "Mid-Atl Christ.",
            "Southwestern Adventist": "SW Adventist",
            "Maine-Fort Kent": "Maine-Ft Kent",
            "Judson University": "Judson",
            "Wisconsin-Lutheran": "WI-Luthern",
            "Dickinson State (ND)": "Dickinson St",
            "Gwynedd-Mercy": "Gwynn-Mercy",
            "Central Baptist College": "Cent Baptist",
            "Lindsey Wilson": "Lind Wilson",
            "CS Bakersfield": "CS-Bakersf",
            "Western Oregon": "W Oregon"
        },
        // UEFA Champions League
        UEFAChampionsLeague: {
            "Royale Union SG": "Royale USG",
            "Olympiacos Piraeus": "Olympiacos",
            "Olympiakos Piraeus": "Olympiakos",
            "FC Copenhagen": "Copenhagen",
            "Union Saint-Gilloise": "Union SG",
            "Newcastle United": "Newcastle",
            "Olympique Marseille": "Marseille",
            "Atlético Madrid": "Atlético",
            "Internazionale": "Inter Milan",
            "Inter Milan": "Inter Milan"
        },
        // UEFA Europa League
        UEFAEuropaLeague: {
            "Din. Zagreb": "D. Zagreb",
            "Crvena zvezda": "Red Star",
            "Maccabi Tel Aviv": "M. Tel Aviv",
            "Dinamo Zagreb": "Din Zagreb",
            "Sporting Braga": "Braga",
            "Crvena Zvezda": "Red Star",
            "Olympique Lyonnais": "Lyon",
            "Go Ahead Eagles": "G.A. Eagles",
            "Nottingham Forest": "Forest"
        },
        "UEFA Europa League": {
            "Din. Zagreb": "D. Zagreb",
            "Crvena zvezda": "Red Star",
            "Maccabi Tel Aviv": "M. Tel Aviv",
            "Dinamo Zagreb": "Din Zagreb",
            "Sporting Braga": "Braga",
            "Crvena Zvezda": "Red Star",
            "Olympique Lyonnais": "Lyon",
            "Go Ahead Eagles": "G.A. Eagles",
            "Nottingham Forest": "Forest"
        },
        // UEFA Conference League
        UEFAConferenceLeague: {
            "Shakhtar Donetsk": "Shaktar D.",
            "Sigma Olomouc": "S. Olomouc",
            "Slovan Bratislava": "S. Bratislava",
            "AEK Athens FC": "AEK Athens",
            "Shamrock Rovers": "Shamrock",
            "Rayo Vallecano": "R. Vallecano",
            "Lincoln Red Imps": "L. Red Imps",
            "Lausanne Sport": "Lausanne",
            "Omonia": "Omonoia",
            "Jagiellonia Białystok": "Jagiellonia",
            "Hamrun Spartans": "Hamrun",
            "Raków Częstochowa": "Raków",
            "Omonia Nicosia": "Omonia"
        },
        "UEFA Conference League": {
            "Shakhtar Donetsk": "Shaktar D.",
            "Sigma Olomouc": "S. Olomouc",
            "Slovan Bratislava": "S. Bratislava",
            "AEK Athens FC": "AEK Athens",
            "Shamrock Rovers": "Shamrock",
            "Rayo Vallecano": "R. Vallecano",
            "Lincoln Red Imps": "L. Red Imps",
            "Lausanne Sport": "Lausanne",
            "Omonia": "Omonoia",
            "Jagiellonia Białystok": "Jagiellonia",
            "Hamrun Spartans": "Hamrun",
            "Raków Częstochowa": "Raków",
            "Omonia Nicosia": "Omonia"
        },
        // AFC Qualifiers
        "AFC Qualifiers": {
            "United Arab Emirates": "UAE"
        },
        // CONCACAF Qualifiers
        "CONCACAF Qualifiers": {
            "Trinidad & Tobago": "Trin. & Tob."
        },
        // UEFA Qualifiers
        "UEFA Qualifiers": {
            "Czech Republic": "Czechia",
            "Northern Ireland": "N Ireland",
            "Bosnia & Herzegovina": "Bosnia & H",
            "North Macedonia": "N Macedonia",
            "Turkey": "Türkiye"
        },
        // Liga Portugal
        LigaPortugal: {
            "Vitória Guimarães": "Vitória G",
            "Vitoria Guimaraes": "Vitória G"
        },
        // Brasileirao
        Brasileirao: {
            "Santos Laguna": "S. Laguna",
            "Santos": "S. Laguna"
        },
        // Belgian Pro League
        BelgianProLeague: {
            "Standard Liège": "S. Liège",
            "Standard Liege": "S. Liège",
            "Standard": "S. Liège",
            "RAAL La Louvière": "La Louvière",
            "Sporting Charleroi": "Charleroi"
        },
        // Coupe de France
        CoupeDeFrance: {
            "Stade Briochin": "S. Briochin",
            "Grenoble Foot 38": "Grenoble 38",
            "Sarreguemines": "S'guemines"
        },
        // Copa del Rey
        CopaDelRey: {
            "Atlético Baleares": "Atl Baleares",
            "Deportivo La Coruña": "La Coruña",
            "Racing Santander": "R Santander",
            "Extremadura 1924": "Extremadura",
            "Real Zaragoza": "R Zaragoza",
            "Cultural Leonesa": "C Leonesa"
        },
        // AFC Champions League
        "AFC Champions League": {
            "Shanghai Shenhua": "Shenhua",
            "Sanfrecce Hiroshima": "Sanfrecce",
            "Melbourne City": "Melbourne City"
        },
        // Scottish Premiership
        ScottishPremiership: {
            "Dundee United": "Dundee",
            "Heart of Midlothian": "Hearts"
        },
        // England: National League
        EnglandNationalLeague: {
            "Hartlepool United": "Hartlepool",
            "Braintree Town": "Braintree",
            "FC Halifax Town": "Halifax Town",
            "Carlisle United": "Carlisle",
            "Boreham Wood": "Boreham"
        },
        // NCAA Women's Volleyball
        NCAAWomensVolleyball: {
            "Texas A&M Aggies": "Texas A&M",
            "Kentucky Wildcats": "Kentucky"
        },
        // Germany: 2. Bundesliga
        Germany2Bundesliga: {
            "TSV Eintracht Braunschweig": "Braunschweig",
            "1. FC Nürnberg": "Nürnberg",
            "SV 07 Elversberg": "Elversberg",
            "Preußen Münster": "Preu Münster"
        },
        // A-League (Australia)
        "A-League": {
            "Adelaide United": "Adelaide",
            "Brisbane Roar": "Brisbane",
            "Central Coast Mariners": "Central Coast",
            "Macarthur FC": "Macarthur",
            "Melbourne City": "Melbourne City",
            "Melbourne City FC": "Melbourne City",
            "Melbourne Victory": "Melbourne Victory",
            "Melbourne Victory FC": "Melbourne Victory",
            "Newcastle Jets": "Newcastle",
            "Newcastle United Jets": "Newcastle",
            "Perth Glory": "Perth",
            "Sydney FC": "Sydney",
            "Wellington Phoenix": "Wellington",
            "Western Sydney Wanderers": "Wanderers",
            "Western United": "Western United",
            "Western United FC": "Western United"
        }
    };
    
    function getTeamDisplayName(name, league = null) {
        // Handle null/undefined/empty values
        if (!name || typeof name !== 'string') {
            return '';
        }
        
        // Remove " W" suffix if present (for NWSL)
        let p = name.endsWith(" W") ? name.slice(0, -2) : name;
        
        // Check if this is a tennis league (ATP, WTA, Davis Cup, or any league containing "ATP" or "WTA")
        const isTennisLeague = league && (league.includes('ATP') || league.includes('WTA') || league.includes('Davis Cup') || league === 'Tennis');
        
        // For tennis player names, remove initial and country code
        // Pattern: "Musetti L. (Ita)" -> "Musetti"
        // Pattern: "Alcaraz C. (Esp)" -> "Alcaraz"
        // For doubles: "Cash J./Glasgow M. (Aus)" -> "Cash<br>Glasgow" (split at "/" and process each part)
        if (isTennisLeague) {
            // Check if this is a doubles name (contains "/")
            if (p.includes('/')) {
                // Split at "/" and process each part separately
                const parts = p.split('/').map(part => part.trim());
                const processedParts = parts.map(part => {
                    // Remove country code in parentheses (e.g., "(Ita)", "(Esp)")
                    let processed = part.replace(/\s*\([^)]+\)\s*$/, '').trim();
                    // Remove initial (e.g., "L.", "C.") - single letter followed by period
                    processed = processed.replace(/\s+[A-Z]\.\s*$/, '').trim();
                    return processed;
                });
                // Join with <br> to display on separate lines
                return processedParts.join('<br>');
            } else {
                // Singles: remove country code and initial
                // Remove country code in parentheses (e.g., "(Ita)", "(Esp)")
                p = p.replace(/\s*\([^)]+\)\s*$/, '').trim();
                // Remove initial (e.g., "L.", "C.") - single letter followed by period
                p = p.replace(/\s+[A-Z]\.\s*$/, '').trim();
            }
        }
        
        if (league === 'FIFA U-17 World Cup') {
            p = p.replace(/\s*U17\b/gi, '').trim();
        }
        
        // If league is specified and has mappings, use league-specific mapping
        // Note: For doubles with <br>, we need to check if the original name (before processing) has a mapping
        if (league && TEAM_DISPLAY_MAP[league]) {
            const originalName = name.endsWith(" W") ? name.slice(0, -2) : name;
            if (TEAM_DISPLAY_MAP[league][originalName]) {
                return TEAM_DISPLAY_MAP[league][originalName];
            }
            return TEAM_DISPLAY_MAP[league][p] || p;
        }
        
        // Otherwise, try all leagues (fallback for backward compatibility)
        for (const leagueMap of Object.values(TEAM_DISPLAY_MAP)) {
            const originalName = name.endsWith(" W") ? name.slice(0, -2) : name;
            if (leagueMap[originalName]) {
                return leagueMap[originalName];
            }
            if (leagueMap[p]) {
                return leagueMap[p];
            }
        }
        
        // Return original name if no mapping found
        return p;
    }
    
    // Granular Live Status Display Function
    function getGranularLiveStatus(game) {
        // Check if game is live - handle both "LIVE" and "IN PROGRESS" statuses
        const stageType = (game.StageType || '').toUpperCase();
        const matchStatus = (game['Match Status'] || '').toUpperCase();
        const isLive = stageType === 'LIVE' || stageType === 'IN PROGRESS' || 
                       matchStatus.includes('IN PROGRESS') || matchStatus.includes('LIVE');
        
        // If not live, return the status
        if (!isLive) {
            return game.StageType || game['Match Status'] || '';
        }
        
        // PRIORITY 1: Use displayTime if available (calculated by backend from ESPN/NCAA APIs)
        // BUT: For soccer, we want to ensure it's just minutes (no <br>), so handle it separately
        if (game.displayTime && game.displayTime !== '' && game.displayTime !== 'TBD') {
            // For soccer, if displayTime contains <br>, extract just the minutes part
            if (game.Sport === 'Soccer' && game.displayTime.includes('<br>')) {
                // Extract minutes from format like "45'<br>..." or just use the first part
                const parts = game.displayTime.split('<br>');
                if (parts[0] && parts[0].includes("'")) {
                    return parts[0]; // Return just the minutes part (e.g., "45'")
                }
            }
            // For non-soccer or soccer without <br>, use displayTime as-is
            return game.displayTime;
        }
        
        const displayLeague = getLeagueDisplayName(game.League, game.Sport);
        
        // Handle halftime/intermission for all sports
        if (game.Stage === "HALF_TIME" || game.Stage === "HALF") {
            return "HALF";
        }
        if (game.Stage === "1ST_INTERMISSION" || game.Stage === "2ND_INTERMISSION") {
            return "Int";
        }
        
        // Formula 1 / Formula One - show lap progress if available
        if (displayLeague && displayLeague.toLowerCase().includes('formula')) {
            const extractNumber = (value) => {
                if (value === null || value === undefined) return null;
                const match = String(value).match(/\d+/);
                return match ? parseInt(match[0], 10) : null;
            };
            
            const currentLapRaw = game['Current Lap'] ?? game.CurrentLap ?? game.currentLap ?? game.currentlap ?? game['current_lap'] ?? game.current_lap ?? game['Lap'] ?? game.lap ?? '';
            const totalLapsRaw = game['Total Laps'] ?? game.TotalLaps ?? game.totalLaps ?? game['Lap Count'] ?? game.lapCount ?? game.lapcount ?? game['Laps'] ?? game.laps ?? '';
            const lapsRemainingRaw = game['Laps Remaining'] ?? game.lapsRemaining ?? game.lapsremaining ?? '';
            
            const currentLap = extractNumber(currentLapRaw);
            let totalLaps = extractNumber(totalLapsRaw);
            
            if (!totalLaps && lapsRemainingRaw && currentLap !== null) {
                const remaining = extractNumber(lapsRemainingRaw);
                if (remaining !== null) {
                    totalLaps = currentLap + remaining;
                }
            }
            
            if (currentLap !== null) {
                return totalLaps ? `Lap ${currentLap}/${totalLaps}` : `Lap ${currentLap}`;
            }
            
            // Sometimes Stage carries lap info like "LAP 32"
            if (game.Stage) {
                const stageLap = extractNumber(game.Stage);
                if (stageLap !== null) {
                    return totalLaps ? `Lap ${stageLap}/${totalLaps}` : `Lap ${stageLap}`;
                }
            }
            
            return 'Live';
        }
        
        if (displayLeague === 'ODI') {
            const stage = (game.Stage || '').toUpperCase();
            if (stage === 'FIRST_INNING') return '1st';
            if (stage === 'SECOND_INNING') return '2nd';
        }
        
        // NFL, NCAAF, NBA, WNBA - Quarter-based sports (NCAAW handled separately above)
        if (['NFL', 'NCAAF', 'NBA', 'WNBA'].includes(displayLeague)) {
            // Check for halftime FIRST (before processing GameTime)
            const stage = (game.Stage || '').toUpperCase();
            const stageType = (game.StageType || '').toUpperCase();
            const matchStatus = (game['Match Status'] || '').toUpperCase();
            
            if (stage.includes('HALF') || stageType.includes('HALF') || matchStatus.includes('HALF') ||
                stage === 'HALFTIME' || stage === 'HALF_TIME' || stage === 'HALF') {
                return 'HALF';
            }
            
            // For American Football (NFL, NCAAF), validate GameTime is within 0-15 minutes
            const isAmericanFootball = displayLeague === 'NFL' || displayLeague === 'NCAAF';
            
            if (game.GameTime && game.GameTime !== "" && game.GameTime !== "-1") {
                // Format quarter and time remaining with proper quarter names
                let quarter = game.Stage;
                if (quarter === "1ST_QUARTER") quarter = "1st";
                else if (quarter === "2ND_QUARTER") quarter = "2nd";
                else if (quarter === "3RD_QUARTER") quarter = "3rd";
                else if (quarter === "4TH_QUARTER" || quarter === "FOURTH_QUARTER") quarter = "4th";
                else if (quarter === "OVERTIME") quarter = "OT";
                else {
                    // Handle any other quarter format (like "THIRD_QUARTER" -> "3rd")
                    quarter = quarter.replace('_QUARTER', '');
                    if (quarter === "FIRST") quarter = "1st";
                    else if (quarter === "SECOND") quarter = "2nd";
                    else if (quarter === "THIRD") quarter = "3rd";
                    else if (quarter === "FOURTH") quarter = "4th";
                    else quarter = quarter.toLowerCase();
                }
                
                // Format time to include seconds if not present
                let timeStr = game.GameTime;
                if (timeStr && !timeStr.includes(':')) {
                    // If time is just a number (like "11"), add ":00" to make it "11:00"
                    timeStr = timeStr + ':00';
                }
                
                // For American Football, validate and clamp time to 0-15 minutes
                if (isAmericanFootball && timeStr.includes(':')) {
                    const [minutes, seconds] = timeStr.split(':').map(Number);
                    // If minutes > 15, it's likely halftime or invalid data
                    if (minutes > 15 || (minutes === 15 && seconds > 0)) {
                        // Check if we're actually in halftime based on quarter
                        if (quarter === "2nd" || stage.includes('HALF')) {
                            return 'HALF';
                        }
                        // Otherwise, clamp to 15:00 max
                        timeStr = '15:00';
                    } else if (minutes < 0) {
                        timeStr = '0:00';
                    } else {
                        // Ensure seconds are 0-59
                        const validSeconds = Math.max(0, Math.min(59, seconds || 0));
                        timeStr = `${minutes}:${String(validSeconds).padStart(2, '0')}`;
                    }
                }
                
                return `${quarter}<br>${timeStr}`;
            }
            
            // If no GameTime but Stage indicates halftime, return HALF
            if (stage.includes('HALF') || stageType.includes('HALF')) {
                return 'HALF';
            }
            
            return game.Stage || '';
        }
        
        // Hockey - Period-based sport (NHL, OHL, and all hockey leagues)
        if (game.Sport === 'Hockey') {
            if (game.GameTime && game.GameTime !== "" && game.GameTime !== "-1") {
                // Format period and time remaining
                let period = game.Stage || '';
                // Remove _PERIOD suffix and normalize
                period = period.replace(/_PERIOD/gi, '').replace(/_/g, '').trim();
                // Convert FIRST_PERIOD/SECOND_PERIOD/THIRD_PERIOD to 1st/2nd/3rd, and PAUSE to INT
                if (period === "FIRST" || period === "1ST") period = "1st";
                else if (period === "SECOND" || period === "2ND") period = "2nd";
                else if (period === "THIRD" || period === "3RD") period = "3rd";
                else if (period === "PAUSE") period = "INT";
                // Format time to include seconds if not present
                let timeStr = game.GameTime;
                if (timeStr && !timeStr.includes(':')) {
                    timeStr = timeStr + ':00';
                }
                return `${period}<br>${timeStr}`;
            }
            // Also format period even without time
            let period = game.Stage || '';
            if (period) {
                // Remove _PERIOD suffix and normalize
                period = period.replace(/_PERIOD/gi, '').replace(/_/g, '').trim();
                // Convert FIRST_PERIOD/SECOND_PERIOD/THIRD_PERIOD to 1st/2nd/3rd, and PAUSE to INT
                if (period === "FIRST" || period === "1ST") period = "1st";
                else if (period === "SECOND" || period === "2ND") period = "2nd";
                else if (period === "THIRD" || period === "3RD") period = "3rd";
                else if (period === "PAUSE") period = "INT";
                return period;
            }
            return game.Stage;
        }
        
        // NCAAM - Quarter-based sport (uses quarters, not halves)
        if (displayLeague === 'NCAAM') {
            // Check for currentPeriod in multiple field names
            const currentPeriod = game['Current Period'] || game.currentPeriod || game.Stage || '';
            const gameTime = game.GameTime || game.gameTime || game.displayClock || '';
            
            if (gameTime && gameTime !== "" && gameTime !== "-1" && currentPeriod) {
                // Format quarter from currentPeriod (e.g., "1ST_QUARTER", "2ND_QUARTER", "HALFTIME")
                let quarter = currentPeriod;
                if (quarter === "1ST_QUARTER" || quarter === "FIRST_QUARTER") quarter = "1st";
                else if (quarter === "2ND_QUARTER" || quarter === "SECOND_QUARTER") quarter = "2nd";
                else if (quarter === "3RD_QUARTER" || quarter === "THIRD_QUARTER") quarter = "3rd";
                else if (quarter === "4TH_QUARTER" || quarter === "FOURTH_QUARTER") quarter = "4th";
                else if (quarter === "HALFTIME" || quarter === "HALF_TIME") quarter = "HALF";
                else if (quarter === "OVERTIME" || quarter === "OT") quarter = "OT";
                else {
                    // Handle any other quarter format
                    quarter = quarter.replace('_QUARTER', '').replace('_', '');
                    if (quarter === "FIRST") quarter = "1st";
                    else if (quarter === "SECOND") quarter = "2nd";
                    else if (quarter === "THIRD") quarter = "3rd";
                    else if (quarter === "FOURTH") quarter = "4th";
                    else quarter = quarter.toLowerCase();
                }
                
                // For halftime, don't show time - just return "HALF"
                if (quarter === "HALF") {
                    return "HALF";
                }
                
                // Format time to include seconds if not present
                let timeStr = gameTime;
                if (timeStr && !timeStr.includes(':')) {
                    timeStr = timeStr + ':00';
                }
                return `${quarter}<br>${timeStr}`;
            }
            // If no time but we have period, just show period
            if (currentPeriod) {
                let quarter = currentPeriod;
                if (quarter === "1ST_QUARTER" || quarter === "FIRST_QUARTER") quarter = "1st";
                else if (quarter === "2ND_QUARTER" || quarter === "SECOND_QUARTER") quarter = "2nd";
                else if (quarter === "3RD_QUARTER" || quarter === "THIRD_QUARTER") quarter = "3rd";
                else if (quarter === "4TH_QUARTER" || quarter === "FOURTH_QUARTER") quarter = "4th";
                else if (quarter === "HALFTIME" || quarter === "HALF_TIME") quarter = "HALF";
                else if (quarter === "OVERTIME" || quarter === "OT") quarter = "OT";
                return quarter;
            }
            return game.Stage || game.StageType || '';
        }
        
        // NCAAW - Quarter-based sport (uses quarters, not halves)
        if (displayLeague === 'NCAAW') {
            // Check for currentPeriod in multiple field names
            const currentPeriod = game['Current Period'] || game.currentPeriod || game.Stage || '';
            const gameTime = game.GameTime || game.gameTime || game.displayClock || '';
            
            // Check for halftime: 1st period with 00:00 or 0:00 or 0.0 clock
            const isZeroClock = (gameTime === '00:00' || gameTime === '0:00' || gameTime === '0.0' || gameTime === '0' || gameTime === '');
            const isFirstPeriod = currentPeriod && (
                currentPeriod.includes('1ST') || 
                currentPeriod.includes('FIRST') || 
                currentPeriod === '1' ||
                currentPeriod.toLowerCase() === '1st'
            );
            
            if (isFirstPeriod && isZeroClock) {
                return "HALF";
            }
            
            if (gameTime && gameTime !== "" && gameTime !== "-1" && currentPeriod) {
                // Format quarter from currentPeriod (e.g., "1ST_QUARTER", "2ND_QUARTER", "HALFTIME")
                let quarter = currentPeriod;
                if (quarter === "1ST_QUARTER" || quarter === "FIRST_QUARTER") quarter = "1st";
                else if (quarter === "2ND_QUARTER" || quarter === "SECOND_QUARTER") quarter = "2nd";
                else if (quarter === "3RD_QUARTER" || quarter === "THIRD_QUARTER") quarter = "3rd";
                else if (quarter === "4TH_QUARTER" || quarter === "FOURTH_QUARTER") quarter = "4th";
                else if (quarter === "HALFTIME" || quarter === "HALF_TIME") quarter = "HALF";
                else if (quarter === "OVERTIME" || quarter === "OT") quarter = "OT";
                else {
                    // Handle any other quarter format
                    quarter = quarter.replace('_QUARTER', '').replace('_', '');
                    if (quarter === "FIRST") quarter = "1st";
                    else if (quarter === "SECOND") quarter = "2nd";
                    else if (quarter === "THIRD") quarter = "3rd";
                    else if (quarter === "FOURTH") quarter = "4th";
                    else quarter = quarter.toLowerCase();
                }
                
                // For halftime, don't show time - just return "HALF"
                if (quarter === "HALF") {
                    return "HALF";
                }
                
                // Format time to include seconds if not present
                let timeStr = gameTime;
                if (timeStr && !timeStr.includes(':')) {
                    timeStr = timeStr + ':00';
                }
                return `${quarter}<br>${timeStr}`;
            }
            // If no time but we have period, just show period
            if (currentPeriod) {
                let quarter = currentPeriod;
                if (quarter === "1ST_QUARTER" || quarter === "FIRST_QUARTER") quarter = "1st";
                else if (quarter === "2ND_QUARTER" || quarter === "SECOND_QUARTER") quarter = "2nd";
                else if (quarter === "3RD_QUARTER" || quarter === "THIRD_QUARTER") quarter = "3rd";
                else if (quarter === "4TH_QUARTER" || quarter === "FOURTH_QUARTER") quarter = "4th";
                else if (quarter === "HALFTIME" || quarter === "HALF_TIME") quarter = "HALF";
                else if (quarter === "OVERTIME" || quarter === "OT") quarter = "OT";
                return quarter;
            }
            return game.Stage || game.StageType || '';
        }
        
        // MLB - Inning-based sport
        if (displayLeague === 'MLB') {
            // Try multiple possible field names for MLB API data
            const inningHalf = game.inningHalf || game.inning_half || game.half || "";
            const currentInning = game.currentInning || game.current_inning || game.inning || "";
            
            if (inningHalf && currentInning) {
                return `${inningHalf.slice(0,3)}<br>${currentInning}`;
            }
            
            // Try to extract from Stage field
            if (game.Stage && game.Stage.includes('INNING')) {
                return game.Stage.replace('_INNING', '').replace('_', ' ');
            }
            
            // Try to extract from other possible fields
            if (game.inningState) {
                return game.inningState;
            }
            
            // For MLB games, try to parse the Stage field more aggressively
            if (game.Stage) {
                // Handle cases like "TOP_2ND_INNING" or "BOTTOM_3RD_INNING"
                if (game.Stage.includes('_INNING')) {
                    const parts = game.Stage.split('_');
                    if (parts.length >= 2) {
                        const half = parts[0]; // TOP or BOTTOM
                        const inning = parts[1]; // 2ND, 3RD, etc.
                        return `${half.slice(0,3)}<br>${inning}`;
                    }
                }
            }
            
            return game.Stage;
        }
        
        // Tennis - handle set display (FIRST_SET -> 1st, etc.)
        if (game.Sport === 'Tennis') {
            const stage = (game.Stage || '').toUpperCase();
            if (stage === 'FIRST_SET') return '1st';
            if (stage === 'SECOND_SET') return '2nd';
            if (stage === 'THIRD_SET') return '3rd';
            if (stage === 'FOURTH_SET') return '4th';
            if (stage === 'FIFTH_SET') return '5th';
        }
        
        // For soccer - use displayClock/period if available, otherwise calculate from timestamps
        if (game.Sport === 'Soccer') {
            // PRIORITY: Use displayClock and period if available (from ESPN API)
            const displayClock = game.displayClock || '';
            const period = game.period || '';
            
            if (displayClock && displayClock !== '' && displayClock !== '0' && displayClock !== '0:00' && displayClock !== '0.0') {
                // Parse minutes from displayClock
                let minutes = null;
                if (displayClock.includes(':')) {
                    const [mins] = displayClock.split(':').map(Number);
                    if (!isNaN(mins)) minutes = mins;
                } else if (!isNaN(parseInt(displayClock))) {
                    minutes = parseInt(displayClock);
                }
                
                if (minutes !== null) {
                    const periodNum = period ? parseInt(period) : null;
                    // If second half and minutes <= 45, add 45
                    if (periodNum === 2 && minutes <= 45) {
                        minutes = 45 + minutes;
                    }
                    // Check for stoppage time in displayClock (e.g., "45+3" or "90+2")
                    const stoppageMatch = displayClock.match(/(\d+)[\'+]?\+(\d+)/);
                    if (stoppageMatch) {
                        const stoppageTime = parseInt(stoppageMatch[2]);
                        return `${minutes}'+${stoppageTime}`;
                    }
                    return `${minutes}'`;
                }
            }
            
            // Fallback: calculate minute from timestamps
            const minute = calculateSoccerMinute(game.StartTime, game.StageStartTime, game.Stage);
            if (minute !== "LIVE") {
                return `${minute}'`;
            }
        }
        
        // For other sports - try to use displayClock and period if available
        const displayClock = game.displayClock || '';
        const period = game.period || '';
        if (displayClock && displayClock !== '' && displayClock !== '0' && displayClock !== '0:00' && displayClock !== '0.0') {
            if (period) {
                const periodNum = parseInt(period);
                let periodStr = '';
                if (periodNum === 1) periodStr = '1st';
                else if (periodNum === 2) periodStr = '2nd';
                else if (periodNum === 3) periodStr = '3rd';
                else if (periodNum === 4) periodStr = '4th';
                else if (periodNum > 4) periodStr = `${periodNum}th`;
                
                if (periodStr) {
                    // Format time to include seconds if not present
                    let timeStr = displayClock;
                    if (timeStr && !timeStr.includes(':')) {
                        timeStr = timeStr + ':00';
                    }
                    return `${periodStr}<br>${timeStr}`;
                }
            }
            return displayClock;
        }
        
        // Final fallback - just show stage
        return game.Stage;
    }
    
    // Calculate soccer minute from timestamps
    function calculateSoccerMinute(startTime, stageStartTime, stage) {
        if (!startTime) return "LIVE";
        
        const now = Math.floor(Date.now() / 1000); // Current time in seconds
        
        // If we have StageStartTime, use it for accurate calculation
        if (stageStartTime) {
            const halfStartTime = stageStartTime; // When current half started
            const minutesElapsed = Math.floor((now - halfStartTime) / 60);
            
            // Add 45 minutes for second half
            if (stage === "SECOND_HALF") {
                return Math.min(minutesElapsed + 45, 90); // Cap at 90 minutes
            }
            
            return Math.min(minutesElapsed, 45); // Cap at 45 minutes for first half
        }
        
        // Fallback: estimate minute from game start time
        const gameStartTime = startTime;
        const minutesElapsed = Math.floor((now - gameStartTime) / 60);
        
        // Add 45 minutes for second half
        if (stage === "SECOND_HALF") {
            return Math.min(minutesElapsed + 45, 90); // Cap at 90 minutes
        }
        
        return Math.min(minutesElapsed, 45); // Cap at 45 minutes for first half
    }
    
    // --- 5. CORE RENDERING FUNCTION ---
    function normalizeDisplayTime(label) {
        if (label === null || label === undefined) return label;
        if (typeof label !== 'string') return label;
        const cleaned = label
            .replace(/[\u00A0\u2007\u202F]/g, ' ')
            .replace(/\s+/g, ' ')
            .trim();
        if (cleaned === '' || cleaned.toUpperCase() === 'TBD') return 'TBD';
        const timeMatch = cleaned.match(/^(\d{1,2}):(\d{2})\s*(AM|PM)$/i);
        if (timeMatch) {
            let hour = parseInt(timeMatch[1], 10);
            const minutes = timeMatch[2];
            const meridiem = timeMatch[3].toUpperCase();
            if (hour === 12) hour = 0;
            if (meridiem === 'PM') hour += 12;
            return `${hour.toString().padStart(2, '0')}:${minutes}`;
        }
        return cleaned.toUpperCase();
    }

    function renderGames(container, gamesData, isGroupedByLeague, isYesterdayScores = false) {
        container.innerHTML = "";
        // Note: gamesData is already filtered at the data level in updateDisplay() - no need to filter here
        
        // Check if this is for Tennis ATP/WTA section
        const isTennisSection = container && (container.id === 'tennis-today-atp-content' || container.id === 'tennis-today-wta-content' || container.id === 'tennis-upcoming-atp-content' || container.id === 'tennis-upcoming-wta-content');
        
        // For league Yesterday tabs, show a simple SCORES header instead of league title row
        if (!isGroupedByLeague && isYesterdayScores) {
            const scoresHeader = document.createElement('div');
            scoresHeader.textContent = 'SCORES';
            scoresHeader.style.color = '#9ca3af';
            scoresHeader.style.fontWeight = '400';
            scoresHeader.style.fontSize = '13px';
            scoresHeader.style.padding = '0 0 6px 5px';
            scoresHeader.style.marginTop = '10px';
            container.appendChild(scoresHeader);
        }
        const leagueGroups = {};

        if (isGroupedByLeague) {
            gamesData.forEach(game => {
                // Check if this is a featured game (has a special property or is in featured games list)
                const isFeatured = game.isFeatured || false;
                
                if (isFeatured) {
                    // Group featured games under "FEATURED"
                    if (!leagueGroups['FEATURED']) leagueGroups['FEATURED'] = [];
                    leagueGroups['FEATURED'].push(game);
                } else {
                    // Group regular games by their league
                    const leagueDisplayName = getLeagueDisplayName(game.League, game.Sport) || "Other";
                if (!leagueGroups[leagueDisplayName]) leagueGroups[leagueDisplayName] = [];
                leagueGroups[leagueDisplayName].push(game);
                }
            });
        } else {
            leagueGroups['singleLeague'] = gamesData;
        }

        const sortedLeagueNames = isGroupedByLeague 
            ? Object.keys(leagueGroups).sort((a, b) => (LEAGUE_DISPLAY_ORDER.indexOf(a) === -1 ? 99 : LEAGUE_DISPLAY_ORDER.indexOf(a)) - (LEAGUE_DISPLAY_ORDER.indexOf(b) === -1 ? 99 : LEAGUE_DISPLAY_ORDER.indexOf(b)))
            : ['singleLeague'];

        sortedLeagueNames.forEach(leagueNameKey => {
            const games = leagueGroups[leagueNameKey];
            const leagueSection = document.createElement("div");
            // For Tennis section, never collapse leagues
            const isCollapsedLeague = isGroupedByLeague && !isTennisSection && COLLAPSED_LEAGUES.includes(leagueNameKey);
            let collapsedScoresRow = null;
            
            // Detect if this is a special NCAA league
            // For grouped by league: check leagueNameKey
            // For league-specific pages: check the games data to determine the league
            let detectedLeagueKey = leagueNameKey;
            if (!isGroupedByLeague && games && games.length > 0) {
                // On league-specific pages, detect the league from the first game
                const firstGame = games[0];
                const leagueDisplayName = getLeagueDisplayName(firstGame.League, firstGame.Sport);
                if (leagueDisplayName === 'NCAAM' || leagueDisplayName === 'NCAAW' || leagueDisplayName === 'NCAAF') {
                    detectedLeagueKey = leagueDisplayName;
                }
            }
            
            const isSpecialNCAALeague = (detectedLeagueKey === 'NCAAM' || detectedLeagueKey === 'NCAAW' || detectedLeagueKey === 'NCAAF');
            const hasEnoughGames = games && games.length >= 10;
            const shouldPrioritizeImportant = isSpecialNCAALeague && hasEnoughGames;

            if(isGroupedByLeague) {
                leagueSection.className = "league-section";
                const title = document.createElement("div");
                title.className = "league-title";
                title.style.display = "flex";
                title.style.alignItems = "center";
                title.style.justifyContent = "flex-start";

                const titleContent = document.createElement("div");
                titleContent.style.display = "flex";
                titleContent.style.alignItems = "center";
                titleContent.style.gap = "5px";
                
                // Special styling for Tennis sections
                if (isTennisSection) {
                    title.style.padding = "3px 0px"; // Minimal padding - only 3px vertical
                    title.style.fontSize = "12px";
                    title.style.fontWeight = "normal";
                    title.style.paddingLeft = "5px";
                    title.style.paddingRight = "0px";
                } else {
                    // Add left padding to FEATURED title to match logo spacing
                    if (leagueNameKey === 'FEATURED') {
                        title.style.paddingLeft = '5px';
                    }
                }
                
                // Add league logo if applicable (skip for Tennis sections)
                if (!isTennisSection) {
                if (leagueNameKey === "NFL") {
                    const logo = document.createElement("img");
                    logo.src = "https://www.flashscore.com/res/image/data/W6t8omXI-prCDKdX1.png";
                    logo.alt = "NFL Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                        titleContent.appendChild(logo);
                } else if (leagueNameKey === "Ligue 1") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/LIgue%201.png";
                    logo.alt = "Ligue 1 Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                        titleContent.appendChild(logo);
                } else if (leagueNameKey === "CFL") {
                    const logo = document.createElement("img");
                    logo.src = "CFL.png";
                    logo.alt = "CFL Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                        titleContent.appendChild(logo);
                } else if (leagueNameKey === "Super Lig") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/Super%20lig.png";
                    logo.alt = "Super Lig Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                        titleContent.appendChild(logo);
                } else if (leagueNameKey === "Italian Super Cup") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/YPeMC9Tp-jsOA0PE1.png";
                    logo.alt = "Italian Super Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                        titleContent.appendChild(logo);
                } else if (leagueNameKey === "UEFA Europa League") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/lxUusmmd-nyYh4pi6.png";
                    logo.alt = "UEFA Europa League Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "UEFA Conference League") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/6a9THkA7-fmGCnzrf.png";
                    logo.alt = "UEFA Conference League Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Formula 1") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/f1.png";
                    logo.alt = "Formula 1 Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Carabao Cup") {
                    const logo = document.createElement("img");
                    logo.src = "https://upload.wikimedia.org/wikipedia/en/thumb/0/0c/EFL_%28Carabao%29_Cup_Logo.svg/250px-EFL_%28Carabao%29_Cup_Logo.svg.png";
                    logo.alt = "Carabao Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Copa del Rey") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/SzmaHcmd-nqEux76Q.png";
                    logo.alt = "Copa del Rey Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "DFB-Pokal") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/GIfP8XA7-nRUFcF5U.png";
                    logo.alt = "DFB-Pokal Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "NCAAF") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/4G8cBECO-lb1Ym94R.png";
                    logo.alt = "NCAAF Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "ATP" || leagueNameKey === "WTA" || leagueNameKey === "ATP Finals (Singles)" || leagueNameKey === "ATP Finals (Doubles)") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/atp.png";
                    logo.alt = "Tennis Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Davis Cup (Singles)" || leagueNameKey === "Davis Cup (Doubles)") {
                    const logo = document.createElement("img");
                    logo.src = "https://r2.thesportsdb.com/images/media/league/badge/i0qscy1672325773.png/medium";
                    logo.alt = "Davis Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "A-League") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/4Uw9VtU1-I5crYno3.png";
                    logo.alt = "A-League Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "WNBA") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/WNBA.png";
                    logo.alt = "WNBA Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "LIV Golf") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/LIVGolf.png";
                    logo.alt = "LIV Golf Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "IndyCar") {
                    const logo = document.createElement("img");
                    logo.src = "indycar.png";
                    logo.alt = "IndyCar Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "NCAAM" || leagueNameKey === "NCAAW" || leagueNameKey === "NCAA Baseball" || leagueNameKey === "NCAA Softball") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/UN5z4YU1-x4aPTEVr.png";
                    logo.alt = "NCAA Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "MotoGP") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/motogp.png";
                    logo.alt = "MotoGP Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "PGA Tour") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/PGATour.png";
                    logo.alt = "PGA Tour Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "DP World Tour") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/IJIc07kD-dGGneQe0.png";
                    logo.alt = "DP World Tour Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "LPGA Tour") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/LPGATour.png";
                    logo.alt = "LPGA Tour Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "PGA Champions") {
                    const logo = document.createElement("img");
                    logo.src = "https://upload.wikimedia.org/wikipedia/en/thumb/f/fe/PGA_Tour_Champions_logo.svg/500px-PGA_Tour_Champions_logo.svg.png";
                    logo.alt = "PGA Champions Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "NBA" || leagueNameKey === "NBA Preseason") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/OhgQNlXI-nyYPIw0n.png";
                    logo.alt = "NBA Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "MLB") {
                    const logo = document.createElement("img");
                    logo.src = "https://www.flashscore.com/res/image/data/QPJ3alWI-pS3BMXxt.png";
                    logo.alt = "MLB Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "MLS") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/CAewoRXI-IaphYoEb.png";
                    logo.alt = "MLS Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "FA Cup") {
                    const logo = document.createElement("img");
                    logo.src = "FACup.png";
                    logo.alt = "FA Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "LaLiga") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/6aNYx0jD-A3tOPy9B.png";
                    logo.alt = "LaLiga Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Serie A") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/rFHMayEO-2exwJQks.png";
                    logo.alt = "Serie A Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Premier League") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/premierleague.png";
                    logo.alt = "Premier League Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "USMNT") {
                    const logo = document.createElement("img");
                    logo.src = "https://cdn.sanity.io/images/oyf3dba6/production/bf72ee7b299178803e565d6c872cdb4baf2aef2d-640x877.png";
                    logo.alt = "USMNT Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Bundesliga") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/fqltz6CO-4ATnefbq.png";
                    logo.alt = "Bundesliga Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Women's Cricket World Cup") {
                    const logo = document.createElement("img");
                    logo.src = "https://upload.wikimedia.org/wikipedia/en/thumb/b/b5/2025_Women%27s_Cricket_World_Cup_logo.svg/500px-2025_Women%27s_Cricket_World_Cup_logo.svg.png";
                    logo.alt = "Women's Cricket World Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "ICC Test Series") {
                    const logo = document.createElement("img");
                    logo.src = "png-icc.png";
                    logo.alt = "ICC Test Series Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "ODI") {
                    const logo = document.createElement("img");
                    logo.src = "https://www.sportmonks.com/wp-content/uploads/2023/01/one-day-international.png";
                    logo.alt = "ODI Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "T20 International") {
                    const logo = document.createElement("img");
                    logo.src = "png-t20.png";
                    logo.alt = "T20 International Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Women's UCL") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/URiA2CjD-tGWdkkzC.png";
                    logo.alt = "UEFA Women's Champions League Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "USL Championship") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/rHzeKoXI-nN00V7HJ.png";
                    logo.alt = "USL Championship Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "NCAA Men's Hockey") {
                    const logo = document.createElement("img");
                    logo.src = "https://www.ncaa.com/modules/custom/casablanca_core/img/sportbanners/icehockey-men.png";
                    logo.alt = "NCAA Men's Hockey Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "OHL") {
                    const logo = document.createElement("img");
                    logo.src = "https://upload.wikimedia.org/wikipedia/en/thumb/8/8f/OHL_Logo.svg/500px-OHL_Logo.svg.png";
                    logo.alt = "OHL Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "CAF Qualifiers") {
                    const logo = document.createElement("img");
                    logo.src = "https://upload.wikimedia.org/wikipedia/en/thumb/7/72/Confederation_of_African_Football_logo.svg/410px-Confederation_of_African_Football_logo.svg.png";
                    logo.alt = "CAF Qualifiers Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "UEFA Qualifiers") {
                    const logo = document.createElement("img");
                    logo.src = "https://a4.espncdn.com/combiner/i?img=%2Fi%2Fleaguelogos%2Fsoccer%2F500%2F67.png";
                    logo.alt = "UEFA Qualifiers Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "AFC Asian Cup Qualifiers" || leagueNameKey === "AFC Qualifiers") {
                    const logo = document.createElement("img");
                    logo.src = "https://upload.wikimedia.org/wikipedia/en/thumb/2/28/Asian_Football_Confederation_logo_2025.svg/500px-Asian_Football_Confederation_logo_2025.svg.png";
                    logo.alt = leagueNameKey + " Logo";
                    logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "AFC Champions League") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/vyvCT5Tp-ttKzJSJq.png";
                    logo.alt = "AFC Champions League Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "CONCACAF Qualifiers") {
                    const logo = document.createElement("img");
                    logo.src = "https://upload.wikimedia.org/wikipedia/commons/thumb/8/87/Concacaf_logo.svg/500px-Concacaf_logo.svg.png";
                    logo.alt = "CONCACAF Qualifiers Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Club Friendly") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/Soccer.png";
                    logo.alt = "Club Friendly Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "International Friendly") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/Soccer.png";
                    logo.alt = "International Friendly Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "NHL" || leagueNameKey === "NHL Preseason") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/lrwv6KTp-YJ8QXhUB.png";
                    logo.alt = "NHL Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "NWSL") {
                    const logo = document.createElement("img");
                    logo.src = "nwsl.png";
                    logo.alt = "NWSL Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "NASCAR Cup Series") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/nascar.png";
                    logo.alt = "NASCAR Cup Series Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "UFC") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/tx44OMld-rojuRsh2.png";
                    logo.alt = "UFC Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Boxing") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/Github%20boxing.png";
                    logo.alt = "Boxing Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "MLS") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/CAewoRXI-IaphYoEb.png";
                    logo.alt = "MLS Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "FA Cup") {
                    const logo = document.createElement("img");
                    logo.src = "FACup.png";
                    logo.alt = "FA Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Copa Sudamericana") {
                    const logo = document.createElement("img");
                    logo.src = "CopaSudamericana.png";
                    logo.alt = "Copa Sudamericana Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "FA Cup") {
                    const logo = document.createElement("img");
                    logo.src = "FACup.png";
                    logo.alt = "FA Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "UEFA Champions League") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/UCL.png";
                    logo.alt = "UEFA Champions League Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Coppa Italia") {
                    const logo = document.createElement("img");
                    logo.src = "CoppaItalia.png";
                    logo.alt = "Coppa Italia Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Coupe de France") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/bPpsXPTp-6ao77VtB.png";
                    logo.alt = "Coupe de France Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Copa Libertadores") {
                    const logo = document.createElement("img");
                    logo.src = "CopaLibertadores.png";
                    logo.alt = "Copa Libertadores Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Saudi Pro League") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/Y9o3ZAV1-dbVv7fPJ.png";
                    logo.alt = "Saudi Pro League Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Liga MX") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/W2jTtTGG-xUMr3lkT.png";
                    logo.alt = "Liga MX Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Ryder Cup") {
                    const logo = document.createElement("img");
                    logo.src = "Ryder Cup.png";
                    logo.alt = "Ryder Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Eredivisie") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/Eredivisie.png";
                    logo.alt = "Eredivisie Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "EFL Championship") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/EFL%20Championship.png";
                    logo.alt = "EFL Championship Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Brasileirão") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/Brasileirao.png";
                    logo.alt = "Brasileirão Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Belgian Pro League") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/88Ble6kd-Q780vzyI.png";
                    logo.alt = "Belgian Pro League Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "LPF Playoffs") {
                    const logo = document.createElement("img");
                    logo.src = "png-Argentina Torneo Betano.png";
                    logo.alt = "LPF Playoffs Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Argentine Primera") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/png-Argentina%20Torneo%20Betano.png";
                    logo.alt = "Argentine Primera Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Scottish Cup") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/zwdJzFld-dCI2lleA.png";
                    logo.alt = "Scottish Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Women's Super League") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/png-WSL.png";
                    logo.alt = "Women's Super League Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Liga Portugal") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/png-Liga%20Portugal.png";
                    logo.alt = "Liga Portugal Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Scottish Premiership") {
                    const logo = document.createElement("img");
                    logo.src = "https://thporth.com/png-SPFL.png";
                    logo.alt = "Scottish Premiership Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "NCAA Women's Volleyball") {
                    const logo = document.createElement("img");
                    logo.src = "https://www.ncaa.com/modules/custom/casablanca_core/img/sportbanners/volleyball-women.png";
                    logo.alt = "NCAA Women's Volleyball Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "England: League One") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/M77QzXA7-fP33jgO5.png";
                    logo.alt = "England: League One Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "England: League Two") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/xQAcEyAj-IHi3niLP.png";
                    logo.alt = "England: League Two Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "England: National League") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/EsxLCiW1-fo7cPihD.png";
                    logo.alt = "England: National League Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "2. Bundesliga") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/ryRxh88j-bTUA446e.png";
                    logo.alt = "2. Bundesliga Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "LaLiga 2") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/pKR6BlXI-zi7o2lSn.png";
                    logo.alt = "LaLiga 2 Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "AFCON") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/YkmaSoU1-W6dDavXQ.png";
                    logo.alt = "AFCON Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Serie B") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/4U93rbmd-tEoIlzmm.png";
                    logo.alt = "Serie B Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Greek Super League") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/UkQpyqTp-Qg3EHN32.png";
                    logo.alt = "Greek Super League Logo";
                    logo.width = 14;
                    logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "Campeones Cup") {
                    const logo = document.createElement("img");
                    logo.src = "CampeonesCup.png";
                    logo.alt = "Campeones Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "FIFA U-17 World Cup") {
                    const logo = document.createElement("img");
                    logo.src = "https://static.flashscore.com/res/image/data/KrHaXEVI-4AahbJk8.png";
                    logo.alt = "FIFA U-17 World Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                        logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                } else if (leagueNameKey === "FIFA U-20 World Cup") {
                    const logo = document.createElement("img");
                    logo.src = "https://upload.wikimedia.org/wikipedia/en/thumb/4/43/2025_FIFA_U-20_World_Cup_logo.svg/315px-2025_FIFA_U-20_World_Cup_logo.svg.png";
                    logo.alt = "FIFA U-20 World Cup Logo";
                        logo.width = 14;
                        logo.height = 14;
                    logo.style.width = "14px";
                    logo.style.height = "14px";
                    logo.style.objectFit = "contain";
                    logo.style.marginLeft = "5px";
                    logo.style.marginRight = "8px";
                    logo.style.verticalAlign = "middle";
                    logo.style.display = "inline-block";
                    logo.style.marginTop = "-2px";
                    titleContent.appendChild(logo);
                    }
                }
                
                const titleText = document.createElement("span");
                titleText.textContent = leagueNameKey;
                titleContent.appendChild(titleText);
                
                title.appendChild(titleContent);

                // Check for direct match first, then check if league name contains "ATP"
                let liveScoresUrl = LEAGUE_LIVE_SCORES_MAP[leagueNameKey];
                if (!liveScoresUrl && leagueNameKey && leagueNameKey.includes("ATP")) {
                    liveScoresUrl = LEAGUE_LIVE_SCORES_MAP["ATP"];
                }
                let liveScoresLink = null;
                if (liveScoresUrl) {
                    liveScoresLink = document.createElement("a");
                    liveScoresLink.href = liveScoresUrl;
                    liveScoresLink.target = "_blank";
                    liveScoresLink.rel = "noopener noreferrer";
                    liveScoresLink.textContent = "SCORES";
                    liveScoresLink.style.fontFamily = "Helvetica, Arial, sans-serif";
                    liveScoresLink.style.fontSize = "8px";
                    liveScoresLink.style.color = "#bebebe";
                    liveScoresLink.style.textDecoration = "underline";
                    liveScoresLink.style.whiteSpace = "nowrap";
                    liveScoresLink.style.paddingRight = "5px";
                    liveScoresLink.style.display = "inline-block";

                    if (isCollapsedLeague) {
                        liveScoresLink.style.marginLeft = "0";
                        collapsedScoresRow = document.createElement("div");
                        collapsedScoresRow.className = "collapsed-league-scores";
                        collapsedScoresRow.style.display = "none";
                        collapsedScoresRow.style.backgroundColor = "#000000";
                        collapsedScoresRow.style.padding = "6px 5px";
                        collapsedScoresRow.style.margin = "0";
                        collapsedScoresRow.style.marginBottom = "0.5em";
                        collapsedScoresRow.style.fontFamily = "Helvetica, Arial, sans-serif";
                        collapsedScoresRow.style.fontSize = "8px";
                        collapsedScoresRow.style.color = "#bebebe";
                        collapsedScoresRow.style.textAlign = "right";
                        collapsedScoresRow.appendChild(liveScoresLink);
                    } else {
                        title.style.justifyContent = "space-between";
                        liveScoresLink.style.marginLeft = "8px";
                        title.appendChild(liveScoresLink);
                    }
                }

                leagueSection.appendChild(title);
            }
            // Special handling for FEATURED section - group by title or league
            if (leagueNameKey === 'FEATURED' && isGroupedByLeague) {
                // Sort all games by order to preserve Google Sheets row order
                // This ensures that games appear in the exact order they were in the Google Sheets document
                const sortedFeaturedGames = [...games].sort((a, b) => {
                    // Primary sort: by order (preserves Google Sheets row order)
                    const orderA = (a && a.order !== undefined) ? a.order : 999999;
                    const orderB = (b && b.order !== undefined) ? b.order : 999999;
                    if (orderA !== orderB) {
                        return orderA - orderB;
                    }
                    // Secondary sort: by displayOrder (fallback for games without order)
                    const fallbackOrderA = (a && a.displayOrder !== undefined) ? a.displayOrder : 999999;
                    const fallbackOrderB = (b && b.displayOrder !== undefined) ? b.displayOrder : 999999;
                    return fallbackOrderA - fallbackOrderB;
                });
                
                let currentTitle = null;
                let currentTable = null;
                let lastDisplayedTimeLabel = null;
                let previousGameTimeLabel = null; // Track previous game's time for separator logic
                let gameIndexInTable = 0; // Track game index within current table
                
                const createSubHeaderAndTable = (titleText) => {
                    const subHeader = document.createElement("div");
                    subHeader.classList.add("featured-subheader");
                    subHeader.style.fontWeight = "normal";
                    subHeader.style.textTransform = "none";
                    subHeader.style.fontSize = "11px";
                    subHeader.style.color = "#e5e7eb";
                    subHeader.style.padding = "8px 5px 4px 5px";
                    subHeader.style.marginTop = "0px";
                    subHeader.style.textAlign = "left";
                    subHeader.style.display = "flex";
                    subHeader.style.alignItems = "center";
                    subHeader.style.backgroundColor = "#000000";
                    subHeader.style.width = "100%";
                    subHeader.style.boxSizing = "border-box";
                    subHeader.textContent = titleText;
                    leagueSection.appendChild(subHeader);
                    
                    const subTable = document.createElement("table");
                    subTable.className = "game-table";
                    subTable.style.width = "100%";
                    subTable.style.maxWidth = "100%";
                    subTable.style.borderCollapse = "collapse";
                    subTable.style.tableLayout = "fixed";
                    
                    const subColgroup = document.createElement("colgroup");
                    // Normal leagues: 4 columns
                    subColgroup.innerHTML = `
                        <col style="width: 32%;">
                        <col style="width: 32%;">
                        <col style="width: 10%;">
                        <col style="width: 26%;">
                    `;
                    subTable.appendChild(subColgroup);
                    
                    const spacerRow = subTable.insertRow();
                    spacerRow.innerHTML = `<td colspan="4" style="height: 5px; padding: 0; border: none;"></td>`;
                    
                    leagueSection.appendChild(subTable);
                    return subTable;
                };
                
                for (let i = 0; i < sortedFeaturedGames.length; i++) {
                    const data = sortedFeaturedGames[i];
                    const titleText = isYesterdayScores 
                        ? (data.yesterdayTitle || data.title || getLeagueDisplayName(data.League, data.Sport) || "Other")
                        : (data.title || getLeagueDisplayName(data.League, data.Sport) || "Other");
                    
                    if (titleText !== currentTitle) {
                        currentTitle = titleText;
                        currentTable = createSubHeaderAndTable(titleText);
                        lastDisplayedTimeLabel = null;
                        previousGameTimeLabel = null; // Reset when starting new table
                        gameIndexInTable = 0; // Reset game index for new table
                    }
                    
                    if (!currentTable) continue;
                    
                        const displayLeague = getLeagueDisplayName(data.League, data.Sport);
                        const leagueKey = getLeagueKeyFromGame(data);
                        const homeDisplay = getTeamDisplayName(data["Home Team"] || "", displayLeague);
                        const awayDisplay = getTeamDisplayName(data["Away Team"] || "", displayLeague);
                        const home = formatTeamNameWithRanking(homeDisplay, leagueKey);
                        const away = formatTeamNameWithRanking(awayDisplay, leagueKey);
                        // Check if names contain <br> (doubles tennis) to adjust styling
                        const isHomeDoubles = homeDisplay.includes('<br>');
                        const isAwayDoubles = awayDisplay.includes('<br>');
                        const homeWhiteSpace = isHomeDoubles ? 'white-space: normal;' : 'white-space: nowrap;';
                        const awayWhiteSpace = isAwayDoubles ? 'white-space: normal;' : 'white-space: nowrap;';
                        // Try multiple possible field names for scores
                        const homeScore = data["Home Score"] || data["HomeScore"] || data.homeScore || '';
                        const awayScore = data["Away Score"] || data["AwayScore"] || data.awayScore || '';
                        const matchStatus = (data["Match Status"] || "").toUpperCase();
                        const stageValue = (data["Stage"] || "").toUpperCase();
                        const stageTypeValue = (data["StageType"] || "").toUpperCase();
                        const statusValue = (data["Status"] || "").toUpperCase();
                        const rawStart = data["Start Time"];
                        
                        // Check if POSTPONED is in any field (Stage, Status, StageType, or Match Status)
                        const isPostponed = stageValue.includes("POSTPONED") || statusValue.includes("POSTPONED") || stageTypeValue.includes("POSTPONED") || matchStatus.includes("POSTPONED");
                        // Check if CANCELED is in any field (Stage, Status, StageType, or Match Status)
                        const isCanceled = stageValue.includes("CANCELED") || statusValue.includes("CANCELED") || stageTypeValue.includes("CANCELED") || matchStatus.includes("CANCELED");
                        
                        // For yesterdayScores, never show live; always treat as final
                        const isLive = isYesterdayScores ? false : (matchStatus.includes("IN PROGRESS") || matchStatus.includes("LIVE"));
                        const isFinal = isYesterdayScores || matchStatus.includes("FINISHED") || matchStatus.includes("FINAL") || matchStatus.includes("GAME OVER");
                        const isPostponedFinal = isFinal && isPostponed;
                        const isCanceledFinal = isFinal && isCanceled;
                        let currentTimeLabel = "";

                        // Check if timeString field exists and is empty (manual games with blank time)
                        if (data.timeString === '') {
                            currentTimeLabel = ""; // Display as empty for blank times
                        } else if (isLive) {
                            // Use EXACT same logic as individual league sections
                            let parsedStatus = '';
                            const displayLeague = getLeagueDisplayName(data.League, data.Sport);
                            if (displayLeague === "MLB") {
                                const inningHalf = data.inningHalf || "";
                                const currentInning = data.currentInning || "";
                                if (inningHalf && currentInning) parsedStatus = `${inningHalf.slice(0,3)} ${currentInning}`;
                            } else {
                                // Use granular live status for ALL sports (including NFL, MLS, etc.)
                                parsedStatus = getGranularLiveStatus(data);
                            }
                            currentTimeLabel = parsedStatus ? `<span style="color: red;">${parsedStatus}</span>` : '<span style="color: red;">Live</span>';
                        } else if (isPostponed) {
                            currentTimeLabel = '<span style="color: #545353;">PPD</span>';
                        } else if (isCanceled) {
                            currentTimeLabel = '<span style="color: #545353;">Canceled</span>';
                        } else if (isFinal) {
                            currentTimeLabel = "F";
                        } else if (rawStart && rawStart.toDate) {
                            // Firestore timestamps are in UTC - convert to user's local time
                            currentTimeLabel = luxon.DateTime.fromJSDate(rawStart.toDate(), { zone: 'utc' }).setZone('local').toFormat('h:mm a');
                        } else {
                            currentTimeLabel = "TBD";
                        }

                    let displayTimeLabel = currentTimeLabel;
                    const normalizedTimeLabel = (!isLive && !isFinal) ? normalizeDisplayTime(currentTimeLabel) : null;
                    if (!isLive && !isFinal && normalizedTimeLabel && normalizedTimeLabel !== 'TBD') {
                        if (normalizedTimeLabel === lastDisplayedTimeLabel) {
                            displayTimeLabel = "";
                        } else {
                            lastDisplayedTimeLabel = normalizedTimeLabel;
                        }
                    }
                    
                    // Get displayLeagueForCheck early for use in granular time logic
                    const displayLeagueForCheck = getLeagueDisplayName(data.League, data.Sport);
                    const isSoccerLeague = ['Premier League', 'LaLiga', 'Serie A', 'Serie B', 'Bundesliga', 'Ligue 1', 'MLS', 'UEFA Champions League', 'AFC Champions League', 'UEFA Europa League', 'UEFA Conference League', 'NWSL', 'FA Cup', 'Coppa Italia', 'Coupe de France', 'DFB-Pokal', 'Carabao Cup', 'Super Cup', 'Eredivisie', 'Liga Portugal', 'EFL Championship', 'Brasileirão', 'Belgian Pro League', "Women's Super League", 'LPF Playoffs', 'Argentine Primera', 'Scottish Cup', 'Liga MX', 'Saudi Pro League', 'Scottish Premiership', 'Copa del Rey', 'Super Lig', 'Greek Super League', 'FIFA U-20 World Cup', 'FIFA U-17 World Cup', 'Campeones Cup', 'USL Championship', "Women's UCL", 'CAF Qualifiers', 'UEFA Qualifiers', 'AFC Asian Cup Qualifiers', 'AFC Qualifiers', 'CONCACAF Qualifiers', 'Club Friendly', 'International Friendly', 'AFCON'].includes(displayLeagueForCheck);
                    
                    // Apply granular time logic for featured games (same as regular games)
                    let timeColumnTop = displayTimeLabel; // Default: keep as-is
                    let timeColumnBottom = ''; // Default: empty
                    
                    if (!isSoccerLeague && isLive) {
                        // RULE: For live games with quarters/halves/periods that have time remaining:
                        // Top line: ONLY "1st", "2nd", "3rd", "4th", or "OT" (period/quarter only)
                        // Bottom line: ONLY time format like "9:59", "0:40" (numbers with colon)
                        
                        let periodQuarter = '';
                        let timeRemaining = '';
                        
                        // ALWAYS try to parse from displayTimeLabel first (which may have "1st<br>9:53" format)
                        if (displayTimeLabel) {
                            // Remove span tags and get inner content
                            const innerContent = displayTimeLabel.replace(/<span[^>]*>|<\/span>/g, '');
                            
                            // Check if it's halftime - show "HALF" without time
                            if (innerContent.toUpperCase() === "HALF" || innerContent.toUpperCase() === "HALFTIME") {
                                timeColumnTop = `<span style="color: red;">HALF</span>`;
                                timeColumnBottom = '';
                                periodQuarter = 'HALF'; // Set flag to skip further processing
                            } else if (innerContent.includes('<br>')) {
                                const parts = innerContent.split('<br>');
                                if (parts.length >= 2) {
                                    const topPart = parts[0].trim();
                                    const bottomPart = parts[1].trim();
                                    
                                    // Check if top part is "Half" or "HALF" - show "HALF" without time
                                    if (topPart.toUpperCase() === "HALF" || topPart.toUpperCase() === "HALFTIME") {
                                        timeColumnTop = `<span style="color: red;">HALF</span>`;
                                        timeColumnBottom = '';
                                        periodQuarter = 'HALF'; // Set flag to skip further processing
                                    } else {
                                    // Validate top part is ONLY period/quarter (1st, 2nd, 3rd, 4th, OT)
                                    if (topPart.match(/^(1st|2nd|3rd|4th|OT)$/i)) {
                                        periodQuarter = topPart.toLowerCase();
                                    }
                                    
                                    // Validate bottom part is ONLY time format (digits:digits)
                                    if (bottomPart.match(/^\d+:\d+$/)) {
                                        timeRemaining = bottomPart;
                                        }
                                    }
                                }
                            } else {
                                // No <br> - might be space-separated like "1st 9:53" or just period
                                // Try to extract period and time from space-separated format
                                const spaceMatch = innerContent.match(/^(1st|2nd|3rd|4th|OT)\s+(\d+:\d+)$/i);
                                if (spaceMatch) {
                                    periodQuarter = spaceMatch[1].toLowerCase();
                                    timeRemaining = spaceMatch[2];
                                } else if (innerContent.match(/^(1st|2nd|3rd|4th|OT)$/i)) {
                                    // Just period, no time
                                    periodQuarter = innerContent.toLowerCase();
                                }
                            }
                        }
                        
                        // If parsing from displayTimeLabel didn't work, try direct data fields
                        if (!periodQuarter || !timeRemaining) {
                            const currentPeriod = data['Current Period'] || data.currentPeriod || data.Stage || '';
                            const gameTime = data.GameTime || data.gameTime || data.displayClock || '';
                            
                            // Check if we have a period/quarter with time remaining (not "Half" or "Int")
                            const hasTimeRemaining = gameTime && gameTime !== "" && gameTime !== "-1";
                            const isHalftimeOrIntermission = currentPeriod && (
                                currentPeriod.includes("HALF") || 
                                currentPeriod.includes("INTERMISSION") ||
                                currentPeriod === "HALF" ||
                                currentPeriod === "HALFTIME" ||
                                currentPeriod === "HALF_TIME"
                            );
                            
                            // If halftime, show "HALF" without time
                            if (isHalftimeOrIntermission && !periodQuarter) {
                                timeColumnTop = `<span style="color: red;">HALF</span>`;
                                timeColumnBottom = '';
                                periodQuarter = 'HALF'; // Set flag to skip further processing
                            } else if (hasTimeRemaining && !isHalftimeOrIntermission && currentPeriod) {
                                // Extract period/quarter - ONLY allow "1st", "2nd", "3rd", "4th", or "OT"
                                if (!periodQuarter) {
                                    let period = currentPeriod;
                                    if (period === "1ST_QUARTER" || period === "FIRST_QUARTER") periodQuarter = "1st";
                                    else if (period === "2ND_QUARTER" || period === "SECOND_QUARTER") periodQuarter = "2nd";
                                    else if (period === "3RD_QUARTER" || period === "THIRD_QUARTER") periodQuarter = "3rd";
                                    else if (period === "4TH_QUARTER" || period === "FOURTH_QUARTER") periodQuarter = "4th";
                                    else if (period === "OVERTIME" || period === "OT") periodQuarter = "OT";
                                    else if (period === "1ST_PERIOD" || period === "FIRST_PERIOD") periodQuarter = "1st";
                                    else if (period === "2ND_PERIOD" || period === "SECOND_PERIOD") periodQuarter = "2nd";
                                    else if (period === "3RD_PERIOD" || period === "THIRD_PERIOD") periodQuarter = "3rd";
                                    else {
                                        // Handle any other quarter format
                                        period = period.replace('_QUARTER', '').replace('_PERIOD', '').replace('_', '');
                                        if (period === "FIRST" || period === "1ST") periodQuarter = "1st";
                                        else if (period === "SECOND" || period === "2ND") periodQuarter = "2nd";
                                        else if (period === "THIRD" || period === "3RD") periodQuarter = "3rd";
                                        else if (period === "FOURTH" || period === "4TH") periodQuarter = "4th";
                                        else if (period === "OVERTIME" || period === "OT") periodQuarter = "OT";
                                    }
                                }
                                
                                // Extract time - ONLY format like "9:59", "0:40" (numbers with colon)
                                if (!timeRemaining && gameTime) {
                                    let timeStr = gameTime;
                                    // Ensure it has colon format
                                    if (!timeStr.includes(':')) {
                                        timeStr = timeStr + ':00';
                                    }
                                    // Validate it matches time format (digits:digits)
                                    if (timeStr.match(/^\d+:\d+$/)) {
                                        timeRemaining = timeStr;
                                    }
                                }
                            }
                        }
                        
                        // Set time column values - STRICT: only period on top, only time on bottom
                        if (periodQuarter === 'HALF') {
                            // Already set above, do nothing
                        } else if (periodQuarter && (periodQuarter === "1st" || periodQuarter === "2nd" || periodQuarter === "3rd" || periodQuarter === "4th" || periodQuarter === "OT")) {
                            timeColumnTop = `<span style="color: red;">${periodQuarter}</span>`;
                        } else {
                            // If we don't have a valid period/quarter, check if displayTimeLabel is "Half" and convert to "HALF"
                            const innerContent = displayTimeLabel ? displayTimeLabel.replace(/<span[^>]*>|<\/span>/g, '') : '';
                            if (innerContent.toUpperCase() === "HALF" || innerContent.toUpperCase() === "HALFTIME") {
                                timeColumnTop = `<span style="color: red;">HALF</span>`;
                                timeColumnBottom = '';
                            } else {
                            timeColumnTop = displayTimeLabel;
                            }
                        }
                        
                        if (timeRemaining && timeRemaining.match(/^\d+:\d+$/)) {
                            timeColumnBottom = `<span style="color: red;">${timeRemaining}</span>`;
                        }
                    }
                        
                    let displayAwayScore = awayScore ?? '';
                    let displayHomeScore = homeScore ?? '';
                        
                    // For yesterdayScores, always show scores (convert to string, show 0 if needed)
                    if (isYesterdayScores) {
                        displayAwayScore = (awayScore !== null && awayScore !== undefined) ? String(awayScore) : '';
                        displayHomeScore = (homeScore !== null && homeScore !== undefined) ? String(homeScore) : '';
                    } else if (!isLive && !isFinal) {
                       displayAwayScore = '';
                       displayHomeScore = '';
                    }

                    // Determine losing team color for final games
                    let homeColor = '';
                    let awayColor = '';
                    let homeScoreColor = '';
                    let awayScoreColor = '';
                    if (isFinal) {
                        if (isPostponedFinal) {
                            // All text in postponed games is #545353
                            homeColor = 'color: #545353;';
                            awayColor = 'color: #545353;';
                            homeScoreColor = 'color: #545353;';
                            awayScoreColor = 'color: #545353;';
                        } else {
                            const homeScoreNum = parseFloat(homeScore) || 0;
                            const awayScoreNum = parseFloat(awayScore) || 0;
                            if (homeScoreNum < awayScoreNum) {
                                homeColor = 'color: #7f7f7f;';
                                homeScoreColor = 'color: #7f7f7f;';
                            } else if (awayScoreNum < homeScoreNum) {
                                awayColor = 'color: #7f7f7f;';
                                awayScoreColor = 'color: #7f7f7f;';
                            }
                        }
                    }

                    const row1 = currentTable.insertRow();
                    row1.className = "game-row";
                    const row2 = currentTable.insertRow();
                    row2.className = "game-row game-separator";
                    
                    // Add special class for ATP Finals (Doubles) to add extra spacing
                    const isAtpDoubles = displayLeagueForCheck === "ATP Finals (Doubles)";
                    if (isAtpDoubles) {
                        row2.classList.add("atp-doubles-match");
                    }
                    
                    // Set channel display - use Tennis Channel for ATP leagues, otherwise use data.channel
                    let featuredChannelToDisplay = data.channel || '';
                    if (data.League && data.League.includes('ATP')) {
                        featuredChannelToDisplay = 'Tennis Channel';
                    }
                    let featuredChannelDisplay = (!isFinal && featuredChannelToDisplay) ? featuredChannelToDisplay : '';
                    
                    // For UFC and Boxing: if no channel, make team names gray (#C0C0C0)
                    const isFeaturedUFCOrBoxing = displayLeagueForCheck === 'UFC' || displayLeagueForCheck === 'Boxing';
                    if (isFeaturedUFCOrBoxing && !isFinal) {
                        if (!featuredChannelDisplay || featuredChannelDisplay.trim() === '') {
                            // Only apply gray color if there's no existing color set (not a final game with losing team color)
                            if (!homeColor) {
                                homeColor = 'color: #C0C0C0;';
                            }
                            if (!awayColor) {
                                awayColor = 'color: #C0C0C0;';
                            }
                        }
                    }
                    
                    if (isSoccerLeague) {
                        // Soccer: home team on top, away team on bottom (opposite of non-soccer)
                        // Time on top line (same as other leagues)
                        row1.innerHTML = `<td style="text-align: center; font-size: 11px; vertical-align: top; padding: 2px 1px; box-sizing: border-box;">${timeColumnTop}</td><td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; ${homeWhiteSpace} font-size: 11px; box-sizing: border-box; ${homeColor}">${home}</td><td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${homeScoreColor}">${displayHomeScore}</td><td rowspan="2" style="position: relative; text-align: center; font-size: 10px; color: #9ca3af; padding: 2px 1px; box-sizing: border-box; overflow: hidden;"><div style="position: absolute; top: 35%; left: 50%; transform: translate(-50%, -50%); max-width: calc(100% - 4px); word-wrap: break-word;">${featuredChannelDisplay}</div></td>`;
                        row2.innerHTML = `<td style="text-align: center; font-size: 11px; padding: 2px 1px; box-sizing: border-box;">${timeColumnBottom}</td><td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; ${awayWhiteSpace} font-size: 11px; box-sizing: border-box; ${awayColor}">${away}</td><td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${awayScoreColor}">${displayAwayScore}</td>`;
                    } else {
                        // All other leagues: away team on top, home team on bottom
                        // Period/quarter goes in time column top row (same line as top team), time remaining goes in time column bottom row (same line as bottom team)
                        // Remove rowspan="2" from time column to allow separate content in each row
                        row1.innerHTML = `<td style="text-align: center; font-size: 11px; vertical-align: top; padding: 2px 1px; box-sizing: border-box;">${timeColumnTop}</td><td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; ${awayWhiteSpace} font-size: 11px; box-sizing: border-box; ${awayColor}">${away}</td><td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${awayScoreColor}">${displayAwayScore}</td><td rowspan="2" style="position: relative; text-align: center; font-size: 10px; color: #9ca3af; padding: 2px 1px; box-sizing: border-box; overflow: hidden;"><div style="position: absolute; top: 35%; left: 50%; transform: translate(-50%, -50%); max-width: calc(100% - 4px); word-wrap: break-word;">${featuredChannelDisplay}</div></td>`;
                        row2.innerHTML = `<td style="text-align: center; font-size: 11px; padding: 2px 1px; box-sizing: border-box;">${timeColumnBottom}</td><td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; ${homeWhiteSpace} font-size: 11px; box-sizing: border-box; ${homeColor}">${home}</td><td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${homeScoreColor}">${displayHomeScore}</td>`;
                    }

                    let gameStatusClass = 'scheduled-game';
                    if (isLive) gameStatusClass = 'live-game';
                    if (isFinal) gameStatusClass = 'final-game';
                    row1.classList.add(gameStatusClass);
                    row2.classList.add(gameStatusClass);
                    
                    // Store match status in data attribute for filtering
                    // Check multiple possible field names for match status
                    // For ESPN API games, also check StageType if Match Status is empty
                    let matchStatusValue = (data["Match Status"] || data.matchStatus || data["matchStatus"] || "").toUpperCase().trim();
                    if (!matchStatusValue && (data["StageType"] || data.StageType)) {
                        matchStatusValue = (data["StageType"] || data.StageType || "").toUpperCase().trim();
                    }
                    if (row1) {
                        row1.dataset.matchStatus = matchStatusValue;
                    }
                    if (row2) {
                        row2.dataset.matchStatus = matchStatusValue;
                    }
                    
                // Add separator line between games (but not after the last game in the same table)
                if (i < sortedFeaturedGames.length - 1) {
                    const nextData = sortedFeaturedGames[i + 1];
                    const nextTitleText = isYesterdayScores 
                        ? (nextData.yesterdayTitle || nextData.title || getLeagueDisplayName(nextData.League, nextData.Sport) || "Other")
                        : (nextData.title || getLeagueDisplayName(nextData.League, nextData.Sport) || "Other");
                    // Only add separator if next game is in the same table (same title)
                    if (nextTitleText === titleText) {
                        // Get the NEXT game's time label to determine if the line above it should be full width
                        const nextRawStart = nextData["Start Time"];
                        const nextMatchStatus = (nextData["Match Status"] || "").toUpperCase();
                        const nextStageValue = (nextData["Stage"] || "").toUpperCase();
                        const nextStageTypeValue = (nextData["StageType"] || "").toUpperCase();
                        const nextStatusValue = (nextData["Status"] || "").toUpperCase();
                        // Check if POSTPONED is in any field (Stage, Status, StageType, or Match Status)
                        const nextIsPostponed = nextStageValue.includes("POSTPONED") || nextStatusValue.includes("POSTPONED") || nextStageTypeValue.includes("POSTPONED") || nextMatchStatus.includes("POSTPONED");
                        // Check if CANCELED is in any field (Stage, Status, StageType, or Match Status)
                        const nextIsCanceled = nextStageValue.includes("CANCELED") || nextStatusValue.includes("CANCELED") || nextStageTypeValue.includes("CANCELED") || nextMatchStatus.includes("CANCELED");
                        const nextIsLive = isYesterdayScores ? false : (nextMatchStatus.includes("IN PROGRESS") || nextMatchStatus.includes("LIVE"));
                        const nextIsFinal = isYesterdayScores || nextMatchStatus.includes("FINISHED") || nextMatchStatus.includes("FINAL") || nextMatchStatus.includes("GAME OVER");
                        const nextIsPostponedFinal = nextIsFinal && nextIsPostponed;
                        const nextIsCanceledFinal = nextIsFinal && nextIsCanceled;
                        let nextTimeLabel = "";
                        
                        if (nextData.timeString === '') {
                            nextTimeLabel = "";
                        } else if (nextIsLive) {
                            nextTimeLabel = "Live";
                        } else if (nextIsPostponed) {
                            nextTimeLabel = '<span style="color: #545353;">PPD</span>';
                        } else if (nextIsCanceled) {
                            nextTimeLabel = '<span style="color: #545353;">Canceled</span>';
                        } else if (nextIsFinal) {
                            nextTimeLabel = "F";
                        } else if (nextRawStart && nextRawStart.toDate) {
                            nextTimeLabel = luxon.DateTime.fromJSDate(nextRawStart.toDate()).toFormat('h:mm a');
                        } else {
                            nextTimeLabel = "TBD";
                        }
                        
                        const nextNormalizedTimeLabel = (!nextIsLive && !nextIsFinal) ? normalizeDisplayTime(nextTimeLabel) : null;
                        const nextGameTimeLabel = nextNormalizedTimeLabel || nextTimeLabel;
                        
                        // Check if next game has a different start time from current game
                        const currentGameTimeLabel = normalizedTimeLabel || currentTimeLabel;
                        const isDifferentTime = nextGameTimeLabel !== currentGameTimeLabel;
                        
                        // If next game has different time, full width (colspan="4"), otherwise partial width (colspan="3")
                        const colspan = isDifferentTime ? 4 : 3;
                        const firstCell = isDifferentTime ? '' : '<td style="padding: 0; border: none; width: 32%;"></td>';
                        
                        const separatorRow = currentTable.insertRow();
                        separatorRow.className = "game-separator-line";
                        separatorRow.innerHTML = `${firstCell}<td colspan="${colspan}" style="padding: 0 0 10px 0; border: none;"><div style="border-top: 1px solid #000000; margin: 0;"></div></td>`;
                    }
                }
                
                // Update previous game time label and increment game index for next iteration
                previousGameTimeLabel = normalizedTimeLabel || currentTimeLabel;
                gameIndexInTable++;
                    
                    // Add spacer row after ATP doubles matches for extra spacing
                    if (isAtpDoubles) {
                        const spacerRow = currentTable.insertRow();
                        spacerRow.className = "atp-doubles-spacer";
                        spacerRow.innerHTML = '<td colspan="4" style="height: 1.5em; padding: 0; border: none; line-height: 0;"></td>';
                    }
                }
                
                container.appendChild(leagueSection);
                return; // Skip normal rendering for FEATURED
            }
            const table = document.createElement("table");
            table.className = "game-table";
            table.style.width = "100%";
            table.style.maxWidth = "100%";
            table.style.borderCollapse = "collapse";
            table.style.tableLayout = "fixed";
            
            // Add colgroup with percentage widths to work in both contexts
            const colgroup = document.createElement("colgroup");
            // Normal leagues: 4 columns
            colgroup.innerHTML = `
                <col style="width: 32%;">   <!-- time -->
                <col style="width: 32%;">  <!-- team -->
                <col style="width: 10%;">   <!-- score -->
                <col style="width: 26%;">   <!-- channel -->
            `;
            table.appendChild(colgroup);
            
            let lastDisplayedTimeLabel = null;
            let lastDisplayedTimeLabelAll = null;
            let previousGameTimeLabel = null; // Track previous game's time for separator logic
            const gameRowPairs = [];
            const separatorRows = []; // Track separator rows for visibility control
            let hasHiddenGames = false;

            // Add spacer row for 5px top padding
            const spacerRow = table.insertRow();
            spacerRow.innerHTML = `<td colspan="4" style="height: 5px; padding: 0; border: none;"></td>`;

            // Process games - handle Boxing separately if needed
            for (let i = 0; i < games.length; i++) {
                const data = games[i];
                const displayLeague = getLeagueDisplayName(data.League, data.Sport);
                const leagueKey = getLeagueKeyFromGame(data);
                const homeDisplay = getTeamDisplayName(data["Home Team"] || "", displayLeague);
                const awayDisplay = getTeamDisplayName(data["Away Team"] || "", displayLeague);
                // Use detectedLeagueKey for important game check to ensure consistency on league-specific pages
                const leagueKeyForImportance = shouldPrioritizeImportant ? detectedLeagueKey : leagueKey;
                const isImportantGame = shouldPrioritizeImportant ? isImportantNcaaGame(homeDisplay, awayDisplay, leagueKeyForImportance, data) : true;
                if (shouldPrioritizeImportant && !isImportantGame) {
                    hasHiddenGames = true;
                }
                const home = formatTeamNameWithRanking(homeDisplay, leagueKey);
                const away = formatTeamNameWithRanking(awayDisplay, leagueKey);
                // Check if names contain <br> (doubles tennis) to adjust styling
                const isHomeDoubles = homeDisplay.includes('<br>');
                const isAwayDoubles = awayDisplay.includes('<br>');
                const homeWhiteSpace = isHomeDoubles ? 'white-space: normal;' : 'white-space: nowrap;';
                const awayWhiteSpace = isAwayDoubles ? 'white-space: normal;' : 'white-space: nowrap;';
                // Try multiple possible field names for scores
                const homeScore = data["Home Score"] || data["HomeScore"] || data.homeScore || '';
                const awayScore = data["Away Score"] || data["AwayScore"] || data.awayScore || '';
                const matchStatus = (data["Match Status"] || "").toUpperCase();
                const stageValue = (data["Stage"] || "").toUpperCase();
                const stageTypeValue = (data["StageType"] || "").toUpperCase();
                const statusValue = (data["Status"] || "").toUpperCase();
                const rawStart = data["Start Time"];
                
                // Check if POSTPONED is in any field (Stage, Status, StageType, or Match Status)
                const isPostponed = stageValue.includes("POSTPONED") || statusValue.includes("POSTPONED") || stageTypeValue.includes("POSTPONED") || matchStatus.includes("POSTPONED");
                // Check if CANCELED is in any field (Stage, Status, StageType, or Match Status)
                const isCanceled = stageValue.includes("CANCELED") || statusValue.includes("CANCELED") || stageTypeValue.includes("CANCELED") || matchStatus.includes("CANCELED");
                
                // For yesterdayScores, never show live; always treat as final
                const isLive = isYesterdayScores ? false : (matchStatus.includes("IN PROGRESS") || matchStatus.includes("LIVE"));
                const isFinal = isYesterdayScores || matchStatus.includes("FINISHED") || matchStatus.includes("FINAL") || matchStatus.includes("GAME OVER");
                const isPostponedFinal = isFinal && isPostponed;
                const isCanceledFinal = isFinal && isCanceled;
                let currentTimeLabel = "";

                // Check if timeString field exists and is empty (manual games with blank time)
                if (data.timeString === '') {
                    currentTimeLabel = ""; // Display as empty for blank times
                } else if (isLive) {
                    let parsedStatus = '';
                    const displayLeague = getLeagueDisplayName(data.League, data.Sport);
                    if (displayLeague === "MLB") {
                        const inningHalf = data.inningHalf || "";
                        const currentInning = data.currentInning || "";
                        if (inningHalf && currentInning) parsedStatus = `${inningHalf.slice(0,3)} ${currentInning}`;
                    } else {
                        // Use granular live status for ALL sports (including EFL Cup, Coppa Italia, etc.)
                        parsedStatus = getGranularLiveStatus(data);
                    }
                    currentTimeLabel = parsedStatus ? `<span style="color: red;">${parsedStatus}</span>` : '<span style="color: red;">Live</span>';
                } else if (isPostponed) {
                    currentTimeLabel = '<span style="color: #545353;">PPD</span>';
                } else if (isCanceled) {
                    currentTimeLabel = '<span style="color: #545353;">Canceled</span>';
                } else if (isFinal) {
                    currentTimeLabel = "F";
                } else if (rawStart && rawStart.toDate) {
                    currentTimeLabel = luxon.DateTime.fromJSDate(rawStart.toDate(), { zone: 'utc' }).setZone('local').toFormat('h:mm a');
                } else {
                    currentTimeLabel = "TBD";
                }

                const normalizedTimeLabel = (!isLive && !isFinal) ? normalizeDisplayTime(currentTimeLabel) : null;
                let displayTimeLabel = currentTimeLabel;
                if (!isLive && !isFinal && normalizedTimeLabel && normalizedTimeLabel !== 'TBD') {
                    if (shouldPrioritizeImportant && !isImportantGame) {
                        if (normalizedTimeLabel === lastDisplayedTimeLabelAll) {
                            displayTimeLabel = "";
                        } else {
                            lastDisplayedTimeLabelAll = normalizedTimeLabel;
                        }
                    } else {
                        const comparisonLabel = shouldPrioritizeImportant ? lastDisplayedTimeLabel : lastDisplayedTimeLabelAll;
                        if (normalizedTimeLabel === comparisonLabel) {
                            displayTimeLabel = "";
                        } else {
                            if (shouldPrioritizeImportant) {
                                lastDisplayedTimeLabel = normalizedTimeLabel;
                            }
                            lastDisplayedTimeLabelAll = normalizedTimeLabel;
                        }
                    }
                }
                
                let displayAwayScore = awayScore ?? '';
                let displayHomeScore = homeScore ?? '';
                
                // For yesterdayScores, always show scores (convert to string, show 0 if needed)
                if (isYesterdayScores) {
                    // Show score if it exists (including 0), otherwise empty string
                    displayAwayScore = (awayScore !== null && awayScore !== undefined && awayScore !== '') ? String(awayScore) : '';
                    displayHomeScore = (homeScore !== null && homeScore !== undefined && homeScore !== '') ? String(homeScore) : '';
                    // Debug: console.log('Score check:', { awayScore, homeScore, displayAwayScore, displayHomeScore, data });
                } else if (!isLive && !isFinal) {
                   displayAwayScore = '';
                   displayHomeScore = '';
                }

                // Determine losing team color for final games
                let homeColor = '';
                let awayColor = '';
                let homeScoreColor = '';
                let awayScoreColor = '';
                if (isFinal) {
                    if (isPostponedFinal || isCanceledFinal) {
                        // All text in postponed or canceled games is #545353
                        homeColor = 'color: #545353;';
                        awayColor = 'color: #545353;';
                        homeScoreColor = 'color: #545353;';
                        awayScoreColor = 'color: #545353;';
                    } else {
                        const homeScoreNum = parseFloat(homeScore) || 0;
                        const awayScoreNum = parseFloat(awayScore) || 0;
                        if (homeScoreNum < awayScoreNum) {
                            homeColor = 'color: #7f7f7f;';
                            homeScoreColor = 'color: #7f7f7f;';
                        } else if (awayScoreNum < homeScoreNum) {
                            awayColor = 'color: #7f7f7f;';
                            awayScoreColor = 'color: #7f7f7f;';
                        }
                    }
                }
                
                // Set channel display - use Tennis Channel for ATP leagues, otherwise use data.channel
                let channelToDisplay = data.channel || '';
                if (data.League && data.League.includes('ATP')) {
                    channelToDisplay = 'Tennis Channel';
                }
                const channelDisplay = (channelToDisplay && !isFinal) ? channelToDisplay : '';
                
                // For UFC and Boxing: handle sub-items (gray text, no time) vs main items (white text, shows time)
                const isUFCOrBoxing = displayLeague === 'UFC' || displayLeague === 'Boxing';
                const isSubItem = data.isSubItem === true; // Check if this is a sub-item
                
                if (isUFCOrBoxing && !isFinal) {
                    if (isSubItem) {
                        // Sub-item: gray text, no time
                        displayTimeLabel = ""; // Don't show time for sub-items
                        if (!homeColor) {
                            homeColor = 'color: #C0C0C0;'; // Light gray
                        }
                        if (!awayColor) {
                            awayColor = 'color: #C0C0C0;'; // Light gray
                        }
                    } else {
                        // Main item: white text (normal), shows time
                        // Only apply gray if no channel (old behavior for backward compatibility)
                    if (!channelDisplay || channelDisplay.trim() === '') {
                        // Only apply gray color if there's no existing color set (not a final game with losing team color)
                        if (!homeColor) {
                            homeColor = 'color: #C0C0C0;';
                        }
                        if (!awayColor) {
                            awayColor = 'color: #C0C0C0;';
                            }
                        }
                    }
                }

                const row1 = table.insertRow();
                row1.className = "game-row";
                const row2 = table.insertRow();
                row2.className = "game-row game-separator";
                
                // Add special class for ATP Finals (Doubles) to add extra spacing
                const isAtpDoubles = displayLeague === "ATP Finals (Doubles)";
                if (isAtpDoubles) {
                    row2.classList.add("atp-doubles-match");
                }
                
                // Check if this is a soccer league - soccer leagues show home on top, away on bottom
                // displayLeague already declared above
                const isSoccerLeague = ['Premier League', 'LaLiga', 'Serie A', 'Serie B', 'Bundesliga', 'Ligue 1', 'MLS', 'UEFA Champions League', 'AFC Champions League', 'UEFA Europa League', 'UEFA Conference League', 'NWSL', 'FA Cup', 'Coppa Italia', 'Coupe de France', 'DFB-Pokal', 'Carabao Cup', 'Super Cup', 'Eredivisie', 'Liga Portugal', 'EFL Championship', 'Brasileirão', 'Belgian Pro League', "Women's Super League", 'LPF Playoffs', 'Argentine Primera', 'Scottish Cup', 'Liga MX', 'Saudi Pro League', 'Scottish Premiership', 'Copa del Rey', 'Super Lig', 'Greek Super League', 'FIFA U-20 World Cup', 'FIFA U-17 World Cup', 'Campeones Cup', 'USL Championship', "Women's UCL", 'CAF Qualifiers', 'UEFA Qualifiers', 'AFC Asian Cup Qualifiers', 'Copa Libertadores', 'Copa Sudamericana', 'AFC Qualifiers', 'CONCACAF Qualifiers', 'Club Friendly', 'AFCON'].includes(displayLeague);
                
                // Check if we're rendering in the league-specific column (for font size adjustment)
                const isLeagueSpecificColumn = container.closest('#league-specific-column') !== null;
                const timeFontSize = isLeagueSpecificColumn ? '10px' : '11px';
                
                // Check if both teams are doubles (for spacing between first and second team)
                const isDoublesMatch = isHomeDoubles && isAwayDoubles;
                const row2TeamCellPadding = isDoublesMatch ? 'padding: 7px 1px 2px 1px;' : 'padding: 2px 1px;'; // Add 5px extra top padding for doubles
                
                // Extract period/quarter and time directly from game data for non-soccer sports
                let timeColumnTop = displayTimeLabel; // Default: keep as-is
                let timeColumnBottom = ''; // Default: empty
                
                if (!isSoccerLeague && isLive) {
                    // RULE: For live games with quarters/halves/periods that have time remaining:
                    // Top line: ONLY "1st", "2nd", "3rd", "4th", or "OT" (period/quarter only)
                    // Bottom line: ONLY time format like "9:59", "0:40" (numbers with colon)
                    
                    let periodQuarter = '';
                    let timeRemaining = '';
                    
                    // ALWAYS try to parse from displayTimeLabel first (which may have "1st<br>9:53" format)
                    if (displayTimeLabel) {
                        // Remove span tags and get inner content
                        const innerContent = displayTimeLabel.replace(/<span[^>]*>|<\/span>/g, '');
                        
                        // Check if it's halftime - show "HALF" without time
                        if (innerContent.toUpperCase() === "HALF" || innerContent.toUpperCase() === "HALFTIME") {
                            timeColumnTop = `<span style="color: red;">HALF</span>`;
                            timeColumnBottom = '';
                            periodQuarter = 'HALF'; // Set flag to skip further processing
                        } else if (innerContent.includes('<br>')) {
                            const parts = innerContent.split('<br>');
                            if (parts.length >= 2) {
                                const topPart = parts[0].trim();
                                const bottomPart = parts[1].trim();
                                
                                // Check if top part is "Half" or "HALF" - show "HALF" without time
                                if (topPart.toUpperCase() === "HALF" || topPart.toUpperCase() === "HALFTIME") {
                                    timeColumnTop = `<span style="color: red;">HALF</span>`;
                                    timeColumnBottom = '';
                                    periodQuarter = 'HALF'; // Set flag to skip further processing
                                } else {
                                // Validate top part is ONLY period/quarter (1st, 2nd, 3rd, 4th, OT)
                                if (topPart.match(/^(1st|2nd|3rd|4th|OT)$/i)) {
                                    periodQuarter = topPart.toLowerCase();
                                }
                                
                                // Validate bottom part is ONLY time format (digits:digits)
                                if (bottomPart.match(/^\d+:\d+$/)) {
                                    timeRemaining = bottomPart;
                                    }
                                }
                            }
                        } else {
                            // No <br> - might be space-separated like "1st 9:53" or just period
                            // Try to extract period and time from space-separated format
                            const spaceMatch = innerContent.match(/^(1st|2nd|3rd|4th|OT)\s+(\d+:\d+)$/i);
                            if (spaceMatch) {
                                periodQuarter = spaceMatch[1].toLowerCase();
                                timeRemaining = spaceMatch[2];
                            } else if (innerContent.match(/^(1st|2nd|3rd|4th|OT)$/i)) {
                                // Just period, no time
                                periodQuarter = innerContent.toLowerCase();
                            }
                        }
                    }
                    
                    // If parsing from displayTimeLabel didn't work, try direct data fields
                    if (!periodQuarter || !timeRemaining) {
                        const currentPeriod = data['Current Period'] || data.currentPeriod || data.Stage || '';
                        const gameTime = data.GameTime || data.gameTime || data.displayClock || '';
                        
                        // Check if we have a period/quarter with time remaining (not "Half" or "Int")
                        const hasTimeRemaining = gameTime && gameTime !== "" && gameTime !== "-1";
                        const isHalftimeOrIntermission = currentPeriod && (
                            currentPeriod.includes("HALF") || 
                            currentPeriod.includes("INTERMISSION") ||
                            currentPeriod === "HALF" ||
                            currentPeriod === "HALFTIME" ||
                            currentPeriod === "HALF_TIME"
                        );
                        
                        // If halftime, show "HALF" without time
                        if (isHalftimeOrIntermission && !periodQuarter) {
                            timeColumnTop = `<span style="color: red;">HALF</span>`;
                            timeColumnBottom = '';
                            periodQuarter = 'HALF'; // Set flag to skip further processing
                        } else if (hasTimeRemaining && !isHalftimeOrIntermission && currentPeriod) {
                            // Extract period/quarter - ONLY allow "1st", "2nd", "3rd", "4th", or "OT"
                            if (!periodQuarter) {
                                let period = currentPeriod;
                                if (period === "1ST_QUARTER" || period === "FIRST_QUARTER") periodQuarter = "1st";
                                else if (period === "2ND_QUARTER" || period === "SECOND_QUARTER") periodQuarter = "2nd";
                                else if (period === "3RD_QUARTER" || period === "THIRD_QUARTER") periodQuarter = "3rd";
                                else if (period === "4TH_QUARTER" || period === "FOURTH_QUARTER") periodQuarter = "4th";
                                else if (period === "OVERTIME" || period === "OT") periodQuarter = "OT";
                                else if (period === "1ST_PERIOD" || period === "FIRST_PERIOD") periodQuarter = "1st";
                                else if (period === "2ND_PERIOD" || period === "SECOND_PERIOD") periodQuarter = "2nd";
                                else if (period === "3RD_PERIOD" || period === "THIRD_PERIOD") periodQuarter = "3rd";
                                else {
                                    // Handle any other quarter format
                                    period = period.replace('_QUARTER', '').replace('_PERIOD', '').replace('_', '');
                                    if (period === "FIRST" || period === "1ST") periodQuarter = "1st";
                                    else if (period === "SECOND" || period === "2ND") periodQuarter = "2nd";
                                    else if (period === "THIRD" || period === "3RD") periodQuarter = "3rd";
                                    else if (period === "FOURTH" || period === "4TH") periodQuarter = "4th";
                                    else if (period === "OVERTIME" || period === "OT") periodQuarter = "OT";
                                }
                            }
                            
                            // Extract time - ONLY format like "9:59", "0:40" (numbers with colon)
                            if (!timeRemaining && gameTime) {
                                let timeStr = gameTime;
                                // Ensure it has colon format
                                if (!timeStr.includes(':')) {
                                    timeStr = timeStr + ':00';
                                }
                                // Validate it matches time format (digits:digits)
                                if (timeStr.match(/^\d+:\d+$/)) {
                                    timeRemaining = timeStr;
                                }
                            }
                        }
                    }
                    
                    // Set time column values - STRICT: only period on top, only time on bottom
                    if (periodQuarter === 'HALF') {
                        // Already set above, do nothing
                    } else if (periodQuarter && (periodQuarter === "1st" || periodQuarter === "2nd" || periodQuarter === "3rd" || periodQuarter === "4th" || periodQuarter === "OT")) {
                        timeColumnTop = `<span style="color: red;">${periodQuarter}</span>`;
                    } else {
                        // If we don't have a valid period/quarter, check if displayTimeLabel is "Half" and convert to "HALF"
                        const innerContent = displayTimeLabel ? displayTimeLabel.replace(/<span[^>]*>|<\/span>/g, '') : '';
                        if (innerContent.toUpperCase() === "HALF" || innerContent.toUpperCase() === "HALFTIME") {
                            timeColumnTop = `<span style="color: red;">HALF</span>`;
                            timeColumnBottom = '';
                        } else {
                        timeColumnTop = displayTimeLabel;
                        }
                    }
                    
                    if (timeRemaining && timeRemaining.match(/^\d+:\d+$/)) {
                        timeColumnBottom = `<span style="color: red;">${timeRemaining}</span>`;
                    }
                }
                
                if (isSoccerLeague) {
                    // Soccer: home team on top, away team on bottom (opposite of non-soccer)
                    // Time on top line (same as other leagues)
                    row1.innerHTML = `<td style="text-align: center; font-size: ${timeFontSize}; vertical-align: top; padding: 2px 1px; box-sizing: border-box;">${timeColumnTop}</td><td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; ${homeWhiteSpace} font-size: 11px; box-sizing: border-box; ${homeColor}">${home}</td><td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${homeScoreColor}">${displayHomeScore}</td><td rowspan="2" style="position: relative; text-align: center; font-size: 10px; color: #9ca3af; padding: 2px 1px; box-sizing: border-box; overflow: hidden;" class="channel-cell-desktop"><div style="position: absolute; top: 35%; left: 50%; transform: translate(-50%, -50%); max-width: calc(100% - 4px); word-wrap: break-word;">${channelDisplay}</div></td>`;
                    row2.innerHTML = `<td style="text-align: center; font-size: ${timeFontSize}; padding: 2px 1px; box-sizing: border-box;">${timeColumnBottom}</td><td class="team-cell" style="${row2TeamCellPadding} overflow: hidden; text-overflow: ellipsis; ${awayWhiteSpace} font-size: 11px; box-sizing: border-box; ${awayColor}">${away}</td><td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${awayScoreColor}">${displayAwayScore}</td>`;
                } else {
                    // All other leagues: away team on top, home team on bottom
                    // Period/quarter goes in time column top row (same line as top team), time remaining goes in time column bottom row (same line as bottom team)
                    // Remove rowspan="2" from time column to allow separate content in each row
                    row1.innerHTML = `<td style="text-align: center; font-size: ${timeFontSize}; vertical-align: top; padding: 2px 1px; box-sizing: border-box;">${timeColumnTop}</td><td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; ${awayWhiteSpace} font-size: 11px; box-sizing: border-box; ${awayColor}">${away}</td><td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${awayScoreColor}">${displayAwayScore}</td><td rowspan="2" style="position: relative; text-align: center; font-size: 10px; color: #9ca3af; padding: 2px 1px; box-sizing: border-box; overflow: hidden;" class="channel-cell-desktop"><div style="position: absolute; top: 35%; left: 50%; transform: translate(-50%, -50%); max-width: calc(100% - 4px); word-wrap: break-word;">${channelDisplay}</div></td>`;
                    row2.innerHTML = `<td style="text-align: center; font-size: ${timeFontSize}; padding: 2px 1px; box-sizing: border-box;">${timeColumnBottom}</td><td class="team-cell" style="${row2TeamCellPadding} overflow: hidden; text-overflow: ellipsis; ${homeWhiteSpace} font-size: 11px; box-sizing: border-box; ${homeColor}">${home}</td><td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${homeScoreColor}">${displayHomeScore}</td>`;
                }

                if (shouldPrioritizeImportant) {
                    const importanceValue = isImportantGame ? 'important' : 'non-important';
                    row1.dataset.importance = importanceValue;
                    if (row2) row2.dataset.importance = importanceValue;

                    const timeCell = row1.cells[0];
                    if (timeCell) {
                        row1.dataset.originalTimeHtml = timeCell.innerHTML;
                    } else {
                        row1.dataset.originalTimeHtml = "";
                    }
                    row1.dataset.normalizedTime = normalizedTimeLabel || '';
                    gameRowPairs.push({ row1, row2 });
                }

                let gameStatusClass = 'scheduled-game';
                if (isLive) gameStatusClass = 'live-game';
                if (isFinal) gameStatusClass = 'final-game';
                row1.classList.add(gameStatusClass);
                row2.classList.add(gameStatusClass);
                
                // Store match status in data attribute for filtering
                // Check multiple possible field names for match status
                // For ESPN API games, also check StageType if Match Status is empty
                let matchStatusValue = (data["Match Status"] || data.matchStatus || data["matchStatus"] || "").toUpperCase().trim();
                if (!matchStatusValue && (data["StageType"] || data.StageType)) {
                    matchStatusValue = (data["StageType"] || data.StageType || "").toUpperCase().trim();
                }
                if (row1) {
                    row1.dataset.matchStatus = matchStatusValue;
                }
                if (row2) {
                    row2.dataset.matchStatus = matchStatusValue;
                }
                
                // Add separator line between games (but not after the last game)
                if (i < games.length - 1) {
                    // Get the NEXT game's time label to determine if the line above it should be full width
                    const nextData = games[i + 1];
                    const nextRawStart = nextData["Start Time"];
                    const nextMatchStatus = (nextData["Match Status"] || "").toUpperCase();
                    const nextStageValue = (nextData["Stage"] || "").toUpperCase();
                    const nextStageTypeValue = (nextData["StageType"] || "").toUpperCase();
                    const nextStatusValue = (nextData["Status"] || "").toUpperCase();
                    // Check if POSTPONED is in any field (Stage, Status, StageType, or Match Status)
                    const nextIsPostponed = nextStageValue.includes("POSTPONED") || nextStatusValue.includes("POSTPONED") || nextStageTypeValue.includes("POSTPONED") || nextMatchStatus.includes("POSTPONED");
                    // Check if CANCELED is in any field (Stage, Status, StageType, or Match Status)
                    const nextIsCanceled = nextStageValue.includes("CANCELED") || nextStatusValue.includes("CANCELED") || nextStageTypeValue.includes("CANCELED") || nextMatchStatus.includes("CANCELED");
                    const nextIsLive = isYesterdayScores ? false : (nextMatchStatus.includes("IN PROGRESS") || nextMatchStatus.includes("LIVE"));
                    const nextIsFinal = isYesterdayScores || nextMatchStatus.includes("FINISHED") || nextMatchStatus.includes("FINAL") || nextMatchStatus.includes("GAME OVER");
                    const nextIsPostponedFinal = nextIsFinal && nextIsPostponed;
                    const nextIsCanceledFinal = nextIsFinal && nextIsCanceled;
                    let nextTimeLabel = "";
                    
                    if (nextData.timeString === '') {
                        nextTimeLabel = "";
                    } else if (nextIsLive) {
                        nextTimeLabel = "Live";
                    } else if (nextIsPostponed) {
                        nextTimeLabel = '<span style="color: #545353;">PPD</span>';
                    } else if (nextIsCanceled) {
                        nextTimeLabel = '<span style="color: #545353;">Canceled</span>';
                    } else if (nextIsFinal) {
                        nextTimeLabel = "F";
                    } else if (nextRawStart && nextRawStart.toDate) {
                        nextTimeLabel = luxon.DateTime.fromJSDate(nextRawStart.toDate()).toFormat('h:mm a');
                    } else {
                        nextTimeLabel = "TBD";
                    }
                    
                    const nextNormalizedTimeLabel = (!nextIsLive && !nextIsFinal) ? normalizeDisplayTime(nextTimeLabel) : null;
                    const nextGameTimeLabel = nextNormalizedTimeLabel || nextTimeLabel;
                    
                    // Check if next game has a different start time from current game
                    const currentGameTimeLabel = normalizedTimeLabel || currentTimeLabel;
                    const isDifferentTime = nextGameTimeLabel !== currentGameTimeLabel;
                    
                    // If next game has different time, full width (colspan="4"), otherwise partial width (colspan="3")
                    const colspan = isDifferentTime ? 4 : 3;
                    const firstCell = isDifferentTime ? '' : '<td style="padding: 0; border: none; width: 32%;"></td>';
                    
                    const separatorRow = table.insertRow();
                    separatorRow.className = "game-separator-line";
                    separatorRow.innerHTML = `${firstCell}<td colspan="${colspan}" style="padding: 0 0 10px 0; border: none;"><div style="border-top: 1px solid #000000; margin: 0;"></div></td>`;
                    
                    // Store separator row with reference to current game index and time info for visibility control
                    if (shouldPrioritizeImportant) {
                        separatorRows.push({ 
                            separatorRow, 
                            gameIndex: i, 
                            nextGameIndex: i + 1,
                            currentGameTimeLabel: normalizedTimeLabel || currentTimeLabel,
                            nextGameTimeLabel: nextGameTimeLabel,
                            isDifferentTime: isDifferentTime,
                            colspan: colspan,
                            firstCell: firstCell
                        });
                    }
                }
                
                // Update previous game time label for next iteration
                previousGameTimeLabel = normalizedTimeLabel || currentTimeLabel;
                
                // Add spacer row after ATP doubles matches for extra spacing
                if (isAtpDoubles) {
                    const spacerRow = table.insertRow();
                    spacerRow.className = "atp-doubles-spacer";
                    spacerRow.innerHTML = '<td colspan="4" style="height: 1.5em; padding: 0; border: none; line-height: 0;"></td>';
                }
                
                // Add 12px spacer row after last game in each league
                if (i === games.length - 1) {
                    const spacerRow = table.insertRow();
                    spacerRow.innerHTML = '<td colspan="4" style="height: 12px; padding: 0; border: none;"></td>';
                    
                    // Add extra 12px spacer for Davis Cup (Doubles)
                    if (displayLeague === "Davis Cup (Doubles)") {
                        const extraSpacerRow = table.insertRow();
                        extraSpacerRow.innerHTML = '<td colspan="4" style="height: 12px; padding: 0; border: none;"></td>';
                    }
                }
            }
            
            if (shouldPrioritizeImportant) {
                if (hasHiddenGames) {
                    let showAllImportantGames = false;
                    table.dataset.hasImportanceToggle = "true";
                    table.dataset.showingAll = "false";
                    
                    const toggleContainer = document.createElement("div");
                    toggleContainer.style.fontSize = "10px";
                    toggleContainer.style.color = "#bebebe";
                    toggleContainer.style.padding = "4px 5px";
                    toggleContainer.style.margin = "0 5px 6px 5px";
                    toggleContainer.style.cursor = "pointer";
                    toggleContainer.style.userSelect = "none";
                    toggleContainer.style.display = "inline-block";
                    toggleContainer.style.width = "calc(100% - 10px)";
                    
                    const toggleLink = document.createElement("span");
                    toggleLink.textContent = "Expand all";
                    toggleLink.style.textDecoration = "underline";
                    toggleLink.style.color = "#bebebe";
                    toggleContainer.appendChild(toggleLink);

                    const updateImportanceVisibility = (liveFilterActiveValue) => {
                        let liveFilterActive = liveFilterActiveValue;
                        if (typeof liveFilterActive !== 'boolean') {
                            const liveFilterToggle = document.getElementById('live-filter-toggle');
                            liveFilterActive = liveFilterToggle ? liveFilterToggle.classList.contains('active') : false;
                        }
                        let lastVisibleNormalizedTime = null;
                        const gameVisibility = []; // Track visibility of each game
                        gameRowPairs.forEach(({ row1, row2 }, index) => {
                            if (!row1) return;
                            const isNonImportant = row1.dataset.importance === 'non-important';
                            const passesImportance = showAllImportantGames || !isNonImportant;
                            const passesLiveFilter = !liveFilterActive || row1.classList.contains('live-game');
                            const shouldShow = passesImportance && passesLiveFilter;
                            gameVisibility[index] = shouldShow;
                            
                        if (shouldShow) {
                            row1.style.display = '';
                            row1.classList.remove('hidden-row');
                            if (row2) {
                                row2.style.display = '';
                                row2.classList.remove('hidden-row');
                            }
                        } else {
                            row1.style.display = 'none';
                            row1.classList.add('hidden-row');
                            if (row2) {
                                row2.style.display = 'none';
                                row2.classList.add('hidden-row');
                            }
                        }

                            const timeCell = row1.cells[0];
                            if (!timeCell) return;
                            const originalHtml = row1.dataset.originalTimeHtml || '';
                            const normalizedTime = row1.dataset.normalizedTime || '';
                            if (shouldShow && normalizedTime && normalizedTime !== 'TBD' && !row1.classList.contains('live-game') && !row1.classList.contains('final-game')) {
                                if (normalizedTime === lastVisibleNormalizedTime) {
                                    timeCell.innerHTML = '';
                                } else {
                                    timeCell.innerHTML = originalHtml;
                                    lastVisibleNormalizedTime = normalizedTime;
                                }
                            } else if (shouldShow) {
                                timeCell.innerHTML = originalHtml;
                                if (normalizedTime && normalizedTime !== 'TBD') {
                                    lastVisibleNormalizedTime = normalizedTime;
                                }
                            } else {
                                timeCell.innerHTML = originalHtml;
                            }
                        });
                        
                        // Update separator row visibility: show separator if current game is visible and there's a visible game after it
                        separatorRows.forEach(({ separatorRow, gameIndex, nextGameIndex, currentGameTimeLabel, nextGameTimeLabel, isDifferentTime, colspan, firstCell }) => {
                            const currentGameVisible = gameVisibility[gameIndex] === true;
                            
                            // Find the next visible game after the current game
                            let nextVisibleGameIndex = -1;
                            let nextVisibleGameTimeLabel = null;
                            for (let j = nextGameIndex; j < gameRowPairs.length; j++) {
                                if (gameVisibility[j] === true) {
                                    nextVisibleGameIndex = j;
                                    // Get the time label for the next visible game
                                    const nextVisibleRow = gameRowPairs[j].row1;
                                    if (nextVisibleRow) {
                                        // Use normalized time if available, otherwise try to extract from original HTML
                                        const nextNormalizedTime = nextVisibleRow.dataset.normalizedTime || '';
                                        if (nextNormalizedTime) {
                                            nextVisibleGameTimeLabel = nextNormalizedTime;
                                        } else {
                                            // For live/final games, check the class to determine time label
                                            if (nextVisibleRow.classList.contains('live-game')) {
                                                nextVisibleGameTimeLabel = 'Live';
                                            } else if (nextVisibleRow.classList.contains('final-game')) {
                                                nextVisibleGameTimeLabel = 'F';
                                            } else {
                                                // Try to extract time from original HTML (strip HTML tags)
                                                const originalHtml = nextVisibleRow.dataset.originalTimeHtml || '';
                                                const tempDiv = document.createElement('div');
                                                tempDiv.innerHTML = originalHtml;
                                                const textContent = tempDiv.textContent || tempDiv.innerText || '';
                                                nextVisibleGameTimeLabel = normalizeDisplayTime(textContent) || textContent;
                                            }
                                        }
                                    }
                                    break;
                                }
                            }
                            
                            // Show separator if current game is visible AND there's a visible game after it
                            if (currentGameVisible && nextVisibleGameIndex !== -1) {
                                separatorRow.style.display = '';
                                
                                // Update width based on whether next visible game has different time
                                // Compare normalized times, or raw labels if normalized not available
                                const currentTimeForComparison = currentGameTimeLabel || '';
                                const nextTimeForComparison = nextVisibleGameTimeLabel || '';
                                const nextVisibleIsDifferentTime = nextTimeForComparison && nextTimeForComparison !== currentTimeForComparison;
                                const actualColspan = nextVisibleIsDifferentTime ? 4 : 3;
                                const actualFirstCell = nextVisibleIsDifferentTime ? '' : '<td style="padding: 0; border: none; width: 32%;"></td>';
                                
                                // Update the separator row HTML if width changed
                                separatorRow.innerHTML = `${actualFirstCell}<td colspan="${actualColspan}" style="padding: 0 0 10px 0; border: none;"><div style="border-top: 1px solid #000000; margin: 0;"></div></td>`;
                            } else {
                                separatorRow.style.display = 'none';
                            }
                        });
                        
                        table.dataset.showingAll = showAllImportantGames ? 'true' : 'false';
                    };

                    table.updateImportanceVisibility = updateImportanceVisibility;

                    toggleContainer.addEventListener('click', () => {
                        showAllImportantGames = !showAllImportantGames;
                        toggleLink.textContent = showAllImportantGames ? "Featured only" : "Expand all";
                        updateImportanceVisibility();
                    });

                    leagueSection.appendChild(toggleContainer);
                    updateImportanceVisibility();
                } else {
                    table.dataset.hasImportanceToggle = "false";
                    table.dataset.showingAll = "true";
                    table.updateImportanceVisibility = undefined;
                }
            }
            
            // Add collapse functionality for grouped leagues
            if (isGroupedByLeague) {
                const isCollapsed = isCollapsedLeague;
                const title = leagueSection.querySelector('.league-title');
                
                // Only add arrow and two-column layout for leagues that can be collapsed
                if (isCollapsed) {
                    leagueSection.style.marginBottom = "";
                    // Create two-column layout for collapsed leagues
                    const titleContainer = document.createElement("div");
                    titleContainer.style.display = "flex";
                    titleContainer.style.alignItems = "center";
                    titleContainer.style.width = "100%";
                    
                    // Create left column for league name (90%)
                    const nameColumn = document.createElement("div");
                    nameColumn.style.flex = "0 0 90%";
                    nameColumn.style.overflow = "hidden";
                    nameColumn.style.wordWrap = "break-word";
                    
                    // Create right column for arrow (10%)
                    const arrowColumn = document.createElement("div");
                    arrowColumn.style.flex = "0 0 10%";
                    arrowColumn.style.textAlign = "center";
                    arrowColumn.style.display = "flex";
                    arrowColumn.style.alignItems = "center";
                    arrowColumn.style.justifyContent = "center";
                    
                    // Move existing content to name column
                    nameColumn.innerHTML = title.innerHTML;
                    
                    // Add collapse/expand arrow
                    const arrow = document.createElement("span");
                    arrow.className = "collapse-arrow";
                    arrow.innerHTML = "▶"; // Right arrow (collapsed state)
                    arrow.style.cursor = "pointer";
                    arrow.style.fontSize = "10px";
                    arrow.style.transition = "transform 0.2s ease";
                    arrow.style.userSelect = "none";
                    arrowColumn.appendChild(arrow);
                    
                    // Add columns to container
                    titleContainer.appendChild(nameColumn);
                    titleContainer.appendChild(arrowColumn);
                    
                    // Replace title content with container
                    title.innerHTML = "";
                    title.appendChild(titleContainer);
                    
                    // Initially hide table if league is in collapsed list
                    table.style.display = "none";
                    table.dataset.collapsible = "true";
                    table.dataset.isCollapsed = "true";
                    if (collapsedScoresRow) {
                        collapsedScoresRow.style.display = "none";
                    }
                }
                
                // Add click handler to title for toggling (only for leagues that can collapse)
                if (isCollapsed && title) {
                    title.style.cursor = "pointer";
                    title.addEventListener('click', function() {
                        const arrow = this.querySelector('.collapse-arrow');
                        if (table.style.display === "none") {
                            // Expand
                            table.style.display = "";
                            table.dataset.isCollapsed = "false";
                            if (arrow) {
                                arrow.innerHTML = "▼";
                            }
                            if (collapsedScoresRow) {
                                collapsedScoresRow.style.display = "block";
                            }
                        } else {
                            // Collapse
                            table.style.display = "none";
                            table.dataset.isCollapsed = "true";
                            if (arrow) {
                                arrow.innerHTML = "▶";
                            }
                            if (collapsedScoresRow) {
                                collapsedScoresRow.style.display = "none";
                            }
                        }
                    });
                }
            }
            
            if (isCollapsedLeague && collapsedScoresRow) {
                leagueSection.appendChild(collapsedScoresRow);
            }
            
            leagueSection.appendChild(table);
            // Ensure consistent spacing for Davis Cup leagues
            if (isGroupedByLeague && (leagueNameKey === "Davis Cup (Singles)" || leagueNameKey === "Davis Cup (Doubles)")) {
                leagueSection.style.marginBottom = "1.5em";
            } else if (isGroupedByLeague && !isCollapsedLeague) {
                leagueSection.style.marginBottom = "1.5em";
            } else if (isGroupedByLeague) {
                leagueSection.style.marginBottom = "";
            }
            container.appendChild(leagueSection);
        });
    }

    // --- 6. DATA FETCHING AND LOGIC FUNCTIONS ---
    function sortGames(a, b) {
        // For Boxing/UFC, use sortOrder if available to preserve exact sheet order
        const leagueA = getLeagueDisplayName(a.League, a.Sport);
        const leagueB = getLeagueDisplayName(b.League, b.Sport);
        const isBoxingOrUFCA = leagueA === 'Boxing' || leagueA === 'UFC';
        const isBoxingOrUFCB = leagueB === 'Boxing' || leagueB === 'UFC';
        
        if (isBoxingOrUFCA && isBoxingOrUFCB && a.sortOrder !== undefined && b.sortOrder !== undefined) {
            return a.sortOrder - b.sortOrder;
        }
        
        const statusA = (a["Match Status"] || "").toUpperCase();
        const statusB = (b["Match Status"] || "").toUpperCase();
        
        // Determine game state: LIVE > SCHEDULED > FINAL
        const isLiveA = statusA.includes("IN PROGRESS") || statusA.includes("IN_PROGRESS") || statusA.includes("LIVE");
        const isLiveB = statusB.includes("IN PROGRESS") || statusB.includes("IN_PROGRESS") || statusB.includes("LIVE");
        const isFinalA = statusA.includes("FINISHED") || statusA.includes("FINAL") || statusA.includes("GAME OVER");
        const isFinalB = statusB.includes("FINISHED") || statusB.includes("FINAL") || statusB.includes("GAME OVER");
        const isScheduledA = !isLiveA && !isFinalA;
        const isScheduledB = !isLiveB && !isFinalB;
        
        // Priority order: LIVE games first, then SCHEDULED, then FINAL
        if (isLiveA && !isLiveB) return -1; // A is live, B is not - A comes first
        if (!isLiveA && isLiveB) return 1;  // B is live, A is not - B comes first
        
        if (isScheduledA && isFinalB) return -1; // A is scheduled, B is final - A comes first
        if (isFinalA && isScheduledB) return 1;  // A is final, B is scheduled - B comes first
        
        // If both are same state (both live, both scheduled, or both final), sort by time
        
        // Check if both are manual games (Game ID starts with "manual-" or "sheet-")
        const isManualA = a["Game ID"] && (a["Game ID"].startsWith("manual-") || a["Game ID"].startsWith("sheet-"));
        const isManualB = b["Game ID"] && (b["Game ID"].startsWith("manual-") || b["Game ID"].startsWith("sheet-"));
        
        // For all games, sort by time first (this ensures chronological order)
        const timeDiff = a["Start Time"] - b["Start Time"];
        if (timeDiff !== 0) return timeDiff;
        
        // If times are equal and both are manual/sheet games from the same league, use displayOrder as tiebreaker
        // This preserves Google Sheet order for games that have the same start time
        if (isManualA && isManualB && a["League"] === b["League"]) {
            const orderA = a["displayOrder"] !== undefined ? a["displayOrder"] : 999999;
            const orderB = b["displayOrder"] !== undefined ? b["displayOrder"] : 999999;
            return orderA - orderB;
        }
        
        // If times are equal and at least one is a manual/sheet game from the same league, prioritize displayOrder
        // This ensures header rows (with channel) appear before individual games
        if ((isManualA || isManualB) && a["League"] === b["League"]) {
            const orderA = a["displayOrder"] !== undefined ? a["displayOrder"] : 999999;
            const orderB = b["displayOrder"] !== undefined ? b["displayOrder"] : 999999;
            if (orderA !== 999999 || orderB !== 999999) {
                return orderA - orderB;
            }
        }
        
        // For mixed or non-manual games with same time, maintain original order (no change)
        return 0;
    }
     function fetchLeagueSchedule(leagueId, leagueName) {
        scheduleContent.innerHTML = '<p style="color: #9ca3af;">Loading schedule...</p>';
        const { DateTime } = luxon;
         // Match home column logic (Denver) for gameDate equality
         const todayStr = DateTime.now().setZone('America/New_York').toISODate();
         
         // League config is not required for today's games; read from sportsGames
         // 1) Exact League + gameDate (primary)
         let q = gamesCollectionRef.where('League', '==', leagueId).where('gameDate', '==', todayStr);
         if (leagueId === 'USA: NCAA') {
             let desiredSport = 'American Football'; // default
             if (leagueName && leagueName.toLowerCase().includes('hockey')) {
                 desiredSport = 'Hockey';
             } else if (leagueName && (leagueName.toLowerCase().includes('basketball') || leagueName === 'NCAAM' || leagueName === 'NCAA Men')) {
                 desiredSport = 'Basketball';
             }
             q = q.where('Sport', '==', desiredSport);
         }
         if (leagueId === 'USA: NCAA Women') {
             q = q.where('Sport', '==', 'Basketball');
         }
         q.onSnapshot(snapshot => {
             if (!snapshot.empty) {
                 const gamesData = snapshot.docs.map(d => d.data()).sort(sortGames);
                 renderGames(scheduleContent, gamesData, false);
            return;
        }
             // 2) Fallback to exact League + scheduledDate (if backend provided it)
             let q2 = gamesCollectionRef.where('League', '==', leagueId).where('scheduledDate', '==', todayStr);
             if (leagueId === 'USA: NCAA') {
                 let desiredSport = 'American Football'; // default
                 if (leagueName && leagueName.toLowerCase().includes('hockey')) {
                     desiredSport = 'Hockey';
                 } else if (leagueName && (leagueName.toLowerCase().includes('basketball') || leagueName === 'NCAAM' || leagueName === 'NCAA Men')) {
                     desiredSport = 'Basketball';
                 }
                 q2 = q2.where('Sport', '==', desiredSport);
             }
             if (leagueId === 'USA: NCAA Women') {
                 q2 = q2.where('Sport', '==', 'Basketball');
             }
             q2.onSnapshot(s2 => {
                 if (!s2.empty) {
                     const gamesData2 = s2.docs.map(d => d.data()).sort(sortGames);
                     renderGames(scheduleContent, gamesData2, false);
                    return;
                }
                 scheduleContent.innerHTML = `<p>No ${leagueName} games found for today.</p>`;
             }, _err => {
                 scheduleContent.innerHTML = '<p style="color: #ef4444;">Error loading schedule.</p>';
             });
         }, _err => {
             scheduleContent.innerHTML = '<p style="color: #ef4444;">Error loading schedule.</p>';
         });
     }

    async function fetchYesterdayScoresForLeague(leagueId, leagueName) {
        const yesterdayScheduleContent = document.getElementById('league-schedule-yesterday-content');
        if (!yesterdayScheduleContent) return;

        yesterdayScheduleContent.innerHTML = '<p style="color: #9ca3af;">Loading yesterday\'s scores...</p>';

        // Direct path: read entire yesterdayScores (no date filter), then organize by league
        try {
            const refAll = db.collection("artifacts/flashlive-daily-scraper/public/data/yesterdayScores");
            const snapAll = await refAll.get();
            if (snapAll.empty) {
                yesterdayScheduleContent.innerHTML = `<p>No completed games found for yesterday.</p>`;
                return;
            }
            const allGames = snapAll.docs.map(d => d.data());
            // Flexible league matching (exact → key-based → partials)
            let leagueGames = allGames.filter(game => {
                if (game.League === leagueId) return true;
                const gameLeagueKey = getLeagueKeyFromDatabaseName(game.League || '');
                const currentLeagueKey = getLeagueKeyFromDatabaseName(leagueId || '');
                if (gameLeagueKey && currentLeagueKey && gameLeagueKey === currentLeagueKey) return true;
                const targetLeagueName = (leagueName || '').toLowerCase();
                const gameLeagueName = (game.League || '').toLowerCase();
                if (targetLeagueName.includes('uefa champions league') && gameLeagueName.includes('champions league')) return true;
                return gameLeagueName.includes(targetLeagueName) || targetLeagueName.includes(gameLeagueName);
            });
            // NCAA split
            if (leagueId === 'USA: NCAA') {
                let desiredSport = 'American Football'; // default
                if (leagueName && leagueName.toLowerCase().includes('hockey')) {
                    desiredSport = 'Hockey';
                } else if (leagueName && (leagueName.toLowerCase().includes('basketball') || leagueName === 'NCAAM' || leagueName === 'NCAA Men')) {
                    desiredSport = 'Basketball';
                }
                leagueGames = leagueGames.filter(g => g.Sport === desiredSport);
            }
            if (leagueId === 'USA: NCAA Women') {
                leagueGames = leagueGames.filter(g => g.Sport === 'Basketball');
            }
            if (leagueGames.length === 0) {
                yesterdayScheduleContent.innerHTML = `<p>No completed games found for yesterday.</p>`;
                return;
            }
            // Render as completed (same as Home SCORES)
            renderGames(yesterdayScheduleContent, leagueGames.sort(sortGames), false, true);
            return;
        } catch (e) {
            // Fall through to existing logic if this path fails
        }

        // Calculate yesterday in both Denver and New York to handle edge timezone mismatches
        const { DateTime } = luxon;
        // Use Eastern Time for gameDate queries (matches backend storage)
        const yesterdayStr = DateTime.now().setZone('America/New_York').minus({ days: 1 }).toISODate();

        // Ensure Home SCORES cache is available (single source of truth)
        const nowCheck = Date.now();
        if (!yesterdayScoresCache || !yesterdayScoresCacheExpiry || nowCheck >= yesterdayScoresCacheExpiry) {
            try { fetchYesterdayScores(); } catch (e) {}
            // Wait briefly for cache to build
            const waitForYesterdayCache = (maxMs = 4000, interval = 200) => new Promise(resolve => {
                const start = Date.now();
                const timer = setInterval(() => {
                    const ready = yesterdayScoresCache && yesterdayScoresCacheExpiry && Date.now() < yesterdayScoresCacheExpiry;
                    if (ready || (Date.now() - start) >= maxMs) {
                        clearInterval(timer);
                        resolve(ready);
                    }
                }, interval);
            });
            await waitForYesterdayCache();
        }

        // If cache is ready now, use it directly and return
        const nowAfterWait = Date.now();
        if (yesterdayScoresCache && yesterdayScoresCacheExpiry && nowAfterWait < yesterdayScoresCacheExpiry) {
            const allGames = yesterdayScoresCache;
            const yesterdayGames = allGames.filter(game => game.gameDate === yesterdayStr);
            let leagueGames = yesterdayGames.filter(game => {
                if (game.League === leagueId) return true;
                const gameLeagueKey = getLeagueKeyFromDatabaseName(game.League || '');
                const currentLeagueKey = getLeagueKeyFromDatabaseName(leagueId || '');
                if (gameLeagueKey && currentLeagueKey && gameLeagueKey === currentLeagueKey) return true;
                const targetLeagueName = leagueName.toLowerCase();
                const gameLeagueName = (game.League || '').toLowerCase();
                if (targetLeagueName.includes('uefa champions league') && gameLeagueName.includes('champions league')) return true;
                return gameLeagueName.includes(targetLeagueName) || targetLeagueName.includes(gameLeagueName);
            });
            if (leagueId === 'USA: NCAA') {
                let desiredSport = 'American Football'; // default
                if (leagueName && leagueName.toLowerCase().includes('hockey')) {
                    desiredSport = 'Hockey';
                } else if (leagueName && (leagueName.toLowerCase().includes('basketball') || leagueName === 'NCAAM' || leagueName === 'NCAA Men')) {
                    desiredSport = 'Basketball';
                }
                leagueGames = leagueGames.filter(g => g.Sport === desiredSport);
            }
            if (leagueId === 'USA: NCAA Women') {
                leagueGames = leagueGames.filter(g => g.Sport === 'Basketball');
            }
            if (leagueGames.length > 0) {
                renderGames(yesterdayScheduleContent, leagueGames.sort(sortGames), false, true);
                return;
            }
        }

        // Fast path: query by date only, then client-filter by league (mirrors home SCORES logic)
        const col = db.collection("artifacts/flashlive-daily-scraper/public/data/yesterdayScores");
        Promise.all([
            col.where('gameDate', '==', yesterdayStr).get()
        ]).then(([snapA, snapB]) => {
            if (!snapA.empty || !snapB.empty) {
                let allGames = [...snapA.docs, ...snapB.docs].map(d => d.data());
                // Flexible league matching
                let leagueGames = allGames.filter(game => {
                    if (game.League === leagueId) return true;
                    const gameLeagueKey = getLeagueKeyFromDatabaseName(game.League || '');
                    const currentLeagueKey = getLeagueKeyFromDatabaseName(leagueId || '');
                    if (gameLeagueKey && currentLeagueKey && gameLeagueKey === currentLeagueKey) return true;
                    const targetLeagueName = leagueName.toLowerCase();
                    const gameLeagueName = (game.League || '').toLowerCase();
                    if (targetLeagueName.includes('uefa champions league') && gameLeagueName.includes('champions league')) return true;
                    return gameLeagueName.includes(targetLeagueName) || targetLeagueName.includes(gameLeagueName);
                });
                // NCAA sport split
                if (leagueId === 'USA: NCAA') {
                    let desiredSport = 'American Football'; // default
                    if (leagueName && leagueName.toLowerCase().includes('hockey')) {
                        desiredSport = 'Hockey';
                    } else if (leagueName && (leagueName.toLowerCase().includes('basketball') || leagueName === 'NCAAM' || leagueName === 'NCAA Men')) {
                        desiredSport = 'Basketball';
                    }
                    leagueGames = leagueGames.filter(g => g.Sport === desiredSport);
                }
                if (leagueId === 'USA: NCAA Women') {
                    leagueGames = leagueGames.filter(g => g.Sport === 'Basketball');
                }
                if (leagueGames.length > 0) {
                    renderGames(yesterdayScheduleContent, leagueGames.sort(sortGames), false, true);
                    return;
                }
            }
            // Fallback to cached/all-games path
            continueWithCachedOrAll();
        }).catch(() => continueWithCachedOrAll());

        function continueWithCachedOrAll() {
        // If we have a valid cache (same data the Home SCORES tab uses), use it for identical results
        const nowMs = Date.now();
        if (yesterdayScoresCache && yesterdayScoresCacheExpiry && nowMs < yesterdayScoresCacheExpiry) {
            const allGames = yesterdayScoresCache; // includes featured merges; we'll filter by league
            const yesterdayGames = allGames.filter(game => game.gameDate === yesterdayStr);
            const leagueGames = yesterdayGames.filter(game => {
                // Exact match first
                if (game.League === leagueId) return true;
                // Then try flexible matching based on league key
                const gameLeagueKey = getLeagueKeyFromDatabaseName(game.League || '');
                const currentLeagueKey = getLeagueKeyFromDatabaseName(leagueId || '');
                if (gameLeagueKey && currentLeagueKey && gameLeagueKey === currentLeagueKey) return true;
                // Fallback: display name and partials
                const targetLeagueName = leagueName.toLowerCase();
                const gameLeagueName = (game.League || '').toLowerCase();
                if (targetLeagueName.includes('uefa champions league') && gameLeagueName.includes('champions league')) return true;
                if (gameLeagueName.includes(targetLeagueName) || targetLeagueName.includes(gameLeagueName)) return true;
                return false;
            });

            // For NCAA, filter by sport from yesterday's scores
            const filteredLeagueGames = leagueGames.filter(game => {
                if (leagueId === 'USA: NCAA') {
                    let desiredSport = 'American Football'; // default
                    if (leagueName && leagueName.toLowerCase().includes('hockey')) {
                        desiredSport = 'Hockey';
                    } else if (leagueName && (leagueName.toLowerCase().includes('basketball') || leagueName === 'NCAAM' || leagueName === 'NCAA Men')) {
                        desiredSport = 'Basketball';
                    }
                    return game.Sport === desiredSport;
                }
                if (leagueId === 'USA: NCAA Women') {
                    return game.Sport === 'Basketball';
                }
                return true;
            });

            if (filteredLeagueGames.length === 0) {
                yesterdayScheduleContent.innerHTML = `<p>No completed games found for yesterday.</p>`;
                return;
            }

            const gamesData = filteredLeagueGames.sort(sortGames);
            renderGames(yesterdayScheduleContent, gamesData, false, true);
            return;
        }

        // If no cache yet, load it once (same as Home SCORES), then filter
        if (!yesterdayScoresCache || !yesterdayScoresCacheExpiry || nowMs >= yesterdayScoresCacheExpiry) {
            try {
                fetchYesterdayScores();
            } catch (e) {}
        }

        // If we have a valid raw cache, use it to avoid refetching
        if (yesterdayScoresRawCache && yesterdayScoresCacheExpiry && nowMs < yesterdayScoresCacheExpiry) {
            const allGames = yesterdayScoresRawCache;
            const yesterdayGames = allGames.filter(game => game.gameDate === yesterdayStr);
            const leagueGames = yesterdayGames.filter(game => {
                // Exact match first
                if (game.League === leagueId) return true;
                // Then try flexible matching based on league key
                const gameLeagueKey = getLeagueKeyFromDatabaseName(game.League || '');
                const currentLeagueKey = getLeagueKeyFromDatabaseName(leagueId || '');
                if (gameLeagueKey && currentLeagueKey && gameLeagueKey === currentLeagueKey) return true;
                // Fallback: display name and partials
                const targetLeagueName = leagueName.toLowerCase();
                const gameLeagueName = (game.League || '').toLowerCase();
                if (targetLeagueName.includes('uefa champions league') && gameLeagueName.includes('champions league')) return true;
                if (gameLeagueName.includes(targetLeagueName) || targetLeagueName.includes(gameLeagueName)) return true;
                return false;
            });

            // For NCAA, filter by sport from yesterday's scores
            const filteredLeagueGames = leagueGames.filter(game => {
                if (leagueId === 'USA: NCAA') {
                    let desiredSport = 'American Football'; // default
                    if (leagueName && leagueName.toLowerCase().includes('hockey')) {
                        desiredSport = 'Hockey';
                    } else if (leagueName && (leagueName.toLowerCase().includes('basketball') || leagueName === 'NCAAM' || leagueName === 'NCAA Men')) {
                        desiredSport = 'Basketball';
                    }
                    return game.Sport === desiredSport;
                }
                if (leagueId === 'USA: NCAA Women') {
                    return game.Sport === 'Basketball';
                }
                return true;
            });

            if (filteredLeagueGames.length === 0) {
                yesterdayScheduleContent.innerHTML = `<p>No completed games found for yesterday.</p>`;
                return;
            }

            const gamesData = filteredLeagueGames.sort(sortGames);
            renderGames(yesterdayScheduleContent, gamesData, false, true);
            return;
        }

        // Otherwise load from Firestore and refresh caches
        const yesterdayScoresRef = db.collection("artifacts/flashlive-daily-scraper/public/data/yesterdayScores");
        
        yesterdayScoresRef.get()
            .then(snapshot => {
                if (snapshot.empty) {
                    yesterdayScheduleContent.innerHTML = `<p>No completed games found for yesterday.</p>`;
                    return;
                }
                
                // Filter games by gameDate first (only yesterday's games)
                const allGames = snapshot.docs.map(doc => doc.data());
                // Exclude old "Asia: AFC Elite" games from Google Sheets (source is not ESPN_LIVE) and any unmapped "AFC Champions League" games
                const filteredAllGames = allGames.filter(game => {
                    // Only exclude if it's an old Google Sheets game (no source or source is not ESPN_LIVE)
                    if (game.League === "Asia: AFC Elite" && game.source !== "ESPN_LIVE") {
                        return false;
                    }
                    // Exclude unmapped "AFC Champions League" games (shouldn't exist if mapping works)
                    if (game.League === "AFC Champions League") {
                        return false;
                    }
                    return true;
                });
                // Refresh raw cache and its expiry (filtered)
                yesterdayScoresRawCache = filteredAllGames;
                yesterdayScoresCacheExpiry = getNextPrepExpiryTimestamp();
                const yesterdayGames = filteredAllGames.filter(game => game.gameDate === yesterdayStr);
                
                // Then filter by league using flexible matching
                const leagueGames = yesterdayGames.filter(game => {
                    // First try exact match
                    if (game.League === leagueId) {
                        return true;
                    }
                    
                    // Then try flexible matching based on league key
                    const gameLeagueKey = getLeagueKeyFromDatabaseName(game.League);
                    const currentLeagueKey = getLeagueKeyFromDatabaseName(leagueId);
                    
                    // If both have matching league keys, include the game
                    if (gameLeagueKey && currentLeagueKey && gameLeagueKey === currentLeagueKey) {
                        return true;
                    }
                    
                    // Fallback: check if the database league name contains the target league name
                    const targetLeagueName = leagueName.toLowerCase();
                    const gameLeagueName = game.League.toLowerCase();
                    
                    // For UEFA Champions League, check for "champions league" in the name
                    if (targetLeagueName.includes('uefa champions league') && gameLeagueName.includes('champions league')) {
                        return true;
                    }
                    // For other leagues, check for partial matches
                    if (gameLeagueName.includes(targetLeagueName) || targetLeagueName.includes(gameLeagueName)) {
                        return true;
                    }
                    
                    return false;
                });
                
                // For NCAA, filter by sport from yesterday's scores
                const filteredLeagueGames = leagueGames.filter(game => {
                    if (leagueId === 'USA: NCAA') {
                        let desiredSport = 'American Football'; // default
                        if (leagueName && leagueName.toLowerCase().includes('hockey')) {
                            desiredSport = 'Hockey';
                        } else if (leagueName && (leagueName.toLowerCase().includes('basketball') || leagueName === 'NCAAM' || leagueName === 'NCAA Men')) {
                            desiredSport = 'Basketball';
                        }
                        return game.Sport === desiredSport;
                    }
                    if (leagueId === 'USA: NCAA Women') {
                        return game.Sport === 'Basketball';
                    }
                    return true;
                });
                
                if (filteredLeagueGames.length === 0) {
                    yesterdayScheduleContent.innerHTML = `<p>No completed games found for yesterday.</p>`;
                    return;
                }
                
                const gamesData = filteredLeagueGames.sort(sortGames);
                renderGames(yesterdayScheduleContent, gamesData, false, true);
            }, err => { 
                console.error('Error fetching yesterday scores for', leagueId, ':', err);
                yesterdayScheduleContent.innerHTML = '<p style="color: #ef4444;">Error loading yesterday\'s scores.</p>'; 
            });
        }
    }

    // Cache configuration
    const STANDINGS_CACHE_PREFIX = 'standings_cache_';
    
    // Helper function to get cache key
    function getStandingsCacheKey(leagueKey) {
        return `${STANDINGS_CACHE_PREFIX}${leagueKey}`;
    }
    
    // Helper function to get cached standings
    function getCachedStandings(leagueKey) {
        const cacheKey = getStandingsCacheKey(leagueKey);
        const cached = localStorage.getItem(cacheKey);
        if (!cached) return null;
        
        try {
            const data = JSON.parse(cached);
            return data.teams;
        } catch (e) {
            return null;
        }
    }
    
    // Helper function to cache standings
    function cacheStandings(leagueKey, teams) {
        const cacheKey = getStandingsCacheKey(leagueKey);
        // Get the lastUpdated timestamp from the first team (all teams have the same timestamp)
        const lastUpdated = teams.length > 0 && teams[0].lastUpdated ? teams[0].lastUpdated : new Date().toISOString();
        const data = {
            teams: teams,
            timestamp: Date.now(),
            lastUpdated: lastUpdated
        };
        localStorage.setItem(cacheKey, JSON.stringify(data));
    }
    
    // Helper function to clear standings cache for a specific league
    function clearStandingsCache(leagueKey) {
        const cacheKey = getStandingsCacheKey(leagueKey);
        localStorage.removeItem(cacheKey);
        console.log(`🗑️ Cleared cache for ${leagueKey}`);
    }
    
    // Helper function to clear all standings cache
    function clearAllStandingsCache() {
        const keys = Object.keys(localStorage);
        keys.forEach(key => {
            if (key.startsWith(STANDINGS_CACHE_PREFIX)) {
                localStorage.removeItem(key);
            }
        });
        console.log('🗑️ Cleared all standings cache');
    }
    
    // Make cache functions available globally for debugging
    window.clearStandingsCache = clearStandingsCache;
    window.clearAllStandingsCache = clearAllStandingsCache;
    window.getStandingsCacheInfo = function() {
        const keys = Object.keys(localStorage);
        const cacheKeys = keys.filter(key => key.startsWith(STANDINGS_CACHE_PREFIX));
        const cacheInfo = {};
        cacheKeys.forEach(key => {
            try {
                const data = JSON.parse(localStorage.getItem(key));
                const age = Date.now() - data.timestamp;
                const ageHours = Math.round(age / (1000 * 60 * 60) * 100) / 100;
                cacheInfo[key] = {
                    teams: data.teams.length,
                    ageHours: ageHours,
                    lastUpdated: data.lastUpdated || 'unknown'
                };
            } catch (e) {
                cacheInfo[key] = { error: 'Invalid cache data' };
            }
        });
        return cacheInfo;
    };
    
    // Function to display standings table (extracted for reuse with cache)
    function displayStandingsTable(leagueKey, teams, standingsContent) {
            // Debug: Log the leagueKey being used
            console.log(`🔍 DEBUG: displayStandingsTable called with leagueKey="${leagueKey}", teams count: ${teams.length}`);
            
            // Build standings table
            let html = '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff;">';
            
            // Determine if this is a soccer league (uses Points) or US sports (uses Wins/Losses)
        // Hockey also uses Points, so we need to exclude it explicitly
        const isUSSport = ['NFL', 'MLB', 'NBA', 'NHL', 'NCAAF', 'WNBA'].includes(leagueKey);
        const isSoccerLeague = !isUSSport && teams.length > 0 && teams[0].Points !== undefined && teams[0].Points !== 0;
            
            // Check if MLS has conference data and should use conference tabs
            if (leagueKey === 'MLS' && teams.length > 0 && teams[0].Conference) {
                console.log(`📊 MLS detected with Conference data, using tabbed layout`);
                html = createMLSStandings(teams);
            } else if (leagueKey === 'MLS') {
                console.log(`⚠️ MLS detected but no Conference field. Sample team:`, teams[0]);
                // Fallback to regular soccer table if Conference field is missing
                html += '<p style="color: #ef4444;">MLS data missing Conference field. Please re-run scraper.</p>';
            } else if (isSoccerLeague) {
            // Soccer standings: Rank, Team, Pts, MP, W, D, L
                html += '<thead><tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
            html += '<th style="padding: 8px; text-align: left; width: 20px;"></th>';
                html += '<th style="padding: 8px; text-align: left;">Team</th>';
            html += '<th style="padding: 8px; text-align: center; width: 50px;">Pts</th>';
                html += '<th style="padding: 8px; text-align: center; width: 40px;">MP</th>';
                html += '<th style="padding: 8px; text-align: center; width: 40px;">W</th>';
                html += '<th style="padding: 8px; text-align: center; width: 40px;">D</th>';
                html += '<th style="padding: 8px; text-align: center; width: 40px;">L</th>';
                html += '</tr></thead><tbody>';
            
            // Sort teams by rank (1-20)
            teams.sort((a, b) => {
                const rankA = parseInt(a.Rank) || 0;
                const rankB = parseInt(b.Rank) || 0;
                return rankA - rankB;
            });
                
                teams.forEach((team, index) => {
                    const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
                    const displayTeamName = getTeamDisplayName(team.Team, leagueKey);
                    html += `<tr style="${rowStyle}">`;
                    html += `<td style="padding: 8px; text-align: left; font-size: 12px;">${team.Rank}</td>`;
                    html += `<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500;">${displayTeamName}</td>`;
                html += `<td style="padding: 8px; text-align: center; font-size: 12px; font-weight: bold;">${Math.round(team.Points)}</td>`;
                html += `<td style="padding: 8px; text-align: center; font-size: 12px;">${team.MP || team.MatchesPlayed || 0}</td>`;
                    html += `<td style="padding: 8px; text-align: center; font-size: 12px;">${team.Wins}</td>`;
                    html += `<td style="padding: 8px; text-align: center; font-size: 12px;">${team.Draws || 0}</td>`;
                    html += `<td style="padding: 8px; text-align: center; font-size: 12px;">${team.Losses || 0}</td>`;
                    html += '</tr>';
                });
            } else {
                // US Sports standings: Use specific tabbed layouts for each league
                if (leagueKey === 'NFL') {
                    html = createNFLStandings(teams);
                } else if (leagueKey === 'MLB') {
                    html = createMLBStandings(teams);
                } else if (leagueKey === 'NBA') {
                    html = createNBAStandings(teams);
                } else if (leagueKey === 'NHL') {
                    html = createNHLStandings(teams);
            } else if (leagueKey === 'NCAAF') {
                html = createNCAAFStandings(teams);
            } else if (leagueKey === 'NCAAM') {
                console.log(`🔍 DEBUG: Creating NCAAM standings with ${teams.length} teams`);
                if (teams.length > 0) {
                    console.log(`🔍 DEBUG: First NCAAM team:`, teams[0]);
                }
                html = createNCAAMStandings(teams);
            } else if (leagueKey === 'NCAAW') {
                console.log(`🔍 DEBUG: Creating NCAAW standings with ${teams.length} teams`);
                if (teams.length > 0) {
                    console.log(`🔍 DEBUG: First NCAAW team:`, teams[0]);
                }
                html = createNCAAWStandings(teams);
                } else if (leagueKey === 'WNBA') {
                    html = createWNBAStandings(teams);
                } else {
                    // Fallback to simple list for other leagues
                    html += '<thead><tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
                    html += '<th style="padding: 8px; text-align: left; width: 40px;">Rank</th>';
                    html += '<th style="padding: 8px; text-align: left;">Team</th>';
                    html += '<th style="padding: 8px; text-align: center; width: 40px;">W</th>';
                    html += '<th style="padding: 8px; text-align: center; width: 40px;">L</th>';
                    html += '<th style="padding: 8px; text-align: center; width: 60px;">PCT</th>';
                    html += '</tr></thead><tbody>';
                    
                    teams.forEach((team, index) => {
                        const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
                        const pct = team.Wins && team.Losses !== undefined ? 
                            (team.Wins / (team.Wins + team.Losses)).toFixed(3) : '0.000';
                        
                        html += `<tr style="${rowStyle}">`;
                        html += `<td style="padding: 8px; text-align: left; font-size: 12px;">${team.Rank}</td>`;
                        html += `<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500;">${team.Team}</td>`;
                        html += `<td style="padding: 8px; text-align: center; font-size: 12px;">${team.Wins}</td>`;
                        html += `<td style="padding: 8px; text-align: center; font-size: 12px;">${team.Losses || 0}</td>`;
                        html += `<td style="padding: 8px; text-align: center; font-size: 12px;">${pct}</td>`;
                        html += '</tr>';
                    });
                    html += '</tbody></table>';
                }
            }
            
            html += '</table>';
            standingsContent.innerHTML = html;
    }
    // New function to load standings from Firestore (FlashLive API data)
    async function fetchLeagueStandingsFromFirestore(leagueKey) {
        const standingsContent = document.getElementById('league-standings-content');
        if (!standingsContent) return;
        
        standingsContent.innerHTML = '<p style="color: #9ca3af;">Loading standings...</p>';
        
        console.log(`📊 Fetching standings for ${leagueKey} from Firestore`);
        
        // Debug: Log the leagueKey to verify it's correct
        console.log(`🔍 DEBUG: leagueKey = "${leagueKey}"`);
        
        // For NCAAM/NCAAW, ensure we clear any stale cache that might be cross-contaminated
        if (leagueKey === 'NCAAM' || leagueKey === 'NCAAW') {
            console.log(`🔍 DEBUG: Clearing cache for ${leagueKey} to prevent cross-contamination`);
            clearStandingsCache(leagueKey);
        }
        
        // Map league keys to Firestore collection names
        const collectionMap = {
            'PremierLeague': 'EPLStandings',  // New collection format
            'LaLiga': 'LaLigaStandings',  // New collection format
            'SerieA': 'SerieAStandings',  // New collection format
            'Bundesliga': 'BundesligaStandings',  // New collection format
            'Ligue1': 'Ligue1Standings',  // New collection format
            'MLS': 'MLSStandings',  // New collection format
            'LigaMX': 'LigaMXStandings',  // New collection format
            'NWSL': 'NWSLStandings',  // New collection format
            'UEFAEuropaLeague': 'UEFAEuropaLeagueStandings',  // New collection format
            'UEFAConferenceLeague': 'UEFAConferenceLeagueStandings',  // New collection format
            'NFL': 'NFLStandings',  // New collection format
            'MLB': 'MLBStandings',  // New collection format
            'NBA': 'NBAStandings',  // New collection format
            'NHL': 'NHLStandings',  // New collection format
            'NCAAF': 'NCAAFStandings',  // New collection format
            'NCAAM': 'NCAAMStandings',  // New collection format
            'NCAAW': 'NCAAWStandings',  // New collection format
            'UEFAChampionsLeague': 'standings',  // UCL uses generic standings collection
            'AFCChampionsLeague': 'AFCChampionsLeagueStandings',
            'WNBA': 'standings',
            'FormulaOne': 'F1DriverStandings',  // F1 has special handling with Driver/Constructor tabs
            'FACup': 'FACupStandings',
            'PGATour': 'PGATourStandings',
            'LPGATour': 'LPGATourStandings',
            'UFC': 'UFCStandings',
            'Boxing': 'BoxingStandings',
            'NASCARCupSeries': 'NASCARCupSeriesStandings',
            'Tennis': 'TennisStandings',
            'LIVGolf': 'LIVGolfStandings',
            'IndyCar': 'IndyCarStandings',
            'MotoGP': 'MotoGPStandings',
            'TrackAndField': 'TrackAndFieldStandings',
            'Soccer': 'SoccerStandings',
            'NCAABaseball': 'NCAABaseballStandings',
            'NCAASoftball': 'NCAASoftballStandings',
            'WorldCupU17': 'WorldCupU17Standings',
            'WorldCupU17PlayOffs': 'WorldCupU17PlayOffsStandings'
        };
        
        const firestoreKeyMap = {
            'PremierLeague': 'Premier League',
            'LaLiga': 'LaLiga',
            'SerieA': 'Serie A',
            'Bundesliga': 'Bundesliga',
            'Ligue1': 'Ligue 1',
            'MLS': 'MLS',
            'LigaMX': 'Liga MX',
            'NWSL': 'NWSL',
            'UEFAEuropaLeague': 'UEFA Europa League',
            'UEFAConferenceLeague': 'UEFA Conference League',
            'NFL': 'NFL',
            'MLB': 'MLB',
            'NBA': 'NBA',
            'NHL': 'NHL',
            'UEFAChampionsLeague': 'UEFAChampionsLeague',
            'AFCChampionsLeague': 'AFC Champions League',
            'WNBA': 'WNBA',
            'FormulaOne': 'Formula One',
            'FACup': 'FA Cup',
            'PGATour': 'PGA Tour',
            'DPWorldTour': 'DP World Tour',
            'LPGATour': 'LPGA Tour',
            'PGATourChampions': 'PGA Champions',
            'UFC': 'UFC',
            'Boxing': 'Boxing',
            'NASCARCupSeries': 'NASCAR Cup Series',
            'Tennis': 'Tennis',
            'LIVGolf': 'LIV Golf',
            'IndyCar': 'IndyCar',
            'MotoGP': 'MotoGP',
            'TrackAndField': 'Track and Field',
            'Soccer': 'Soccer',
            'NCAABaseball': 'NCAA Baseball',
            'NCAASoftball': 'NCAA Softball',
            'WorldCupU17': 'World Cup U17',
            'WorldCupU17PlayOffs': 'World Cup U17 Play Offs'
        };
        
        const collectionName = collectionMap[leagueKey] || 'standings';
        const firestoreKey = firestoreKeyMap[leagueKey] || leagueKey;
        
        // Debug: Log collection mapping
        console.log(`🔍 DEBUG: leagueKey="${leagueKey}" -> collectionName="${collectionName}"`);
        
        try {
            let teams = [];
            
            // Check if this league uses the new collection format (like NFLStandings)
            if (collectionName !== 'standings') {
                // For Google Sheets-based leagues, check if data is stored in CSV format
                const dataDoc = await db.collection(collectionName).doc('data').get();
                
                if (dataDoc.exists) {
                    const csvData = dataDoc.data();
                    // Convert CSV format back to array format for frontend
                    if (csvData.headers && csvData.rows) {
                        // Convert row objects back to arrays (Firestore doesn't allow nested arrays)
                        const convertedRows = csvData.rows.map(rowObj => {
                            // rowObj is an object with numeric string keys like { "0": "value1", "1": "value2" }
                            const numKeys = Object.keys(rowObj).map(k => parseInt(k)).sort((a, b) => a - b);
                            return numKeys.map(key => rowObj[key.toString()] || '');
                        });
                        const rows = [csvData.headers, ...convertedRows];
                        // Use the existing CSV display logic
                        if (leagueKey === 'UFC') {
                            const menHtml = buildGroupedStandingsHtml(rows) || buildStandardStandingsTable(rows);
                            let womenHtml = '<p style="color: #9ca3af;">Loading women\'s rankings...</p>';
                            try {
                                const womenUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS2Z0QfXw34ib6V0gmcdqVvu6gwy8vHnD6cF3xMhJGZJHpU_s0vwC0h7phvbV0joe4tdVDGHiJ1kBfX/pub?gid=591530521&single=true&output=csv';
                                const womenRows = await fetchFromGoogleSheetsCSV(womenUrl);
                                womenHtml = buildGroupedStandingsHtml(womenRows) || buildStandardStandingsTable(womenRows);
                            } catch (womenError) {
                                console.error('Error loading UFC women rankings:', womenError);
                                womenHtml = '<p style="color: #ef4444;">Error loading women\'s rankings.</p>';
                            }
                            standingsContent.innerHTML = `
                                <div class="ufc-subtabs" style="display: flex; background-color: #2a2a2a; margin-bottom: 6px;">
                                    <div class="ufc-subtab active" data-ufc-tab="men" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #fff; border-bottom: 2px solid #fff;">Men's</div>
                                    <div class="ufc-subtab" data-ufc-tab="women" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #ccc;">Women's</div>
                                </div>
                                <div class="ufc-subcontent" data-ufc-content="men">${menHtml}</div>
                                <div class="ufc-subcontent" data-ufc-content="women" style="display: none;">${womenHtml}</div>
                            `;
                            const subTabs = standingsContent.querySelectorAll('.ufc-subtab');
                            const subContents = standingsContent.querySelectorAll('.ufc-subcontent');
                            subTabs.forEach(tab => {
                                tab.addEventListener('click', () => {
                                    const target = tab.dataset.ufcTab;
                                    subTabs.forEach(t => {
                                        t.classList.remove('active');
                                        t.style.color = '#ccc';
                                        t.style.borderBottom = 'none';
                                    });
                                    tab.classList.add('active');
                                    tab.style.color = '#fff';
                                    tab.style.borderBottom = '2px solid #fff';
                                    subContents.forEach(content => {
                                        content.style.display = content.dataset.ufcContent === target ? 'block' : 'none';
                                    });
                                });
                            });
                            return true;
                        } else if (leagueKey === 'Boxing') {
                            const menHtml = buildGroupedStandingsHtml(rows) || buildStandardStandingsTable(rows);
                            let womenHtml = '<p style="color: #9ca3af;">Loading women\'s rankings...</p>';
                            try {
                                // Try to fetch women's data from Firestore first
                                const womenDataDoc = await db.collection(collectionName).doc('data-women').get();
                                if (womenDataDoc.exists) {
                                    const womenCsvData = womenDataDoc.data();
                                    if (womenCsvData.headers && womenCsvData.rows) {
                                        // Convert row objects back to arrays (Firestore doesn't allow nested arrays)
                                        const convertedWomenRows = womenCsvData.rows.map(rowObj => {
                                            const numKeys = Object.keys(rowObj).map(k => parseInt(k)).sort((a, b) => a - b);
                                            return numKeys.map(key => rowObj[key.toString()] || '');
                                        });
                                        const womenRows = [womenCsvData.headers, ...convertedWomenRows];
                                        womenHtml = buildGroupedStandingsHtml(womenRows) || buildStandardStandingsTable(womenRows);
                                    } else {
                                        throw new Error('Invalid women\'s data format in Firestore');
                                    }
                                } else {
                                    // Fallback to Google Sheets if not in Firestore
                                    const womenUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRthmvN_N-bKFQdsc5V_Otx92FF5qwjYkI9YXHoKgKyV5jvfmb6skABo0Ncbh1x0ehEU-4Je3w_KPmb/pub?gid=0&single=true&output=csv';
                                    const womenRows = await fetchFromGoogleSheetsCSV(womenUrl);
                                    womenHtml = buildGroupedStandingsHtml(womenRows) || buildStandardStandingsTable(womenRows);
                                }
                            } catch (womenError) {
                                console.error('Error loading Boxing women rankings:', womenError);
                                womenHtml = '<p style="color: #ef4444;">Error loading women\'s rankings.</p>';
                            }
                            standingsContent.innerHTML = `
                                <div class="boxing-subtabs" style="display: flex; background-color: #2a2a2a; margin-bottom: 6px;">
                                    <div class="boxing-subtab active" data-boxing-tab="men" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #fff; border-bottom: 2px solid #fff;">Men's</div>
                                    <div class="boxing-subtab" data-boxing-tab="women" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #ccc;">Women's</div>
                                </div>
                                <div class="boxing-subcontent" data-boxing-content="men">${menHtml}</div>
                                <div class="boxing-subcontent" data-boxing-content="women" style="display: none;">${womenHtml}</div>
                            `;
                            const subTabs = standingsContent.querySelectorAll('.boxing-subtab');
                            const subContents = standingsContent.querySelectorAll('.boxing-subcontent');
                            subTabs.forEach(tab => {
                                tab.addEventListener('click', () => {
                                    const target = tab.dataset.boxingTab;
                                    subTabs.forEach(t => {
                                        t.classList.remove('active');
                                        t.style.color = '#ccc';
                                        t.style.borderBottom = 'none';
                                    });
                                    tab.classList.add('active');
                                    tab.style.color = '#fff';
                                    tab.style.borderBottom = '2px solid #fff';
                                    subContents.forEach(content => {
                                        content.style.display = content.dataset.boxingContent === target ? 'block' : 'none';
                                    });
                                });
                            });
                            return true;
                        } else if (leagueKey === 'Tennis') {
                            // Tennis has ATP/WTA tabs - but we only have one sheet, so use standard display
                            const html = buildGroupedStandingsHtml(rows) || buildStandardStandingsTable(rows);
                            standingsContent.innerHTML = html;
                            return true;
                        } else {
                            // Standard display for other leagues
                            const html = buildGroupedStandingsHtml(rows) || buildStandardStandingsTable(rows);
                            standingsContent.innerHTML = html;
                            return true;
                        }
                    }
                }
                
                // Fallback: try old format (individual documents)
                console.log(`🔍 DEBUG: Fetching from collection: ${collectionName} for leagueKey: ${leagueKey}`);
                const snapshot = await db.collection(collectionName).get();
                
                // If collection is empty, return false to fall back to CSV
                if (snapshot.empty) {
                    console.log(`📊 No data in ${collectionName}, falling back to CSV`);
                    return false;
                }
                
                teams = snapshot.docs.map(doc => doc.data());
                
                // CRITICAL: For NCAAM/NCAAW, verify we got the right data by checking sample team
                if ((leagueKey === 'NCAAM' || leagueKey === 'NCAAW') && teams.length > 0) {
                    const sampleTeam = teams[0];
                    console.log(`🔍 DEBUG: ${leagueKey} - Sample team from ${collectionName}:`, sampleTeam);
                    console.log(`🔍 DEBUG: ${leagueKey} - Total teams: ${teams.length}, First team Conference: "${sampleTeam.Conference}"`);
                    // Verify the data looks correct (should have Conference, Team, etc.)
                    if (!sampleTeam.Conference || !sampleTeam.Team) {
                        console.error(`⚠️ WARNING: ${leagueKey} data from ${collectionName} appears invalid!`);
                    }
                    
                    // Double-check: Verify collection name matches leagueKey
                    if (leagueKey === 'NCAAM' && collectionName !== 'NCAAMStandings') {
                        console.error(`❌ ERROR: NCAAM leagueKey but fetching from wrong collection: ${collectionName}`);
                    }
                    if (leagueKey === 'NCAAW' && collectionName !== 'NCAAWStandings') {
                        console.error(`❌ ERROR: NCAAW leagueKey but fetching from wrong collection: ${collectionName}`);
                    }
                }
                
                // Check if we have cached data and compare timestamps
                const cachedData = localStorage.getItem(getStandingsCacheKey(leagueKey));
                if (cachedData && teams.length > 0 && teams[0].lastUpdated) {
                    try {
                        const cache = JSON.parse(cachedData);
                        const firestoreLastUpdated = teams[0].lastUpdated;
                        const cacheLastUpdated = cache.lastUpdated;
                        
                        // Check if cache is missing lastUpdated field (old format) - clear it
                        if (!cacheLastUpdated) {
                            console.log(`🗑️ Old cache format detected for ${leagueKey}, clearing...`);
                            clearStandingsCache(leagueKey);
                            // Continue to display fresh data and update cache below
                        }
                        // If cached data is from the SAME scraper run (same lastUpdated), use cache to avoid re-rendering
                        else if (cacheLastUpdated === firestoreLastUpdated) {
                            console.log(`📊 Cache is up-to-date for ${leagueKey}, using cached version`);
                            const cachedTeams = getCachedStandings(leagueKey);
                            if (cachedTeams && cachedTeams.length > 0) {
                                displayStandingsTable(leagueKey, cachedTeams, standingsContent);
                                return true;
                            }
                        } else {
                            console.log(`📊 New data detected for ${leagueKey}! Cache: ${cacheLastUpdated}, Firestore: ${firestoreLastUpdated}`);
                            // Continue to display fresh data and update cache below
                        }
                    } catch (e) {
                        console.log(`📊 Error parsing cache for ${leagueKey}, clearing bad cache...`);
                        clearStandingsCache(leagueKey);
                        // Continue with fresh data
                    }
                }
            } else {
                // Old format: query 'standings' collection by league field
                const snapshot = await db.collection('standings')
                    .where('league', '==', firestoreKey)
                    .get();
                
                if (snapshot.empty) {
                    // Fallback to CSV if no Firestore data
                    return false;
                }
                
                teams = snapshot.docs.map(doc => doc.data());
            }
            
            // Cache the fetched data
            if (teams.length > 0) {
                cacheStandings(leagueKey, teams);
                console.log(`📊 Cached ${teams.length} teams for ${leagueKey}`);
            }
            
            if (teams.length === 0) {
                standingsContent.innerHTML = '<p>No standings data available.</p>';
                return true;
            }
            
            // Debug: Verify data source for NCAAM/NCAAW
            if (leagueKey === 'NCAAM' || leagueKey === 'NCAAW') {
                console.log(`🔍 DEBUG: ${leagueKey} - Collection: ${collectionName}, Teams count: ${teams.length}`);
                if (teams.length > 0) {
                    console.log(`🔍 DEBUG: First team sample:`, teams[0]);
                    // Check if teams have Conference field (should be present for both NCAAM and NCAAW)
                    const sampleConference = teams[0].Conference;
                    console.log(`🔍 DEBUG: Sample conference from data: "${sampleConference}"`);
                }
            }
            
            // Display the standings table
            console.log(`📊 Displaying standings for ${leagueKey}, ${teams.length} teams, first team:`, teams[0]);
            console.log(`🔍 DEBUG: About to call displayStandingsTable with leagueKey="${leagueKey}"`);
            displayStandingsTable(leagueKey, teams, standingsContent);
            return true;
            
        } catch (error) {
            console.error(`Error loading Firestore standings for ${leagueKey}:`, error);
            return false;
        }
    }

    // NFL Standings: AFC/NFC tabs with divisions
    function createNFLStandings(teams) {
        // Filter teams by conference based on their Division field
        const afcTeams = teams.filter(team => team.Division && team.Division.startsWith('AFC'));
        const nfcTeams = teams.filter(team => team.Division && team.Division.startsWith('NFC'));
        
        let html = '<div class="standings-tabs">';
        html += '<button class="tab-button active" onclick="showNFLTab(\'afc\')" id="nfl-afc-tab">AFC</button>';
        html += '<button class="tab-button" onclick="showNFLTab(\'nfc\')" id="nfl-nfc-tab">NFC</button>';
        html += '</div>';
        html += '<div id="nfl-afc-content" class="tab-content active">';
        html += createNFLConferenceStandings(afcTeams, 'AFC');
        html += '</div>';
        html += '<div id="nfl-nfc-content" class="tab-content">';
        html += createNFLConferenceStandings(nfcTeams, 'NFC');
        html += '</div>';
        // JavaScript functions will be defined elsewhere
        
        return html;
    }
    
    function createNFLConferenceStandings(teams, conference) {
        const divisions = ['AFC East', 'AFC North', 'AFC South', 'AFC West', 'NFC East', 'NFC North', 'NFC South', 'NFC West'];
        const conferenceDivisions = divisions.filter(div => div.startsWith(conference));
        let html = '';
        
        conferenceDivisions.forEach(divisionName => {
            const divisionTeams = teams.filter(team => team.Division === divisionName);
            if (divisionTeams.length === 0) return;
            
            // Sort teams by wins (descending), then by losses (ascending), then by ties (descending)
            divisionTeams.sort((a, b) => {
                const winsA = parseInt(a.Wins) || 0;
                const winsB = parseInt(b.Wins) || 0;
                if (winsA !== winsB) return winsB - winsA; // Higher wins first
                
                const lossesA = parseInt(a.Losses) || 0;
                const lossesB = parseInt(b.Losses) || 0;
                if (lossesA !== lossesB) return lossesA - lossesB; // Lower losses first
                
                const tiesA = parseInt(a.Ties) || 0;
                const tiesB = parseInt(b.Ties) || 0;
                return tiesB - tiesA; // Higher ties first
            });
            
            html += '<div class="division-section">';
            html += '<h3 class="division-header">' + divisionName + '</h3>';
            html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff; margin-bottom: 15px;">';
            html += '<thead>';
            html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
            html += '<th style="padding: 8px; text-align: left; border-bottom: 1px solid #666;">Team</th>';
            html += '<th style="padding: 8px; text-align: center; border-bottom: 1px solid #666;">W</th>';
            html += '<th style="padding: 8px; text-align: center; border-bottom: 1px solid #666;">L</th>';
            html += '<th style="padding: 8px; text-align: center; border-bottom: 1px solid #666;">T</th>';
            html += '</tr>';
            html += '</thead>';
            html += '<tbody>';
            
            divisionTeams.forEach((team, index) => {
                const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
                html += '<tr style="' + rowStyle + '">';
                html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500; color: #ffffff;">' + team.Team + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.Wins + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.Losses + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + (team.Ties || 0) + '</td>';
                html += '</tr>';
            });
            
            html += '</tbody></table></div>';
        });
        
        return html;
    }

    // MLB Standings: AL/NL tabs with divisions
    function createMLBStandings(teams) {
        const alTeams = teams.filter(team => team.Division && team.Division.startsWith('AL'));
        const nlTeams = teams.filter(team => team.Division && team.Division.startsWith('NL'));
        
        let html = '<div class="standings-tabs">';
        html += '<button class="tab-button active" onclick="showMLBTab(\'al\')" id="mlb-al-tab">AL</button>';
        html += '<button class="tab-button" onclick="showMLBTab(\'nl\')" id="mlb-nl-tab">NL</button>';
        html += '</div>';
        html += '<div id="mlb-al-content" class="tab-content active">';
        html += createMLBLeagueStandings(alTeams);
        html += '</div>';
        html += '<div id="mlb-nl-content" class="tab-content">';
        html += createMLBLeagueStandings(nlTeams);
        html += '</div>';
        
        return html;
    }
    
    function createMLBLeagueStandings(teams) {
        // Group teams by division
        const divisions = [...new Set(teams.map(t => t.Division))].sort();
        let html = '';
        
        divisions.forEach(divisionName => {
            const divisionTeams = teams.filter(team => team.Division === divisionName);
            if (divisionTeams.length === 0) return;
            
            // Sort teams by wins (descending), then losses (ascending)
            divisionTeams.sort((a, b) => {
                const winsA = parseInt(a.Wins) || 0;
                const winsB = parseInt(b.Wins) || 0;
                if (winsA !== winsB) return winsB - winsA; // Higher wins first
                
                const lossesA = parseInt(a.Losses) || 0;
                const lossesB = parseInt(b.Losses) || 0;
                return lossesA - lossesB; // Lower losses first
            });
            
            html += '<div class="division-section">';
            html += '<h3 class="division-header">' + divisionName + '</h3>';
            html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff; margin-bottom: 20px;">';
            html += '<thead>';
            html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
            html += '<th style="padding: 8px; text-align: left; border-bottom: 1px solid #666;">Team</th>';
            html += '<th style="padding: 8px; text-align: center; width: 60px; border-bottom: 1px solid #666;">W</th>';
            html += '<th style="padding: 8px; text-align: center; width: 60px; border-bottom: 1px solid #666;">L</th>';
            html += '</tr>';
            html += '</thead>';
            html += '<tbody>';
            
            divisionTeams.forEach((team, index) => {
                const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
                html += '<tr style="' + rowStyle + '">';
                html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500; color: #ffffff;">' + team.Team + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.Wins + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.Losses + '</td>';
                html += '</tr>';
            });
            
            html += '</tbody></table></div>';
        });
        
        return html;
    }

    // NBA Standings: East/West tabs
    function createNBAStandings(teams) {
        const eastTeams = teams.filter(team => team.Conference === 'Eastern Conference');
        const westTeams = teams.filter(team => team.Conference === 'Western Conference');
        
        let html = '<div class="standings-tabs">';
        html += '<button class="tab-button active" onclick="showNBATab(\'east\')" id="nba-east-tab">Eastern Conference</button>';
        html += '<button class="tab-button" onclick="showNBATab(\'west\')" id="nba-west-tab">Western Conference</button>';
        html += '</div>';
        html += '<div id="nba-east-content" class="tab-content active">';
        html += createNBAConferenceStandings(eastTeams, 'Eastern Conference');
        html += '</div>';
        html += '<div id="nba-west-content" class="tab-content">';
        html += createNBAConferenceStandings(westTeams, 'Western Conference');
        html += '</div>';
        
        return html;
    }
    
    function createNBAConferenceStandings(teams, conference) {
        // Sort teams by wins (descending), then by losses (ascending)
        teams.sort((a, b) => {
            const winsA = parseInt(a.Wins) || 0;
            const winsB = parseInt(b.Wins) || 0;
            if (winsA !== winsB) return winsB - winsA; // Higher wins first
            
            const lossesA = parseInt(a.Losses) || 0;
            const lossesB = parseInt(b.Losses) || 0;
            return lossesA - lossesB; // Lower losses first
        });
        
        let html = '<div class="conference-section">';
        html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff;">';
        html += '<thead>';
        html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
        html += '<th style="padding: 8px; text-align: center; width: 30px;"></th>';
        html += '<th style="padding: 8px; text-align: left;">Team</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">W</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">L</th>';
        html += '</tr>';
        html += '</thead>';
        html += '<tbody>';
        
        teams.forEach((team, index) => {
            const rank = index + 1;
            const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
            html += '<tr style="' + rowStyle + '">';
            html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #9ca3af;">' + rank + '</td>';
            html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500;">' + team.Team + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 12px;">' + team.Wins + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 12px;">' + team.Losses + '</td>';
            html += '</tr>';
        });
        
        html += '</tbody></table></div>';
        return html;
    }
    // MLS Standings: East/West tabs
    function createMLSStandings(teams) {
        const eastTeams = teams.filter(team => team.Conference === 'Eastern Conference');
        const westTeams = teams.filter(team => team.Conference === 'Western Conference');
        
        let html = '<div class="standings-tabs">';
        html += '<button class="tab-button active" onclick="showMLSTab(\'east\')" id="mls-east-tab">Eastern Conference</button>';
        html += '<button class="tab-button" onclick="showMLSTab(\'west\')" id="mls-west-tab">Western Conference</button>';
        html += '</div>';
        html += '<div id="mls-east-content" class="tab-content active">';
        html += createMLSConferenceStandings(eastTeams, 'Eastern Conference');
        html += '</div>';
        html += '<div id="mls-west-content" class="tab-content">';
        html += createMLSConferenceStandings(westTeams, 'Western Conference');
        html += '</div>';
        
        return html;
    }
    
    function createMLSConferenceStandings(teams, conference) {
        // Sort teams by rank (which is based on points)
        teams.sort((a, b) => {
            const rankA = parseInt(a.Rank) || 0;
            const rankB = parseInt(b.Rank) || 0;
            return rankA - rankB;
        });
        
        let html = '<div class="conference-section">';
        html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff;">';
        html += '<thead>';
        html += '<tr style="background-color: #4a4a4a; font-size: 9px; font-weight: 600;">';
        html += '<th style="padding: 8px; text-align: left; width: 20px;"></th>';
        html += '<th style="padding: 8px; text-align: left;">Team</th>';
        html += '<th style="padding: 8px; text-align: center; width: 50px;">Pts</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">MP</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">W</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">D</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">L</th>';
        html += '</tr>';
        html += '</thead>';
        html += '<tbody>';
        
        teams.forEach((team, index) => {
            const rank = team.Rank || (index + 1);
            const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
            const displayTeamName = getTeamDisplayName(team.Team, 'MLS');
            html += '<tr style="' + rowStyle + '">';
            html += '<td style="padding: 8px; text-align: center; font-size: 10px; color: #9ca3af;">' + rank + '</td>';
            html += '<td style="padding: 8px; text-align: left; font-size: 10px; font-weight: 500;">' + displayTeamName + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 10px; font-weight: 600;">' + (team.Points || 0) + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 10px;">' + (team.MP || 0) + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 10px;">' + (team.Wins || 0) + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 10px;">' + (team.Draws || 0) + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 10px;">' + (team.Losses || 0) + '</td>';
            html += '</tr>';
        });
        
        html += '</tbody></table></div>';
        return html;
    }

    // NHL Standings: East/West tabs with divisions
    function createNHLStandings(teams) {
        const eastTeams = teams.filter(team => team.Conference === 'Eastern Conference');
        const westTeams = teams.filter(team => team.Conference === 'Western Conference');
        
        let html = '<div class="standings-tabs">';
        html += '<button class="tab-button active" onclick="showNHLTab(\'east\')" id="nhl-east-tab">Eastern Conference</button>';
        html += '<button class="tab-button" onclick="showNHLTab(\'west\')" id="nhl-west-tab">Western Conference</button>';
        html += '</div>';
        html += '<div id="nhl-east-content" class="tab-content active">';
        html += createNHLConferenceStandings(eastTeams, 'Eastern Conference');
        html += '</div>';
        html += '<div id="nhl-west-content" class="tab-content">';
        html += createNHLConferenceStandings(westTeams, 'Western Conference');
        html += '</div>';
        
        return html;
    }
    
    function createNHLConferenceStandings(teams, conference) {
        const divisions = conference === 'Eastern Conference' ? ['Atlantic Division', 'Metropolitan Division'] : ['Central Division', 'Pacific Division'];
        let html = '';
        
        divisions.forEach(division => {
            const divisionTeams = teams.filter(team => team.Division === division);
            if (divisionTeams.length === 0) return;
            
            // Sort teams by points (descending)
            divisionTeams.sort((a, b) => {
                const pointsA = parseInt(a.Points) || 0;
                const pointsB = parseInt(b.Points) || 0;
                return pointsB - pointsA; // Higher points first
            });
            
            html += '<div class="division-section">';
            html += '<h3 class="division-header">' + division + '</h3>';
            html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff; margin-bottom: 20px;">';
            html += '<thead>';
            html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
            html += '<th style="padding: 8px; text-align: left; border-bottom: 1px solid #666;">Team</th>';
            html += '<th style="padding: 8px; text-align: center; width: 50px; border-bottom: 1px solid #666;">Pts</th>';
            html += '<th style="padding: 8px; text-align: center; width: 50px; border-bottom: 1px solid #666;">GP</th>';
            html += '<th style="padding: 8px; text-align: center; width: 50px; border-bottom: 1px solid #666;">W</th>';
            html += '<th style="padding: 8px; text-align: center; width: 50px; border-bottom: 1px solid #666;">L</th>';
            html += '<th style="padding: 8px; text-align: center; width: 50px; border-bottom: 1px solid #666;">OTL</th>';
            html += '</tr>';
            html += '</thead>';
            html += '<tbody>';
            
            divisionTeams.forEach((team, index) => {
                const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
                html += '<tr style="' + rowStyle + '">';
                html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500; color: #ffffff;">' + team.Team + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.Points + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.GP + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.Wins + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.Losses + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + (team.OTL || 0) + '</td>';
                html += '</tr>';
            });
            
            html += '</tbody></table></div>';
        });
        
        return html;
    }

    // WNBA Standings: Hardcoded data
    function createWNBAStandings(teams) {
        let html = '<div class="wnba-standings">';
        html += '<div class="conference-section">';
        html += '<h3 class="conference-header">Eastern Conference</h3>';
        html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff; margin-bottom: 30px;">';
        html += '<thead>';
        html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
        html += '<th style="padding: 8px; text-align: left; width: 40px;">Rank</th>';
        html += '<th style="padding: 8px; text-align: left;">Team</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">W</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">L</th>';
        html += '</tr>';
        html += '</thead>';
        html += '<tbody>';
        
        const eastTeams = [
            { Rank: 3, Team: 'Dream', Wins: 30, Losses: 14 },
            { Rank: 5, Team: 'Liberty', Wins: 27, Losses: 17 },
            { Rank: 6, Team: 'Fever', Wins: 24, Losses: 20 },
            { Rank: 10, Team: 'Mystics', Wins: 16, Losses: 28 },
            { Rank: 11, Team: 'Sun', Wins: 11, Losses: 33 },
            { Rank: 12, Team: 'Sky', Wins: 10, Losses: 34 }
        ];
        
        eastTeams.forEach((team, index) => {
            const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
            html += '<tr style="' + rowStyle + '">';
            html += '<td style="padding: 8px; text-align: left; font-size: 12px;">' + team.Rank + '</td>';
            html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500;">' + team.Team + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 12px;">' + team.Wins + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 12px;">' + team.Losses + '</td>';
            html += '</tr>';
        });
        
        html += '</tbody>';
        html += '</table>';
        html += '</div>';
        html += '<div class="conference-section">';
        html += '<h3 class="conference-header">Western Conference</h3>';
        html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff;">';
        html += '<thead>';
        html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
        html += '<th style="padding: 8px; text-align: left; width: 40px;">Rank</th>';
        html += '<th style="padding: 8px; text-align: left;">Team</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">W</th>';
        html += '<th style="padding: 8px; text-align: center; width: 40px;">L</th>';
        html += '</tr>';
        html += '</thead>';
        html += '<tbody>';
        
        const westTeams = [
            { Rank: 1, Team: 'Lynx', Wins: 34, Losses: 10 },
            { Rank: 2, Team: 'Aces', Wins: 30, Losses: 14 },
            { Rank: 4, Team: 'Mercury', Wins: 27, Losses: 17 },
            { Rank: 7, Team: 'Storm', Wins: 23, Losses: 21 },
            { Rank: 8, Team: 'Valkyries', Wins: 23, Losses: 21 },
            { Rank: 9, Team: 'Sparks', Wins: 21, Losses: 23 },
            { Rank: 13, Team: 'Wings', Wins: 10, Losses: 34 }
        ];
        
        westTeams.forEach((team, index) => {
            const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
            html += '<tr style="' + rowStyle + '">';
            html += '<td style="padding: 8px; text-align: left; font-size: 12px;">' + team.Rank + '</td>';
            html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500;">' + team.Team + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 12px;">' + team.Wins + '</td>';
            html += '<td style="padding: 8px; text-align: center; font-size: 12px;">' + team.Losses + '</td>';
            html += '</tr>';
        });
        
        html += '</tbody></table></div></div>';
        return html;
    }

    // NCAAF Standings: Show all conferences
    function createNCAAFStandings(teams) {
        // Get unique conferences and sort them, filtering out "undefined"
        const conferences = [...new Set(teams.map(t => t.Conference))].filter(conf => conf && conf !== 'undefined' && conf.trim() !== '').sort();
        
        let html = '<div class="ncaaf-standings">';
        
        conferences.forEach(conferenceName => {
            const conferenceTeams = teams.filter(team => team.Conference === conferenceName);
            if (conferenceTeams.length === 0) return;
            
            // Sort by conference record first (ConfRecord like "4-0"), then overall record (Wins/Losses)
            conferenceTeams.sort((a, b) => {
                const [cWA, cLA] = String(a.ConfRecord || '').split('-').map(n => parseInt(n) || 0);
                const [cWB, cLB] = String(b.ConfRecord || '').split('-').map(n => parseInt(n) || 0);
                if (cWA !== cWB) return cWB - cWA; // more conference wins first
                if (cLA !== cLB) return cLA - cLB; // fewer conference losses next

                const winsA = parseInt(a.Wins) || 0;
                const winsB = parseInt(b.Wins) || 0;
                if (winsA !== winsB) return winsB - winsA; // more overall wins

                const lossesA = parseInt(a.Losses) || 0;
                const lossesB = parseInt(b.Losses) || 0;
                return lossesA - lossesB; // fewer overall losses
            });
            
            html += '<div class="conference-section" style="margin-bottom: 30px;">';
            html += '<h3 class="conference-header" style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 10px; padding: 8px; background-color: #3a3a3a; border-left: 4px solid #ef4444;">' + conferenceName + '</h3>';
            html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff;">';
            html += '<thead>';
            html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
            html += '<th style="padding: 8px; text-align: left; border-bottom: 1px solid #666;">Team</th>';
            html += '<th style="padding: 8px; text-align: center; width: 80px; border-bottom: 1px solid #666;">Overall</th>';
            html += '<th style="padding: 8px; text-align: center; width: 80px; border-bottom: 1px solid #666;">Conf</th>';
            html += '</tr>';
            html += '</thead>';
            html += '<tbody>';
            
            conferenceTeams.forEach((team, index) => {
                const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
                html += '<tr style="' + rowStyle + '">';
                html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500; color: #ffffff;">' + team.Team + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.OverallRecord + '</td>';
                html += '<td style="padding: 8px; text-align: center; font-size: 12px; color: #ffffff;">' + team.ConfRecord + '</td>';
                html += '</tr>';
            });
            
            html += '</tbody></table></div>';
        });
        
        html += '</div>';
        return html;
    }

    // NCAAM Standings: Show all conferences with Team | Overall | Conf columns
    function createNCAAMStandings(teams) {
        // Conference name mapping for NCAAM
        const conferenceNameMap = {
            'ASUN Conference': 'ASUN',
            'America East Conference': 'America East',
            'American Conference': 'AAC',
            'Atlantic 10 Conference': 'A-10',
            'Atlantic Coast Conference': 'ACC',
            'Big 12 Conference': 'Big 12',
            'Big East Conference': 'Big East',
            'Big Sky Conference': 'Big Sky',
            'Big South Conference': 'Big South',
            'Big Ten Conference': 'B1G',
            'Big West Conference': 'Big West',
            'Coastal Athletic Association': 'CAA',
            'Conference USA': 'Conference USA',
            'Horizon League': 'Horizon League',
            'Ivy League': 'Ivy League',
            'Metro Atlantic Athletic Conference': 'MAAC',
            'Mid-American Conference': 'MAC',
            'Mid-Eastern Athletic Conference': 'MEAC',
            'Missouri Valley Conference': 'Missouri Valley',
            'Mountain West Conference': 'Mountain West',
            'Northeast Conference': 'NEC',
            'Ohio Valley Conference': 'Ohio Valley',
            'Patriot League': 'Patriot League',
            'Southeastern Conference': 'SEC',
            'Southern Conference': 'Southern',
            'Southland Conference': 'Southland',
            'Southwestern Athletic Conference': 'SWAC',
            'Summit League': 'Summit League',
            'Sun Belt Conference': 'Sun Belt',
            'West Coast Conference': 'WCC',
            'Western Athletic Conference': 'WAC'
        };
        
        // Get unique conferences and sort them, filtering out "undefined"
        const conferences = [...new Set(teams.map(t => t.Conference))].filter(conf => conf && conf !== 'undefined' && conf.trim() !== '').sort();
        
        let html = '<div class="ncaam-standings">';
        
        conferences.forEach(conferenceName => {
            // Use mapped name if available, otherwise use original
            const displayConferenceName = conferenceNameMap[conferenceName] || conferenceName;
            const conferenceTeams = teams.filter(team => team.Conference === conferenceName);
            if (conferenceTeams.length === 0) return;
            
            // Sort by conference record first, then overall record
            // If conference record is 0-0, sort by overall record
            conferenceTeams.sort((a, b) => {
                const [cWA, cLA] = String(a.ConfRecord || '0-0').split('-').map(n => parseInt(n) || 0);
                const [cWB, cLB] = String(b.ConfRecord || '0-0').split('-').map(n => parseInt(n) || 0);
                
                // If both have 0-0 conference records, sort by overall record
                if (cWA === 0 && cLA === 0 && cWB === 0 && cLB === 0) {
                    const winsA = parseInt(a.Wins) || 0;
                    const winsB = parseInt(b.Wins) || 0;
                    if (winsA !== winsB) return winsB - winsA; // more overall wins first
                    const lossesA = parseInt(a.Losses) || 0;
                    const lossesB = parseInt(b.Losses) || 0;
                    return lossesA - lossesB; // fewer overall losses first
                }
                
                // Otherwise, sort by conference record first
                if (cWA !== cWB) return cWB - cWA; // more conference wins first
                if (cLA !== cLB) return cLA - cLB; // fewer conference losses next

                // Then by overall record
                const winsA = parseInt(a.Wins) || 0;
                const winsB = parseInt(b.Wins) || 0;
                if (winsA !== winsB) return winsB - winsA; // more overall wins

                const lossesA = parseInt(a.Losses) || 0;
                const lossesB = parseInt(b.Losses) || 0;
                return lossesA - lossesB; // fewer overall losses
            });
            
            html += '<div class="conference-section" style="margin-bottom: 30px;">';
            html += '<h3 class="conference-header" style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 10px; padding: 8px; background-color: #3a3a3a; border-left: 4px solid #ef4444;">' + displayConferenceName + '</h3>';
            html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff; table-layout: fixed;">';
            html += '<colgroup>';
            html += '<col style="width: auto;">';
            html += '<col style="width: 60px;">';
            html += '<col style="width: 60px;">';
            html += '</colgroup>';
            html += '<thead>';
            html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
            html += '<th style="padding: 8px; text-align: left; border-bottom: 1px solid #666;">Team</th>';
            html += '<th style="padding: 8px 5px 8px 0; text-align: right; border-bottom: 1px solid #666;">Conf.</th>';
            html += '<th style="padding: 8px 8px 8px 5px; text-align: right; border-bottom: 1px solid #666;">Overall</th>';
            html += '</tr>';
            html += '</thead>';
            html += '<tbody>';
            
            conferenceTeams.forEach((team, index) => {
                const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
                html += '<tr style="' + rowStyle + '">';
                html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500; color: #ffffff;">' + team.Team + '</td>';
                html += '<td style="padding: 8px 5px 8px 0; text-align: right; font-size: 12px; color: #ffffff;">' + team.ConfRecord + '</td>';
                html += '<td style="padding: 8px 8px 8px 5px; text-align: right; font-size: 12px; color: #ffffff;">' + team.OverallRecord + '</td>';
                html += '</tr>';
            });
            
            html += '</tbody></table></div>';
        });
        
        html += '</div>';
        return html;
    }

    // NCAAW Standings: Show all conferences with Team | Overall | Conf columns
    function createNCAAWStandings(teams) {
        // Conference name mapping for NCAAW (same as NCAAM)
        const conferenceNameMap = {
            'ASUN Conference': 'ASUN',
            'America East Conference': 'America East',
            'American Conference': 'AAC',
            'Atlantic 10 Conference': 'A-10',
            'Atlantic Coast Conference': 'ACC',
            'Big 12 Conference': 'Big 12',
            'Big East Conference': 'Big East',
            'Big Sky Conference': 'Big Sky',
            'Big South Conference': 'Big South',
            'Big Ten Conference': 'B1G',
            'Big West Conference': 'Big West',
            'Coastal Athletic Association': 'CAA',
            'Conference USA': 'Conference USA',
            'Horizon League': 'Horizon League',
            'Ivy League': 'Ivy League',
            'Metro Atlantic Athletic Conference': 'MAAC',
            'Mid-American Conference': 'MAC',
            'Mid-Eastern Athletic Conference': 'MEAC',
            'Missouri Valley Conference': 'Missouri Valley',
            'Mountain West Conference': 'Mountain West',
            'Northeast Conference': 'NEC',
            'Ohio Valley Conference': 'Ohio Valley',
            'Patriot League': 'Patriot League',
            'Southeastern Conference': 'SEC',
            'Southern Conference': 'Southern',
            'Southland Conference': 'Southland',
            'Southwestern Athletic Conference': 'SWAC',
            'Summit League': 'Summit League',
            'Sun Belt Conference': 'Sun Belt',
            'West Coast Conference': 'WCC',
            'Western Athletic Conference': 'WAC'
        };
        
        // Get unique conferences and sort them, filtering out "undefined"
        const conferences = [...new Set(teams.map(t => t.Conference))].filter(conf => conf && conf !== 'undefined' && conf.trim() !== '').sort();
        
        let html = '<div class="ncaaw-standings">';
        
        conferences.forEach(conferenceName => {
            // Use mapped name if available, otherwise use original
            const displayConferenceName = conferenceNameMap[conferenceName] || conferenceName;
            const conferenceTeams = teams.filter(team => team.Conference === conferenceName);
            if (conferenceTeams.length === 0) return;
            
            // Sort by conference record first, then overall record
            // If conference record is 0-0, sort by overall record
            conferenceTeams.sort((a, b) => {
                const [cWA, cLA] = String(a.ConfRecord || '0-0').split('-').map(n => parseInt(n) || 0);
                const [cWB, cLB] = String(b.ConfRecord || '0-0').split('-').map(n => parseInt(n) || 0);
                
                // If both have 0-0 conference records, sort by overall record
                if (cWA === 0 && cLA === 0 && cWB === 0 && cLB === 0) {
                    const winsA = parseInt(a.Wins) || 0;
                    const winsB = parseInt(b.Wins) || 0;
                    if (winsA !== winsB) return winsB - winsA; // more overall wins first
                    const lossesA = parseInt(a.Losses) || 0;
                    const lossesB = parseInt(b.Losses) || 0;
                    return lossesA - lossesB; // fewer overall losses first
                }
                
                // Otherwise, sort by conference record first
                if (cWA !== cWB) return cWB - cWA; // more conference wins first
                if (cLA !== cLB) return cLA - cLB; // fewer conference losses next

                // Then by overall record
                const winsA = parseInt(a.Wins) || 0;
                const winsB = parseInt(b.Wins) || 0;
                if (winsA !== winsB) return winsB - winsA; // more overall wins

                const lossesA = parseInt(a.Losses) || 0;
                const lossesB = parseInt(b.Losses) || 0;
                return lossesA - lossesB; // fewer overall losses
            });
            
            html += '<div class="conference-section" style="margin-bottom: 30px;">';
            html += '<h3 class="conference-header" style="color: #ffffff; font-size: 16px; font-weight: 600; margin-bottom: 10px; padding: 8px; background-color: #3a3a3a; border-left: 4px solid #ef4444;">' + displayConferenceName + '</h3>';
            html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff; table-layout: fixed;">';
            html += '<colgroup>';
            html += '<col style="width: auto;">';
            html += '<col style="width: 60px;">';
            html += '<col style="width: 60px;">';
            html += '</colgroup>';
            html += '<thead>';
            html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
            html += '<th style="padding: 8px; text-align: left; border-bottom: 1px solid #666;">Team</th>';
            html += '<th style="padding: 8px 5px 8px 0; text-align: right; border-bottom: 1px solid #666;">Conf.</th>';
            html += '<th style="padding: 8px 8px 8px 5px; text-align: right; border-bottom: 1px solid #666;">Overall</th>';
            html += '</tr>';
            html += '</thead>';
            html += '<tbody>';
            
            conferenceTeams.forEach((team, index) => {
                const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
                html += '<tr style="' + rowStyle + '">';
                html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500; color: #ffffff;">' + team.Team + '</td>';
                html += '<td style="padding: 8px 5px 8px 0; text-align: right; font-size: 12px; color: #ffffff;">' + team.ConfRecord + '</td>';
                html += '<td style="padding: 8px 8px 8px 5px; text-align: right; font-size: 12px; color: #ffffff;">' + team.OverallRecord + '</td>';
                html += '</tr>';
            });
            
            html += '</tbody></table></div>';
        });
        
        html += '</div>';
        return html;
    }

    // REPLACE THE OLD FUNCTION WITH THIS ONE
    async function fetchLeagueStandings(url, leagueKey) {
        const standingsContent = document.getElementById('league-standings-content');
        if (!standingsContent) return;
        
        // First try to load from Firestore (FlashLive API data)
        const loadedFromFirestore = await fetchLeagueStandingsFromFirestore(leagueKey);
        if (loadedFromFirestore) {
            return; // Successfully loaded from Firestore
        }
        
        // Fallback to CSV if not in Firestore
        standingsContent.innerHTML = '<p style="color: #9ca3af;">Loading standings...</p>';
        try {
            if (leagueKey === 'Tennis') {
                const ATP_RANKINGS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ74Qw3ZgBqRAKd_HVAnGLI9zDqk_JILTBTtlrFKI8oCosRHnLQZ9Nu8BIAVYdLq932wzE8oz3UNCIP/pub?gid=0&single=true&output=csv';
                const WTA_RANKINGS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ74Qw3ZgBqRAKd_HVAnGLI9zDqk_JILTBTtlrFKI8oCosRHnLQZ9Nu8BIAVYdLq932wzE8oz3UNCIP/pub?gid=1773187500&single=true&output=csv';
                
                const [atpRows, wtaRows] = await Promise.all([
                    fetchFromGoogleSheetsCSV(ATP_RANKINGS_URL),
                    fetchFromGoogleSheetsCSV(WTA_RANKINGS_URL)
                ]);
                
                const buildRankingsTable = (rows) => {
                    if (!rows || rows.length < 2) {
                        return '<p style="color: #9ca3af;">No rankings data available.</p>';
                    }
                    
                    const headerRow = rows[0];
                    const rankIndex = headerRow.findIndex(h => h.toLowerCase().includes('rank'));
                    const nameIndex = headerRow.findIndex(h => h.toLowerCase().includes('name'));
                    const pointsIndex = headerRow.findIndex(h => h.toLowerCase().includes('point'));
                    
                    const dataRows = rows.slice(1).filter(row => row.length > 1 && row[rankIndex] && row[nameIndex]);
                    
                    let tableHtml = '<table style="width: 100%; border-collapse: collapse; color: #ffffff; font-size: 12px;">';
                    tableHtml += '<thead><tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
                    tableHtml += '<th style="padding: 8px; text-align: left; width: 50px;">Rank</th>';
                    tableHtml += '<th style="padding: 8px; text-align: left;">Name</th>';
                    tableHtml += '<th style="padding: 8px; text-align: right; width: 80px;">Points</th>';
                    tableHtml += '</tr></thead><tbody>';
                    
                    dataRows.forEach((row, index) => {
                        const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
                        tableHtml += `<tr style="${rowStyle}">`;
                        tableHtml += `<td style="padding: 8px; text-align: left;">${row[rankIndex] || ''}</td>`;
                        tableHtml += `<td style="padding: 8px; text-align: left; font-weight: 500;">${row[nameIndex] || ''}</td>`;
                        tableHtml += `<td style="padding: 8px; text-align: right;">${row[pointsIndex] || ''}</td>`;
                        tableHtml += '</tr>';
                    });
                    
                    tableHtml += '</tbody></table>';
                    return tableHtml;
                };
                
                const atpTable = buildRankingsTable(atpRows);
                const wtaTable = buildRankingsTable(wtaRows);
                
                standingsContent.innerHTML = `
                    <div class="tennis-rankings">
                        <div class="tennis-rankings-tabs" style="display: flex; background-color: #2a2a2a; margin-bottom: 6px;">
                            <div class="tennis-rankings-tab active" data-tab="atp" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #fff; border-bottom: 2px solid #fff;">ATP</div>
                            <div class="tennis-rankings-tab" data-tab="wta" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #ccc;">WTA</div>
                        </div>
                        <div class="tennis-rankings-content" data-tab-content="atp">${atpTable}</div>
                        <div class="tennis-rankings-content" data-tab-content="wta" style="display: none;">${wtaTable}</div>
                    </div>
                `;
                
                const tennisTabs = standingsContent.querySelectorAll('.tennis-rankings-tab');
                const tennisContents = standingsContent.querySelectorAll('.tennis-rankings-content');
                
                tennisTabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const target = tab.dataset.tab;
                        
                        tennisTabs.forEach(t => {
                            t.classList.remove('active');
                            t.style.color = '#ccc';
                            t.style.borderBottom = 'none';
                        });
                        tab.classList.add('active');
                        tab.style.color = '#fff';
                        tab.style.borderBottom = '2px solid #fff';
                        
                        tennisContents.forEach(content => {
                            content.style.display = content.dataset.tabContent === target ? 'block' : 'none';
                        });
                    });
                });
                
                return;
            }
            
            if (!url || !url.startsWith('http')) {
                standingsContent.innerHTML = '<p>Standings not available.</p>';
                return;
            }
            const response = await fetch(url);
            if (!response.ok) throw new Error('Network response was not ok');
            const csvText = await response.text();
            const rows = csvText.split(/\r?\n/).map(row => row.split(',').map(cell => cell.trim().replace(/^"|"$/g, '')));
            if (rows.length < 2) {
                standingsContent.innerHTML = '<p>No standings data available.</p>';
                return;
            }
            
            if (leagueKey === 'UFC') {
                const menHtml = buildGroupedStandingsHtml(rows) || buildStandardStandingsTable(rows);
                let womenHtml = '<p style="color: #9ca3af;">Loading women\'s rankings...</p>';
                try {
                    const womenUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS2Z0QfXw34ib6V0gmcdqVvu6gwy8vHnD6cF3xMhJGZJHpU_s0vwC0h7phvbV0joe4tdVDGHiJ1kBfX/pub?gid=591530521&single=true&output=csv';
                    const womenRows = await fetchFromGoogleSheetsCSV(womenUrl);
                    womenHtml = buildGroupedStandingsHtml(womenRows) || buildStandardStandingsTable(womenRows);
                } catch (womenError) {
                    console.error('Error loading UFC women rankings:', womenError);
                    womenHtml = '<p style="color: #ef4444;">Error loading women\'s rankings.</p>';
                }
                standingsContent.innerHTML = `
                    <div class="ufc-subtabs" style="display: flex; background-color: #2a2a2a; margin-bottom: 6px;">
                        <div class="ufc-subtab active" data-ufc-tab="men" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #fff; border-bottom: 2px solid #fff;">Men's</div>
                        <div class="ufc-subtab" data-ufc-tab="women" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #ccc;">Women's</div>
                    </div>
                    <div class="ufc-subcontent" data-ufc-content="men">${menHtml}</div>
                    <div class="ufc-subcontent" data-ufc-content="women" style="display: none;">${womenHtml}</div>
                `;

                const subTabs = standingsContent.querySelectorAll('.ufc-subtab');
                const subContents = standingsContent.querySelectorAll('.ufc-subcontent');
                subTabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const target = tab.dataset.ufcTab;
                        subTabs.forEach(t => {
                            t.classList.remove('active');
                            t.style.color = '#ccc';
                            t.style.borderBottom = 'none';
                        });
                        tab.classList.add('active');
                        tab.style.color = '#fff';
                        tab.style.borderBottom = '2px solid #fff';

                        subContents.forEach(content => {
                            content.style.display = content.dataset.ufcContent === target ? 'block' : 'none';
                        });
                    });
                });

                return;
            }
            
            if (leagueKey === 'WNBA') {
                const teams = [];
                let currentConference = '';
                
                rows.forEach(row => {
                    if (row.length === 0) return;
                    const label = (row[0] || '').toLowerCase();
                    if (!label) return;
                    
                    if (label.includes('eastern conference')) {
                        currentConference = 'Eastern Conference';
                        return;
                    }
                    if (label.includes('western conference')) {
                        currentConference = 'Western Conference';
                        return;
                    }
                    if (label === 'rank' || label === 'team' || !currentConference) {
                        return;
                    }
                    const rank = row[0];
                    const teamName = row[1];
                    const wins = row[2];
                    const losses = row[3];
                    if (!rank || !teamName) return;
                    teams.push({
                        Rank: rank,
                        Team: teamName,
                        Wins: wins || '0',
                        Losses: losses || '0',
                        Conference: currentConference
                    });
                });
                
                standingsContent.innerHTML = createWNBAStandings(teams);
                return;
            }
            
            if (leagueKey === 'Boxing') {
                const menHtml = buildGroupedStandingsHtml(rows) || buildStandardStandingsTable(rows);
                let womenHtml = '<p style="color: #9ca3af;">Loading women\'s rankings...</p>';
                try {
                    // Try to fetch women's data from Firestore first
                    const collectionName = collectionMap[leagueKey] || 'standings';
                    const womenDataDoc = await db.collection(collectionName).doc('data-women').get();
                    if (womenDataDoc.exists) {
                        const womenCsvData = womenDataDoc.data();
                        if (womenCsvData.headers && womenCsvData.rows) {
                            // Convert row objects back to arrays (Firestore doesn't allow nested arrays)
                            const convertedWomenRows = womenCsvData.rows.map(rowObj => {
                                const numKeys = Object.keys(rowObj).map(k => parseInt(k)).sort((a, b) => a - b);
                                return numKeys.map(key => rowObj[key.toString()] || '');
                            });
                            const womenRows = [womenCsvData.headers, ...convertedWomenRows];
                            womenHtml = buildGroupedStandingsHtml(womenRows) || buildStandardStandingsTable(womenRows);
                        } else {
                            throw new Error('Invalid women\'s data format in Firestore');
                        }
                    } else {
                        // Fallback to Google Sheets if not in Firestore
                        const womenUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRthmvN_N-bKFQdsc5V_Otx92FF5qwjYkI9YXHoKgKyV5jvfmb6skABo0Ncbh1x0ehEU-4Je3w_KPmb/pub?gid=0&single=true&output=csv';
                        const womenRows = await fetchFromGoogleSheetsCSV(womenUrl);
                        womenHtml = buildGroupedStandingsHtml(womenRows) || buildStandardStandingsTable(womenRows);
                    }
                } catch (womenError) {
                    console.error('Error loading Boxing women rankings:', womenError);
                    womenHtml = '<p style="color: #ef4444;">Error loading women\'s rankings.</p>';
                }
                standingsContent.innerHTML = `
                    <div class="boxing-subtabs" style="display: flex; background-color: #2a2a2a; margin-bottom: 6px;">
                        <div class="boxing-subtab active" data-boxing-tab="men" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #fff; border-bottom: 2px solid #fff;">Men's</div>
                        <div class="boxing-subtab" data-boxing-tab="women" style="flex: 1; text-align: center; font-size: 10px; line-height: 18px; cursor: pointer; color: #ccc;">Women's</div>
                    </div>
                    <div class="boxing-subcontent" data-boxing-content="men">${menHtml}</div>
                    <div class="boxing-subcontent" data-boxing-content="women" style="display: none;">${womenHtml}</div>
                `;

                const subTabs = standingsContent.querySelectorAll('.boxing-subtab');
                const subContents = standingsContent.querySelectorAll('.boxing-subcontent');
                subTabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const target = tab.dataset.boxingTab;
                        subTabs.forEach(t => {
                            t.classList.remove('active');
                            t.style.color = '#ccc';
                            t.style.borderBottom = 'none';
                        });
                        tab.classList.add('active');
                        tab.style.color = '#fff';
                        tab.style.borderBottom = '2px solid #fff';

                        subContents.forEach(content => {
                            content.style.display = content.dataset.boxingContent === target ? 'block' : 'none';
                        });
                    });
                });

                return;
            }
            
            // Special handling for UFC/Boxing - group by classification (detect from URL)
            const isUFC = url.includes('2PACX-1vS2Z0QfXw34ib6V0gmcdqVvu6gwy8vHnD6cF3xMhJGZJHpU_s0vwC0h7phvbV0joe4tdVDGHiJ1kBfX');
            const isBoxing = url.includes('2PACX-1vRthmvN_N-bKFQdsc5V_Otx92FF5qwjYkI9YXHoKgKyV5jvfmb6skABo0Ncbh1x0ehEU-4Je3w_KPmb');
            if (isUFC || isBoxing) {
                const groupedHtml = buildGroupedStandingsHtml(rows);
                if (groupedHtml) {
                    standingsContent.innerHTML = groupedHtml;
                    return;
                }
            }
            
            // Default table display for other leagues
            standingsContent.innerHTML = buildStandardStandingsTable(rows);
        } catch (error) { standingsContent.innerHTML = `<p style="color: #ef4444;">Error loading standings.</p>`; }
    }
    
// Cache for featured games
let featuredGamesCache = {
    data: [],
    timestamp: 0,
    date: null
};

async function fetchFeaturedGames() {
    try {
        const { DateTime } = luxon;
        const todayStr = DateTime.now().setZone('America/New_York').toISODate();
        
        // fetchFeaturedGamesForDate already handles MLB matching and live data merging
        return await fetchFeaturedGamesForDate(todayStr);
    } catch (error) {
        console.error('Error fetching featured games:', error);
        return [];
    }
}
    async function fetchFeaturedGamesForDate(dateStr) {
        try {
            const db = firebase.firestore();
            const featuredRef = db.collection("artifacts/flashlive-daily-scraper/public/data/Featured");
            
            // Query only featured games for the specific date
            const snapshot = await featuredRef.where('gameDate', '==', dateStr).get();
            
            if (snapshot.empty) {
                return [];
            }
            
            const featuredGamesForDate = snapshot.docs.map(doc => doc.data());
            
            // Now fetch the LIVE data for these game IDs from sportsGames or yesterdayScores
            const { DateTime } = luxon;
            const todayStr = DateTime.now().setZone('America/New_York').toISODate();
            const isToday = dateStr === todayStr;
            
            const collectionName = isToday 
                ? 'artifacts/flashlive-daily-scraper/public/data/sportsGames'
                : 'artifacts/flashlive-daily-scraper/public/data/yesterdayScores';
            
            const gamesRef = db.collection(collectionName);
            
            // Separate MLB games from other games - check multiple possible Sport field values
            const mlbFeaturedGames = featuredGamesForDate.filter(game => 
                game.Sport === 'Baseball' || 
                game.Sport === 'MLB' || 
                game.Sport === 'baseball' ||
                game.Sport === 'mlb' ||
                (game.League && game.League.toLowerCase().includes('mlb')) ||
                (game.League && game.League.toLowerCase().includes('baseball'))
            );
            const nonMlbFeaturedGames = featuredGamesForDate.filter(game => 
                game.Sport !== 'Baseball' && 
                game.Sport !== 'MLB' && 
                game.Sport !== 'baseball' &&
                game.Sport !== 'mlb' &&
                !(game.League && game.League.toLowerCase().includes('mlb')) &&
                !(game.League && game.League.toLowerCase().includes('baseball'))
            );
            
            // Only fetch MLB games from the collection if we have MLB featured games
            let mlbGamesFromCollection = [];
            if (mlbFeaturedGames.length > 0) {
                // Try multiple possible Sport field values
                const possibleSportValues = ['Baseball', 'MLB', 'baseball', 'mlb'];
                for (const sportValue of possibleSportValues) {
                    const mlbSnapshot = await gamesRef.where('Sport', '==', sportValue).get();
                    if (!mlbSnapshot.empty) {
                        mlbGamesFromCollection = mlbSnapshot.docs.map(doc => doc.data());
                        break;
                    }
                }
            }
            
            let liveFeaturedGames = [];
            
            // Create a map of game IDs to their title, yesterdayTitle, and order from Featured collection
            const gameIdToTitleMap = {};
            const gameIdToYesterdayTitleMap = {};
            const gameIdToOrderMap = {};
            featuredGamesForDate.forEach(game => {
                if (game['Game ID']) {
                    if (game.title) {
                        gameIdToTitleMap[game['Game ID']] = game.title;
                    }
                    if (game.yesterdayTitle) {
                        gameIdToYesterdayTitleMap[game['Game ID']] = game.yesterdayTitle;
                    }
                    if (game.order !== undefined) {
                        gameIdToOrderMap[game['Game ID']] = game.order;
                    }
                }
            });
            
            // Handle non-MLB games by Game ID matching
            const nonMlbGameIds = nonMlbFeaturedGames.map(g => g['Game ID']);
            if (nonMlbGameIds.length > 0) {
                if (nonMlbGameIds.length <= 10) {
                    const gamesSnapshot = await gamesRef.where('Game ID', 'in', nonMlbGameIds).get();
                    liveFeaturedGames = gamesSnapshot.docs.map(doc => {
                        const gameData = doc.data();
                        const featuredGame = nonMlbFeaturedGames.find(fg => fg['Game ID'] === gameData['Game ID']);
                        // Add title, yesterdayTitle, order, and channel from Featured collection
                        gameData.title = gameIdToTitleMap[gameData['Game ID']] || '';
                        gameData.yesterdayTitle = gameIdToYesterdayTitleMap[gameData['Game ID']] || '';
                        gameData.order = gameIdToOrderMap[gameData['Game ID']];
                        // Preserve channel from featuredGame if liveGame doesn't have one (for manual games)
                        if (featuredGame && (!gameData.channel && !gameData.Channel)) {
                            gameData.channel = featuredGame.channel || featuredGame.Channel || '';
                            gameData.Channel = featuredGame.channel || featuredGame.Channel || '';
                        }
                        return gameData;
                    });
                } else {
                    // Batch queries if more than 10 game IDs
                    for (let i = 0; i < nonMlbGameIds.length; i += 10) {
                        const batch = nonMlbGameIds.slice(i, i + 10);
                        const gamesSnapshot = await gamesRef.where('Game ID', 'in', batch).get();
                        const batchGames = gamesSnapshot.docs.map(doc => {
                            const gameData = doc.data();
                            const featuredGame = nonMlbFeaturedGames.find(fg => fg['Game ID'] === gameData['Game ID']);
                            // Add title, yesterdayTitle, order, and channel from Featured collection
                            gameData.title = gameIdToTitleMap[gameData['Game ID']] || '';
                            gameData.yesterdayTitle = gameIdToYesterdayTitleMap[gameData['Game ID']] || '';
                            gameData.order = gameIdToOrderMap[gameData['Game ID']];
                            // Preserve channel from featuredGame if liveGame doesn't have one (for manual games)
                            if (featuredGame && (!gameData.channel && !gameData.Channel)) {
                                gameData.channel = featuredGame.channel || featuredGame.Channel || '';
                                gameData.Channel = featuredGame.channel || featuredGame.Channel || '';
                            }
                            return gameData;
                        });
                        liveFeaturedGames = liveFeaturedGames.concat(batchGames);
                    }
                }
            }
            
            // Handle MLB games by fuzzy matching team names
            for (const featuredGame of mlbFeaturedGames) {
                const featuredHome = (featuredGame['Home Team'] || '').toLowerCase().trim();
                const featuredAway = (featuredGame['Away Team'] || '').toLowerCase().trim();
                
                // Find matching game in live data
                const matchingGame = mlbGamesFromCollection.find(game => {
                    const gameHome = (game['Home Team'] || '').toLowerCase().trim();
                    const gameAway = (game['Away Team'] || '').toLowerCase().trim();
                    
                    // Check if teams match (either home/away or away/home since order might differ)
                    return (gameHome === featuredHome && gameAway === featuredAway) ||
                           (gameHome === featuredAway && gameAway === featuredHome);
                });
                
                if (matchingGame) {
                    // Add title, yesterdayTitle, order, and channel from Featured collection
                    matchingGame.title = featuredGame.title || '';
                    matchingGame.yesterdayTitle = featuredGame.yesterdayTitle || '';
                    matchingGame.order = featuredGame.order;
                    // Preserve channel from featuredGame if liveGame doesn't have one (for manual games)
                    if (!matchingGame.channel && !matchingGame.Channel) {
                        matchingGame.channel = featuredGame.channel || featuredGame.Channel || '';
                        matchingGame.Channel = featuredGame.channel || featuredGame.Channel || '';
                    }
                    liveFeaturedGames.push(matchingGame);
                }
                // Only include featured games that have a matching live game
                // Do not include non-live featured games
            }
            
            // Sort by order field to preserve Google Sheets row order
            // Sort by order from Featured sheet (lower order first) - preserves Google Sheets row order
            liveFeaturedGames.sort((a, b) => {
                const orderA = (a && a.order !== undefined && a.order !== null) ? Number(a.order) : 999999;
                const orderB = (b && b.order !== undefined && b.order !== null) ? Number(b.order) : 999999;
                return orderA - orderB;
            });
            
            return liveFeaturedGames;
        } catch (error) {
            console.error(`Error fetching featured games for ${dateStr}:`, error);
            return [];
        }
    }

    
    // Track active tab globally - 'ALL' or 'LIVE'
    let activeTab = 'ALL';
    
    // TODAY tab lifecycle state (FSM-based, prevents midnight flip until games finish + 2 hours)
    let activeTodayDate = null; // The date currently shown in TODAY tab (YYYY-MM-DD)
    let holdTimer = null; // setTimeout reference for 2-hour hold
    let holdUntil = null; // Timestamp when hold expires (ms since epoch)
    let todaySlateUnsubscribe = null; // Firestore listener unsubscribe function
    
    // Get Firestore reference for TODAY latch state (lazy initialization)
    function getTodaySlateRef() {
        if (typeof db === 'undefined' || !db) {
            throw new Error('Firestore db not initialized');
        }
        return db.collection('system').doc('todaySlate');
    }
    
    // Initialize TODAY latch state from Firestore (shared state)
    async function initTodayLatch() {
        const { DateTime } = luxon;
        
        try {
            // Try to read from Firestore first (shared state)
            const todaySlateRef = getTodaySlateRef();
            const doc = await todaySlateRef.get();
            
            if (doc.exists) {
                const data = doc.data();
                activeTodayDate = data.activeTodayDate;
                holdUntil = data.holdUntil || null;
                
                console.log('📡 Loaded TODAY latch state from Firestore:', activeTodayDate);
                
                // If hold expired while page was closed, advance immediately
                if (holdUntil && Date.now() >= holdUntil) {
                    await advanceTodayDate();
                } else if (holdUntil) {
                    // Restore timer if still in hold period
                    const delay = holdUntil - Date.now();
                    if (delay > 0) {
                        holdTimer = setTimeout(() => {
                            advanceTodayDate();
                        }, delay);
                        console.log(`🔒 TODAY tab held until ${new Date(holdUntil).toLocaleString()}`);
                    }
                }
            } else {
                // No Firestore state - initialize with current date
                activeTodayDate = DateTime
                    .now()
                    .setZone('America/New_York')
                    .toISODate();
                
                // Write initial state to Firestore
                await persistTodayLatch();
                console.log('✨ Initialized TODAY latch state:', activeTodayDate);
            }
            
            // Set up real-time listener for TODAY latch state (syncs across all users/devices)
            todaySlateUnsubscribe = todaySlateRef.onSnapshot((doc) => {
                if (doc.exists) {
                    const data = doc.data();
                    const newActiveDate = data.activeTodayDate;
                    const newHoldUntil = data.holdUntil || null;
                    
                    // Only update if state changed (avoid infinite loops)
                    if (newActiveDate !== activeTodayDate || newHoldUntil !== holdUntil) {
                        console.log('🔄 TODAY latch state updated from Firestore:', newActiveDate);
                        
                        activeTodayDate = newActiveDate;
                        holdUntil = newHoldUntil;
                        
                        // Clear existing timer
                        if (holdTimer) {
                            clearTimeout(holdTimer);
                            holdTimer = null;
                        }
                        
                        // Restore timer if hold is active
                        if (holdUntil && Date.now() < holdUntil) {
                            const delay = holdUntil - Date.now();
                            holdTimer = setTimeout(() => {
                                advanceTodayDate();
                            }, delay);
                        } else if (holdUntil && Date.now() >= holdUntil) {
                            // Hold expired, advance immediately
                            advanceTodayDate();
                        }
                        
                        // Reload games if date changed
                        if (typeof fetchTodayGames === 'function') {
                            fetchTodayGames(() => {});
                        }
                    }
                }
            }, (error) => {
                console.error('❌ Error listening to TODAY latch state:', error);
            });
            
        } catch (error) {
            console.error('❌ Error initializing TODAY latch state:', error);
            // Fallback to localStorage if Firestore fails
            activeTodayDate = localStorage.getItem('activeTodayDate') || 
                DateTime.now().setZone('America/New_York').toISODate();
            holdUntil = Number(localStorage.getItem('holdUntil')) || null;
        }
    }
    
    // Persist TODAY latch state to Firestore (shared state)
    async function persistTodayLatch() {
        try {
            const todaySlateRef = getTodaySlateRef();
            await todaySlateRef.set({
                activeTodayDate: activeTodayDate,
                holdUntil: holdUntil || null,
                lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
            }, { merge: true });
            
            // Also backup to localStorage as fallback
            localStorage.setItem('activeTodayDate', activeTodayDate);
            if (holdUntil) {
                localStorage.setItem('holdUntil', holdUntil);
            } else {
                localStorage.removeItem('holdUntil');
            }
        } catch (error) {
            console.error('❌ Error persisting TODAY latch state:', error);
            // Fallback to localStorage only
            localStorage.setItem('activeTodayDate', activeTodayDate);
            if (holdUntil) {
                localStorage.setItem('holdUntil', holdUntil);
            } else {
                localStorage.removeItem('holdUntil');
            }
        }
    }
    
    // Initialize on page load
    initTodayLatch();
    
    // Advance TODAY date by 1 day (FSM transition: ROTATE)
    async function advanceTodayDate() {
        console.log('🔄 Advancing TODAY tab to next day...');
        
        const { DateTime } = luxon;
        
        // Advance activeTodayDate by 1 day (don't use current date!)
        activeTodayDate = DateTime
            .fromISO(activeTodayDate, { zone: 'America/New_York' })
            .plus({ days: 1 })
            .toISODate();
        
        console.log('📅 TODAY tab now showing:', activeTodayDate);
        
        // Clear hold state
        holdUntil = null;
        if (holdTimer) {
            clearTimeout(holdTimer);
            holdTimer = null;
        }
        
        await persistTodayLatch();
        
        // Reload TODAY games with new date
        if (typeof fetchTodayGames === 'function') {
            fetchTodayGames(() => {
                // updateDisplay will be called by Firestore listeners
            });
        }
    }
    
    // FSM logic: Handle TODAY tab state transitions based on game status
    async function handleTodayFSM(games) {
        if (!games || games.length === 0) return;
        
        // Check if all games are FINAL
        const allFinal = games.every(game => {
            const status = (game['Match Status'] || '').toUpperCase();
            return status.includes('FINAL') ||
                   status.includes('FINISHED') ||
                   status.includes('GAME OVER');
        });
        
        // ─── STATE: TODAY_ACTIVE ─────────────────────────
        // At least one game is not FINAL - clear any hold timer
        if (!allFinal) {
            if (holdTimer) {
                clearTimeout(holdTimer);
                holdTimer = null;
                holdUntil = null;
                await persistTodayLatch();
                console.log('🔄 Active games detected, clearing hold');
            }
            return;
        }
        
        // ─── STATE: TODAY_HOLDING ───────────────────────
        // All games are FINAL - start 2-hour hold timer if not already started
        if (!holdTimer) {
            holdUntil = Date.now() + (2 * 60 * 60 * 1000); // 2 hours from now
            
            holdTimer = setTimeout(() => {
                advanceTodayDate();
            }, holdUntil - Date.now());
            
            await persistTodayLatch();
            console.log(`✅ All games finished! Starting 2-hour hold until ${new Date(holdUntil).toLocaleString()}`);
        }
    }
    
    async function fetchTodayGames(callback) {
        // Load Top 25 rankings cache for all NCAA leagues (for home page games display)
        // Wait for all caches to load before rendering games
        await Promise.all([
            loadTop25RankingsCache('NCAAF'),
            loadTop25RankingsCache('NCAAM'),
            loadTop25RankingsCache('NCAAW'),
            loadCFPRankingsCache()
        ]);
        
        const todayContainer = document.getElementById('games');
        const errorDiv = document.getElementById('error');
        if (!todayContainer || !errorDiv) return () => {};

        errorDiv.textContent = "";
        const { DateTime } = luxon;
        
        // Use activeTodayDate (which may be held from previous day) instead of current calendar date
        const todayStr = activeTodayDate; // Use the active date (may be held from yesterday)

        let regularGames = [];
        let featuredGames = [];
        let updateDisplayRef = null; // Store reference to updateDisplay so it can be called from outside
        
        // Set up real-time listener for regular games
        const regularGamesUnsubscribe = gamesCollectionRef.where('gameDate', '==', todayStr)
            .onSnapshot(snapshot => {
                const previousCount = regularGames.length;
                regularGames = snapshot.empty ? [] : snapshot.docs.map(doc => doc.data()).sort(sortGames);
                const newCount = regularGames.length;
                console.log(`🔄 [Firestore Listener] Regular games updated: ${previousCount} → ${newCount} games`);
                if (snapshot.docChanges && snapshot.docChanges().length > 0) {
                    snapshot.docChanges().forEach(change => {
                        const game = change.doc.data();
                        console.log(`  📝 ${change.type}: ${game['Away Team']} vs ${game['Home Team']} (${game['Match Status'] || 'No status'})`);
                    });
                }
                updateDisplay();
            }, err => {
                console.error("❌ Error fetching regular games: ", err);
                errorDiv.textContent = "Failed to load real-time data.";
            });

        // Store featured games data and live games data separately
        let featuredGamesData = [];
        let liveGamesData = [];
        
        // Helper function to merge featured games with live data
        function mergeFeaturedWithLive() {
            if (featuredGamesData.length === 0) {
                featuredGames = [];
                updateDisplay();
                return;
            }
            
            console.log(`[Featured Games] Merging ${featuredGamesData.length} featured games with ${liveGamesData.length} live games`);
            
            const mergedFeaturedGames = featuredGamesData.map(featuredGame => {
                const featuredGameId = String(featuredGame['Game ID'] || '').trim();
                console.log(`[Featured Games] Processing featured game: GameID="${featuredGameId}", Teams="${featuredGame['Away Team']} vs ${featuredGame['Home Team']}", League="${featuredGame.League}"`);
                // For MLB games, match by team names since Game IDs are different
                if (featuredGame.Sport === 'Baseball' || featuredGame.Sport === 'MLB' || 
                    featuredGame.League === 'MLB' || (featuredGame.League && featuredGame.League.toLowerCase().includes('mlb'))) {
                    const liveGame = liveGamesData.find(live => {
                        const featuredHome = String(featuredGame['Home Team'] || '').toLowerCase().trim();
                        const featuredAway = String(featuredGame['Away Team'] || '').toLowerCase().trim();
                        const liveHome = String(live['Home Team'] || '').toLowerCase().trim();
                        const liveAway = String(live['Away Team'] || '').toLowerCase().trim();
                        
                        // Also check Sport field for MLB
                        const isMLB = live.Sport === 'Baseball' || live.Sport === 'MLB' || 
                                     live.League === 'MLB' || (live.League && live.League.toLowerCase().includes('mlb'));
                        
                        return isMLB && ((liveHome === featuredHome && liveAway === featuredAway) ||
                                         (liveHome === featuredAway && liveAway === featuredHome));
                    });
                    
                    if (liveGame) {
                        console.log(`[Featured Games] ✅ MLB match found: "${liveGame['Away Team']} vs ${liveGame['Home Team']}"`);
                        const matchStatus = (liveGame['Match Status'] || '').toUpperCase();
                        const isLive = matchStatus.includes('IN PROGRESS') || matchStatus.includes('LIVE');
                        const isFinal = matchStatus.includes('FINISHED') || matchStatus.includes('FINAL') || matchStatus.includes('GAME OVER');

                        // Preserve channel from featuredGame if liveGame doesn't have one (for manual games)
                        const channel = (liveGame.channel || liveGame.Channel) ? (liveGame.channel || liveGame.Channel) : (featuredGame.channel || featuredGame.Channel || '');

                        return {
                            ...liveGame,
                            channel: channel,
                            Channel: channel,
                            title: featuredGame.title || liveGame.title || '',
                            yesterdayTitle: featuredGame.yesterdayTitle || liveGame.yesterdayTitle || '',
                            order: featuredGame.order,
                            isFeatured: true,
                            isFeaturedLive: isLive && !isFinal
                        };
                    } else {
                        console.log(`[Featured Games] ⚠️ No MLB match found for "${featuredGame['Away Team']} vs ${featuredGame['Home Team']}"`);
                    }
                } else {
                    // For non-MLB games, match by Game ID first (most reliable), then by team names + league
                    const liveGame = liveGamesData.find(live => {
                        // Primary match: Game ID (case-insensitive, trimmed)
                        const liveGameId = String(live['Game ID'] || '').trim();
                        const featuredGameId = String(featuredGame['Game ID'] || '').trim();
                        if (liveGameId && featuredGameId && liveGameId === featuredGameId) {
                            return true;
                        }
                        
                        // Secondary match: Team names + League (case-insensitive, trimmed)
                        const liveHome = String(live['Home Team'] || '').toLowerCase().trim();
                        const liveAway = String(live['Away Team'] || '').toLowerCase().trim();
                        const liveLeague = String(live.League || '').toLowerCase().trim();
                        
                        const featuredHome = String(featuredGame['Home Team'] || '').toLowerCase().trim();
                        const featuredAway = String(featuredGame['Away Team'] || '').toLowerCase().trim();
                        const featuredLeague = String(featuredGame.League || '').toLowerCase().trim();
                        
                        // Match if teams and league match (either home/away or away/home order)
                        return liveLeague === featuredLeague && 
                               ((liveHome === featuredHome && liveAway === featuredAway) ||
                                (liveHome === featuredAway && liveAway === featuredHome));
                    });
                    
                    if (liveGame) {
                        console.log(`[Featured Games] ✅ Match found: GameID="${liveGame['Game ID']}", Teams="${liveGame['Away Team']} vs ${liveGame['Home Team']}"`);
                        const matchStatus = (liveGame['Match Status'] || '').toUpperCase();
                        const isLive = matchStatus.includes('IN PROGRESS') || matchStatus.includes('LIVE');
                        const isFinal = matchStatus.includes('FINISHED') || matchStatus.includes('FINAL') || matchStatus.includes('GAME OVER');

                        // Preserve channel from featuredGame if liveGame doesn't have one (for manual games)
                        const channel = (liveGame.channel || liveGame.Channel) ? (liveGame.channel || liveGame.Channel) : (featuredGame.channel || featuredGame.Channel || '');

                        return {
                            ...liveGame,
                            channel: channel,
                            Channel: channel,
                            title: featuredGame.title || liveGame.title || '',
                            yesterdayTitle: featuredGame.yesterdayTitle || liveGame.yesterdayTitle || '',
                            order: featuredGame.order,
                            isFeatured: true,
                            isFeaturedLive: isLive && !isFinal
                        };
                    } else {
                        console.log(`[Featured Games] ⚠️ No match found for GameID="${featuredGameId}", will use featured data`);
                    }
                }
                
                // No live match found - fall back to featured data (scheduled or final)
                // This ensures featured games still display even if not yet in sportsGames
                const matchStatus = (featuredGame['Match Status'] || '').toUpperCase();
                const isLive = matchStatus.includes('IN PROGRESS') || matchStatus.includes('LIVE');
                const isFinal = matchStatus.includes('FINISHED') || matchStatus.includes('FINAL') || matchStatus.includes('GAME OVER');

                // Preserve channel from featuredGame (for manual games)
                const channel = featuredGame.channel || featuredGame.Channel || '';

                return {
                    ...featuredGame,
                    channel: channel,
                    Channel: channel,
                    title: featuredGame.title || featuredGame.GameTitle || '',
                    yesterdayTitle: featuredGame.yesterdayTitle || featuredGame.GameYesterdayTitle || '',
                    order: featuredGame.order,
                    isFeatured: true,
                    isFeaturedLive: isLive && !isFinal
                };
            }).filter(game => game !== null);

            // Sort by order from Featured sheet (lower order first) - preserves Google Sheets row order
            mergedFeaturedGames.sort((a, b) => {
                const orderA = (a && a.order !== undefined && a.order !== null) ? Number(a.order) : 999999;
                const orderB = (b && b.order !== undefined && b.order !== null) ? Number(b.order) : 999999;
                return orderA - orderB;
            });

            featuredGames = mergedFeaturedGames;
            updateDisplay();
        }
        
        // Set up real-time listener for Featured games
        const featuredRef = firebase.firestore().collection("artifacts/flashlive-daily-scraper/public/data/Featured");
        const featuredGamesUnsubscribe = featuredRef.where('gameDate', '==', todayStr)
            .onSnapshot(snapshot => {
                if (snapshot.empty) {
                    featuredGamesData = [];
                    mergeFeaturedWithLive();
                    return;
                }
                
                featuredGamesData = snapshot.docs.map(doc => {
                    const data = doc.data() || {};
                    if (data.order !== undefined && data.order !== null) {
                        data.order = Number(data.order);
                    }
                    // Ensure channel is preserved (sync channel and Channel fields)
                    const channel = data.channel || data.Channel || '';
                    if (channel) {
                        data.channel = channel;
                        data.Channel = channel;
                    }
                    return data;
                }).sort((a, b) => {
                    const orderA = (a && a.order !== undefined) ? a.order : 999;
                    const orderB = (b && b.order !== undefined) ? b.order : 999;
                    return orderA - orderB;
                });
                mergeFeaturedWithLive();
            }, err => { 
                console.error("Error fetching featured games: ", err);
            });
        
        // Set up real-time listener for live games (sportsGames collection)
        const gamesRef = firebase.firestore().collection("artifacts/flashlive-daily-scraper/public/data/sportsGames");
        const liveGamesUnsubscribe = gamesRef.where('gameDate', '==', todayStr)
            .onSnapshot(snapshot => {
                const previousCount = liveGamesData.length;
                liveGamesData = snapshot.empty ? [] : snapshot.docs.map(doc => doc.data());
                const newCount = liveGamesData.length;
                console.log(`🔄 [Firestore Listener] Live games updated: ${previousCount} → ${newCount} games`);
                if (snapshot.docChanges && snapshot.docChanges().length > 0) {
                    snapshot.docChanges().forEach(change => {
                        const game = change.doc.data();
                        console.log(`  📝 ${change.type}: ${game['Away Team']} vs ${game['Home Team']} (${game['Match Status'] || 'No status'})`);
                    });
                }
                mergeFeaturedWithLive();
            }, err => {
                console.error("❌ Error fetching live games for featured: ", err);
            });

        function updateDisplay() {
            // CRITICAL: Check LIVE filter state directly AND activeTab variable
            // Use the most authoritative source - LIVE filter DOM state takes precedence
            const liveFilterElement = document.getElementById('live-filter-toggle');
            const isLiveFilterActive = liveFilterElement && liveFilterElement.classList.contains('active');
            // If LIVE filter is active in DOM, use 'LIVE', otherwise use activeTab variable (defaults to 'ALL')
            const currentActiveTab = isLiveFilterActive ? 'LIVE' : (activeTab || 'ALL');
            
            // Ensure activeTab variable stays in sync with DOM state
            if (isLiveFilterActive && activeTab !== 'LIVE') {
                activeTab = 'LIVE';
            } else if (!isLiveFilterActive && activeTab === 'LIVE') {
                activeTab = 'ALL';
            }
            
            // Diagnostic logging to confirm data state
            const nonLiveRegular = regularGames.filter(g => {
                const s = (g["Match Status"] || "").toUpperCase();
                return !s.includes("IN PROGRESS") && !s.includes("LIVE");
            }).length;
            const nonLiveFeatured = featuredGames.filter(g => {
                const s = (g["Match Status"] || "").toUpperCase();
                return !s.includes("IN PROGRESS") && !s.includes("LIVE");
            }).length;
            
            console.log(
                '[updateDisplay] TAB:', currentActiveTab,
                '| activeTab var:', activeTab,
                '| LIVE filter active:', isLiveFilterActive,
                '| regular:', regularGames.length,
                '| featured:', featuredGames.length,
                '| non-live regular:', nonLiveRegular,
                '| non-live featured:', nonLiveFeatured
            );
            
            // Prevent rendering when data arrays are empty (prevents empty wipe)
            if (!regularGames.length && !featuredGames.length) {
                return;
            }
            
            let gamesToRender = [];
            
            // In Live tab, exclude featured games entirely
            if (currentActiveTab === 'LIVE') {
                // Only show regular games (no featured section)
                gamesToRender = [...regularGames];
            } else {
                // In ALL tab, show both featured and regular games
                gamesToRender = [...featuredGames, ...regularGames];
            }
            
            // Exclude old "Asia: AFC Elite" games from Google Sheets (source is not ESPN_LIVE) and any unmapped "AFC Champions League" games
            gamesToRender = gamesToRender.filter(game => {
                // Only exclude if it's an old Google Sheets game (no source or source is not ESPN_LIVE)
                if (game.League === "Asia: AFC Elite" && game.source !== "ESPN_LIVE") {
                    return false;
                }
                // Exclude unmapped "AFC Champions League" games (shouldn't exist if mapping works)
                if (game.League === "AFC Champions League") {
                    return false;
                }
                return true;
            });
            
            // Filter at DATA level BEFORE rendering - this is the key fix
            if (currentActiveTab === 'LIVE') {
                gamesToRender = gamesToRender.filter(game => {
                    const matchStatus = (game["Match Status"] || game.matchStatus || game["matchStatus"] || "").toUpperCase().trim();
                    // Only include live/in-progress games
                    return matchStatus.includes("IN PROGRESS") || 
                           matchStatus.includes("IN_PROGRESS") ||
                           matchStatus.includes("LIVE");
                });
            }
            
            renderGames(todayContainer, gamesToRender, true);
            
            // ─────────────────────────────────────────────
            // 🧠 FSM LOGIC — Handle TODAY tab state transitions
            // ─────────────────────────────────────────────
            const allGames = [...regularGames, ...featuredGames];
            // Fire-and-forget: FSM updates state asynchronously
            handleTodayFSM(allGames).catch(err => {
                console.error('Error in FSM logic:', err);
            });
            
            if (callback) {
                callback();
            }
        }
        
        // Store reference so it can be called when Live filter is toggled
        updateDisplayRef = updateDisplay;

        // Return cleanup function and updateDisplay reference
        const cleanup = () => {
            regularGamesUnsubscribe();
            featuredGamesUnsubscribe();
            liveGamesUnsubscribe();
        };
        
        // Attach updateDisplay to window so Live filter can call it
        window.triggerGamesUpdate = updateDisplay;
        
        // Attach manual refresh function for debugging
        window.manualRefreshGames = async () => {
            console.log('🔄 Manual refresh triggered...');
            const { DateTime } = luxon;
            const todayStr = DateTime.now().setZone('America/New_York').toISODate();
            console.log(`📅 Today's date string: ${todayStr}`);
            
            // Force re-fetch from Firestore
            try {
                const snapshot = await gamesCollectionRef.where('gameDate', '==', todayStr).get();
                console.log(`📊 Found ${snapshot.size} games in Firestore for today`);
                if (snapshot.size > 0) {
                    const sampleGame = snapshot.docs[0].data();
                    console.log(`📝 Sample game: ${sampleGame['Away Team']} vs ${sampleGame['Home Team']} - Status: ${sampleGame['Match Status']}`);
                }
            } catch (err) {
                console.error('❌ Error during manual refresh:', err);
            }
            
            // Trigger updateDisplay
            if (updateDisplayRef) {
                updateDisplayRef();
            }
        };
        
        return cleanup;
    }

    // Cache for yesterday's scores to improve performance (valid until next prep-yesterday run at 3:55 AM ET)
    let yesterdayScoresCache = null;            // Combined list used by SCORES tab rendering
    let yesterdayScoresRawCache = null;         // Raw docs list for league Yesterday tabs
    let yesterdayScoresCacheExpiry = null;      // Epoch ms when cache expires

    function getNextPrepExpiryTimestamp() {
        try {
            const { DateTime } = luxon;
            const nowNY = DateTime.now().setZone('America/New_York');
            let nextRun = nowNY.set({ hour: 3, minute: 55, second: 0, millisecond: 0 });
            if (nowNY >= nextRun) {
                nextRun = nextRun.plus({ days: 1 });
            }
            return nextRun.toMillis();
        } catch (e) {
            // Fallback: 24h
            return Date.now() + 24 * 60 * 60 * 1000;
        }
    }

    function fetchYesterdayScores() {
        const scoresContainer = document.getElementById('dynamicScoresContent');
        const scoresLoading = document.getElementById('scoresLoading');
        const scoresError = document.getElementById('scoresErrorMessage');
        const scoresErrorText = document.getElementById('scoresErrorText');

        if (!scoresContainer || !scoresLoading || !scoresError) return;

        // Check cache first
        const nowMs = Date.now();
        if (yesterdayScoresCache && yesterdayScoresCacheExpiry && nowMs < yesterdayScoresCacheExpiry) {
            renderYesterdayScores(yesterdayScoresCache);
            return;
        }

        scoresLoading.style.display = 'flex';
        scoresError.style.display = 'none';
        scoresContainer.innerHTML = '';

        // Read from sportsGames collection - filter for yesterday's FINAL games
        const sportsGamesRef = db.collection("artifacts/flashlive-daily-scraper/public/data/sportsGames");

        // Get yesterday's date (in Eastern Time to match gameDate storage)
        const { DateTime } = luxon;
        const now = DateTime.now().setZone('America/New_York');
        const yesterdayStr = now.minus({ days: 1 }).toISODate();

        // Query for yesterday's games that are FINAL
        console.log('[SCORES] Querying for yesterday\'s games. Date:', yesterdayStr);
        console.log('[SCORES] Current time (Mountain):', now.toISO());
        console.log('[SCORES] Yesterday date string:', yesterdayStr);
        sportsGamesRef.where('gameDate', '==', yesterdayStr).get()
            .then(async snapshot => {
            scoresLoading.style.display = 'none';
                
                console.log('[SCORES] Query result: found', snapshot.size, 'games for', yesterdayStr);
                
                if (snapshot.empty) {
                    console.log('[SCORES] No games found for yesterday\'s date');
                    console.log('[SCORES] DEBUG: Checking if games exist with different dates...');
                    // Debug: Check what dates actually exist in the collection
                    const allGamesSnapshot = await sportsGamesRef.limit(100).get();
                    const dateCounts = {};
                    allGamesSnapshot.forEach(doc => {
                        const data = doc.data();
                        const gd = data.gameDate || 'NO_DATE';
                        dateCounts[gd] = (dateCounts[gd] || 0) + 1;
                    });
                    console.log('[SCORES] DEBUG: Sample of gameDate values in collection:', dateCounts);
                    scoresContainer.innerHTML = '<p style="padding: 10px;">No completed games found. Check back after games finish.</p>';
                    return;
                }
                
                const allGamesData = snapshot.docs.map(doc => doc.data());
                console.log('[SCORES] Total games found:', allGamesData.length);
                
                // Log match statuses for debugging
                const statusCounts = {};
                allGamesData.forEach(game => {
                    const status = game['Match Status'] || 'NO STATUS';
                    statusCounts[status] = (statusCounts[status] || 0) + 1;
                });
                console.log('[SCORES] Match status breakdown:', statusCounts);
                
                // Filter to only FINAL games (yesterday's completed games)
                // Explicitly exclude SCHEDULED, IN PROGRESS, and LIVE games
                const matchStatusFilter = (status, homeScore, awayScore) => {
                    const upperStatus = (status || '').toUpperCase();
                    
                    // Explicitly exclude SCHEDULED, IN PROGRESS, and LIVE games
                    if (upperStatus.includes('SCHEDULED') || upperStatus.includes('IN PROGRESS') || upperStatus.includes('LIVE')) {
                        return false;
                    }
                    
                    // Include FINAL, FINISHED, or GAME OVER games
                    if (upperStatus.includes('FINAL') || upperStatus.includes('FINISHED') || upperStatus.includes('GAME OVER')) {
                        return true;
                    }
                    
                    // Include games with scores (indicating they've been played) if not explicitly excluded above
                    const hasScores = (homeScore !== undefined && homeScore !== null && homeScore !== '') || 
                                     (awayScore !== undefined && awayScore !== null && awayScore !== '');
                    return hasScores;
                };
                
                const finalGamesData = allGamesData.filter(game => 
                    matchStatusFilter(game['Match Status'], game['Home Score'], game['Away Score'])
                );
                console.log('[SCORES] FINAL games after filtering:', finalGamesData.length);
                
                // Exclude old "Asia: AFC Elite" games from Google Sheets (source is not ESPN_LIVE) and any unmapped "AFC Champions League" games
                const filteredAllGamesData = finalGamesData.filter(game => {
                    // Only exclude if it's an old Google Sheets game (no source or source is not ESPN_LIVE)
                    if (game.League === "Asia: AFC Elite" && game.source !== "ESPN_LIVE") {
                        return false;
                    }
                    // Exclude unmapped "AFC Champions League" games (shouldn't exist if mapping works)
                    if (game.League === "AFC Champions League") {
                        return false;
                    }
                    return true;
                });
                console.log('[SCORES] FINAL games after league filtering:', filteredAllGamesData.length);
                
                // Keep a raw cache for league Yesterday tabs (filtered)
                yesterdayScoresRawCache = filteredAllGamesData;
                
                // Use the filtered FINAL games from yesterday
                let gamesData = filteredAllGamesData.sort(sortGames);
                
                // If no FINAL games found for yesterday, show message
                if (gamesData.length === 0) {
                    console.log('[SCORES] No FINAL games found after all filtering');
                    scoresContainer.innerHTML = '<p style="padding: 10px; color: #9ca3af;">No completed games found for yesterday.</p>';
                    return;
                }
                
                // Try to get featured games for the date we're using, but don't fail if it doesn't work
                let yesterdayFeaturedGames = [];
                try {
                    const dateToUse = gamesData.length > 0 ? gamesData[0].gameDate : yesterdayStr;
                    yesterdayFeaturedGames = await fetchFeaturedGamesForDate(dateToUse);
                    
                    // Mark yesterday's featured games
                    yesterdayFeaturedGames.forEach(game => {
                        game.isFeatured = true;
                    });
                } catch (error) {
                    console.error('Error fetching yesterday\'s featured games:', error);
                    // Continue without featured games if there's an error
                }
                // Combine games with yesterday's featured games first
                const allGames = [...yesterdayFeaturedGames, ...gamesData];
                
                // Cache the results until next 3:55 AM ET
                yesterdayScoresCache = allGames;
                yesterdayScoresCacheExpiry = getNextPrepExpiryTimestamp();
                
                renderYesterdayScores(allGames);
            })
            .catch(error => {
            scoresLoading.style.display = 'none';
            scoresError.style.display = 'block';
            if(scoresErrorText) scoresErrorText.textContent = "An error occurred while loading scores.";
            console.error("Error fetching yesterday's scores:", error);
        });
    }

    function renderYesterdayScores(gamesData) {
        const scoresContainer = document.getElementById('dynamicScoresContent');
        const scoresLoading = document.getElementById('scoresLoading');
        const scoresError = document.getElementById('scoresErrorMessage');
        
        if (!scoresContainer) return;
        
        scoresLoading.style.display = 'none';
        scoresError.style.display = 'none';
        
        renderGames(scoresContainer, gamesData, true, true);
    }
    
    
    // START OF CORRECTED SECTION
    // Store unsubscribe function for league-specific today games listener
    let leagueTodayGamesUnsubscribe = null;
    
    window.loadLeagueSpecificData = async function(leagueKey) {
        const leagueInfo = LEAGUE_DATA_CONFIG[leagueKey];
        if (!leagueInfo) return;
        if (leagueHeader) leagueHeader.innerText = leagueKey;
        
        // Clean up previous listener if exists
        if (leagueTodayGamesUnsubscribe) {
            leagueTodayGamesUnsubscribe();
            leagueTodayGamesUnsubscribe = null;
        }
        
        // Show/hide NCAA standings sub-tabs (CFP for NCAAF only, Top 25, Standings) for NCAAF, NCAAM, NCAAW
        const isNCALeague = ['NCAAF', 'NCAAM', 'NCAAW'].includes(leagueKey);
        const ncaaStandingsTabs = document.getElementById('ncaa-standings-tabs');
        const top25Content = document.getElementById('league-top25-content');
        const standingsContentOnly = document.getElementById('league-standings-content');
        const cfpContent = document.getElementById('league-cfp-content');
        const cfpTab = document.getElementById('ncaa-cfp-tab');
        
        if (ncaaStandingsTabs) {
            ncaaStandingsTabs.style.display = isNCALeague ? 'flex' : 'none';
        }
        
        // Show CFP tab only for NCAAF
        if (cfpTab) {
            if (leagueKey === 'NCAAF') {
                cfpTab.style.display = ''; // Remove display: none to make it a flex item
            } else {
                cfpTab.style.display = 'none';
            }
        }
        
        // Clear old Top 25 content when switching leagues
        if (top25Content) {
            top25Content.innerHTML = '<p style="color: #9ca3af;">Loading Top 25...</p>';
        }
        
        if (isNCALeague) {
            // Load Top 25 rankings cache for this league
            // Wait for cache to load before proceeding
            const cachePromises = [loadTop25RankingsCache(leagueKey)];
            if (leagueKey === 'NCAAF') {
                cachePromises.push(loadCFPRankingsCache());
            }
            await Promise.all(cachePromises);
            
            // Set CFP tab as active by default for NCAAF, Top 25 for others
            const top25Tab = ncaaStandingsTabs.querySelector('.ncaa-standings-tab[data-ncaa-standings-tab="top25"]');
            const standingsTab = ncaaStandingsTabs.querySelector('.ncaa-standings-tab[data-ncaa-standings-tab="standings"]');
            
            if (leagueKey === 'NCAAF' && cfpTab) {
                // For NCAAF, set CFP tab as active by default
                cfpTab.classList.add('active');
                cfpTab.style.color = '#fff';
                cfpTab.style.borderBottom = '2px solid #fff';
                if (top25Tab) {
                    top25Tab.classList.remove('active');
                    top25Tab.style.color = '#ccc';
                    top25Tab.style.borderBottom = 'none';
                }
                if (standingsTab) {
                    standingsTab.classList.remove('active');
                    standingsTab.style.color = '#ccc';
                    standingsTab.style.borderBottom = 'none';
                }
                // Show CFP content, hide other content
                if (cfpContent) {
                    cfpContent.style.display = 'block';
                    loadCFPData();
                }
                if (top25Content) top25Content.style.display = 'none';
                if (standingsContentOnly) standingsContentOnly.style.display = 'none';
            } else {
                // For NCAAM and NCAAW, set Top 25 tab as active by default
                if (top25Tab && standingsTab) {
                    top25Tab.classList.add('active');
                    top25Tab.style.color = '#fff';
                    top25Tab.style.borderBottom = '2px solid #fff';
                    standingsTab.classList.remove('active');
                    standingsTab.style.color = '#ccc';
                    standingsTab.style.borderBottom = 'none';
                }
                // Show Top 25 content, hide other content, and LOAD the data
                if (top25Content) {
                    top25Content.style.display = 'block';
                    loadTop25Data(leagueKey); // LOAD THE DATA!
                }
                if (standingsContentOnly) standingsContentOnly.style.display = 'none';
                if (cfpContent) cfpContent.style.display = 'none';
            }
        } else {
            // For non-NCAA leagues, show standings content only
            if (top25Content) top25Content.style.display = 'none';
            if (standingsContentOnly) standingsContentOnly.style.display = 'block';
            if (cfpContent) cfpContent.style.display = 'none';
        }
        
        // Hide yesterday content when loading new league
        const yesterdayContent = document.getElementById('league-schedule-yesterday-content');
        if (yesterdayContent) yesterdayContent.style.display = 'none';
        const todayScheduleContent = document.getElementById('league-schedule-today-content');
        const upcomingScheduleContent = document.getElementById('league-schedule-upcoming-content');
        const standingsContent = document.getElementById('league-standings-content');
        const scheduleTabsContainer = document.getElementById('schedule-tabs');
        const mainTabsContainer = document.getElementById('main-tabs');
        const scheduleTabContentEl = document.getElementById('schedule-tab-content');
        const standingsTabContentEl = document.getElementById('standings-tab-content');
        const statsTabContentEl = document.getElementById('stats-tab-content');

        function activateMainTab(tabName) {
            if (!mainTabsContainer) return;
            const scheduleMainTab = mainTabsContainer.querySelector('.main-tab[data-main-tab="schedule"]');
            const standingsMainTab = mainTabsContainer.querySelector('.main-tab[data-main-tab="standings"]');
            const statsMainTab = mainTabsContainer.querySelector('.main-tab[data-main-tab="stats"]');

            mainTabsContainer.querySelectorAll('.main-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.style.backgroundColor = '#2a2a2a';
                tab.style.color = '#ccc';
                tab.style.fontWeight = 'normal';
            });
            
            if (scheduleTabContentEl) scheduleTabContentEl.style.display = 'none';
            if (standingsTabContentEl) standingsTabContentEl.style.display = 'none';
            if (statsTabContentEl) statsTabContentEl.style.display = 'none';

            const setActiveStyles = (tab) => {
                tab.classList.add('active');
                tab.style.backgroundColor = '#fff';
                tab.style.color = '#000';
                tab.style.fontWeight = 'bold';
            };

            if (tabName === 'standings' && standingsMainTab && standingsMainTab.style.display !== 'none') {
                setActiveStyles(standingsMainTab);
                if (standingsTabContentEl) standingsTabContentEl.style.display = 'block';
            } else {
            if (scheduleMainTab) {
                    setActiveStyles(scheduleMainTab);
                }
                if (scheduleTabContentEl) scheduleTabContentEl.style.display = 'block';
            }
        }

        function handleNoTodayGames() {
            if (scheduleTabsContainer) {
                const todayScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab=\"today\"]');
                const upcomingScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab=\"upcoming\"]');
                if (todayScheduleTab) {
                    todayScheduleTab.classList.remove('active');
                    todayScheduleTab.style.backgroundColor = '#2a2a2a';
                    todayScheduleTab.style.color = '#ccc';
                    todayScheduleTab.style.borderBottom = 'none';
                }
                if (upcomingScheduleTab) {
                    upcomingScheduleTab.classList.add('active');
                    upcomingScheduleTab.style.backgroundColor = '#2a2a2a';
                    upcomingScheduleTab.style.color = '#fff';
                    upcomingScheduleTab.style.borderBottom = '2px solid #fff';
                }
            }
            if (todayScheduleContent) todayScheduleContent.style.display = 'none';
            if (upcomingScheduleContent) upcomingScheduleContent.style.display = 'block';
            activateMainTab('standings');
            
            // For NCAA leagues, load Top 25 data when switching to Standings tab
            const isNCALeague = ['NCAAF', 'NCAAM', 'NCAAW'].includes(leagueKey);
            if (isNCALeague && (leagueKey === 'NCAAM' || leagueKey === 'NCAAW')) {
                // Top 25 tab is already active by default for NCAAM/NCAAW, so load the data
                loadTop25Data(leagueKey);
            }
        }

        if (scheduleTabsContainer) {
            scheduleTabsContainer.style.display = 'flex';
        }

        if (mainTabsContainer) {
            const standingsMainTab = mainTabsContainer.querySelector('.main-tab[data-main-tab=\"standings\"]');
            const statsMainTab = mainTabsContainer.querySelector('.main-tab[data-main-tab=\"stats\"]');
            
            if (standingsMainTab) {
                if (leagueKey === 'FACup') {
                    standingsMainTab.style.display = 'none';
                    if (standingsTabContentEl) {
                        standingsTabContentEl.style.display = 'none';
                    }
                } else {
                    standingsMainTab.style.display = '';
                }
            }
            
            // Show stats tab for NBA and MLB
            if (statsMainTab) {
                if (leagueKey === 'NBA' || leagueKey === 'MLB') {
                    statsMainTab.style.display = '';
                } else {
                    statsMainTab.style.display = 'none';
                }
            }
        }

        activateMainTab('schedule');
        
        // Update stats category menu based on league
        updateStatsCategoryMenu(leagueKey);
        
        // Special handling for Soccer page - consolidated view
        if (leagueKey === 'Soccer') {
            activateMainTab('schedule');
            loadConsolidatedSoccerData();
            return;
        }
        
        // Special handling for Tennis - show ATP/WTA sub-tabs for Today tab
        const isTennis = leagueKey === 'Tennis';
        const tennisTodayTabs = document.getElementById('tennis-today-tabs');
        const tennisTodayAtpContent = document.getElementById('tennis-today-atp-content');
        const tennisTodayWtaContent = document.getElementById('tennis-today-wta-content');
        const todayDefaultContent = document.getElementById('league-schedule-today-default-content');
        
        if (isTennis && tennisTodayTabs && tennisTodayAtpContent && tennisTodayWtaContent) {
            tennisTodayTabs.style.display = 'flex';
            tennisTodayAtpContent.style.display = 'block';
            tennisTodayWtaContent.style.display = 'none';
            if (todayDefaultContent) {
                todayDefaultContent.style.display = 'none';
            }
            
            // Add click handlers for Today sub-tabs
            const atpTodayTab = tennisTodayTabs.querySelector('[data-tennis-today-tab="atp"]');
            const wtaTodayTab = tennisTodayTabs.querySelector('[data-tennis-today-tab="wta"]');
            
            if (atpTodayTab && wtaTodayTab) {
                // Remove existing listeners by cloning
                const newAtpTodayTab = atpTodayTab.cloneNode(true);
                const newWtaTodayTab = wtaTodayTab.cloneNode(true);
                atpTodayTab.parentNode.replaceChild(newAtpTodayTab, atpTodayTab);
                wtaTodayTab.parentNode.replaceChild(newWtaTodayTab, wtaTodayTab);
                
                newAtpTodayTab.addEventListener('click', () => {
                    newAtpTodayTab.classList.add('active');
                    newAtpTodayTab.style.color = '#fff';
                    newAtpTodayTab.style.borderBottom = '2px solid #fff';
                    newWtaTodayTab.classList.remove('active');
                    newWtaTodayTab.style.color = '#ccc';
                    newWtaTodayTab.style.borderBottom = 'none';
                    tennisTodayAtpContent.style.display = 'block';
                    tennisTodayWtaContent.style.display = 'none';
                });
                
                newWtaTodayTab.addEventListener('click', () => {
                    newWtaTodayTab.classList.add('active');
                    newWtaTodayTab.style.color = '#fff';
                    newWtaTodayTab.style.borderBottom = '2px solid #fff';
                    newAtpTodayTab.classList.remove('active');
                    newAtpTodayTab.style.color = '#ccc';
                    newAtpTodayTab.style.borderBottom = 'none';
                    tennisTodayWtaContent.style.display = 'block';
                    tennisTodayAtpContent.style.display = 'none';
                });
            }
        } else if (!isTennis) {
            // Hide Tennis sub-tabs for non-Tennis leagues
            if (tennisTodayTabs) tennisTodayTabs.style.display = 'none';
            if (tennisTodayAtpContent) tennisTodayAtpContent.style.display = 'none';
            if (tennisTodayWtaContent) tennisTodayWtaContent.style.display = 'none';
            if (todayDefaultContent) todayDefaultContent.style.display = 'block';
        }
        
        // Reset schedule sub-tabs (Today/Yesterday/Upcoming) - reset ALL tabs to inactive state
        if (scheduleTabsContainer) {
            const todayScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="today"]');
            // const yesterdayScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="yesterday"]'); // Commented out
            const upcomingScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="upcoming"]');
            
            // Reset ALL tabs to inactive state (both classes and inline styles)
            scheduleTabsContainer.querySelectorAll('.schedule-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.style.backgroundColor = '#2a2a2a';
                tab.style.color = '#ccc';
                tab.style.borderBottom = 'none';
            });
            
            // The existing logic in the data loading will determine which tab becomes active
            // based on whether there are games today or not
        }

        // Load TODAY schedule - use real-time listener for live score updates
        if (isTennis && tennisTodayAtpContent && tennisTodayWtaContent) {
            tennisTodayAtpContent.innerHTML = '<p style="color: #9ca3af;">Loading ATP schedule...</p>';
            tennisTodayWtaContent.innerHTML = '<p style="color: #9ca3af;">Loading WTA schedule...</p>';
        } else {
        todayScheduleContent.innerHTML = '<p style="color: #9ca3af;">Loading today\'s schedule...</p>';
        }
        const { DateTime } = luxon;
        const todayStr = DateTime.now().setZone('America/New_York').toISODate();
        
        // Set up real-time listener for today's games (similar to home page)
        const todayGamesQuery = gamesCollectionRef.where('gameDate', '==', todayStr);
        leagueTodayGamesUnsubscribe = todayGamesQuery.onSnapshot(snapshot => {
            try {
                if (leagueKey === 'FormulaOne') {
                    const allGames = snapshot.docs.map(doc => doc.data());
                    const formulaGames = allGames.filter(isFormulaOneGame);

                    if (formulaGames.length > 0) {
                        activateTodayScheduleTab();
                        todayScheduleContent.innerHTML = '';
                        const sortedFormulaGames = formulaGames.sort(sortGames);
                        renderGames(todayScheduleContent, sortedFormulaGames, false);
                        activateMainTab('schedule');
                    } else {
                    todayScheduleContent.innerHTML = `<p>No games found for today.</p>`;
                        handleNoTodayGames();
                    }
                    return;
                }

                if (snapshot.empty) {
                    // Try one-time fallback check for scheduledDate
                    gamesCollectionRef.where('scheduledDate', '==', todayStr).get().then(fallbackSnapshot => {
                        if (fallbackSnapshot.empty) {
                            if (isTennis && tennisTodayAtpContent && tennisTodayWtaContent) {
                                tennisTodayAtpContent.innerHTML = `<p>No ATP games found for today.</p>`;
                                tennisTodayWtaContent.innerHTML = `<p>No WTA games found for today.</p>`;
                            } else {
                                todayScheduleContent.innerHTML = `<p>No games found for today.</p>`;
                            }
                            handleNoTodayGames();
                        } else {
                            processGames(fallbackSnapshot);
                        }
                    }).catch(err => {
                        console.error('Error loading today\'s schedule (fallback):', err);
                        if (isTennis && tennisTodayAtpContent && tennisTodayWtaContent) {
                            tennisTodayAtpContent.innerHTML = '<p style="color: #ef4444;">Error loading ATP schedule.</p>';
                            tennisTodayWtaContent.innerHTML = '<p style="color: #ef4444;">Error loading WTA schedule.</p>';
                        } else {
                            todayScheduleContent.innerHTML = '<p style="color: #ef4444;">Error loading today\'s schedule.</p>';
                        }
                    });
                    return;
                }
                
                processGames(snapshot);
            } catch (error) {
                console.error('Error loading today\'s schedule:', error);
                if (isTennis && tennisTodayAtpContent && tennisTodayWtaContent) {
                    tennisTodayAtpContent.innerHTML = '<p style="color: #ef4444;">Error loading ATP schedule.</p>';
                    tennisTodayWtaContent.innerHTML = '<p style="color: #ef4444;">Error loading WTA schedule.</p>';
                } else {
                    todayScheduleContent.innerHTML = '<p style="color: #ef4444;">Error loading today\'s schedule.</p>';
                }
            }
        }, err => {
            console.error('Error loading today\'s schedule:', err);
            if (isTennis && tennisTodayAtpContent && tennisTodayWtaContent) {
                tennisTodayAtpContent.innerHTML = '<p style="color: #ef4444;">Error loading ATP schedule.</p>';
                tennisTodayWtaContent.innerHTML = '<p style="color: #ef4444;">Error loading WTA schedule.</p>';
            } else {
                todayScheduleContent.innerHTML = '<p style="color: #ef4444;">Error loading today\'s schedule.</p>';
            }
        });
        
        // Helper function to process and filter games
        function processGames(snapshot) {
                // Filter games by league using flexible matching
            const allGames = snapshot.docs.map(doc => doc.data());
                const gamesData = allGames.filter(game => {
                    const gameLeague = game.League || '';
                    
                    // First try exact match
                    if (gameLeague === leagueInfo.leagueId) {
                        return true;
                    }

                // Special handling for Formula One - match any league name that contains "Formula 1" or "Formula One"
                if (leagueKey === 'FormulaOne') {
                    const leagueNameLower = gameLeague.toLowerCase();
                    const sportLower = (game.Sport || '').toLowerCase();
                    if (leagueNameLower.includes('formula 1') || leagueNameLower.includes('formula one')) {
                        return true;
                    }
                    // FlashLive sometimes lists Formula 1 sessions under "Motorsport" with GP names
                    if (sportLower === 'motorsport' && leagueNameLower.includes('grand prix')) {
                        return true;
                    }
                }

                // Special handling for Tennis - match any league name that contains "ATP", "WTA", or "Davis Cup" and Sport is "Tennis"
                if (leagueKey === 'Tennis') {
                    const leagueNameLower = gameLeague.toLowerCase();
                    const sportLower = (game.Sport || '').toLowerCase();
                    if (sportLower === 'tennis' && (leagueNameLower.includes('atp') || leagueNameLower.includes('wta') || leagueNameLower.includes('davis cup'))) {
                        return true;
                    }
                    }
                    
                    // Then try flexible matching based on league key
                    const gameLeagueKey = getLeagueKeyFromDatabaseName(gameLeague);
                    const currentLeagueKey = getLeagueKeyFromDatabaseName(leagueInfo.leagueId);
                    
                    // If both have matching league keys, include the game
                    if (gameLeagueKey && currentLeagueKey && gameLeagueKey === currentLeagueKey) {
                        return true;
                    }
                    
                    // Fallback: check if the database league name contains the target league name
                    const targetLeagueName = leagueInfo.leagueId.toLowerCase();
                    const gameLeagueName = gameLeague.toLowerCase();
                    
                    // For UEFA Champions League, check for "champions league" in the name
                    if (targetLeagueName.includes('champions league') && gameLeagueName.includes('champions league')) {
                        return true;
                    }
                    // For other leagues, check for partial matches
                    if (gameLeagueName.includes(targetLeagueName) || targetLeagueName.includes(gameLeagueName)) {
                        return true;
                    }
                    
                    return false;
                });
                
            // For NCAAF, filter out hockey games
            // For NCAAF, filter out NCAAW games and only show American Football
            // For NCAAM, filter out NCAAW games (women's games)
            // For NCAA Baseball and NCAA Softball, filter out NCAAW games
            // For UEFA Champions League, filter out women's games
                const filteredGamesData = gamesData.filter(game => {
                const gameLeague = game.League || '';
                const gameSport = game.Sport || '';
                
                // Exclude NCAAW games (USA: NCAA Women with Basketball sport) from all NCAA leagues except NCAAW itself
                if (gameLeague === 'USA: NCAA Women' && gameSport === 'Basketball' && leagueKey !== 'NCAAW') {
                    return false;
                }
                
                if (leagueKey === 'NCAAF' && gameLeague === 'USA: NCAA') {
                    // Only show USA: NCAA with American Football sport
                    return gameSport === 'American Football';
                }
                if (leagueKey === 'NCAAM') {
                    // Exclude women's games - only show men's basketball
                    const leagueName = game.League || '';
                    if (leagueName.toLowerCase().includes('women') || leagueName.toLowerCase().includes('womens')) {
                        return false;
                    }
                    // Only show Basketball sport for NCAAM
                    return gameSport === 'Basketball';
                }
                if (leagueKey === 'NCAAW') {
                    // Only show women's games
                    const leagueName = game.League || '';
                    return (leagueName.toLowerCase().includes('women') || leagueName.toLowerCase().includes('womens')) && gameSport === 'Basketball';
                }
                if (leagueKey === 'NCAABaseball') {
                    // Exclude NCAAW games - only show Baseball sport
                    return gameSport === 'Baseball';
                }
                if (leagueKey === 'NCAASoftball') {
                    // Exclude NCAAW games - only show Softball sport
                    return gameSport === 'Softball';
                }
                if (leagueKey === 'UEFAChampionsLeague') {
                    // Exclude women's Champions League games
                    const leagueName = game.League || '';
                    return !leagueName.toLowerCase().includes('women') && !leagueName.toLowerCase().includes('womens');
                }
                return true;
            });

            if (filteredGamesData.length === 0) {
                if (isTennis && tennisTodayAtpContent && tennisTodayWtaContent) {
                    tennisTodayAtpContent.innerHTML = `<p>No ATP games found for today.</p>`;
                    tennisTodayWtaContent.innerHTML = `<p>No WTA games found for today.</p>`;
                } else {
                    todayScheduleContent.innerHTML = `<p>No games found for today.</p>`;
                }
                handleNoTodayGames();
                    return;
                }
                
                // If there ARE games today, activate Today tab with proper styling
                const todayScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="today"]');
                const upcomingScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="upcoming"]');
                if (todayScheduleTab) {
            todayScheduleTab.classList.add('active');
                    todayScheduleTab.style.backgroundColor = '#2a2a2a';
                    todayScheduleTab.style.color = '#fff';
                    todayScheduleTab.style.borderBottom = '2px solid #fff';
                }
                if (upcomingScheduleTab) {
            upcomingScheduleTab.classList.remove('active');
                    upcomingScheduleTab.style.backgroundColor = '#2a2a2a';
                    upcomingScheduleTab.style.color = '#ccc';
                    upcomingScheduleTab.style.borderBottom = 'none';
                }
            if (todayScheduleContent) todayScheduleContent.style.display = 'block';
            if (upcomingScheduleContent) upcomingScheduleContent.style.display = 'none';
            activateMainTab('schedule');
            
            // Special handling for Tennis - separate ATP, WTA, and Davis Cup games
            if (isTennis && tennisTodayAtpContent && tennisTodayWtaContent) {
                const atpGames = filteredGamesData.filter(game => {
                    const leagueName = (game.League || '').toLowerCase();
                    return leagueName.includes('atp') || leagueName.includes('davis cup');
                });
                const wtaGames = filteredGamesData.filter(game => {
                    const leagueName = (game.League || '').toLowerCase();
                    return leagueName.includes('wta');
                });
                
                const sortedAtpGames = atpGames.sort(sortGames);
                const sortedWtaGames = wtaGames.sort(sortGames);
                
                if (sortedAtpGames.length > 0) {
                    // Use isGroupedByLeague: true to show league headers (e.g., "ATP Finals (Singles)", "ATP Finals (Doubles)", "Davis Cup (Singles)", "Davis Cup (Doubles)")
                    renderGames(tennisTodayAtpContent, sortedAtpGames, true);
                } else {
                    tennisTodayAtpContent.innerHTML = `<p>No ATP games found for today.</p>`;
                }
                
                if (sortedWtaGames.length > 0) {
                    // Use isGroupedByLeague: true to show league headers
                    renderGames(tennisTodayWtaContent, sortedWtaGames, true);
                } else {
                    tennisTodayWtaContent.innerHTML = `<p>No WTA games found for today.</p>`;
                }
            } else {
                const sortedGames = filteredGamesData.sort(sortGames);
                renderGames(todayScheduleContent, sortedGames, false);
            }
        }

        // Load UPCOMING schedule
        loadUpcomingSchedule(leagueKey);
        
        // Reusing the standings fetcher - pass leagueKey for Firestore lookup
        fetchLeagueStandings(leagueInfo.standingsUrl, leagueKey);
        
    };

    function isFormulaOneGame(game) {
        if (!game) return false;
        const leagueRaw = ((game.League || game.league || '') + '').toLowerCase();
        const sportRaw = ((game.Sport || game.sport || '') + '').toLowerCase();
        const gameIdRaw = ((game['Game ID'] || game.gameId || '') + '').toLowerCase();
        const matchupRaw = ((game.Matchup || game.matchup || '') + '').toLowerCase();
        if (gameIdRaw.startsWith('f1_')) return true;
        if (leagueRaw.includes('formula 1') || leagueRaw.includes('formula1') || leagueRaw.includes('formula one') || leagueRaw === 'formulaone') return true;
        if (leagueRaw.includes('f1')) return true;
        if (sportRaw === 'motorsport' && (leagueRaw.includes('grand prix') || matchupRaw.includes('grand prix'))) return true;
        return false;
    }

    function activateTodayScheduleTab() {
        const scheduleTabsContainer = document.getElementById('schedule-tabs');
        if (!scheduleTabsContainer) return;
        const todayScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="today"]');
        const upcomingScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="upcoming"]');
        // const yesterdayScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="yesterday"]'); // Commented out

        scheduleTabsContainer.querySelectorAll('.schedule-tab').forEach(tab => {
            tab.classList.remove('active');
            tab.style.backgroundColor = '#2a2a2a';
            tab.style.color = '#ccc';
            tab.style.borderBottom = 'none';
        });

        if (todayScheduleTab) {
            todayScheduleTab.classList.add('active');
            todayScheduleTab.style.backgroundColor = '#2a2a2a';
            todayScheduleTab.style.color = '#fff';
            todayScheduleTab.style.borderBottom = '2px solid #fff';
        }
        if (upcomingScheduleTab) {
            upcomingScheduleTab.style.backgroundColor = '#2a2a2a';
            upcomingScheduleTab.style.color = '#ccc';
        }
        // if (yesterdayScheduleTab) {
        //     yesterdayScheduleTab.style.backgroundColor = '#2a2a2a';
        //     yesterdayScheduleTab.style.color = '#ccc';
        // }

        const todayContent = document.getElementById('league-schedule-today-content');
        const upcomingContent = document.getElementById('league-schedule-upcoming-content');
        const yesterdayContent = document.getElementById('league-schedule-yesterday-content');
        if (todayContent) todayContent.style.display = 'block';
        if (upcomingContent) upcomingContent.style.display = 'none';
        if (yesterdayContent) yesterdayContent.style.display = 'none';
    }

    // Consolidated Soccer Data Loading Function
    function loadConsolidatedSoccerData() {
        const todayScheduleContent = document.getElementById('league-schedule-today-content');
        const upcomingScheduleContent = document.getElementById('league-schedule-upcoming-content');
        const standingsContent = document.getElementById('league-standings-content');
        
        // Hide the tab system for soccer page
        const scheduleTabsContainer = document.getElementById('schedule-tabs');
        if (scheduleTabsContainer) {
            scheduleTabsContainer.style.display = 'none';
        }
        
        // Show only the today content area (we'll use it for consolidated view)
        if (todayScheduleContent) {
            todayScheduleContent.style.display = 'block';
            todayScheduleContent.innerHTML = '<p style="color: #9ca3af;">Loading all soccer games...</p>';
        }
        if (upcomingScheduleContent) {
            upcomingScheduleContent.style.display = 'none';
        }
        
        // Get only today's soccer games using the consolidated approach
        const { DateTime } = luxon;
        const today = DateTime.now().setZone('America/Denver');
        const todayStr = today.toISODate();
        
        // Get only today's games
        console.log('Fetching soccer games for date =', todayStr);
        gamesCollectionRef.where('gameDate', '==', todayStr).get()
            .then(snapshot => {
                if (snapshot.empty) {
                    todayScheduleContent.innerHTML = '<p>No soccer games found.</p>';
                    return;
                }
                
                // Filter for soccer games only and format them for consolidated display
                const allGames = snapshot.docs.map(doc => doc.data());
                const soccerGames = allGames.filter(game => {
                    const displayLeague = getLeagueDisplayName(game.League, game.Sport);
                    // Check if it's a soccer league
                    return ['Premier League', 'LaLiga', 'Serie A', 'Bundesliga', 'Ligue 1', 'MLS', 'UEFA Champions League', 'AFC Champions League', 'UEFA Europa League', 'UEFA Conference League', 'NWSL', 'FA Cup', 'Coppa Italia', 'DFB-Pokal', 'Carabao Cup', 'Super Cup', 'Eredivisie', 'Liga Portugal', 'EFL Championship', 'Brasileirão', 'Belgian Pro League', "Women's Super League", 'LPF Playoffs', 'Argentine Primera', 'Scottish Cup', 'Liga MX', 'Saudi Pro League', 'Scottish Premiership', 'Copa del Rey', 'Super Lig', 'FIFA U-20 World Cup', 'FIFA U-17 World Cup', 'Campeones Cup', 'USL Championship', "Women's UCL", 'CAF Qualifiers', 'UEFA Qualifiers', 'AFC Asian Cup Qualifiers', 'AFC Qualifiers', 'CONCACAF Qualifiers'].includes(displayLeague);
                });
                
                if (soccerGames.length === 0) {
                    todayScheduleContent.innerHTML = '<p>No soccer games found.</p>';
                    return;
                }
                
                // Format games for consolidated display (add league display name)
                const formattedGames = soccerGames.map(game => ({
                    ...game,
                    leagueDisplayName: getLeagueDisplayName(game.League, game.Sport),
                    isToday: game.gameDate === todayStr
                }));
                
                // Use the consolidated rendering function that shows league titles
                renderConsolidatedSoccerGames(todayScheduleContent, formattedGames, today);
            })
            .catch(error => {
                console.error('Error loading soccer games:', error);
                todayScheduleContent.innerHTML = '<p style="color: #ef4444;">Error loading soccer games.</p>';
            });
        
        // Load standings (use a generic soccer standings or hide it)
        if (standingsContent) {
            standingsContent.innerHTML = '<p style="color: #9ca3af;">Standings available on individual league pages.</p>';
        }
    }
    function loadAllSoccerGames(soccerLeagues, container) {
        const { DateTime } = luxon;
        const today = DateTime.now().setZone('America/Denver');
        const todayStr = today.toISODate();
        
        
        let allGames = [];
        let completedRequests = 0;
        const totalRequests = soccerLeagues.length * 2; // 2 requests per league (today + upcoming)
        
        if (totalRequests === 0) {
            container.innerHTML = '<p style="color: #9ca3af;">No soccer leagues configured.</p>';
            return;
        }
        
        soccerLeagues.forEach(leagueKey => {
            const leagueInfo = LEAGUE_DATA_CONFIG[leagueKey];
            if (!leagueInfo) {
                completedRequests += 2; // Skip both today and upcoming
                if (completedRequests === totalRequests) {
                    renderConsolidatedSoccerGames(container, allGames, today);
                }
                return;
            }
            
            
            // 1. Get TODAY'S games from FlashLiveAPI
            // For NCAAF, also filter by Sport to exclude hockey games
            let todayQuery = gamesCollectionRef.where('League', '==', leagueInfo.leagueId).where('gameDate', '==', todayStr);
            if (leagueKey === 'NCAAF') {
                todayQuery = todayQuery.where('Sport', '==', 'American Football');
            } else if (leagueKey === 'NCAAMensHockey' || (leagueInfo.displayName && leagueInfo.displayName.toLowerCase().includes('hockey'))) {
                todayQuery = todayQuery.where('Sport', '==', 'Hockey');
            }
            
            todayQuery.get()
                .then(snapshot => {
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        allGames.push({
                            ...data,
                            leagueKey: leagueKey,
                            leagueDisplayName: getLeagueDisplayName(data.League, data.Sport),
                            isToday: true,
                            source: 'flashlive'
                        });
                    });
                    
                    completedRequests++;
                    if (completedRequests === totalRequests) {
                        console.log(`Total games found: ${allGames.length}`);
                        renderConsolidatedSoccerGames(container, allGames, today);
                    }
                })
                .catch(error => {
                    console.error(`Error loading today's games for ${leagueKey}:`, error);
                    completedRequests++;
                    if (completedRequests === totalRequests) {
                        renderConsolidatedSoccerGames(container, allGames, today);
                    }
                });
            
            // 2. Get UPCOMING games from individual Firestore collections
            if (leagueInfo.upcomingCollectionName) {
                const upcomingCollectionRef = db.collection(leagueInfo.upcomingCollectionName);
                upcomingCollectionRef.get()
                    .then(snapshot => {
                        
                        snapshot.forEach(doc => {
                            const data = doc.data();
                            
                            const away = data['away'] || '';
                            const home = data['home'] || '';
                            const timeStr = data['time'] || '';
                            const dateStr = data['date'] || '';
                            
                            // Simple check: if date is not today, include it
                            const today = new Date().toISOString().split('T')[0];
                            if (dateStr && dateStr !== today) {
                                allGames.push({
                                    'Home Team': home,
                                    'Away Team': away,
                                    'Start Time': timeStr,
                                    'Match Status': 'SCHEDULED',
                                    'Home Score': '',
                                    'Away Score': '',
                                    'League': leagueInfo.leagueId,
                                    'Sport': 'Soccer',
                                    leagueKey: leagueKey,
                                    leagueDisplayName: getLeagueDisplayName(leagueInfo.leagueId, 'Soccer'),
                                    isToday: false,
                                    source: 'upcoming',
                                    gameDate: dateStr
                                });
                            }
                        });
                        
                        completedRequests++;
                        if (completedRequests === totalRequests) {
                            renderConsolidatedSoccerGames(container, allGames, today);
                        }
                    })
                    .catch(error => {
                        console.error(`Error loading upcoming games for ${leagueKey}:`, error);
                        completedRequests++;
                        if (completedRequests === totalRequests) {
                            renderConsolidatedSoccerGames(container, allGames, today);
                        }
                    });
            } else {
                completedRequests++;
                if (completedRequests === totalRequests) {
                    renderConsolidatedSoccerGames(container, allGames, today);
                }
            }
        });
    }

    function renderConsolidatedSoccerGames(container, allGames, today) {
        if (!container) return;
        
        
        if (allGames.length === 0) {
            container.innerHTML = '<p style="color: #9ca3af;">No soccer games found.</p>';
            return;
        }
        
        // Group games by date
        const gamesByDate = {};
        allGames.forEach(game => {
            const gameDate = game.gameDate;
            if (!gamesByDate[gameDate]) {
                gamesByDate[gameDate] = {};
            }
            if (!gamesByDate[gameDate][game.leagueDisplayName]) {
                gamesByDate[gameDate][game.leagueDisplayName] = [];
            }
            gamesByDate[gameDate][game.leagueDisplayName].push(game);
        });
        
        // Sort dates
        const sortedDates = Object.keys(gamesByDate).sort();
        
        let html = '';
        sortedDates.forEach(dateStr => {
            const isToday = dateStr === today.toISODate();
            let dateHeader;
            if (isToday) {
                dateHeader = 'Today';
            } else {
                // Format date as "September 13" in user's local timezone
                const { DateTime } = luxon;
                const dateObj = DateTime.fromISO(dateStr).setZone('local');
                dateHeader = dateObj.toFormat('MMMM d');
            }
            
            // Add date header - match the large TODAY tab styling from the image
            html += `<div class="date-section" style="margin-bottom: 20px;">`;
            html += `<div class="date-header" style="background-color: #d1d5db; color: black; padding: 2px 16px; font-weight: bold; font-size: 12px; margin-bottom: 8px; text-transform: uppercase; border: none;">${dateHeader}</div>`;
            
            // Sort leagues within each date using LEAGUE_DISPLAY_ORDER
            const leagues = Object.keys(gamesByDate[dateStr]).sort((a, b) => {
                const indexA = LEAGUE_DISPLAY_ORDER.indexOf(a);
                const indexB = LEAGUE_DISPLAY_ORDER.indexOf(b);
                // If both leagues are in the order, sort by their position
                if (indexA !== -1 && indexB !== -1) {
                    return indexA - indexB;
                }
                // If only one is in the order, prioritize it
                if (indexA !== -1) return -1;
                if (indexB !== -1) return 1;
                // If neither is in the order, sort alphabetically
                return a.localeCompare(b);
            });
            leagues.forEach(leagueName => {
                const games = gamesByDate[dateStr][leagueName];
                
                // Use the same league-section and league-title styling as other pages
                html += `<div class="league-section">`;
                html += `<div class="league-title" style="font-size: 12px; padding: 2px 16px; border: none;">${leagueName}</div>`;
                
                // Use the same game-table styling as other pages
                html += `<table class="game-table">`;
                
                // Add colgroup for consistent column widths (same as individual league pages)
                html += `<colgroup>`;
                html += `<col style="width: 32%;">`;  // Time column
                html += `<col style="width: 32%;">`;  // Team column
                html += `<col style="width: 10%;">`;  // Score column
                html += `<col style="width: 26%;">`;  // Channel column
                html += `</colgroup>`;
                
                // Sort games by time chronologically (handle both timestamp and string formats)
                games.sort((a, b) => {
                    let timeA = 0;
                    let timeB = 0;
                    
                    // Convert to comparable timestamps
                    if (typeof a['Start Time'] === 'number') {
                        timeA = a['Start Time'];
                    } else if (a['Start Time'] && typeof a['Start Time'] === 'object' && a['Start Time'].seconds) {
                        timeA = a['Start Time'].seconds * 1000;
                    } else if (typeof a['Start Time'] === 'string' && a['Start Time']) {
                        // Handle string times like "9:30 AM" - convert to comparable timestamp
                        const { DateTime } = luxon;
                        try {
                            // Parse string time and convert to timestamp for comparison
                            let timeStr = a['Start Time'].replace(/:\d{2}(?=\s*[AP]M)/, ''); // Remove seconds if present
                            const gameDate = a.gameDate || new Date().toISOString().split('T')[0];
                            
                            // Convert 12-hour format to 24-hour format for proper parsing
                            let hour = parseInt(timeStr.split(':')[0]);
                            const minute = timeStr.split(':')[1].split(' ')[0];
                            const ampm = timeStr.split(' ')[1];
                            
                            if (ampm === 'PM' && hour !== 12) hour += 12;
                            if (ampm === 'AM' && hour === 12) hour = 0;
                            
                            const dateTime = DateTime.fromISO(`${gameDate}T${hour.toString().padStart(2, '0')}:${minute}`).setZone('local');
                            timeA = dateTime.toMillis();
                        } catch (e) {
                            timeA = 0; // Fallback if parsing fails
                        }
                    }
                    
                    if (typeof b['Start Time'] === 'number') {
                        timeB = b['Start Time'];
                    } else if (b['Start Time'] && typeof b['Start Time'] === 'object' && b['Start Time'].seconds) {
                        timeB = b['Start Time'].seconds * 1000;
                    } else if (typeof b['Start Time'] === 'string' && b['Start Time']) {
                        // Handle string times like "9:30 AM" - convert to comparable timestamp
                        const { DateTime } = luxon;
                        try {
                            // Parse string time and convert to timestamp for comparison
                            let timeStr = b['Start Time'].replace(/:\d{2}(?=\s*[AP]M)/, ''); // Remove seconds if present
                            const gameDate = b.gameDate || new Date().toISOString().split('T')[0];
                            
                            // Convert 12-hour format to 24-hour format for proper parsing
                            let hour = parseInt(timeStr.split(':')[0]);
                            const minute = timeStr.split(':')[1].split(' ')[0];
                            const ampm = timeStr.split(' ')[1];
                            
                            if (ampm === 'PM' && hour !== 12) hour += 12;
                            if (ampm === 'AM' && hour === 12) hour = 0;
                            
                            const dateTime = DateTime.fromISO(`${gameDate}T${hour.toString().padStart(2, '0')}:${minute}`).setZone('local');
                            timeB = dateTime.toMillis();
                        } catch (e) {
                            timeB = 0; // Fallback if parsing fails
                        }
                    }
                    
                    return timeA - timeB;
                });
                
                let lastDisplayedTimeLabel = null;
                
                games.forEach((game, gameIndex) => {
                    const displayLeague = getLeagueDisplayName(game.League, game.Sport);
                    const leagueKey = getLeagueKeyFromGame(game);
                    const homeDisplay = getTeamDisplayName(game['Home Team'] || '', displayLeague);
                    const awayDisplay = getTeamDisplayName(game['Away Team'] || '', displayLeague);
                    const homeTeam = formatTeamNameWithRanking(homeDisplay, leagueKey);
                    const awayTeam = formatTeamNameWithRanking(awayDisplay, leagueKey);
                    const homeScore = game['Home Score'] || '';
                    const awayScore = game['Away Score'] || '';
                    const status = game['Match Status'] || '';
                    const matchStatus = (game['Match Status'] || '').toUpperCase();
                    const stageValue = (game['Stage'] || '').toUpperCase();
                    const stageTypeValue = (game['StageType'] || '').toUpperCase();
                    const statusValue = (game['Status'] || '').toUpperCase();
                    
                    // Check if POSTPONED is in any field (Stage, Status, StageType, or Match Status)
                    const isPostponed = stageValue.includes("POSTPONED") || statusValue.includes("POSTPONED") || stageTypeValue.includes("POSTPONED") || matchStatus.includes("POSTPONED");
                    // Check if CANCELED is in any field (Stage, Status, StageType, or Match Status)
                    const isCanceled = stageValue.includes("CANCELED") || statusValue.includes("CANCELED") || stageTypeValue.includes("CANCELED") || matchStatus.includes("CANCELED");
                    
                    // Format time/status display (same logic as home page)
                    let timeDisplay = '';
                    const isLive = status.includes("IN PROGRESS") || status.includes("LIVE");
                    const isFinal = status.includes("FINISHED") || status.includes("FINAL") || status.includes("GAME OVER");
                    const isPostponedFinal = isFinal && isPostponed;
                    const isCanceledFinal = isFinal && isCanceled;
                    
                    if (isLive) {
                        // Show live status instead of start time
                        let parsedStatus = '';
                        const displayLeague = getLeagueDisplayName(game.League, game.Sport);
                        if (displayLeague === "MLB") {
                            const inningHalf = game.inningHalf || "";
                            const currentInning = game.currentInning || "";
                            parsedStatus = `${inningHalf} ${currentInning}`.trim();
                        } else {
                            // Use granular live status for ALL sports (including soccer)
                            parsedStatus = getGranularLiveStatus(game);
                        }
                        timeDisplay = parsedStatus ? `<span style="color: red;">${parsedStatus}</span>` : '<span style="color: red;">Live</span>';
                    } else if (isPostponed) {
                        timeDisplay = '<span style="color: #545353;">PPD</span>';
                    } else if (isCanceled) {
                        timeDisplay = '<span style="color: #545353;">Canceled</span>';
                    } else if (isFinal) {
                        timeDisplay = "F";
                    } else {
                        // Show start time for scheduled games
                        if (typeof game['Start Time'] === 'number') {
                            // Handle timestamp from FlashLiveAPI - convert to user's local time
                            const { DateTime } = luxon;
                            const gameTime = DateTime.fromMillis(game['Start Time']).setZone('local');
                            timeDisplay = gameTime.toFormat('h:mm a');
                        } else if (game['Start Time'] && typeof game['Start Time'] === 'object' && game['Start Time'].seconds) {
                            // Handle Firestore Timestamp object - convert to user's local time
                            const { DateTime } = luxon;
                            const gameTime = DateTime.fromSeconds(game['Start Time'].seconds).setZone('local');
                            timeDisplay = gameTime.toFormat('h:mm a');
                        } else {
                            // Handle string time from upcoming collections - use same logic as LigaMX league page
                            const timeStr = game['Start Time'] || '';
                            if (timeStr && timeStr.includes(':')) {
                                const { DateTime } = luxon;
                                try {
                                    // Parse as Eastern time with seconds format, then convert to local (same as LigaMX)
                                    let easternTime = DateTime.fromFormat(timeStr, 'h:mm:ss a', { zone: 'America/New_York' });
                                    
                                    // If that doesn't work, try without seconds
                                    if (!easternTime.isValid) {
                                        easternTime = DateTime.fromFormat(timeStr, 'h:mm a', { zone: 'America/New_York' });
                                    }
                                    
                                    if (easternTime.isValid) {
                                        const localTime = easternTime.toLocal();
                                        timeDisplay = localTime.toFormat('h:mm a');
                                    } else {
                                        timeDisplay = timeStr.replace(/:\d{2}(?=\s*[AP]M)/, ''); // fallback
                                    }
                                } catch (e) {
                                    // Fallback to original string if parsing fails
                                    timeDisplay = timeStr.replace(/:\d{2}(?=\s*[AP]M)/, '');
                                }
                            } else {
                                timeDisplay = timeStr || 'TBD';
                            }
                        }
                    }
                    
                    // Store raw time value for separator comparison (before HTML formatting)
                    let rawTimeDisplay = timeDisplay;
                    if (isLive) {
                        // Extract text from HTML for comparison
                        rawTimeDisplay = timeDisplay.replace(/<[^>]*>/g, '').trim();
                    }
                    
                    // Prevent duplicate time display (same logic as renderGames function)
                    let displayTimeLabel = timeDisplay;
                    if (!isLive && !isFinal) {
                        const normalizedTimeLabel = normalizeDisplayTime(timeDisplay);
                        if (normalizedTimeLabel && normalizedTimeLabel !== 'TBD') {
                            if (normalizedTimeLabel === lastDisplayedTimeLabel) {
                                displayTimeLabel = "";
                            } else {
                                lastDisplayedTimeLabel = normalizedTimeLabel;
                            }
                        }
                    }
                    
                    // Determine if it's today or upcoming for formatting
                    const isGameToday = game.isToday;
                    // Use the exact same structure as home page renderGames function
                    const homeScoreDisplay = (isLive || isFinal) ? (homeScore !== '' ? homeScore : '') : '';
                    const awayScoreDisplay = (isLive || isFinal) ? (awayScore !== '' ? awayScore : '') : '';
                    
                    // Determine losing team color for final games
                    let homeColor = '';
                    let awayColor = '';
                    let homeScoreColor = '';
                    let awayScoreColor = '';
                    if (isFinal) {
                        if (isPostponedFinal) {
                            // All text in postponed games is #545353
                            homeColor = 'color: #545353;';
                            awayColor = 'color: #545353;';
                            homeScoreColor = 'color: #545353;';
                            awayScoreColor = 'color: #545353;';
                        } else {
                            const homeScoreNum = parseFloat(homeScore) || 0;
                            const awayScoreNum = parseFloat(awayScore) || 0;
                            if (homeScoreNum < awayScoreNum) {
                                homeColor = 'color: #7f7f7f;';
                                homeScoreColor = 'color: #7f7f7f;';
                            } else if (awayScoreNum < homeScoreNum) {
                                awayColor = 'color: #7f7f7f;';
                                awayScoreColor = 'color: #7f7f7f;';
                            }
                        }
                    }
                    
                    // Soccer: home team on top, away team on bottom (same as home page)
                    // Add channel data (hide for finished games) - use Tennis Channel for ATP leagues
                    let channelToDisplay = game.channel || '';
                    if (game.League && game.League.includes('ATP')) {
                        channelToDisplay = 'Tennis Channel';
                    }
                    const channelDisplay = (channelToDisplay && !isFinal) ? channelToDisplay : '';
                    
                    html += `<tr class="game-row">`;
                    html += `<td rowspan="2" style="text-align: center; font-size: 11px; vertical-align: top; padding: 2px 1px; box-sizing: border-box;">${displayTimeLabel}</td>`;
                    html += `<td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 11px; box-sizing: border-box; ${homeColor}">${homeTeam}</td>`;
                    html += `<td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${homeScoreColor}">${homeScoreDisplay}</td>`;
                    html += `<td rowspan="2" style="position: relative; text-align: center; font-size: 10px; color: #9ca3af; padding: 2px 1px; box-sizing: border-box;"><div style="position: absolute; top: 35%; left: 50%; transform: translate(-50%, -50%);">${channelDisplay}</div></td>`;
                    html += `</tr>`;
                    
                    html += `<tr class="game-row game-separator">`;
                    html += `<td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 11px; box-sizing: border-box; ${awayColor}">${awayTeam}</td>`;
                    html += `<td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box; ${awayScoreColor}">${awayScoreDisplay}</td>`;
                    html += `</tr>`;
                    
                    // Add separator line between games (but not after the last game)
                    if (gameIndex < games.length - 1) {
                        const nextGame = games[gameIndex + 1];
                        const nextStatus = nextGame['Match Status'] || '';
                        const nextIsLive = nextStatus.includes("IN PROGRESS") || nextStatus.includes("LIVE");
                        const nextIsFinal = nextStatus.includes("FINISHED") || nextStatus.includes("FINAL") || nextStatus.includes("GAME OVER");
                        
                        let nextRawTimeDisplay = '';
                        if (nextIsLive) {
                            let parsedStatus = '';
                            const nextDisplayLeague = getLeagueDisplayName(nextGame.League, nextGame.Sport);
                            if (nextDisplayLeague === "MLB") {
                                const inningHalf = nextGame.inningHalf || "";
                                const currentInning = nextGame.currentInning || "";
                                parsedStatus = `${inningHalf} ${currentInning}`.trim();
                            } else {
                                parsedStatus = getGranularLiveStatus(nextGame);
                            }
                            nextRawTimeDisplay = parsedStatus || 'Live';
                        } else if (nextIsFinal) {
                            nextRawTimeDisplay = "F";
                        } else {
                            if (typeof nextGame['Start Time'] === 'number') {
                                const { DateTime } = luxon;
                                const gameTime = DateTime.fromMillis(nextGame['Start Time']).setZone('local');
                                nextRawTimeDisplay = gameTime.toFormat('h:mm a');
                            } else if (nextGame['Start Time'] && typeof nextGame['Start Time'] === 'object' && nextGame['Start Time'].seconds) {
                                const { DateTime } = luxon;
                                const gameTime = DateTime.fromSeconds(nextGame['Start Time'].seconds).setZone('local');
                                nextRawTimeDisplay = gameTime.toFormat('h:mm a');
                            } else {
                                const timeStr = nextGame['Start Time'] || '';
                                if (timeStr && timeStr.includes(':')) {
                                    const { DateTime } = luxon;
                                    try {
                                        let easternTime = DateTime.fromFormat(timeStr, 'h:mm:ss a', { zone: 'America/New_York' });
                                        if (!easternTime.isValid) {
                                            easternTime = DateTime.fromFormat(timeStr, 'h:mm a', { zone: 'America/New_York' });
                                        }
                                        if (easternTime.isValid) {
                                            const localTime = easternTime.toLocal();
                                            nextRawTimeDisplay = localTime.toFormat('h:mm a');
                                        } else {
                                            nextRawTimeDisplay = timeStr.replace(/:\d{2}(?=\s*[AP]M)/, '');
                                        }
                                    } catch (e) {
                                        nextRawTimeDisplay = timeStr.replace(/:\d{2}(?=\s*[AP]M)/, '');
                                    }
                                } else {
                                    nextRawTimeDisplay = timeStr || 'TBD';
                                }
                            }
                        }
                        
                        const nextNormalizedTimeLabel = (!nextIsLive && !nextIsFinal) ? normalizeDisplayTime(nextRawTimeDisplay) : null;
                        const nextGameTimeLabel = nextNormalizedTimeLabel || nextRawTimeDisplay;
                        
                        const currentNormalizedTimeLabel = (!isLive && !isFinal) ? normalizeDisplayTime(rawTimeDisplay) : null;
                        const currentGameTimeLabel = currentNormalizedTimeLabel || rawTimeDisplay;
                        
                        const isDifferentTime = nextGameTimeLabel !== currentGameTimeLabel;
                        
                        const colspan = isDifferentTime ? 4 : 3;
                        const firstCell = isDifferentTime ? '' : '<td style="padding: 0; border: none; width: 32%;"></td>';
                        
                        html += `<tr class="game-separator-line">${firstCell}<td colspan="${colspan}" style="padding: 0 0 10px 0; border: none;"><div style="border-top: 1px solid #000000; margin: 0;"></div></td></tr>`;
                    }
                });
                
                html += `</table></div>`;
            });
            
            html += `</div>`; // Close date-section
        });
        
        container.innerHTML = html;
    }

    function loadTennisUpcomingSchedule(tourType, container) {
        if (!container) return;
        
        container.innerHTML = '<p style="color: #9ca3af;">Loading ' + tourType + ' schedule...</p>';
        
        // WTA loads from Google Sheets CSV
        if (tourType === 'WTA') {
            const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSw4dh1Lx3leBYXjVjOsFfvM5CQ0KAy_hdSz0sezyDB8yUvF62FlJD65sbAOx_qZDU5F5wFrgMGBrIH/pub?gid=889186709&single=true&output=csv';
            
            fetch(csvUrl)
                .then(response => response.text())
                .then(csvText => {
                    // Parse CSV
                    const lines = csvText.split('\n').filter(line => line.trim());
                    if (lines.length < 2) {
                        container.innerHTML = '<p style="color: #9ca3af;">No upcoming WTA tournaments found.</p>';
                        return;
                    }
                    
                    // Parse header
                    const headers = lines[0].split(',').map(h => h.trim());
                    const dateIndex = headers.indexOf('Date');
                    const tournamentIndex = headers.indexOf('Tournament');
                    const channelIndex = headers.indexOf('Channel');
                    
                    if (dateIndex === -1 || tournamentIndex === -1 || channelIndex === -1) {
                        container.innerHTML = '<p style="color: #c00;">Error: CSV format incorrect.</p>';
                        return;
                    }
                    
                    let tournaments = [];
                    
                    // Parse data rows
                    for (let i = 1; i < lines.length; i++) {
                        const line = lines[i];
                        // Handle CSV parsing with potential commas in quoted fields
                        const values = [];
                        let current = '';
                        let inQuotes = false;
                        
                        for (let j = 0; j < line.length; j++) {
                            const char = line[j];
                            if (char === '"') {
                                inQuotes = !inQuotes;
                            } else if (char === ',' && !inQuotes) {
                                values.push(current.trim());
                                current = '';
                            } else {
                                current += char;
                            }
                        }
                        values.push(current.trim());
                        
                        const dateStr = values[dateIndex] || '';
                        const tournament = values[tournamentIndex] || '';
                        const channel = values[channelIndex] || '';
                        
                        if (!dateStr || !tournament) continue;
                        
                        tournaments.push({
                            dateHeader: dateStr,
                            tournament: tournament,
                            channel: channel
                        });
                    }
                    
                    if (tournaments.length === 0) {
                        container.innerHTML = '<p style="color: #9ca3af;">No upcoming WTA tournaments found.</p>';
                        return;
                    }
                    
                    // Group by date
                    const tournamentsByDate = {};
                    tournaments.forEach(t => {
                        if (!tournamentsByDate[t.dateHeader]) {
                            tournamentsByDate[t.dateHeader] = [];
                        }
                        tournamentsByDate[t.dateHeader].push(t);
                    });
                    
                    // Sort date headers (try to parse and sort chronologically)
                    const sortedDateHeaders = Object.keys(tournamentsByDate).sort((a, b) => {
                        // Try to extract start date from range (e.g., "November 17-23" -> "November 17")
                        const getStartDate = (dateStr) => {
                            if (dateStr.includes('-')) {
                                const parts = dateStr.split('-');
                                if (parts.length >= 2) {
                                    const monthDay = parts[0].trim();
                                    const year = luxon.DateTime.now().year;
                                    const fullDate = `${monthDay}, ${year}`;
                                    const parsed = luxon.DateTime.fromFormat(fullDate, 'MMMM d, yyyy');
                                    if (parsed.isValid) return parsed;
                                }
                            }
                            // Try parsing as single date
                            const year = luxon.DateTime.now().year;
                            const fullDate = `${dateStr}, ${year}`;
                            const parsed = luxon.DateTime.fromFormat(fullDate, 'MMMM d, yyyy');
                            return parsed.isValid ? parsed : luxon.DateTime.fromMillis(0);
                        };
                        
                        const dateA = getStartDate(a);
                        const dateB = getStartDate(b);
                        return dateA - dateB;
                    });
                    
                    let html = '';
                    
                    sortedDateHeaders.forEach(dateHeader => {
                        // Date header (use as-is from CSV, e.g., "November 17-23")
                        html += `<div class="date-header" style="background-color: #d1d5db; color: #000; padding: 0px 12px; margin: 8px 0 4px 0; font-weight: normal; font-size: 11px; line-height: 18px;">${dateHeader}</div>`;
                        
                        // Tournaments for this date
                        tournamentsByDate[dateHeader].forEach(tournament => {
                            // Tournament name with channel on the right
                            html += `<div style="padding: 8px 12px; display: flex; justify-content: space-between; align-items: center; color: white; font-size: 11px; background-color: #1f2937; border-bottom: 1px solid #374151;">`;
                            html += `<span style="font-weight: bold;">${tournament.tournament}</span>`;
                            if (tournament.channel) {
                                html += `<span style="color: #9ca3af; font-size: 10px; margin-left: 12px;">${tournament.channel}</span>`;
                            }
                            html += `</div>`;
                        });
                        
                        html += `<div style="margin-bottom: 20px;"></div>`;
                    });
                    
                    container.innerHTML = html;
                })
                .catch(error => {
                    container.innerHTML = `<div class="error" style="color: #c00;">Error loading WTA schedule: ${error.message}</div>`;
                });
            return;
        }
        
        // ATP loads from Firestore
        const collectionRef = db.collection(tourType);
        
        collectionRef.get().then(snapshot => {
            const today = luxon.DateTime.now().startOf('day');
            let tournaments = [];
            
            snapshot.forEach(doc => {
                const data = doc.data();
                const dateStr = data.date;
                const tournament = data.tournament || '';
                const time = data.time || '';
                const channel = data.channel || '';
                
                if (!dateStr || !tournament) return;
                
                let gameDate;
                if (typeof dateStr === 'string' && dateStr.match(/^\d{4}-\d{2}-\d{2}$/)) {
                    gameDate = luxon.DateTime.fromISO(dateStr);
                } else {
                    return;
                }
                
                if (!gameDate || !gameDate.isValid) return;
                
                // Show tournaments from today onwards
                if (gameDate < today) return;
                
                tournaments.push({
                    date: gameDate,
                    dateHeader: gameDate.toFormat('MMMM d, yyyy'),
                    tournament: tournament,
                    time: time,
                    channel: channel
                });
            });
            
            if (tournaments.length === 0) {
                container.innerHTML = '<p style="color: #9ca3af;">No upcoming ' + tourType + ' tournaments found.</p>';
                return;
            }
            
            // Sort by date
            tournaments.sort((a, b) => a.date - b.date);
            
            // Group by date
            const tournamentsByDate = {};
            tournaments.forEach(t => {
                if (!tournamentsByDate[t.dateHeader]) {
                    tournamentsByDate[t.dateHeader] = [];
                }
                tournamentsByDate[t.dateHeader].push(t);
            });
            
            // Sort date headers chronologically
            const sortedDateHeaders = Object.keys(tournamentsByDate).sort((a, b) => {
                const dateA = luxon.DateTime.fromFormat(a, 'MMMM d, yyyy');
                const dateB = luxon.DateTime.fromFormat(b, 'MMMM d, yyyy');
                return dateA - dateB;
            });
            
            // Filter out today's date from upcoming
            const todayFormatted = luxon.DateTime.now().toFormat('MMMM d, yyyy');
            const filteredDateHeaders = sortedDateHeaders.filter(dateHeader => dateHeader !== todayFormatted);
            
            let html = '';
            
            filteredDateHeaders.forEach(dateHeader => {
                // Format date header (e.g., "November 13")
                const dateObj = luxon.DateTime.fromFormat(dateHeader, 'MMMM d, yyyy');
                const formattedDate = dateObj.isValid ? dateObj.toFormat('MMMM d') : dateHeader;
                
                // Date header
                html += `<div class="date-header" style="background-color: #d1d5db; color: #000; padding: 0px 12px; margin: 8px 0 4px 0; font-weight: normal; font-size: 11px; line-height: 18px;">${formattedDate}</div>`;
                
                // Tournaments for this date
                tournamentsByDate[dateHeader].forEach(tournament => {
                    // Tournament name
                    html += `<div style="padding: 8px 12px; color: white; font-size: 11px; font-weight: bold; background-color: #1f2937;">${tournament.tournament}</div>`;
                    
                    // Time and Channel on same line
                    html += `<div style="padding: 6px 12px; display: flex; gap: 12px; background-color: #1f2937; border-bottom: 1px solid #374151;">`;
                    if (tournament.time) {
                        html += `<span style="color: #9ca3af; font-size: 10px;">${tournament.time}</span>`;
                    }
                    if (tournament.channel) {
                        html += `<span style="color: #9ca3af; font-size: 10px;">${tournament.channel}</span>`;
                    }
                    html += `</div>`;
                });
                
                html += `<div style="margin-bottom: 20px;"></div>`;
            });
            
            container.innerHTML = html;
        }).catch(error => {
            container.innerHTML = `<div class="error" style="color: #c00;">Error loading ${tourType} schedule: ${error.message}</div>`;
        });
    }

    function loadUpcomingSchedule(leagueKey) {
        const upcomingScheduleContent = document.getElementById('league-schedule-upcoming-content');
        if (!upcomingScheduleContent) return;

        // Special handling for Tennis - show ATP/WTA sub-tabs
        // Normalize league key (trim whitespace, handle case)
        const normalizedLeagueKey = leagueKey ? leagueKey.trim() : '';
        
        // Check if this is Tennis - must be checked first before any other processing
        if (normalizedLeagueKey === 'Tennis' || leagueKey === 'Tennis') {
            const tennisTabs = document.getElementById('tennis-upcoming-tabs');
            const atpContent = document.getElementById('tennis-upcoming-atp-content');
            const wtaContent = document.getElementById('tennis-upcoming-wta-content');
            const defaultContent = document.getElementById('league-schedule-upcoming-default-content');
            
            // Always clear default content first when Tennis is detected
            if (defaultContent) {
                defaultContent.innerHTML = '';
                defaultContent.style.display = 'none';
            }
            
            if (tennisTabs && atpContent && wtaContent) {
                tennisTabs.style.display = 'flex';
                atpContent.style.display = 'block';
                wtaContent.style.display = 'none';
                
                // Ensure parent container is using flex layout
                if (upcomingScheduleContent) {
                    upcomingScheduleContent.style.display = 'flex';
                    upcomingScheduleContent.style.flexDirection = 'column';
                }
                
                // Load ATP and WTA data
                loadTennisUpcomingSchedule('ATP', atpContent);
                loadTennisUpcomingSchedule('WTA', wtaContent);
            } else {
                console.error('Tennis sub-tab elements not found:', {
                    tennisTabs: !!tennisTabs,
                    atpContent: !!atpContent,
                    wtaContent: !!wtaContent,
                    defaultContent: !!defaultContent
                });
                // Fallback: show error message
                if (defaultContent) {
                    defaultContent.style.display = 'block';
                    defaultContent.innerHTML = '<p style="color: #c00;">Error: Tennis sub-tabs not found.</p>';
                }
                return;
            }
            
            // Add click handlers for sub-tabs (remove existing first to prevent duplicates)
            const atpTab = tennisTabs.querySelector('[data-tennis-tab="atp"]');
            const wtaTab = tennisTabs.querySelector('[data-tennis-tab="wta"]');
            
            if (atpTab && wtaTab) {
                // Remove existing listeners by cloning
                const newAtpTab = atpTab.cloneNode(true);
                const newWtaTab = wtaTab.cloneNode(true);
                atpTab.parentNode.replaceChild(newAtpTab, atpTab);
                wtaTab.parentNode.replaceChild(newWtaTab, wtaTab);
                
                newAtpTab.addEventListener('click', () => {
                    newAtpTab.classList.add('active');
                    newAtpTab.style.color = '#fff';
                    newAtpTab.style.borderBottom = '2px solid #fff';
                    newWtaTab.classList.remove('active');
                    newWtaTab.style.color = '#ccc';
                    newWtaTab.style.borderBottom = 'none';
                    atpContent.style.display = 'block';
                    wtaContent.style.display = 'none';
                });
                
                newWtaTab.addEventListener('click', () => {
                    newWtaTab.classList.add('active');
                    newWtaTab.style.color = '#fff';
                    newWtaTab.style.borderBottom = '2px solid #fff';
                    newAtpTab.classList.remove('active');
                    newAtpTab.style.color = '#ccc';
                    newAtpTab.style.borderBottom = 'none';
                    wtaContent.style.display = 'block';
                    atpContent.style.display = 'none';
                });
            }
            return;
        }
        
        // Hide Tennis sub-tabs for other leagues
        const tennisTabs = document.getElementById('tennis-upcoming-tabs');
        const atpContent = document.getElementById('tennis-upcoming-atp-content');
        const wtaContent = document.getElementById('tennis-upcoming-wta-content');
        const defaultContent = document.getElementById('league-schedule-upcoming-default-content');
        
        if (tennisTabs) tennisTabs.style.display = 'none';
        if (atpContent) atpContent.style.display = 'none';
        if (wtaContent) wtaContent.style.display = 'none';
        if (defaultContent) {
            defaultContent.style.display = 'block';
            // Clear any old content first
            defaultContent.innerHTML = '<p style="color: #9ca3af;">Loading upcoming schedule...</p>';
        }

        // Check for hardcoded schedule first
        if (HARDCODED_UPCOMING_SCHEDULES[leagueKey]) {
            const todayStr = luxon.DateTime.now().setZone('America/New_York').toISODate();
            const allGames = HARDCODED_UPCOMING_SCHEDULES[leagueKey];
            
            // Filter to only future games
            const futureGames = allGames.filter(game => game.date > todayStr);
            
            if (futureGames.length === 0) {
                if (defaultContent) {
                    defaultContent.innerHTML = '<p style="color: #9ca3af;">No upcoming games scheduled.</p>';
                }
                return;
            }
            
            // Helper function to extract mascot name only
            function getMascotName(fullTeamName) {
                // List of city/state prefixes to remove
                const prefixes = [
                    'New York', 'Los Angeles', 'San Francisco', 'San Diego', 'San Antonio', 'San Jose',
                    'Las Vegas', 'New England', 'New Orleans', 'Tampa Bay', 'Green Bay',
                    'Kansas City', 'Oklahoma City', 'Golden State', 'Portland Trail',
                    'Minnesota', 'Indiana', 'Tennessee', 'Carolina', 'Arizona', 'Jacksonville',
                    'Philadelphia', 'Pittsburgh', 'Baltimore', 'Cleveland', 'Cincinnati',
                    'Houston', 'Dallas', 'Washington', 'Chicago', 'Detroit', 'Milwaukee',
                    'Denver', 'Seattle', 'Atlanta', 'Miami', 'Charlotte', 'Orlando',
                    'Brooklyn', 'Toronto', 'Boston', 'Buffalo', 'Memphis'
                ];
                
                let mascot = fullTeamName.trim();
                
                // Remove prefix if found
                for (const prefix of prefixes) {
                    if (mascot.startsWith(prefix + ' ')) {
                        mascot = mascot.substring(prefix.length + 1);
                        break;
                    }
                }
                
                return mascot;
            }
            
            // Check if this league uses the Featured Only / Expand All toggle
            const isNcaaLeague = (leagueKey === 'NCAAM' || leagueKey === 'NCAAW');
            const importantTeamsSet = leagueKey === 'NCAAM' ? IMPORTANT_NCAAM_TEAMS : (leagueKey === 'NCAAW' ? IMPORTANT_NCAAW_TEAMS : null);
            
            // Function to check if a game involves important teams
            function isImportantGame(game) {
                if (!importantTeamsSet) return true; // Show all games if no important teams filter
                const awayNormalized = normalizeNcaaTeamName(game.away);
                const homeNormalized = normalizeNcaaTeamName(game.home);
                return importantTeamsSet.has(awayNormalized) || importantTeamsSet.has(homeNormalized);
            }
            
            // Mark games as important or not
            futureGames.forEach(game => {
                game.isImportant = isImportantGame(game);
            });
            
            // Count featured vs non-featured games
            const featuredGamesCount = futureGames.filter(g => g.isImportant).length;
            const nonFeaturedGamesCount = futureGames.filter(g => !g.isImportant).length;
            
            // Object to track expand/collapse state for each date
            const dateExpandStates = {};
            
            // Initialize all dates to collapsed (false = show featured only)
            const sortedDates = Object.keys(futureGames.reduce((acc, game) => {
                acc[game.date] = true;
                return acc;
            }, {})).sort();
            
            sortedDates.forEach(date => {
                dateExpandStates[date] = false;
            });
            
            // Function to render the schedule
            function renderSchedule() {
                // Group all games by date (not filtered yet)
                const gamesByDate = {};
                futureGames.forEach(game => {
                    if (!gamesByDate[game.date]) {
                        gamesByDate[game.date] = [];
                    }
                    gamesByDate[game.date].push(game);
                });
                
                // Build HTML
                let html = '';
                
                const sortedDates = Object.keys(gamesByDate).sort();
                
                sortedDates.forEach(dateStr => {
                    const dateObj = luxon.DateTime.fromISO(dateStr);
                    const dateHeader = dateObj.toFormat('EEEE, MMMM d, yyyy');
                    const isExpanded = dateExpandStates[dateStr];
                    
                    html += `<div style="background-color: #2a2a2a; padding: 6px 10px; font-weight: bold; font-size: 11px; border-bottom: 1px solid #3a3a3a; margin-top: 10px;">${dateHeader}</div>`;
                    
                    // Add toggle button under each date header if there are non-featured games
                    if (isNcaaLeague && nonFeaturedGamesCount > 0) {
                        html += `
                            <div class="upcoming-schedule-toggle" data-date="${dateStr}" style="font-size: 10px; padding: 6px 10px; cursor: pointer; color: #9ca3af; border-bottom: 1px solid #2a2a2a;">
                                <span style="text-decoration: underline;">${isExpanded ? 'Featured only' : 'Expand all'}</span>
                            </div>
                        `;
                    }
                    
                    // Filter games for this date based on its expand state
                    const datesToShow = isExpanded ? gamesByDate[dateStr] : gamesByDate[dateStr].filter(g => g.isImportant);
                    
                    datesToShow.forEach(game => {
                        // Parse time as EST and convert to user's local time (or keep TBD)
                        let displayTime = game.time;
                        if (game.time && game.time.toUpperCase() !== 'TBD') {
                            const estTime = luxon.DateTime.fromFormat(game.time, 'h:mm a', { zone: 'America/New_York' });
                            if (estTime.isValid) {
                                const localTime = estTime.setZone('local');
                                displayTime = localTime.toFormat('h:mm a');
                            }
                        }
                        
                        // Determine display order based on league type
                        const isSoccerLeague = ['LaLiga', 'Premier League', 'Bundesliga', 'Serie A', 'Ligue 1', 'Ligue1', 'MLS', 'LigaMX', 'FA Cup', 'Copa del Rey', 'DFB-Pokal', 'Coppa Italia'].includes(leagueKey);
                        
                        let topTeam, bottomTeam;
                        if (isSoccerLeague) {
                            // Soccer: Home team on top, away team on bottom
                            topTeam = game.home;
                            bottomTeam = game.away;
                        } else {
                            // Other sports (NFL, etc.): Away team on top, home team on bottom
                            topTeam = getMascotName(game.away);
                            bottomTeam = getMascotName(game.home);
                        }
                        
                        // Apply Top 25 rankings for NCAA leagues
                        if (isNcaaLeague) {
                            topTeam = formatTeamNameWithRanking(topTeam, leagueKey);
                            bottomTeam = formatTeamNameWithRanking(bottomTeam, leagueKey);
                        }
                        
                        html += `
                            <div style="display: flex; align-items: center; padding: 8px 10px; border-bottom: 1px solid #2a2a2a; font-size: 11px;">
                                <div style="width: 80px; flex-shrink: 0; color: #9ca3af;">${displayTime}</div>
                                <div style="flex: 1; display: flex; flex-direction: column; gap: 2px;">
                                    <div>${topTeam}</div>
                                    <div>${bottomTeam}</div>
                                </div>
                                ${game.channel ? `<div style="width: 80px; text-align: right; color: #9ca3af; flex-shrink: 0;">${game.channel}</div>` : ''}
                            </div>
                        `;
                    });
                });
                
                return html;
            }
            
            // Function to attach toggle handlers
            function attachToggleHandlers() {
                const toggleButtons = defaultContent.querySelectorAll('.upcoming-schedule-toggle');
                toggleButtons.forEach((button) => {
                    button.addEventListener('click', (e) => {
                        const dateStr = button.getAttribute('data-date');
                        
                        // Get the clicked button's offset from the top of the container
                        const buttonOffsetFromTop = button.offsetTop - defaultContent.scrollTop;
                        
                        // Toggle the state for this specific date
                        dateExpandStates[dateStr] = !dateExpandStates[dateStr];
                        
                        defaultContent.innerHTML = renderSchedule();
                        
                        // Find the corresponding toggle button for this date after re-render
                        const newToggleButton = defaultContent.querySelector(`.upcoming-schedule-toggle[data-date="${dateStr}"]`);
                        if (newToggleButton) {
                            // Calculate the new scroll position to maintain the visual position of the clicked toggle
                            const targetScrollTop = newToggleButton.offsetTop - buttonOffsetFromTop;
                            defaultContent.scrollTop = targetScrollTop;
                        }
                        
                        attachToggleHandlers(); // Re-attach handlers after re-render
                    });
                });
            }
            
            // Initial render
            if (defaultContent) {
                defaultContent.innerHTML = renderSchedule();
                
                // Add click handlers for all toggle buttons
                if (isNcaaLeague && nonFeaturedGamesCount > 0) {
                    attachToggleHandlers();
                }
            }
            return;
        }

        const leagueInfo = LEAGUE_DATA_CONFIG[leagueKey];
        if (!leagueInfo || !leagueInfo.upcomingCollectionName) {
            if (defaultContent) {
                defaultContent.innerHTML = '<p style="color: #9ca3af;">Upcoming schedule is not available for this league.</p>';
            }
            return;
        }

        if (defaultContent) {
            defaultContent.innerHTML = '<p style="color: #9ca3af;">Loading upcoming schedule...</p>';
        }
        const upcomingCollectionRef = db.collection(leagueInfo.upcomingCollectionName);

        upcomingCollectionRef.get().then(snapshot => {
            const now = luxon.DateTime.now().toMillis();
            let games = [];
        
            snapshot.forEach(doc => {
                const data = doc.data();
            
            // Get field names based on league type
            let awayField, homeField, timeField, dateField;
            
            if (leagueKey === 'PremierLeague') {
                awayField = 'away';
                homeField = 'home';
                timeField = 'time';
                dateField = 'date';
            } else if (['Bundesliga', 'LaLiga', 'LigaMX', 'MLB', 'NBA', 'NCAAM', 'NCAAW', 'NCAABaseball', 'NCAASoftball', 'NFL', 'NHL', 'NWSL', 'SerieA', 'UEFAChampionsLeague', 'AFCChampionsLeague', 'UEFAConferenceLeague', 'UEFAEuropaLeague', 'WNBA', 'FACup'].includes(leagueKey)) {
                awayField = 'away';
                homeField = 'home';
                timeField = 'time';
                dateField = 'date';
            } else if (leagueKey === 'MLS') {
                awayField = 'away';
                homeField = 'home';
                timeField = 'time';
                dateField = 'date';
            } else if (['Boxing', 'UFC'].includes(leagueKey)) {
                // Boxing and UFC now use 'home' and 'away' fields like other leagues
                awayField = 'away';
                homeField = 'home';
                timeField = 'time';
                dateField = 'date';
            } else if (['LIVGolf'].includes(leagueKey)) {
                awayField = 'event';
                homeField = 'event';
                timeField = 'time';
                dateField = 'date';
            } else if (leagueKey === 'MotoGP') {
                awayField = 'away';
                homeField = 'home';
                timeField = 'time';
                dateField = 'date';
            } else if (['LPGATour', 'PGATour'].includes(leagueKey)) {
                // Special handling: data structure has dateRange, tournament, and rounds array
                // Skip standard field mapping - will handle separately
                awayField = null;
                homeField = null;
                timeField = null;
                dateField = null;
            } else if (leagueKey === 'FormulaOne') {
                awayField = 'away';
                homeField = 'home';
                timeField = 'time';
                dateField = 'date';
            } else if (leagueKey === 'NASCARCupSeries') {
                awayField = 'race';
                homeField = 'location';
                timeField = 'time';
                dateField = 'date';
            } else if (leagueKey === 'Tennis') {
                awayField = 'tournament';
                homeField = 'tour';
                timeField = 'time';
                dateField = 'date';
            } else if (leagueKey === 'TrackAndField') {
                awayField = 'meet';
                homeField = 'meet';
                timeField = 'time';
                dateField = 'date';
            } else {
                // Default fallback
                awayField = 'away';
                homeField = 'home';
                timeField = 'time';
                dateField = 'date';
            }

            // Special handling for PGATour and LPGATour
            if (['LPGATour', 'PGATour'].includes(leagueKey) && data.tournament && data.rounds && Array.isArray(data.rounds)) {
                // Parse date range
                const startDate = data.startDate ? luxon.DateTime.fromISO(data.startDate) : null;
                const endDate = data.endDate ? luxon.DateTime.fromISO(data.endDate) : null;
                
                if (!startDate || !startDate.isValid) {
                    return;
                }
                
                // Show tournaments from today onwards
                const today = luxon.DateTime.now().startOf('day');
                if (endDate && endDate < today) {
                    return;
                }
                
                // Format date range header
                let dateRangeHeader = '';
                if (startDate && endDate && startDate.toISODate() !== endDate.toISODate()) {
                    const startFormatted = startDate.toFormat('MMMM d');
                    const endDay = endDate.toFormat('d');
                    dateRangeHeader = `${startFormatted}-${endDay}`;
                } else if (startDate) {
                    dateRangeHeader = startDate.toFormat('MMMM d');
                }
                
                games.push({
                    dateHeader: dateRangeHeader,
                    tournament: data.tournament,
                    rounds: data.rounds,
                    gameDate: startDate,
                    isGolfTournament: true
                });
                return;
            }

            const away = data[awayField] || "";
            const home = data[homeField] || "";
            let timeStr = "";

            if (data[timeField]) {
                if (typeof data[timeField] === "object" && typeof data[timeField].toDate === "function") {
                    // Firestore Timestamp - treat as Eastern time and convert to local
                    const jsDate = data[timeField].toDate();
                    const easternTime = luxon.DateTime.fromJSDate(jsDate, { zone: 'America/New_York' });
                    const localTime = easternTime.toLocal();
                    timeStr = localTime.toFormat('h:mm a');
                    
                } else {
                    // String time - treat as Eastern time and convert to local
                    const timeString = String(data[timeField]).replace(/"/g, "");
                    if (timeString) {
                        // Parse as Eastern time with seconds format, then convert to local
                        let easternTime = luxon.DateTime.fromFormat(timeString, 'h:mm:ss a', { zone: 'America/New_York' });
                        
                        // If that doesn't work, try without seconds
                        if (!easternTime.isValid) {
                            easternTime = luxon.DateTime.fromFormat(timeString, 'h:mm a', { zone: 'America/New_York' });
                        }
                        
                        if (easternTime.isValid) {
                            const localTime = easternTime.toLocal();
                            timeStr = localTime.toFormat('h:mm a');
                        } else {
                            timeStr = timeString; // fallback
                        }
                    }
                }
            }

                let gameDate;

            if (data[dateField] && typeof data[dateField] === "object" && typeof data[dateField].toDate === "function") {
                // Handle Firestore Timestamp (legacy)
                gameDate = luxon.DateTime.fromJSDate(data[dateField].toDate());
            } else if (typeof data[dateField] === "string") {
                // Handle new YYYY-MM-DD format
                if (data[dateField].match(/^\d{4}-\d{2}-\d{2}$/)) {
                    gameDate = luxon.DateTime.fromISO(data[dateField]);
                } else {
                    // Handle legacy formats
                    let cleaned = data[dateField].replace(" at ", " ").replace(/ UTC[-+]\d+/, "");
                    gameDate = luxon.DateTime.fromFormat(cleaned, "LLLL d, yyyy h:mm:ss.SSS a", { zone: 'America/New_York' });
                    if (!gameDate.isValid) {
                        let dateOnly = data[dateField].split(" at ")[0];
                        gameDate = luxon.DateTime.fromFormat(dateOnly, "LLLL d, yyyy", { zone: 'America/New_York' });
                        if (!gameDate.isValid) {
                            // Try parsing just month and day (assume current year)
                            gameDate = luxon.DateTime.fromFormat(dateOnly, "LLLL d", { zone: 'America/New_York' });
                            if (gameDate.isValid) {
                                // Set to current year if not specified
                                gameDate = gameDate.set({ year: luxon.DateTime.now().year });
                            }
                        }
                    }
                }
            }

            if (!gameDate || !gameDate.isValid) {
                return;
            }
            
            // Show games from today onwards (not just future games)
            const today = luxon.DateTime.now().startOf('day');
            if (gameDate < today) {
                return;
            }

                games.push({
                    dateHeader: gameDate.toFormat('MMMM d, yyyy'),
                    time: timeStr || gameDate.toFormat('h:mm a'),
                    away,
                    home,
                    gameDate,
                    channel: data.channel || '',
                    gameId: doc.id
                });
            });
        
            console.log(`NHL: Processed ${games.length} games after filtering`);
            if (games.length === 0) {
                // Don't overwrite Tennis sub-tabs - use default content instead
                const defaultContent = document.getElementById('league-schedule-upcoming-default-content');
                if (defaultContent && defaultContent.style.display !== 'none') {
                    defaultContent.innerHTML = "<p>No upcoming games found.</p>";
                } else {
                upcomingScheduleContent.innerHTML = "<p>No upcoming games found.</p>";
                }
                console.log('NHL: No games after processing - check date filtering logic');
                return;
            }
        
            // Separate golf tournaments from regular games
            const golfTournaments = games.filter(g => g.isGolfTournament);
            const regularGames = games.filter(g => !g.isGolfTournament);
            
            // Sort golf tournaments by start date
            golfTournaments.sort((a, b) => a.gameDate - b.gameDate);
            // Sort regular games by date
            regularGames.sort((a, b) => a.gameDate - b.gameDate);
            
            // Group golf tournaments by date header
            const golfByDate = {};
            golfTournaments.forEach(g => {
                if (!golfByDate[g.dateHeader]) golfByDate[g.dateHeader] = [];
                golfByDate[g.dateHeader].push(g);
            });
            
            // Group regular games by date
            const gamesByDate = {};
            regularGames.forEach(g => {
                if (!gamesByDate[g.dateHeader]) gamesByDate[g.dateHeader] = [];
                gamesByDate[g.dateHeader].push(g);
            });
        
        
            let html = "";
        
        // Handle golf tournaments separately if this is a golf league
        if (['LPGATour', 'PGATour'].includes(leagueKey) && Object.keys(golfByDate).length > 0) {
            // Sort golf tournament date headers
            const sortedGolfHeaders = Object.keys(golfByDate).sort((a, b) => {
                // Try to parse as date range or single date
                const parseGolfDate = (header) => {
                    // Try to extract start date from range like "November 13-16, 2025" or "November 13, 2025"
                    const match = header.match(/(\w+)\s+(\d+)/);
                    if (match) {
                        const month = match[1];
                        const day = parseInt(match[2]);
                        const year = new Date().getFullYear();
                        return luxon.DateTime.fromObject({ month: luxon.DateTime.fromFormat(month, 'MMMM').month, day, year });
                    }
                    return luxon.DateTime.now();
                };
                return parseGolfDate(a) - parseGolfDate(b);
            });
            
            sortedGolfHeaders.forEach(dateHeader => {
                // Show date range header for golf tournaments
                html += `<div class="date-header" style="background-color: #d1d5db; color: #000; padding: 0px 12px; margin: 8px 0 4px 0; font-weight: normal; font-size: 11px; line-height: 18px;">${dateHeader}</div>`;
                
                // Display golf tournaments (no table, custom format)
                golfByDate[dateHeader].forEach(game => {
                    if (game.isGolfTournament && game.tournament && game.rounds) {
                        // Tournament header
                        html += `<div class="tournament-header" style="padding: 8px 12px; border-bottom: 1px solid #374151; background-color: #1f2937;">`;
                        html += `<div class="tournament-name" style="color: white; font-size: 11px; font-weight: bold; margin-bottom: 4px;">${game.tournament}</div>`;
                        html += `</div>`;
                        
                        // Display each round
                        game.rounds.forEach((round, index) => {
                            const dayDisplay = round.day || '';
                            const roundName = round.round || '';
                            const timeDisplay = round.time || '';
                            const channelDisplay = round.channel || '';
                            
                            html += `
                                <div class="round-row" style="display: flex; justify-content: space-between; align-items: center; padding: 6px 12px; border-bottom: ${index < game.rounds.length - 1 ? '1px solid #374151' : 'none'}; background-color: #1f2937;">
                                    <div class="round-info" style="flex: 1; display: flex; gap: 12px;">
                                        ${dayDisplay ? `<span style="color: white; font-size: 11px;">${dayDisplay}</span>` : ''}
                                        <span style="color: white; font-size: 11px;">${roundName}</span>
                                        ${timeDisplay ? `<span style="color: #9ca3af; font-size: 10px;">${timeDisplay}</span>` : ''}
                                        ${channelDisplay ? `<span style="color: #9ca3af; font-size: 10px;">${channelDisplay}</span>` : ''}
                                    </div>
                                </div>
                            `;
                        });
                        html += `<div style="margin-bottom: 20px;"></div>`;
                    }
                });
            });
        }
        
        // Sort date headers chronologically for regular games
        const sortedDateHeaders = Object.keys(gamesByDate).sort((a, b) => {
            const dateA = luxon.DateTime.fromFormat(a, 'MMMM d, yyyy');
            const dateB = luxon.DateTime.fromFormat(b, 'MMMM d, yyyy');
            return dateA - dateB;
        });
        
        // Filter out today's date from upcoming games
        const today = luxon.DateTime.now().toFormat('MMMM d, yyyy');
        const filteredDateHeaders = sortedDateHeaders.filter(dateHeader => dateHeader !== today);
        
        filteredDateHeaders.forEach(dateHeader => {
            // Format date header to match screenshot (e.g., "September 4")
            const dateObj = luxon.DateTime.fromFormat(dateHeader, 'MMMM d, yyyy');
            const formattedDate = dateObj.isValid ? dateObj.toFormat('MMMM d') : dateHeader;
            
            // Always show the date header
            html += `<div class="date-header" style="background-color: #d1d5db; color: #000; padding: 0px 12px; margin: 8px 0 4px 0; font-weight: normal; font-size: 11px; line-height: 18px;">${formattedDate}</div>`;
            
            // Create table for this date's games (same structure as renderGames)
            html += '<table style="width: 100%; border-collapse: collapse; margin-bottom: 20px; table-layout: fixed;">';
            
            // Add colgroup with percentage widths to match renderGames
            html += `
                <colgroup>
                    <col style="width: 32%;">   <!-- time -->
                    <col style="width: 32%;">  <!-- team -->
                    <col style="width: 10%;">   <!-- score -->
                    <col style="width: 26%;">   <!-- channel -->
                </colgroup>
            `;
            
            // Sort games by time within each date for ALL leagues
            const sortedGames = gamesByDate[dateHeader].sort((a, b) => {
                // Parse time strings to compare them
                const timeA = a.time || '';
                const timeB = b.time || '';
                
                // Convert time to 24-hour format for comparison
                const parseTime = (timeStr) => {
                    if (!timeStr) return 9999; // Put games without times at the end
                    const match = timeStr.match(/(\d{1,2}):(\d{2})\s*(AM|PM)/i);
                    if (!match) return 9999; // Put invalid times at the end
                    
                    let hours = parseInt(match[1]);
                    const minutes = parseInt(match[2]);
                    const ampm = match[3].toUpperCase();
                    
                    if (ampm === 'PM' && hours !== 12) hours += 12;
                    if (ampm === 'AM' && hours === 12) hours = 0;
                    
                    return hours * 60 + minutes;
                };
                
                return parseTime(timeA) - parseTime(timeB);
            });
            
            let lastDisplayedTimeLabel = null;
            let previousGameTimeLabel = null; // Track previous game's time for separator logic

            sortedGames.forEach((game, gameIndex) => {
                // Format for specified leagues: Use same table format as Today tab
                if (['NFL', 'NBA', 'MLB', 'NHL', 'NCAAF', 'WNBA', 'NCAAM', 'NCAAW', 'NCAABaseball', 'NCAASoftball', 'Boxing', 'UFC'].includes(leagueKey)) {
                    const isUFCOrBoxing = leagueKey === 'UFC' || leagueKey === 'Boxing';
                    const isSubItem = game.isSubItem === true; // Check if this is a sub-item
                    
                    let timeDisplayRaw = '';
                    if (isUFCOrBoxing && isSubItem) {
                        // Sub-item: no time displayed
                        timeDisplayRaw = '';
                    } else {
                        timeDisplayRaw = (game.time && game.time !== '12:00 AM' ? game.time : (game.time === '' || game.time === '12:00 AM' ? 'TBD' : ''));
                    }
                    
                    let displayTimeLabel = timeDisplayRaw;
                    const normalizedTimeLabel = normalizeDisplayTime(timeDisplayRaw);
                    if (normalizedTimeLabel && normalizedTimeLabel !== 'TBD') {
                        if (normalizedTimeLabel === lastDisplayedTimeLabel) {
                            displayTimeLabel = '';
                        } else {
                            lastDisplayedTimeLabel = normalizedTimeLabel;
                        }
                    }
                    // Use Tennis Channel for ATP leagues
                    let channelToDisplay = game.channel || '';
                    if (game.League && game.League.includes('ATP')) {
                        channelToDisplay = 'Tennis Channel';
                    }
                    const channelDisplay = channelToDisplay;
                    
                    // Use getTeamDisplayName to match home page formatting
                    const gameLeague = game.League || '';
                    const gameSport = game.Sport || '';
                    const displayLeague = getLeagueDisplayName(gameLeague, gameSport);
                    let gameLeagueKey = getLeagueKeyFromGame(game);
                    if (!gameLeagueKey) {
                        gameLeagueKey = leagueKey;
                    }
                    const awayDisplay = getTeamDisplayName(game.away || '', displayLeague);
                    const homeDisplay = getTeamDisplayName(game.home || '', displayLeague);
                    let awayTeam = formatTeamNameWithRanking(awayDisplay, gameLeagueKey);
                    let homeTeam = formatTeamNameWithRanking(homeDisplay, gameLeagueKey);
                    
                    // For UFC and Boxing: handle sub-items (gray text) vs main items (white text)
                    let awayColor = '';
                    let homeColor = '';
                    if (isUFCOrBoxing && isSubItem) {
                        // Sub-item: gray text
                        awayColor = 'color: #C0C0C0;';
                        homeColor = 'color: #C0C0C0;';
                    }
                    
                    // Use EXACT same table format as renderGames function (10px font for time column in league-specific column)
                    html += `
                        <tr class="game-row scheduled-game">
                            <td rowspan="2" style="text-align: left; font-size: 10px; vertical-align: top; padding: 2px 1px; box-sizing: border-box;">${displayTimeLabel}</td>
                            <td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 11px; box-sizing: border-box; max-width: 0; ${awayColor}">${awayTeam}</td>
                            <td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box;"></td>
                            <td rowspan="2" style="position: relative; text-align: center; font-size: 10px; color: #9ca3af; padding: 2px 1px; box-sizing: border-box;"><div style="position: absolute; top: 35%; left: 50%; transform: translate(-50%, -50%);">${channelDisplay}</div></td>
                        </tr>
                        <tr class="game-row game-separator scheduled-game">
                            <td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 11px; box-sizing: border-box; max-width: 0; ${homeColor}">${homeTeam}</td>
                            <td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box;"></td>
                        </tr>
                    `;
                    
                    // Add separator line between games (but not after the last game)
                    if (gameIndex < sortedGames.length - 1) {
                        const nextGame = sortedGames[gameIndex + 1];
                        const nextTimeDisplayRaw = (nextGame.time && nextGame.time !== '12:00 AM') ? nextGame.time : (nextGame.time === '' || nextGame.time === '12:00 AM' ? 'TBD' : '');
                        const nextNormalizedTimeLabel = normalizeDisplayTime(nextTimeDisplayRaw);
                        const nextGameTimeLabel = nextNormalizedTimeLabel || nextTimeDisplayRaw;
                        
                        // Check if next game has a different start time from current game
                        const currentGameTimeLabel = normalizedTimeLabel || timeDisplayRaw;
                        const isDifferentTime = nextGameTimeLabel !== currentGameTimeLabel;
                        
                        // If next game has different time, full width (colspan="4"), otherwise partial width (colspan="3")
                        const colspan = isDifferentTime ? 4 : 3;
                        const firstCell = isDifferentTime ? '' : '<td style="padding: 0; border: none; width: 32%;"></td>';
                        
                        html += `<tr class="game-separator-line">${firstCell}<td colspan="${colspan}" style="padding: 0 0 10px 0; border: none;"><div style="border-top: 1px solid #000000; margin: 0;"></div></td></tr>`;
                    }
                    
                    // Update previous game time label for next iteration
                    previousGameTimeLabel = normalizedTimeLabel || timeDisplayRaw;
                } else if (['Bundesliga', 'LaLiga', 'LigaMX', 'Ligue1', 'MLS', 'NWSL', 'PremierLeague', 'SerieA', 'UEFAEuropaLeague', 'UEFAChampionsLeague', 'UEFAConferenceLeague', 'AFCChampionsLeague', 'FIFAWorldCupAfricanQualifiers', 'FIFAWorldCupEuropeanQualifiers', '2027AFCAsianCupQualifiers', 'FIFAWorldCupAsianQualifiers', 'FIFAWorldCupCONCACAFQualifiers', 'ClubFriendly', 'FACup'].includes(leagueKey)) {
                    // Format for soccer leagues: Use same table format as home page (soccer shows home on top, away on bottom)
                    const timeDisplayRaw = game.time && game.time !== '12:00 AM' ? game.time : (game.time === '' || game.time === '12:00 AM' ? 'TBD' : '');
                    let displayTimeLabel = timeDisplayRaw;
                    const normalizedTimeLabel = normalizeDisplayTime(timeDisplayRaw);
                    if (normalizedTimeLabel && normalizedTimeLabel !== 'TBD') {
                        if (normalizedTimeLabel === lastDisplayedTimeLabel) {
                            displayTimeLabel = '';
                        } else {
                            lastDisplayedTimeLabel = normalizedTimeLabel;
                        }
                    }
                    // Use Tennis Channel for ATP leagues
                    let channelToDisplay = game.channel || '';
                    if (game.League && game.League.includes('ATP')) {
                        channelToDisplay = 'Tennis Channel';
                    }
                    const channelDisplay = channelToDisplay;
                    
                    // Use getTeamDisplayName to match home page formatting
                    const gameLeague = game.League || '';
                    const gameSport = game.Sport || '';
                    const displayLeague = getLeagueDisplayName(gameLeague, gameSport);
                    let gameLeagueKey = getLeagueKeyFromGame(game);
                    if (!gameLeagueKey) {
                        gameLeagueKey = leagueKey;
                    }
                    const homeDisplay = getTeamDisplayName(game.home || '', displayLeague);
                    const awayDisplay = getTeamDisplayName(game.away || '', displayLeague);
                    const homeTeam = formatTeamNameWithRanking(homeDisplay, gameLeagueKey);
                    const awayTeam = formatTeamNameWithRanking(awayDisplay, gameLeagueKey);
                    
                    // Use EXACT same table format as renderGames function for soccer (10px font for time column in league-specific column)
                    html += `
                        <tr class="game-row scheduled-game">
                            <td rowspan="2" style="text-align: left; font-size: 10px; vertical-align: top; padding: 2px 1px; box-sizing: border-box;">${displayTimeLabel}</td>
                            <td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 11px; box-sizing: border-box; max-width: 0;">${homeTeam}</td>
                            <td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box;"></td>
                            <td rowspan="2" style="position: relative; text-align: center; font-size: 10px; color: #9ca3af; padding: 2px 1px; box-sizing: border-box;"><div style="position: absolute; top: 35%; left: 50%; transform: translate(-50%, -50%);">${channelDisplay}</div></td>
                        </tr>
                        <tr class="game-row game-separator scheduled-game">
                            <td class="team-cell" style="padding: 2px 1px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-size: 11px; box-sizing: border-box; max-width: 0;">${awayTeam}</td>
                            <td style="text-align: right; padding: 2px 1px; font-size: 11px; box-sizing: border-box;"></td>
                        </tr>
                    `;
                    
                    // Add separator line between games (but not after the last game)
                    if (gameIndex < sortedGames.length - 1) {
                        const nextGame = sortedGames[gameIndex + 1];
                        const nextTimeDisplayRaw = nextGame.time && nextGame.time !== '12:00 AM' ? nextGame.time : (nextGame.time === '' || nextGame.time === '12:00 AM' ? 'TBD' : '');
                        const nextNormalizedTimeLabel = normalizeDisplayTime(nextTimeDisplayRaw);
                        const nextGameTimeLabel = nextNormalizedTimeLabel || nextTimeDisplayRaw;
                        
                        // Check if next game has a different start time from current game
                        const currentGameTimeLabel = normalizedTimeLabel || timeDisplayRaw;
                        const isDifferentTime = nextGameTimeLabel !== currentGameTimeLabel;
                        
                        // If next game has different time, full width (colspan="4"), otherwise partial width (colspan="3")
                        const colspan = isDifferentTime ? 4 : 3;
                        const firstCell = isDifferentTime ? '' : '<td style="padding: 0; border: none; width: 32%;"></td>';
                        
                        html += `<tr class="game-separator-line">${firstCell}<td colspan="${colspan}" style="padding: 0 0 10px 0; border: none;"><div style="border-top: 1px solid #000000; margin: 0;"></div></td></tr>`;
                    }
                    
                    // Update previous game time label for next iteration
                    previousGameTimeLabel = normalizedTimeLabel || timeDisplayRaw;
                } else if (['Boxing'].includes(leagueKey)) {
                    // Boxing: Group by event, show event as subheader, then all boxer matchups under it
                    const currentEvent = game.away; // awayField = 'event' - this is the event name
                    const currentGameIndex = gamesByDate[dateHeader].indexOf(game);
                    const lastEvent = currentGameIndex > 0 ? gamesByDate[dateHeader][currentGameIndex - 1]?.away : null;
                    
                    // If this is a new event, add event header
                    if (currentEvent !== lastEvent) {
                        html += `<div class="event-header" style="background-color: #9ca3af; color: #000; padding: 4px 12px; margin: 4px 0 2px 0; font-weight: normal; font-size: 10px; line-height: 16px;">${currentEvent}</div>`;
                    }
                    
                    // Add boxer matchup
                    const boxingTime = (game.time && game.time !== '12:00 AM') ? game.time : '';
                    html += `
                        <div class="match-row" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 6px 12px; border-bottom: none;">
                            <div class="teams" style="flex: 1; margin-right: 8px;">
                                <div class="boxers" style="color: white; font-size: 11px; line-height: 1.4;">${game.home}</div>
                            </div>
                            <div class="time" style="color: white; font-size: 11px; font-weight: normal; margin-top: 4px;">${boxingTime}</div>
                        </div>
                    `;
                } else if (['Tennis'].includes(leagueKey)) {
                    // Tennis: Tour on top, Tournament on bottom, no time
                    html += `
                        <div class="match-row" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 8px 12px; border-bottom: none;">
                            <div class="teams" style="flex: 1; margin-right: 8px;">
                                <div class="tour" style="color: white; font-size: 11px; line-height: 1.4; margin-bottom: 4px;">${game.home}</div>
                                <div class="tournament" style="color: white; font-size: 11px; line-height: 1.4;">${game.away}</div>
                            </div>
                            <div class="time" style="color: white; font-size: 11px; font-weight: normal; margin-top: 4px;"></div>
                        </div>
                    `;
                } else if (['LIVGolf', 'UFC'].includes(leagueKey)) {
                    // LIVGolf, UFC: Event on top, blank on bottom, time on right
                    // Use Tennis Channel for ATP leagues
                    let channelToDisplay = game.channel || '';
                    if (game.League && game.League.includes('ATP')) {
                        channelToDisplay = 'Tennis Channel';
                    }
                    const channelDisplay = channelToDisplay;
                    const timeDisplay = game.time && game.time !== '12:00 AM' ? game.time : (game.time === '' || game.time === '12:00 AM' ? 'TBD' : '');
                    html += `
                        <div class="match-row" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 8px 12px; border-bottom: none;">
                            <div class="teams" style="flex: 1; margin-right: 8px;">
                                <div class="event" style="color: white; font-size: 11px; line-height: 1.4; margin-bottom: 4px;">${game.home}</div>
                                <div class="blank" style="color: white; font-size: 11px; line-height: 1.4;"></div>
                            </div>
                            <div class="time" style="color: white; font-size: 11px; font-weight: normal; margin-top: 4px; display: flex; flex-direction: column; align-items: flex-end;">
                                <div>${timeDisplay}</div>
                                ${channelDisplay ? `<div style="color: #9ca3af; font-size: 10px; margin-top: 2px;">${channelDisplay}</div>` : ''}
                            </div>
                        </div>
                    `;
                } else if (leagueKey === 'MotoGP') {
                    // MotoGP: Grand Prix on top, Race type on bottom, time on right
                    html += `
                        <div class="match-row" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 8px 12px; border-bottom: none;">
                            <div class="teams" style="flex: 1; margin-right: 8px;">
                                <div class="event" style="color: white; font-size: 11px; line-height: 1.4; margin-bottom: 4px;">${game.home}</div>
                                <div class="race-type" style="color: white; font-size: 11px; line-height: 1.4;">${game.away}</div>
                            </div>
                            <div class="time" style="color: white; font-size: 11px; font-weight: normal; margin-top: 4px;">${game.time && game.time !== '12:00 AM' ? game.time : (game.time === '' || game.time === '12:00 AM' ? 'TBD' : '')}</div>
                        </div>
                    `;
                } else if (['FormulaOne'].includes(leagueKey)) {
                    // FormulaOne: Grand Prix on top, Event type on bottom, time on right
                    html += `
                        <div class="match-row" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 8px 12px; border-bottom: none;">
                            <div class="teams" style="flex: 1; margin-right: 8px;">
                                <div class="event" style="color: white; font-size: 11px; line-height: 1.4; margin-bottom: 4px;">${game.home}</div>
                                <div class="event-type" style="color: white; font-size: 11px; line-height: 1.4;">${game.away}</div>
                            </div>
                            <div class="time" style="color: white; font-size: 11px; font-weight: normal; margin-top: 4px;">${game.time && game.time !== '12:00 AM' ? game.time : (game.time === '' || game.time === '12:00 AM' ? 'TBD' : '')}</div>
                        </div>
                    `;
                } else if (['LPGATour', 'PGATour'].includes(leagueKey)) {
                    // LPGATour, PGATour: Skip in table format - handled separately above
                    // This should not be reached for golf tournaments, but keep fallback
                    if (!game.isGolfTournament) {
                    html += `
                        <div class="match-row" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 8px 12px; border-bottom: none;">
                            <div class="teams" style="flex: 1; margin-right: 8px;">
                                    <div class="tournament" style="color: white; font-size: 11px; line-height: 1.4; margin-bottom: 4px;">${game.home || ''}</div>
                                <div class="blank" style="color: white; font-size: 11px; line-height: 1.4;"></div>
                            </div>
                            <div class="time" style="color: white; font-size: 11px; font-weight: normal; margin-top: 4px;"></div>
                        </div>
                    `;
                    }
                } else if (['NASCARCupSeries'].includes(leagueKey)) {
                    // NASCARCupSeries: Race on top, Location on bottom, time on right
                    html += `
                        <div class="match-row" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 8px 12px; border-bottom: none;">
                            <div class="teams" style="flex: 1; margin-right: 8px;">
                                <div class="race" style="color: white; font-size: 11px; line-height: 1.4; margin-bottom: 4px;">${game.away}</div>
                                <div class="location" style="color: white; font-size: 11px; line-height: 1.4;">${game.home}</div>
                            </div>
                            <div class="time" style="color: white; font-size: 11px; font-weight: normal; margin-top: 4px;">${game.time && game.time !== '12:00 AM' ? game.time : (game.time === '' || game.time === '12:00 AM' ? 'TBD' : '')}</div>
                        </div>
                    `;
                } else if (['TrackAndField'].includes(leagueKey)) {
                    // TrackAndField: Meet on top, blank on bottom, no time
                    html += `
                        <div class="match-row" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 8px 12px; border-bottom: none;">
                            <div class="teams" style="flex: 1; margin-right: 8px;">
                                <div class="meet" style="color: white; font-size: 11px; line-height: 1.4; margin-bottom: 4px;">${game.home}</div>
                                <div class="blank" style="color: white; font-size: 11px; line-height: 1.4;"></div>
                            </div>
                            <div class="time" style="color: white; font-size: 11px; font-weight: normal; margin-top: 4px;"></div>
                        </div>
                    `;
                } else {
                    // Default format for other leagues
                    html += `<div class="match-row"><span class="team">${game.away}</span><span class="team">at ${game.home}</span><span class="time">${game.time && game.time !== '12:00 AM' ? game.time : (game.time === '' || game.time === '12:00 AM' ? 'TBD' : '')}</span></div>`;
                }
                });
            
            // Close the table for this date
            html += '</table>';
            });
        
        // Only update content if we're still on the same league
        const currentLeagueHeader = document.getElementById('league-specific-header');
        const currentLeagueKey = currentLeagueHeader ? currentLeagueHeader.innerText.trim() : null;
        const normalizedCurrentKey = currentLeagueKey ? currentLeagueKey.trim() : '';
        
        if (currentLeagueKey === leagueKey || normalizedCurrentKey === leagueKey) {
            // Don't overwrite Tennis sub-tabs - use default content instead
            const defaultContent = document.getElementById('league-schedule-upcoming-default-content');
            if (normalizedCurrentKey === 'Tennis') {
                // Should not reach here for Tennis (should return early), but just in case, don't overwrite
                return;
            }
            if (defaultContent && defaultContent.style.display !== 'none') {
                defaultContent.innerHTML = html;
            } else {
            upcomingScheduleContent.innerHTML = html;
            }
        }
        }).catch(error => {
        // Only update content if we're still on the same league
        const currentLeagueHeader = document.getElementById('league-specific-header');
        const currentLeagueKey = currentLeagueHeader ? currentLeagueHeader.innerText.trim() : null;
        if (currentLeagueKey === leagueKey) {
            // Don't overwrite Tennis sub-tabs - use default content instead
            const defaultContent = document.getElementById('league-schedule-upcoming-default-content');
            if (defaultContent && defaultContent.style.display !== 'none') {
                defaultContent.innerHTML = `<div class="error" style="color: #c00;">Error loading schedule: ${error.message}</div>`;
            } else {
            upcomingScheduleContent.innerHTML = `<div class="error" style="color: #c00;">Error loading schedule: ${error.message}</div>`;
            }
        }
        });
    }


    // --- 7. TABS AND FILTER INITIALIZATION ---
function initializeTabsAndFilters() {
    const gamesTabsContainer = document.getElementById('games-tabs');
    if (!gamesTabsContainer) {
        console.warn('⚠️ games-tabs container not found, retrying in 100ms...');
        setTimeout(initializeTabsAndFilters, 100);
        return;
    }
    
    // Use event delegation - attach ONE listener to container that handles all tab clicks
    // This survives DOM replacement, re-renders, and async loads
    gamesTabsContainer.addEventListener('click', (e) => {
        const clickedTab = e.target.closest('.games-tab');
        if (!clickedTab) return;
        
        e.preventDefault();
        e.stopPropagation();
        
        const tabId = clickedTab.dataset.tab || clickedTab.id;
        console.log('🎯 Tab clicked:', tabId);
        
        const todayTab = gamesTabsContainer.querySelector('.games-tab[data-tab="today"]');
        const scoresTab = gamesTabsContainer.querySelector('.games-tab[data-tab="scores"]');
        const liveFilter = document.getElementById('live-filter-toggle');
        
        const todayContainer = document.getElementById('tv-listings-today');
        const scoresContainer = document.getElementById('tv-listings-scores');
        
        let activeListenerUnsubscribe = window.activeListenerUnsubscribe || null;
        
        // Handle TODAY tab - BULLETPROOF VERSION
        if (clickedTab.dataset.tab === 'today') {
            console.log('📅 Switching to TODAY tab...');
            
            // Step 1: Update tab styling
            if (scoresTab) scoresTab.classList.remove('active');
            if (liveFilter) liveFilter.classList.remove('active');
            clickedTab.classList.add('active');
            
            // Step 2: Unsubscribe from previous listener (CRASH-PROOF: check if it's a function)
            if (activeListenerUnsubscribe && typeof activeListenerUnsubscribe === 'function') {
                activeListenerUnsubscribe();
                activeListenerUnsubscribe = null;
                window.activeListenerUnsubscribe = null;
            } else if (activeListenerUnsubscribe) {
                // It's a Promise or something else, just clear it
                activeListenerUnsubscribe = null;
                window.activeListenerUnsubscribe = null;
            }
            
            // Step 3: FORCE hide scores container (multiple methods)
            if (scoresContainer) {
                scoresContainer.classList.remove('active');
                scoresContainer.style.setProperty('display', 'none', 'important');
                scoresContainer.style.visibility = 'hidden';
                scoresContainer.style.opacity = '0';
                scoresContainer.style.height = '0';
                scoresContainer.style.overflow = 'hidden';
            }
            
            // Step 4: FORCE show today container (multiple methods + parent check)
            if (todayContainer) {
                // Remove from scores
                todayContainer.classList.remove('active');
                
                // Add active class
                todayContainer.classList.add('active');
                
                // Force inline styles with !important
                todayContainer.style.setProperty('display', 'flex', 'important');
                todayContainer.style.setProperty('visibility', 'visible', 'important');
                todayContainer.style.setProperty('opacity', '1', 'important');
                todayContainer.style.setProperty('height', 'auto', 'important');
                // Don't override overflow - CSS already has overflow-y: auto !important for scrolling
                
                // Check parent visibility
                let parent = todayContainer.parentElement;
                while (parent && parent !== document.body) {
                    const parentDisplay = getComputedStyle(parent).display;
                    const parentVisibility = getComputedStyle(parent).visibility;
                    if (parentDisplay === 'none' || parentVisibility === 'hidden') {
                        console.warn('⚠️ Parent is hidden:', parent.id || parent.className);
                        parent.style.setProperty('display', 'flex', 'important');
                        parent.style.setProperty('visibility', 'visible', 'important');
                    }
                    parent = parent.parentElement;
                }
                
                // Verify it's actually visible
                setTimeout(() => {
                    const finalDisplay = getComputedStyle(todayContainer).display;
                    if (finalDisplay === 'none') {
                        console.error('🔴 TODAY container still hidden! Forcing again...');
                        todayContainer.style.setProperty('display', 'flex', 'important');
                    } else {
                        console.log('✅ TODAY container is visible:', finalDisplay);
                    }
                }, 10);
            } else {
                console.error('❌ todayContainer not found!');
            }
            
            // Step 5: Set activeTab
            activeTab = 'ALL';
            
            // Step 6: Load today's games (fetchTodayGames is async, so it returns a Promise)
            if (typeof fetchTodayGames === 'function') {
                fetchTodayGames(() => {
                    // updateDisplay will be called by Firestore listeners
                }).then(cleanup => {
                    // Store the cleanup function (not the Promise)
                    window.activeListenerUnsubscribe = cleanup;
                }).catch(err => {
                    console.error('❌ Error loading today games:', err);
                    window.activeListenerUnsubscribe = null;
                });
            } else {
                console.error('❌ fetchTodayGames function not found');
            }
            return;
        }
        
        // Handle SCORES tab - BULLETPROOF VERSION
        if (clickedTab.dataset.tab === 'scores') {
            console.log('📊 Switching to SCORES tab...');
            
            // Step 1: Update tab styling
            if (todayTab) todayTab.classList.remove('active');
            if (liveFilter) liveFilter.classList.remove('active');
            clickedTab.classList.add('active');
            
            // Step 2: Unsubscribe from previous listener (CRASH-PROOF: check if it's a function)
            if (activeListenerUnsubscribe && typeof activeListenerUnsubscribe === 'function') {
                activeListenerUnsubscribe();
                activeListenerUnsubscribe = null;
                window.activeListenerUnsubscribe = null;
            } else if (activeListenerUnsubscribe) {
                // It's a Promise or something else, just clear it
                activeListenerUnsubscribe = null;
                window.activeListenerUnsubscribe = null;
            }
            
            // Step 3: FORCE hide today container (multiple methods)
            if (todayContainer) {
                todayContainer.classList.remove('active');
                todayContainer.style.setProperty('display', 'none', 'important');
                todayContainer.style.visibility = 'hidden';
                todayContainer.style.opacity = '0';
                todayContainer.style.height = '0';
                todayContainer.style.overflow = 'hidden';
            }
            
            // Step 4: FORCE show scores container (multiple methods + parent check)
            if (scoresContainer) {
                // Remove from today
                scoresContainer.classList.remove('active');
                
                // Add active class
                scoresContainer.classList.add('active');
                
                // Force inline styles with !important
                scoresContainer.style.setProperty('display', 'flex', 'important');
                scoresContainer.style.setProperty('visibility', 'visible', 'important');
                scoresContainer.style.setProperty('opacity', '1', 'important');
                scoresContainer.style.setProperty('height', 'auto', 'important');
                // Don't override overflow - CSS already has overflow-y: auto !important for scrolling
                
                // Check parent visibility
                let parent = scoresContainer.parentElement;
                while (parent && parent !== document.body) {
                    const parentDisplay = getComputedStyle(parent).display;
                    const parentVisibility = getComputedStyle(parent).visibility;
                    if (parentDisplay === 'none' || parentVisibility === 'hidden') {
                        console.warn('⚠️ Parent is hidden:', parent.id || parent.className);
                        parent.style.setProperty('display', 'flex', 'important');
                        parent.style.setProperty('visibility', 'visible', 'important');
                    }
                    parent = parent.parentElement;
                }
                
                // Verify it's actually visible
                setTimeout(() => {
                    const finalDisplay = getComputedStyle(scoresContainer).display;
                    if (finalDisplay === 'none') {
                        console.error('🔴 SCORES container still hidden! Forcing again...');
                        scoresContainer.style.setProperty('display', 'flex', 'important');
                    } else {
                        console.log('✅ SCORES container is visible:', finalDisplay);
                    }
                }, 10);
            } else {
                console.error('❌ scoresContainer not found!');
            }
            
            // Step 5: Load scores
            if (typeof fetchYesterdayScores === 'function') {
                fetchYesterdayScores();
            } else {
                console.error('❌ fetchYesterdayScores function not found');
            }
            return;
        }
        
        // Handle LIVE filter
        if (clickedTab.id === 'live-filter-toggle') {
            const todayTab = gamesTabsContainer.querySelector('.games-tab[data-tab="today"]');
            const scoresTab = gamesTabsContainer.querySelector('.games-tab[data-tab="scores"]');
            
            // Ensure we're on TODAY tab content first
            if (todayTab && !todayTab.classList.contains('active') && !clickedTab.classList.contains('active')) {
                // Switch to TODAY tab only if LIVE filter is not already active
                // CRASH-PROOF: check if it's a function before calling
                if (activeListenerUnsubscribe && typeof activeListenerUnsubscribe === 'function') {
                    activeListenerUnsubscribe();
                    activeListenerUnsubscribe = null;
                    window.activeListenerUnsubscribe = null;
                } else if (activeListenerUnsubscribe) {
                    // It's a Promise or something else, just clear it
                    activeListenerUnsubscribe = null;
                    window.activeListenerUnsubscribe = null;
                }
                
                if (scoresTab) scoresTab.classList.remove('active');
                todayTab.classList.add('active');
                
                const todayContainer = document.getElementById('tv-listings-today');
                const scoresContainer = document.getElementById('tv-listings-scores');
                
                if (todayContainer) todayContainer.classList.add('active');
                if (scoresContainer) scoresContainer.classList.remove('active');
                
                // Load today's games (fetchTodayGames is async, so it returns a Promise)
                if (typeof fetchTodayGames === 'function') {
                    fetchTodayGames(() => {
                        // updateDisplay will be called by Firestore listeners
                    }).then(cleanup => {
                        // Store the cleanup function (not the Promise)
                        window.activeListenerUnsubscribe = cleanup;
                    }).catch(err => {
                        console.error('❌ Error loading today games:', err);
                        window.activeListenerUnsubscribe = null;
                    });
                }
            }
            
            // Toggle LIVE filter state
            const willBeActive = !clickedTab.classList.contains('active');
            clickedTab.classList.toggle('active');
            
            // Set activeTab
            activeTab = clickedTab.classList.contains('active') ? 'LIVE' : 'ALL';
            
            // Update active tab styling
            if (willBeActive) {
                if (scoresTab) scoresTab.classList.remove('active');
                if (todayTab) todayTab.classList.remove('active');
            } else {
                if (scoresTab) scoresTab.classList.remove('active');
                if (todayTab) todayTab.classList.add('active');
            }
            
            // Force updateDisplay
            if (typeof window.triggerGamesUpdate === 'function') {
                window.triggerGamesUpdate();
            }
            return;
        }
    });
    
    console.log('✅ Event delegation listener attached to games-tabs container');
    
    let activeListenerUnsubscribe = null;

    const applyLiveFilter = () => {
        if (!liveFilter) {
            console.warn('Live filter: liveFilter element not found');
            return;
        }
        const isFilterActive = liveFilter.classList.contains('active');
        console.log('Live filter: isFilterActive =', isFilterActive);
        const todayContent = document.getElementById('games');
        if (!todayContent) {
            console.warn('Live filter: games container not found');
            return;
        }
        const allGameRows = todayContent.querySelectorAll('.game-row');
        console.log('Live filter: Found', allGameRows.length, 'game rows');
        const leagueSections = todayContent.querySelectorAll('.league-section');
        const gameTables = todayContent.querySelectorAll('.game-table');
        const tablesWithImportance = new Set();

        // Counters for debugging
        let hiddenCount = 0;
        let shownCount = 0;
        let noMatchStatusCount = 0;

        // When Live filter is active, ONLY show games that are in progress (live)
        // Hide games with "F" (final), start times, or any non-live status
        allGameRows.forEach(row => {
            const parentTable = row.closest('table');
            if (parentTable && parentTable.dataset.hasImportanceToggle === 'true') {
                tablesWithImportance.add(parentTable);
                return;
            }
            
            // Skip separator rows - they'll be handled with their paired row
            if (row.classList.contains('game-separator')) {
                return;
            }
            
            let showRow = true;
            if (isFilterActive) {
                // Check the match status from data attribute - ONLY show live/in-progress games
                const matchStatus = (row.dataset.matchStatus || "").toUpperCase().trim();
                
                // If no match status found, hide the game (shouldn't happen, but be safe)
                if (!matchStatus) {
                    noMatchStatusCount++;
                    showRow = false;
                } else {
                    // Explicitly exclude SCHEDULED and FINAL games
                    if (matchStatus === "SCHEDULED" || matchStatus === "FINAL" || matchStatus.includes("FINAL")) {
                        hiddenCount++;
                        showRow = false;
                    } else {
                        // Only show games that are explicitly live/in-progress
                        const isLive = matchStatus.includes("IN PROGRESS") || 
                                       matchStatus.includes("IN_PROGRESS") ||
                                       matchStatus.includes("LIVE");
                        
                        if (!isLive) {
                            // Hide any game that's not explicitly live
                            hiddenCount++;
                            showRow = false;
                        } else {
                            shownCount++;
                        }
                    }
                }
            }
            
            // Hide/show both row1 and row2 together using CSS class
            if (showRow) {
                row.classList.remove('live-filter-hidden');
                row.style.display = '';
            } else {
                row.classList.add('live-filter-hidden');
                row.style.display = 'none';
            }
            const nextRow = row.nextElementSibling;
            if (nextRow && nextRow.classList.contains('game-separator')) {
                if (showRow) {
                    nextRow.classList.remove('live-filter-hidden');
                    nextRow.style.display = '';
                } else {
                    nextRow.classList.add('live-filter-hidden');
                    nextRow.style.display = 'none';
                }
            }
        });
        
        // Log filter results
        if (isFilterActive) {
            console.log('Live filter results: Shown =', shownCount, ', Hidden =', hiddenCount, ', No matchStatus =', noMatchStatusCount);
        }

        tablesWithImportance.forEach(table => {
            if (typeof table.updateImportanceVisibility === 'function') {
                table.updateImportanceVisibility(isFilterActive);
            }
        });

        gameTables.forEach(table => {
            // Check if this table is in the FEATURED section
            const leagueSection = table.closest('.league-section');
            const isFeaturedSection = leagueSection && (
                leagueSection.querySelector('.league-title')?.textContent?.trim() === 'FEATURED' ||
                leagueSection.getAttribute('data-league') === 'FEATURED'
            );
            
            // Hide entire FEATURED section when Live filter is active
            if (isFilterActive && isFeaturedSection) {
                table.style.display = 'none';
                // Also hide the featured subheader
                const header = table.previousElementSibling;
                if (header && header.classList && header.classList.contains('featured-subheader')) {
                    header.style.display = 'none';
                }
                return;
            }
            
            const rows = table.querySelectorAll('.game-row');
            const hasVisible = !isFilterActive || Array.from(rows).some(row => row.style.display !== 'none');
            const isDefaultCollapsed = table.dataset.collapsible === 'true' && table.dataset.isCollapsed === 'true';
            if (isDefaultCollapsed) {
                table.style.display = 'none';
            } else {
                table.style.display = hasVisible ? '' : 'none';
            }

            const scoresRow = table.previousElementSibling;
            if (scoresRow && scoresRow.classList && scoresRow.classList.contains('collapsed-league-scores')) {
                const shouldShowScoresRow = table.style.display !== 'none' && table.dataset.isCollapsed !== 'true';
                scoresRow.style.display = shouldShowScoresRow ? 'block' : 'none';
            }

            const header = table.previousElementSibling;
            if (header && header.classList && header.classList.contains('featured-subheader')) {
                header.style.display = hasVisible ? 'flex' : 'none';
            }
        });

        leagueSections.forEach(section => {
            // Hide FEATURED section when Live filter is active
            const sectionTitle = section.querySelector('.league-title');
            const isFeaturedSection = sectionTitle && (
                sectionTitle.textContent?.trim() === 'FEATURED' ||
                section.getAttribute('data-league') === 'FEATURED'
            );
            
            if (isFilterActive && isFeaturedSection) {
                section.style.display = 'none';
                if (sectionTitle) {
                    sectionTitle.style.display = 'none';
                }
                return;
            }
            
            const visibleRows = section.querySelectorAll('.game-row:not([style*="display: none"])');
            const shouldShowSection = visibleRows.length > 0;
            section.style.display = shouldShowSection ? 'block' : 'none';
            
            // Also hide the league title if the section is hidden
            const prevElement = section.previousElementSibling;
            if (prevElement && prevElement.classList.contains('league-title')) {
                prevElement.style.display = shouldShowSection ? 'block' : 'none';
            }
        });
    };

    // Initial load - trigger TODAY tab
    const todayTab = gamesTabsContainer.querySelector('.games-tab[data-tab="today"]');
    if (todayTab) {
        todayTab.click();
    } else {
        console.warn('⚠️ Today tab not found for initial load');
    }
    
    // Debug: Monitor for any code that's overriding display (as suggested by ChatGPT)
    const todayContainer = document.getElementById('tv-listings-today');
    const scoresContainer = document.getElementById('tv-listings-scores');
    
    if (todayContainer) {
        new MutationObserver(() => {
            const computed = getComputedStyle(todayContainer).display;
            if (computed === 'none' && todayContainer.classList.contains('active')) {
                console.warn('🔴 WARNING: todayContainer has "active" class but display is "none"!');
                console.trace('Stack trace:');
            }
        }).observe(todayContainer, { 
            attributes: true, 
            attributeFilter: ['style', 'class'] 
        });
    }
    
    if (scoresContainer) {
        new MutationObserver(() => {
            const computed = getComputedStyle(scoresContainer).display;
            if (computed === 'none' && scoresContainer.classList.contains('active')) {
                console.warn('🔴 WARNING: scoresContainer has "active" class but display is "none"!');
                console.trace('Stack trace:');
            }
        }).observe(scoresContainer, { 
            attributes: true, 
            attributeFilter: ['style', 'class'] 
        });
    }
}

// Call initialization function
initializeTabsAndFilters();

// DEBUGGING: MutationObserver to catch what's undoing our changes
const todayTarget = document.getElementById('tv-listings-today');
const scoresTarget = document.getElementById('tv-listings-scores');

if (todayTarget) {
    new MutationObserver(mutations => {
        mutations.forEach(m => {
            console.log(
                '🔴 TODAY MUTATION:',
                m.attributeName,
                'display =',
                getComputedStyle(todayTarget).display,
                'stack:',
                new Error().stack
            );
        });
    }).observe(todayTarget, {
        attributes: true,
        attributeFilter: ['style', 'class']
    });
}

if (scoresTarget) {
    new MutationObserver(mutations => {
        mutations.forEach(m => {
            console.log(
                '🔴 SCORES MUTATION:',
                m.attributeName,
                'display =',
                getComputedStyle(scoresTarget).display,
                'stack:',
                new Error().stack
            );
        });
    }).observe(scoresTarget, {
        attributes: true,
        attributeFilter: ['style', 'class']
    });
}

// --- STATS SUB-TABS INITIALIZATION ---
const statsSubTabsContainer = document.getElementById('stats-sub-tabs');
if (statsSubTabsContainer) {
    const playerStatsTab = statsSubTabsContainer.querySelector('.stats-sub-tab[data-stats-sub-tab="player"]');
    const teamStatsTab = statsSubTabsContainer.querySelector('.stats-sub-tab[data-stats-sub-tab="team"]');
    
    playerStatsTab.addEventListener('click', () => {
        // Remove active class from all sub-tabs
        statsSubTabsContainer.querySelectorAll('.stats-sub-tab').forEach(tab => {
            tab.classList.remove('active');
            tab.style.borderBottom = 'none';
        });
        // Add active class to clicked tab
        playerStatsTab.classList.add('active');
        playerStatsTab.style.borderBottom = '1px solid #fff';
        
        // Show player content, hide team content
        document.getElementById('player-stats-content').style.display = 'flex';
        document.getElementById('team-stats-content').style.display = 'none';
    });
    
    teamStatsTab.addEventListener('click', () => {
        // Remove active class from all sub-tabs
        statsSubTabsContainer.querySelectorAll('.stats-sub-tab').forEach(tab => {
            tab.classList.remove('active');
            tab.style.borderBottom = 'none';
        });
        // Add active class to clicked tab
        teamStatsTab.classList.add('active');
        teamStatsTab.style.borderBottom = '1px solid #fff';
        
        // Show team content, hide player content
        document.getElementById('player-stats-content').style.display = 'none';
        document.getElementById('team-stats-content').style.display = 'flex';
        
        // Automatically load the first category in the team stats menu
        const teamCategoryMenu = document.getElementById('team-category-menu');
        if (teamCategoryMenu) {
            const firstCategoryItem = teamCategoryMenu.querySelector('.stats-category-item');
            if (firstCategoryItem) {
                // Activate the first category
                teamCategoryMenu.querySelectorAll('.stats-category-item').forEach(item => {
                    item.classList.remove('active');
                    item.style.borderBottom = 'none';
                    item.style.backgroundColor = '#141414';
                    item.style.color = '#BFBFBF';
                    item.style.fontWeight = 'normal';
                });
                
                firstCategoryItem.classList.add('active');
                firstCategoryItem.style.borderBottom = '1px solid #fff';
                firstCategoryItem.style.backgroundColor = '#000';
                firstCategoryItem.style.color = '#fff';
                firstCategoryItem.style.fontWeight = 'bold';
                
                // Load the stats for the first category
                const firstCategory = firstCategoryItem.dataset.category;
                if (firstCategory) {
                    loadStatsCategory(firstCategory, 'team-stats-content-area');
                }
            }
        }
    });
}

// --- STATS CATEGORY MENU INITIALIZATION ---
function initializeStatsCategoryMenu(menuId, displayId) {
    const categoryMenu = document.getElementById(menuId);
    if (!categoryMenu) return;
    
    categoryMenu.addEventListener('click', (e) => {
        const clickedItem = e.target.closest('.stats-category-item');
        if (!clickedItem) return;
        
        const category = clickedItem.dataset.category;
        
        // Update all category items in this menu
        categoryMenu.querySelectorAll('.stats-category-item').forEach(item => {
            item.classList.remove('active');
            item.style.borderBottom = 'none';
            item.style.backgroundColor = '#141414';
            item.style.color = '#BFBFBF';
            item.style.fontWeight = 'normal';
        });
        
        // Activate clicked item
        clickedItem.classList.add('active');
        clickedItem.style.borderBottom = '1px solid #fff';
        clickedItem.style.backgroundColor = '#000';
        clickedItem.style.color = '#fff';
        clickedItem.style.fontWeight = 'bold';
        
        // Load stats for this category
        loadStatsCategory(category, displayId);
    });
    
    // Load the first category by default
    const firstCategory = categoryMenu.querySelector('.stats-category-item');
    if (firstCategory) {
        const defaultCategory = firstCategory.dataset.category;
        console.log('Loading default stats category:', defaultCategory);
        loadStatsCategory(defaultCategory, displayId);
    }
}

// Initialize both category menus
initializeStatsCategoryMenu('player-category-menu', 'player-stats-content-area');
initializeStatsCategoryMenu('team-category-menu', 'team-stats-content-area');

// --- STATS CATEGORY LOADER ---
function loadStatsCategory(category, displayElementId) {
    console.log('loadStatsCategory called with:', category, displayElementId);
    const displayElement = document.getElementById(displayElementId);
    if (!displayElement) {
        console.log('Display element not found:', displayElementId);
        return;
    }
    
    displayElement.innerHTML = `<p style="color: #9ca3af;">Loading ${category} statistics...</p>`;
    
    // Get current league to determine data source
    const leagueHeader = document.getElementById('league-specific-header');
    const currentLeague = leagueHeader ? leagueHeader.innerText : null;
    console.log('Current league detected:', currentLeague);
    
    // Check if this is player or team stats
    const statsSubTabsContainer = document.getElementById('stats-sub-tabs');
    const isTeamStats = statsSubTabsContainer && statsSubTabsContainer.querySelector('.stats-sub-tab[data-stats-sub-tab="team"]')?.classList.contains('active');
    
    // Load stats based on league and category
    if (currentLeague === 'MLB') {
        console.log('Loading MLB stats for category:', category);
        loadMLBStats(category, displayElement);
    } else if (currentLeague === 'NBA') {
        if (isTeamStats) {
            console.log('Loading NBA team stats for category:', category);
            loadNBATeamStats(category, displayElement);
    } else {
            console.log('Loading NBA player stats for category:', category);
            loadNBAStats(category, displayElement);
        }
    } else {
        console.log('Non-MLB/NBA league, showing placeholder for:', currentLeague);
        // For other leagues, show placeholder
        setTimeout(() => {
            displayElement.innerHTML = `<p style="color: #9ca3af;">${category} statistics for ${currentLeague} will be implemented here...</p>`;
        }, 500);
    }
}
// --- PARSE BASEBALL REFERENCE DATA ---
function parseBaseballReferenceData(html, category) {
    try {
        // Create a temporary DOM parser
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        
        // Find the 2025 Leaders section
        const leadersSection = Array.from(doc.querySelectorAll('h2')).find(h2 => h2.textContent.includes('2025 Leaders'));
        
        if (!leadersSection) {
            console.log('2025 Leaders section not found');
            return [];
        }
        
        // Get all the leader entries
        const leaderEntries = [];
        let currentElement = leadersSection.nextElementSibling;
        
        while (currentElement && currentElement.tagName !== 'H2') {
            if (currentElement.tagName === 'P' && currentElement.textContent.trim()) {
                const text = currentElement.textContent.trim();
                // Look for bold text followed by leader info
                const match = text.match(/^\*\*(.+?)\*\*\s*(.+)$/) || 
                            text.match(/^(.+?)\s+(.+)$/);
                
                if (match) {
                    const statName = match[1].trim();
                    const leaderInfo = match[2].trim();
                    
                    // Only include if it looks like a valid stat entry
                    if (statName && leaderInfo && leaderInfo.includes('(')) {
                        // Categorize the stats
                        if (shouldIncludeStat(statName, category)) {
                            leaderEntries.push({
                                stat: statName,
                                leader: leaderInfo
                            });
                        }
                    }
                }
            }
            currentElement = currentElement.nextElementSibling;
        }
        
        return leaderEntries;
        
    } catch (error) {
        console.error('Error parsing Baseball Reference data:', error);
        return [];
    }
}

// --- CATEGORIZE STATS ---
function shouldIncludeStat(statName, category) {
    const battingStats = [
        'WAR Position Players', 'Offensive WAR', 'Defensive WAR', 'Batting Average', 'On-Base%', 
        'Slugging %', 'On-Base Plus Slugging', 'Games Played', 'At Bats', 'Plate Appearances',
        'Runs Scored', 'Hits', 'Total Bases', 'Doubles', 'Triples', 'Home Runs', 'Runs Batted In',
        'Bases on Balls', 'Strikeouts', 'Stolen Bases', 'Singles', 'Adjusted OPS+', 'Runs Created',
        'Adj. Batting Runs', 'Adj. Batting Wins', 'Extra Base Hits', 'Times On Base', 'Offensive Win %',
        'Hit By Pitch', 'Sacrifice Hits', 'Sacrifice Flies', 'Intentional Bases on Balls',
        'Double Plays Grounded Into', 'Caught Stealing', 'SB %', 'Power-Speed #', 'AB per SO',
        'AB per HR', 'Outs Made', 'Base-Out Runs Added (RE24)', 'Win Probability Added (WPA)',
        'Situ. Wins Added (WPA/LI)', 'Championship WPA (cWPA)', 'Base-Out Wins Added (REW)',
        'rOBA', 'Rbat+'
    ];
    
    const pitchingStats = [
        'WAR for Pitchers', 'Earned Run Average', 'Wins', 'Win-Loss %', 'Walks & Hits per IP',
        'Hits per 9 IP', 'Bases On Balls per 9 IP', 'Strikeouts per 9 IP', 'Games Played',
        'Saves', 'Innings Pitched', 'Strikeouts', 'Games Started', 'Complete Games', 'Shutouts',
        'Home Runs', 'Bases on Balls', 'Hits', 'Strikeouts / Base On Balls', 'Home Runs per 9 IP',
        'Losses', 'Earned Runs', 'Wild Pitches', 'Hit By Pitch', 'Batters Faced', 'Games Finished',
        'Adjusted ERA+', 'Fielding Independent Pitching', 'Adj. Pitching Runs', 'Adj. Pitching Wins',
        'Base-Out Runs Saved (RE24)', 'Win Probability Added (WPA)', 'Sit. Wins Saved (WPA/LI)',
        'Championship WPA (cWPA)', 'Base-Out Wins Saved (REW)'
    ];
    
    const fieldingStats = [
        'Putouts', 'Assists', 'Errors Committed', 'Total Zone Runs', 'Def. Games as C',
        'Putouts as C', 'Assists as C', 'Errors Committed as C', 'Double Plays Turned as C',
        'Passed Balls', 'Stolen Bases Allowed as C', 'Caught Stealing as C', 'Caught Stealing %'
    ];
    
    const advancedStats = [
        'Wins Above Replacement', 'WAR Position Players', 'WAR for Pitchers', 'Adjusted OPS+',
        'Adjusted ERA+', 'Fielding Independent Pitching', 'Base-Out Runs Added (RE24)',
        'Win Probability Added (WPA)', 'Situ. Wins Added (WPA/LI)', 'Championship WPA (cWPA)',
        'Base-Out Wins Added (REW)', 'Base-Out Wins Saved (REW)', 'rOBA', 'Rbat+'
    ];
    
    switch (category) {
        case 'batting':
            return battingStats.some(stat => statName.includes(stat));
        case 'pitching':
            return pitchingStats.some(stat => statName.includes(stat));
        case 'fielding':
            return fieldingStats.some(stat => statName.includes(stat));
        case 'advanced':
            return advancedStats.some(stat => statName.includes(stat));
        default:
            return true;
    }
}

// --- DISPLAY MLB STATS ---
function displayMLBStats(statsData, category, displayElement) {
    let html = `<div style="color: white;">`;
    html += `<h4 style="color: #fff; font-size: 12px; margin-bottom: 10px; border-bottom: 1px solid #4a4a4a; padding-bottom: 5px;">2025 MLB ${category.charAt(0).toUpperCase() + category.slice(1)} Leaders</h4>`;
    
    if (statsData.length > 0) {
        html += `<table style="width: 100%; border-collapse: collapse; font-size: 10px;">`;
        html += `<thead><tr style="border-bottom: 1px solid #4a4a4a;">`;
        html += `<th style="padding: 4px; text-align: left; color: #ccc;">Statistic</th>`;
        html += `<th style="padding: 4px; text-align: left; color: #ccc;">Leader</th>`;
        html += `</tr></thead><tbody>`;
        
        statsData.forEach(stat => {
            html += `<tr style="border-bottom: 1px solid #333;">`;
            html += `<td style="padding: 4px; color: white; font-weight: 500;">${stat.stat}</td>`;
            html += `<td style="padding: 4px; color: #ccc;">${stat.leader}</td>`;
            html += `</tr>`;
        });
        
        html += `</tbody></table>`;
    } else {
        html += `<p style="color: #9ca3af;">No ${category} statistics available.</p>`;
    }
    
    html += `<p style="color: #666; font-size: 9px; margin-top: 10px;">Data from Baseball Reference • Updated daily</p>`;
    html += `</div>`;
    
    displayElement.innerHTML = html;
}

// --- DAILY STATS REFRESH SYSTEM ---
const statsCache = {
    data: new Map(),
    timestamps: new Map(),
    CACHE_DURATION: 12 * 60 * 60 * 1000, // 12 hours cache for cost efficiency
    
    set(key, data) {
        this.data.set(key, data);
        this.timestamps.set(key, Date.now());
    },
    
    get(key) {
        const timestamp = this.timestamps.get(key);
        if (!timestamp || Date.now() - timestamp > this.CACHE_DURATION) {
            this.data.delete(key);
            this.timestamps.delete(key);
            return null;
        }
        return this.data.get(key);
    },
    
    clear() {
        this.data.clear();
        this.timestamps.clear();
    }
};

// --- ENHANCED MLB STATS LOADER FROM FIRESTORE ---
async function loadMLBStats(category, displayElement) {
    const cacheKey = `mlb_stats_${category}`;
    let cachedData = statsCache.get(cacheKey);
    
    if (cachedData) {
        console.log('Using cached MLB stats for', category);
        displayMLBStatsFromFirestore(cachedData, category, displayElement);
        return;
    }
    
    try {
        console.log('Fetching fresh MLB stats from Firestore for', category);
        
        // Load from Firestore
        const statsData = await loadMLBStatsFromFirestore(category);
        
        if (statsData && statsData.length > 0) {
            // Cache the data for 12 hours
            statsCache.set(cacheKey, statsData);
            displayMLBStatsFromFirestore(statsData, category, displayElement);
        } else {
            displayElement.innerHTML = `<p style="color: #9ca3af;">No ${category} data available. Please sync from Google Sheets.</p>`;
        }
        
    } catch (error) {
        console.error('Error loading MLB stats from Firestore:', error);
        displayElement.innerHTML = `<p style="color: #ef4444;">Error loading MLB statistics. Please try again later.</p>`;
    }
}

// --- LOAD MLB STATS FROM FIRESTORE ---
async function loadMLBStatsFromFirestore(category) {
    try {
        const docRef = db.collection('mlb_stats').doc(category);
        const doc = await docRef.get();
        
        if (doc.exists) {
            const data = doc.data();
            const statsData = data.stats || [];
            console.log('✅ Loaded', statsData.length, 'stats for', category);
            return statsData;
        } else {
            console.log('❌ No stats found for category:', category);
            return [];
        }
    } catch (error) {
        console.error('❌ Error loading MLB stats from Firestore:', error);
        return [];
    }
}

// --- DISPLAY MLB STATS FROM FIRESTORE ---
function displayMLBStatsFromFirestore(statsData, category, displayElement) {
    let html = `<div style="color: white;">`;
    html += `<h4 style="color: #fff; font-size: 12px; margin-bottom: 10px; border-bottom: 1px solid #4a4a4a; padding-bottom: 5px;">2025 MLB ${category.charAt(0).toUpperCase() + category.slice(1)} Leaders</h4>`;
    
    if (statsData && statsData.length > 0) {
        html += `<table style="width: 100%; border-collapse: collapse; font-size: 10px;">`;
        html += `<thead><tr style="border-bottom: 1px solid #4a4a4a;">`;
        html += `<th style="padding: 4px; text-align: left; color: #ccc;">Statistic</th>`;
        html += `<th style="padding: 4px; text-align: left; color: #ccc;">Leader</th>`;
        html += `<th style="padding: 4px; text-align: left; color: #ccc;">Value</th>`;
        html += `</tr></thead><tbody>`;
        
        statsData.forEach(stat => {
            html += `<tr style="border-bottom: 1px solid #333;">`;
            html += `<td style="padding: 4px; color: white; font-weight: 500;">${stat.statName}</td>`;
            html += `<td style="padding: 4px; color: #ccc;">${stat.leaderName}</td>`;
            html += `<td style="padding: 4px; color: #ccc;">${stat.value}</td>`;
            html += `</tr>`;
        });
        
        html += `</tbody></table>`;
    } else {
        html += `<p style="color: #9ca3af;">No ${category} statistics available.</p>`;
    }
    
    html += `<p style="color: #666; font-size: 9px; margin-top: 10px;">Data from Google Sheets • Updated daily • Cached for 12 hours</p>`;
    html += `</div>`;
    
    displayElement.innerHTML = html;
}

// --- LOAD NBA STATS FROM FIRESTORE ---
async function loadNBAStatsFromFirestore(section) {
    try {
        const docRef = db.collection('nbaStats').doc(section);
        const doc = await docRef.get();
        
        if (doc.exists) {
            const data = doc.data();
            const statsData = data.stats || {};
            console.log('✅ Loaded NBA stats for section:', section);
            return statsData;
        } else {
            console.log('❌ No stats found for section:', section);
            return null;
        }
    } catch (error) {
        console.error('❌ Error loading NBA stats from Firestore:', error);
        return null;
    }
}

// --- LOAD NBA STATS ---
async function loadNBAStats(category, displayElement) {
    const cacheKey = `nba_stats_${category}`;
    let cachedData = statsCache.get(cacheKey);
    
    if (cachedData) {
        console.log('Using cached NBA stats for', category);
        displayNBAStatsFromFirestore(cachedData, category, displayElement);
        return;
    }
    
    try {
        console.log('Fetching fresh NBA stats from Firestore for', category);
        
        // Map category to Firestore section
        const sectionMap = {
            'seasonLeaders': 'seasonLeaders',
            'forwards': 'forwards',
            'guards': 'guards',
            'rookies': 'rookies',
            'centers': 'centers',
            'seasonTotals': 'seasonTotals',
            'advanced': 'advanced',
            'miscellaneous': 'miscellaneous',
            'trackingDrives': 'trackingDrives',
            'trackingShooting': 'trackingShooting',
            'trackingPassing': 'trackingPassing',
            'trackingSpeed': 'trackingSpeed',
            'clutch': 'clutch',
            'scoring': 'scoring',
            'bioStats': 'bioStats'
        };
        
        const section = sectionMap[category] || category;
        const statsData = await loadNBAStatsFromFirestore(section);
        
        if (statsData) {
            // Cache the data for 12 hours
            statsCache.set(cacheKey, statsData);
            displayNBAStatsFromFirestore(statsData, category, displayElement);
        } else {
            displayElement.innerHTML = `<p style="color: #9ca3af;">No ${category} data available. Please run the upload script.</p>`;
        }
        
    } catch (error) {
        console.error('Error loading NBA stats from Firestore:', error);
        displayElement.innerHTML = `<p style="color: #ef4444;">Error loading NBA statistics. Please try again later.</p>`;
    }
}

// --- DISPLAY NBA STATS FROM FIRESTORE ---
function displayNBAStatsFromFirestore(statsData, category, displayElement) {
    let html = `<div style="color: white;">`;
    
    // Category display names
    const categoryNames = {
        'seasonLeaders': 'Season Leaders',
        'forwards': 'Forwards',
        'guards': 'Guards',
        'rookies': 'Rookies',
        'centers': 'Centers',
        'seasonTotals': 'Season Totals',
        'advanced': 'Advanced',
        'miscellaneous': 'Miscellaneous',
        'trackingDrives': 'Player Tracking - Drives',
        'trackingShooting': 'Player Tracking - Shooting',
        'trackingPassing': 'Player Tracking - Passing',
        'trackingSpeed': 'Player Tracking - Speed',
        'clutch': 'Clutch',
        'scoring': 'Scoring',
        'bioStats': 'Bio Stats'
    };
    
    const categoryName = categoryNames[category] || category;
    html += `<h4 style="color: #fff; font-size: 12px; margin-bottom: 10px; border-bottom: 1px solid #4a4a4a; padding-bottom: 5px;">NBA ${categoryName}</h4>`;
    
    if (statsData && Object.keys(statsData).length > 0) {
        // Display each stat category within the section
        Object.keys(statsData).forEach(statKey => {
            const players = statsData[statKey];
            if (players && players.length > 0) {
                // Stat name formatting
                const statName = statKey.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()).trim();
                
                html += `<div style="margin-bottom: 15px;">`;
                html += `<h5 style="color: #fff; font-size: 11px; margin-bottom: 5px; margin-top: 10px;">${statName}</h5>`;
                html += `<table style="width: 100%; border-collapse: collapse; font-size: 9px; margin-bottom: 10px;">`;
                html += `<thead><tr style="border-bottom: 1px solid #4a4a4a;">`;
                html += `<th style="padding: 3px 4px; text-align: left; color: #ccc;">Player</th>`;
                html += `<th style="padding: 3px 4px; text-align: left; color: #ccc;"></th>`;
                html += `<th style="padding: 3px 4px; text-align: right; color: #ccc;"></th>`;
                html += `</tr></thead><tbody>`;
                
                players.slice(0, 10).forEach((player, index) => {
                    const value = typeof player.value === 'number' 
                        ? (player.value < 1 && (statKey.includes('Pct') || statKey.includes('Percentage')) 
                            ? (player.value * 100).toFixed(1) + '%'
                            : player.value.toFixed(1))
                        : player.value;
                    
                    html += `<tr style="border-bottom: 1px solid #333;">`;
                    html += `<td style="padding: 3px 4px; color: white; font-weight: 500;">${player.name}</td>`;
                    html += `<td style="padding: 3px 4px; color: #ccc;">${player.team}</td>`;
                    html += `<td style="padding: 3px 4px; color: #ccc; text-align: right;">${value}</td>`;
                    html += `</tr>`;
                });
                
                html += `</tbody></table>`;
                html += `</div>`;
            }
        });
    } else {
        html += `<p style="color: #9ca3af;">No ${category} statistics available.</p>`;
    }
    
    html += `<p style="color: #666; font-size: 9px; margin-top: 10px;">Data from NBA.com</p>`;
    html += `</div>`;
    
    displayElement.innerHTML = html;
}

// --- LOAD NBA TEAM STATS FROM FIRESTORE ---
async function loadNBATeamStatsFromFirestore(section) {
    try {
        const docRef = db.collection('nbaTeamStats').doc(section);
        const doc = await docRef.get();
        
        if (doc.exists) {
            const data = doc.data();
            const statsData = data.stats || {};
            const lastUpdated = data.lastUpdated;
            console.log('✅ Loaded NBA team stats for section:', section);
            return { stats: statsData, lastUpdated: lastUpdated };
        } else {
            console.log('❌ No team stats found for section:', section);
            return null;
        }
    } catch (error) {
        console.error('❌ Error loading NBA team stats from Firestore:', error);
        return null;
    }
}

// --- LOAD NBA TEAM STATS ---
async function loadNBATeamStats(category, displayElement) {
    const cacheKey = `nba_team_stats_${category}`;
    let cachedData = statsCache.get(cacheKey);
    
    // Check if cached data exists and is still valid (same lastUpdated timestamp)
    if (cachedData && cachedData.stats) {
        // We'll verify the timestamp matches when we fetch from Firestore
        // For now, just proceed to fetch and compare
    }
    
    try {
        console.log('Fetching fresh NBA team stats from Firestore for', category);
        
        // Map category to Firestore section
        const sectionMap = {
            'seasonLeaders': 'seasonLeaders',
            'scoring': 'scoring',
            'bench': 'bench',
            'statsInWins': 'statsInWins',
            'advanced': 'advanced',
            'miscellaneous': 'miscellaneous',
            'tracking': 'tracking',
            'trackingDrives': 'trackingDrives',
            'trackingShooting': 'trackingShooting',
            'trackingPassing': 'trackingPassing',
            'trackingSpeed': 'trackingSpeed',
            'hustle': 'hustle',
            'clutch': 'clutch'
        };
        
        const section = sectionMap[category] || category;
        const result = await loadNBATeamStatsFromFirestore(section);
        
        if (result && result.stats) {
            // Check if we have cached data with the same lastUpdated timestamp
            const cachedEntry = statsCache.get(cacheKey);
            if (cachedEntry && cachedEntry.lastUpdated && result.lastUpdated) {
                // Compare timestamps - if they match, use cache
                const cachedTime = cachedEntry.lastUpdated.toMillis ? cachedEntry.lastUpdated.toMillis() : cachedEntry.lastUpdated;
                const newTime = result.lastUpdated.toMillis ? result.lastUpdated.toMillis() : result.lastUpdated;
                if (cachedTime === newTime) {
                    console.log('Using cached NBA team stats (same timestamp)');
                    displayNBATeamStatsFromFirestore(cachedEntry.stats, category, displayElement);
                    return;
                }
            }
            
            // Cache the data with lastUpdated timestamp
            statsCache.set(cacheKey, { stats: result.stats, lastUpdated: result.lastUpdated });
            displayNBATeamStatsFromFirestore(result.stats, category, displayElement);
        } else {
            displayElement.innerHTML = `<p style="color: #9ca3af;">No ${category} data available. Please run the upload script.</p>`;
        }
        
    } catch (error) {
        console.error('Error loading NBA team stats from Firestore:', error);
        displayElement.innerHTML = `<p style="color: #ef4444;">Error loading NBA team statistics. Please try again later.</p>`;
    }
}

// --- DISPLAY NBA TEAM STATS FROM FIRESTORE ---
function displayNBATeamStatsFromFirestore(statsData, category, displayElement) {
    let html = `<div style="color: white;">`;
    
    // Category display names
    const categoryNames = {
        'seasonLeaders': 'Season Leaders',
        'scoring': 'Scoring',
        'bench': 'Bench',
        'statsInWins': 'Stats in Wins',
        'advanced': 'Advanced',
        'miscellaneous': 'Miscellaneous',
        'tracking': 'Tracking',
        'trackingDrives': 'Tracking - Drives',
        'trackingShooting': 'Tracking - Shooting',
        'trackingPassing': 'Tracking - Passing',
        'trackingSpeed': 'Tracking - Speed',
        'hustle': 'Hustle',
        'clutch': 'Clutch'
    };
    
    const categoryName = categoryNames[category] || category;
    html += `<h4 style="color: #fff; font-size: 12px; margin-bottom: 10px; border-bottom: 1px solid #4a4a4a; padding-bottom: 5px;">NBA ${categoryName}</h4>`;
    
    if (statsData && Object.keys(statsData).length > 0) {
        // Display each stat category within the section
        Object.keys(statsData).forEach(statKey => {
            const teams = statsData[statKey];
            if (teams && teams.length > 0) {
                // Stat name formatting with special handling for common patterns
                let statName = statKey.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()).trim();
                
                // Fix common naming issues
                if (statKey === 'fastBreakPointsPerGame') {
                    statName = 'Fast Break Points Per Game';
                } else if (statKey === 'secondChancePointsPerGame') {
                    statName = '2nd Chance Points Per Game';
                } else if (statKey === 'pointsInPaintPerGame') {
                    statName = 'Points In The Paint Per Game';
                } else if (statKey === 'pctPoints3PT') {
                    statName = '% of Points Three Pointers';
                } else if (statKey === 'pctPointsInPaint') {
                    statName = '% of Points In The Paint';
                } else if (statKey === 'pctPointsMidRange') {
                    statName = '% of Points Mid-Range';
                }
                
                html += `<div style="margin-bottom: 15px;">`;
                html += `<h5 style="color: #fff; font-size: 11px; margin-bottom: 5px; margin-top: 10px;">${statName}</h5>`;
                html += `<table style="width: 100%; border-collapse: collapse; font-size: 9px; margin-bottom: 10px;">`;
                html += `<thead><tr style="border-bottom: 1px solid #4a4a4a;">`;
                html += `<th style="padding: 3px 4px; text-align: left; color: #ccc;">Team</th>`;
                html += `<th style="padding: 3px 4px; text-align: left; color: #ccc;"></th>`;
                html += `<th style="padding: 3px 4px; text-align: right; color: #ccc;"></th>`;
                html += `</tr></thead><tbody>`;
                
                teams.slice(0, 10).forEach((team, index) => {
                    // Check if this is a percentage stat (starts with 'pct' or contains 'Percentage' or 'efg')
                    const isPercentage = statKey.toLowerCase().startsWith('pct') || 
                                        statKey.includes('Percentage') || 
                                        statKey.includes('efg') ||
                                        statKey.includes('Pct');
                    
                    let value;
                    if (typeof team.value === 'number') {
                        // For percentage stats, always format as percentage
                        if (isPercentage) {
                            // If value is less than 1, it's a decimal (0.487 = 48.7%)
                            // If value is >= 1, it's already a percentage (48.7 = 48.7%)
                            if (team.value < 1) {
                                value = (team.value * 100).toFixed(1) + '%';
                            } else {
                                value = team.value.toFixed(1) + '%';
                            }
                        } else {
                            value = team.value.toFixed(1);
                        }
                    } else {
                        value = team.value;
                    }
                    
                    html += `<tr style="border-bottom: 1px solid #333;">`;
                    html += `<td style="padding: 3px 4px; color: white; font-weight: 500;">${team.name}</td>`;
                    html += `<td style="padding: 3px 4px; color: #ccc;"></td>`;
                    html += `<td style="padding: 3px 4px; color: #ccc; text-align: right;">${value}</td>`;
                    html += `</tr>`;
                });
                
                html += `</tbody></table>`;
                html += `</div>`;
            }
        });
    } else {
        html += `<p style="color: #9ca3af;">No ${category} statistics available.</p>`;
    }
    
    html += `<p style="color: #666; font-size: 9px; margin-top: 10px;">Data from NBA.com</p>`;
    html += `</div>`;
    
    displayElement.innerHTML = html;
}

// --- DAILY REFRESH SCHEDULER ---
function startDailyStatsRefresh() {
    // Clear cache at midnight every day
    const now = new Date();
    const midnight = new Date(now);
    midnight.setHours(24, 0, 0, 0); // Next midnight
    const msUntilMidnight = midnight.getTime() - now.getTime();
    
    setTimeout(() => {
        console.log('Clearing MLB stats cache for daily refresh...');
        statsCache.clear();
        
        // Set up daily refresh
        setInterval(() => {
            console.log('Daily MLB stats cache refresh...');
            statsCache.clear();
        }, 24 * 60 * 60 * 1000); // Every 24 hours
        
    }, msUntilMidnight);
}

// Start the daily refresh system
startDailyStatsRefresh();

// --- TEST BASEBALL REFERENCE SCRAPER ---
async function testBaseballReferenceScraper() {
    console.log('=== TESTING BASEBALL REFERENCE SCRAPER ===');
    
    const proxyUrl = 'https://api.allorigins.win/raw?url=';
    const baseballRefUrl = 'https://www.baseball-reference.com/leaders/';
    
    try {
        console.log('Fetching Baseball Reference data...');
        const response = await fetch(proxyUrl + encodeURIComponent(baseballRefUrl));
        
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        
        const html = await response.text();
        console.log('✅ Successfully fetched HTML (length:', html.length, 'characters)');
        
        // Parse the HTML
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        
        // Find all h2 elements to see what sections exist
        const allH2s = Array.from(doc.querySelectorAll('h2'));
        console.log('\n📋 All H2 sections found:');
        allH2s.forEach((h2, index) => {
            console.log(`${index + 1}. "${h2.textContent.trim()}"`);
        });
        // Look for 2025 Leaders section
        const leadersSection = allH2s.find(h2 => h2.textContent.includes('2025 Leaders'));
        
        if (leadersSection) {
            console.log('\n✅ Found "2025 Leaders" section');
            
            // Get all content after this section until next h2
            const leaderEntries = [];
            let currentElement = leadersSection.nextElementSibling;
            let elementCount = 0;
            
            console.log('\n📊 Parsing leader entries...');
            
            while (currentElement && currentElement.tagName !== 'H2' && elementCount < 50) {
                if (currentElement.tagName === 'P' && currentElement.textContent.trim()) {
                    const text = currentElement.textContent.trim();
                    console.log(`Entry ${elementCount + 1}: "${text}"`);
                    
                    // Try different parsing patterns
                    const patterns = [
                        /^\*\*(.+?)\*\*\s*(.+)$/,  // **Stat** Leader info
                        /^(.+?)\s+(.+)$/           // Stat Leader info
                    ];
                    
                    for (const pattern of patterns) {
                        const match = text.match(pattern);
                        if (match) {
                            const statName = match[1].trim();
                            const leaderInfo = match[2].trim();
                            
                            if (statName && leaderInfo) {
                                leaderEntries.push({
                                    stat: statName,
                                    leader: leaderInfo,
                                    rawText: text
                                });
                                console.log(`  ✅ Parsed: "${statName}" -> "${leaderInfo}"`);
                                break;
                            }
                        }
                    }
                }
                currentElement = currentElement.nextElementSibling;
                elementCount++;
            }
            
            console.log(`\n📈 Total leader entries found: ${leaderEntries.length}`);
            
            // Show first 10 entries
            console.log('\n🏆 First 10 leader entries:');
            leaderEntries.slice(0, 10).forEach((entry, index) => {
                console.log(`${index + 1}. ${entry.stat}: ${entry.leader}`);
            });
            
            // Categorize by stat type
            console.log('\n📊 Categorizing stats...');
            const battingStats = leaderEntries.filter(entry => 
                shouldIncludeStat(entry.stat, 'batting')
            );
            const pitchingStats = leaderEntries.filter(entry => 
                shouldIncludeStat(entry.stat, 'pitching')
            );
            const fieldingStats = leaderEntries.filter(entry => 
                shouldIncludeStat(entry.stat, 'fielding')
            );
            const advancedStats = leaderEntries.filter(entry => 
                shouldIncludeStat(entry.stat, 'advanced')
            );
            
            console.log(`Batting stats: ${battingStats.length}`);
            console.log(`Pitching stats: ${pitchingStats.length}`);
            console.log(`Fielding stats: ${fieldingStats.length}`);
            console.log(`Advanced stats: ${advancedStats.length}`);
            
            // Show sample from each category
            if (battingStats.length > 0) {
                console.log('\n⚾ Sample Batting Stats:');
                battingStats.slice(0, 3).forEach(entry => {
                    console.log(`  ${entry.stat}: ${entry.leader}`);
                });
            }
            
            if (pitchingStats.length > 0) {
                console.log('\n⚾ Sample Pitching Stats:');
                pitchingStats.slice(0, 3).forEach(entry => {
                    console.log(`  ${entry.stat}: ${entry.leader}`);
                });
            }
            
        } else {
            console.log('❌ "2025 Leaders" section not found');
            console.log('Available sections:', allH2s.map(h2 => h2.textContent.trim()));
        }
        
    } catch (error) {
        console.error('❌ Error testing scraper:', error);
    }
    
    console.log('\n=== SCRAPER TEST COMPLETE ===');
}

// Make test function available globally
window.testBaseballScraper = testBaseballReferenceScraper;

// --- UPDATE STATS CATEGORY MENU BASED ON LEAGUE ---
function updateStatsCategoryMenu(leagueKey) {
    const playerCategoryMenu = document.getElementById('player-category-menu');
    if (!playerCategoryMenu) return;
    
    // Clear existing menu items
    playerCategoryMenu.innerHTML = '';
    
    if (leagueKey === 'NBA') {
        // NBA categories
        const nbaCategories = [
            { key: 'seasonLeaders', name: 'Season Leaders' },
            { key: 'forwards', name: 'Forwards' },
            { key: 'guards', name: 'Guards' },
            { key: 'rookies', name: 'Rookies' },
            { key: 'centers', name: 'Centers' },
            { key: 'seasonTotals', name: 'Season Totals' },
            { key: 'advanced', name: 'Advanced' },
            { key: 'miscellaneous', name: 'Miscellaneous' },
            { key: 'trackingDrives', name: 'Tracking - Drives' },
            { key: 'trackingShooting', name: 'Tracking - Shooting' },
            { key: 'trackingPassing', name: 'Tracking - Passing' },
            { key: 'trackingSpeed', name: 'Tracking - Speed' },
            { key: 'clutch', name: 'Clutch' },
            { key: 'scoring', name: 'Scoring' },
            { key: 'bioStats', name: 'Bio Stats' }
        ];
        
        nbaCategories.forEach((cat, index) => {
            const item = document.createElement('div');
            item.className = 'stats-category-item';
            item.dataset.category = cat.key;
            item.style.cssText = index === 0 
                ? 'padding: 8px 2px; cursor: pointer; border-bottom: 1px solid #fff; background-color: #000; color: #fff; font-weight: bold; font-size: 9px; margin-bottom: 1px;'
                : 'padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;';
            item.textContent = cat.name;
            playerCategoryMenu.appendChild(item);
        });
        
        // Re-initialize the menu
        initializeStatsCategoryMenu('player-category-menu', 'player-stats-content-area');
    } else if (leagueKey === 'MLB') {
        // MLB categories (default)
        const mlbCategories = [
            { key: 'batting', name: 'Batting' },
            { key: 'pitching', name: 'Pitching' },
            { key: 'fielding', name: 'Fielding' },
            { key: 'advanced', name: 'Advanced' }
        ];
        
        mlbCategories.forEach((cat, index) => {
            const item = document.createElement('div');
            item.className = 'stats-category-item';
            item.dataset.category = cat.key;
            item.style.cssText = index === 0 
                ? 'padding: 8px 2px; cursor: pointer; border-bottom: 1px solid #fff; background-color: #000; color: #fff; font-weight: bold; font-size: 9px; margin-bottom: 1px;'
                : 'padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;';
            item.textContent = cat.name;
            playerCategoryMenu.appendChild(item);
        });
        
        // Re-initialize the menu
        initializeStatsCategoryMenu('player-category-menu', 'player-stats-content-area');
    }
    
    // Update team category menu
    const teamCategoryMenu = document.getElementById('team-category-menu');
    if (teamCategoryMenu) {
        // Clear existing menu items
        teamCategoryMenu.innerHTML = '';
        
        if (leagueKey === 'NBA') {
            // NBA team categories
            const nbaTeamCategories = [
                { key: 'seasonLeaders', name: 'Season Leaders' },
                { key: 'scoring', name: 'Scoring' },
                { key: 'bench', name: 'Bench' },
                { key: 'statsInWins', name: 'Stats in Wins' },
                { key: 'advanced', name: 'Advanced' },
                { key: 'miscellaneous', name: 'Miscellaneous' },
                { key: 'trackingDrives', name: 'Tracking - Drives' },
                { key: 'trackingShooting', name: 'Tracking - Shooting' },
                { key: 'trackingPassing', name: 'Tracking - Passing' },
                { key: 'trackingSpeed', name: 'Tracking - Speed' },
                { key: 'hustle', name: 'Hustle' },
                { key: 'clutch', name: 'Clutch' }
            ];
            
            nbaTeamCategories.forEach((cat, index) => {
                const item = document.createElement('div');
                item.className = 'stats-category-item';
                item.dataset.category = cat.key;
                item.style.cssText = index === 0 
                    ? 'padding: 8px 2px; cursor: pointer; border-bottom: 1px solid #fff; background-color: #000; color: #fff; font-weight: bold; font-size: 9px; margin-bottom: 1px;'
                    : 'padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;';
                item.textContent = cat.name;
                teamCategoryMenu.appendChild(item);
            });
            
            // Re-initialize the menu
            initializeStatsCategoryMenu('team-category-menu', 'team-stats-content-area');
        } else if (leagueKey === 'MLB') {
            // MLB team categories (default)
            const mlbTeamCategories = [
                { key: 'standings', name: 'Standings' },
                { key: 'offense', name: 'Offense' },
                { key: 'defense', name: 'Defense' },
                { key: 'pitching', name: 'Pitching' }
            ];
            
            mlbTeamCategories.forEach((cat, index) => {
                const item = document.createElement('div');
                item.className = 'stats-category-item';
                item.dataset.category = cat.key;
                item.style.cssText = index === 0 
                    ? 'padding: 8px 2px; cursor: pointer; border-bottom: 1px solid #fff; background-color: #000; color: #fff; font-weight: bold; font-size: 9px; margin-bottom: 1px;'
                    : 'padding: 8px 2px; cursor: pointer; background-color: #141414; color: #BFBFBF; font-size: 9px; margin-bottom: 1px;';
                item.textContent = cat.name;
                teamCategoryMenu.appendChild(item);
            });
            
            // Re-initialize the menu
            initializeStatsCategoryMenu('team-category-menu', 'team-stats-content-area');
        }
    }
}

// --- RESET STATS TABS TO DEFAULT ---
function resetStatsTabsToDefault() {
    // Reset Player/Team sub-tabs to Player active
    const statsSubTabsContainer = document.getElementById('stats-sub-tabs');
    if (statsSubTabsContainer) {
        const playerStatsTab = statsSubTabsContainer.querySelector('.stats-sub-tab[data-stats-sub-tab="player"]');
        const teamStatsTab = statsSubTabsContainer.querySelector('.stats-sub-tab[data-stats-sub-tab="team"]');
        
        // Reset all sub-tabs
        statsSubTabsContainer.querySelectorAll('.stats-sub-tab').forEach(tab => {
            tab.classList.remove('active');
            tab.style.borderBottom = 'none';
        });
        
        // Activate Player tab
        if (playerStatsTab) {
            playerStatsTab.classList.add('active');
            playerStatsTab.style.borderBottom = '1px solid #fff';
        }
        
        // Show player content, hide team content
        document.getElementById('player-stats-content').style.display = 'flex';
        document.getElementById('team-stats-content').style.display = 'none';
    }
    
    // Get current league to determine first category
    const leagueHeader = document.getElementById('league-specific-header');
    const currentLeague = leagueHeader ? leagueHeader.innerText : null;
    
    // Reset Player category menu to first item active
    const playerCategoryMenu = document.getElementById('player-category-menu');
    if (playerCategoryMenu) {
        const firstCategoryItem = playerCategoryMenu.querySelector('.stats-category-item');
        
        // Reset all category items
        playerCategoryMenu.querySelectorAll('.stats-category-item').forEach(item => {
            item.classList.remove('active');
            item.style.borderBottom = 'none';
            item.style.backgroundColor = '#141414';
            item.style.color = '#BFBFBF';
            item.style.fontWeight = 'normal';
        });
        
        // Activate first category
        if (firstCategoryItem) {
            firstCategoryItem.classList.add('active');
            firstCategoryItem.style.borderBottom = '1px solid #fff';
            firstCategoryItem.style.backgroundColor = '#000';
            firstCategoryItem.style.color = '#fff';
            firstCategoryItem.style.fontWeight = 'bold';
        }
    }
    
    // Reset Team category menu to first item (Standings) active
    const teamCategoryMenu = document.getElementById('team-category-menu');
    if (teamCategoryMenu) {
        const firstCategoryItem = teamCategoryMenu.querySelector('.stats-category-item[data-category="standings"]');
        
        // Reset all category items
        teamCategoryMenu.querySelectorAll('.stats-category-item').forEach(item => {
            item.classList.remove('active');
            item.style.borderBottom = 'none';
            item.style.backgroundColor = '#141414';
            item.style.color = '#BFBFBF';
            item.style.fontWeight = 'normal';
        });
        
        // Activate first category (Standings)
        if (firstCategoryItem) {
            firstCategoryItem.classList.add('active');
            firstCategoryItem.style.borderBottom = '1px solid #fff';
            firstCategoryItem.style.backgroundColor = '#000';
            firstCategoryItem.style.color = '#fff';
            firstCategoryItem.style.fontWeight = 'bold';
        }
    }
}

// --- FUNCTION TO UPDATE STANDINGS TAB TEXT BASED ON LEAGUE (Define early so it's available) ---
window.updateStandingsTabText = function(leagueName) {
    const standingsTab = document.querySelector('.main-tab[data-main-tab="standings"]');
    if (!standingsTab) return;
    
    // Soccer leagues use "TABLE"
    const soccerLeagues = [
        'Soccer', 'PremierLeague', 'MLS', 'LaLiga', 'SerieA', 'Bundesliga', 
        'Ligue1', 'LigaMX', 'NWSL', 'UEFAChampionsLeague', 'UEFAEuropaLeague', 
        'UEFAConferenceLeague', 'FACup', 'EFLCup', 'CopaDelRey', 'DFBPokal',
        'BelgianProLeague', 'Brasileirão', 'LigaPortugal', 'Eredivisie',
        'CopaLibertadores', 'CopaSudamericana', 'CFL', "Women's UCL"
    ];
    
    // Combat sports and individual sports use "RANKINGS"
    const rankingsLeagues = ['UFC', 'Boxing', 'PGATour', 'LPGATour', 'Tennis'];
    
    // Track & Field uses "WORLD LEADS"
    const worldLeadsLeagues = ['TrackAndField'];
    
    if (soccerLeagues.includes(leagueName)) {
        standingsTab.innerText = 'TABLE';
    } else if (rankingsLeagues.includes(leagueName)) {
        standingsTab.innerText = 'RANKINGS';
    } else if (worldLeadsLeagues.includes(leagueName)) {
        standingsTab.innerText = 'WORLD LEADS';
    } else {
        standingsTab.innerText = 'STANDINGS';
    }
}

// --- MAIN TABS INITIALIZATION ---
const mainTabsContainer = document.getElementById('main-tabs');
if (mainTabsContainer) {
    mainTabsContainer.addEventListener('click', (e) => {
        const clickedTab = e.target.closest('.main-tab');
        if (!clickedTab) return;
        
        const tabType = clickedTab.dataset.mainTab;
        
        // Update tab appearances
        mainTabsContainer.querySelectorAll('.main-tab').forEach(tab => {
            tab.classList.remove('active');
            tab.style.backgroundColor = '#2a2a2a';
            tab.style.color = '#ccc';
            tab.style.fontWeight = 'normal';
        });
        clickedTab.classList.add('active');
        clickedTab.style.backgroundColor = '#fff';
        clickedTab.style.color = '#000';
        clickedTab.style.fontWeight = 'bold';
        
        // Show/hide content
        document.querySelectorAll('.main-tab-content').forEach(content => {
            content.style.display = 'none';
        });
        document.getElementById(`${tabType}-tab-content`).style.display = 'block';
        
        // Load standings when Standings tab is clicked
        if (tabType === 'standings') {
            const leagueHeader = document.getElementById('league-specific-header');
            const leagueKey = leagueHeader ? leagueHeader.innerText : null;
            
            // Check if this is an NCAA league (NCAAF, NCAAM, NCAAW)
            const isNCALeague = ['NCAAF', 'NCAAM', 'NCAAW'].includes(leagueKey);
            
            if (isNCALeague) {
                // For NCAA leagues, activate Top 25 tab by default
                const ncaaStandingsTabs = document.getElementById('ncaa-standings-tabs');
                const top25Tab = ncaaStandingsTabs ? ncaaStandingsTabs.querySelector('.ncaa-standings-tab[data-ncaa-standings-tab="top25"]') : null;
                const standingsTab = ncaaStandingsTabs ? ncaaStandingsTabs.querySelector('.ncaa-standings-tab[data-ncaa-standings-tab="standings"]') : null;
                const cfpTab = document.getElementById('ncaa-cfp-tab');
                const top25Content = document.getElementById('league-top25-content');
                const standingsContentOnly = document.getElementById('league-standings-content');
                const cfpContent = document.getElementById('league-cfp-content');
                
                // Show CFP tab only for NCAAF
                if (cfpTab) {
                    if (leagueKey === 'NCAAF') {
                        cfpTab.style.display = ''; // Remove display: none to make it a flex item
                    } else {
                        cfpTab.style.display = 'none';
                    }
                }
                
                if (leagueKey === 'NCAAF' && cfpTab) {
                    // For NCAAF, activate CFP tab by default
                    cfpTab.classList.add('active');
                    cfpTab.style.color = '#fff';
                    cfpTab.style.borderBottom = '2px solid #fff';
                    if (top25Tab) {
                        top25Tab.classList.remove('active');
                        top25Tab.style.color = '#ccc';
                        top25Tab.style.borderBottom = 'none';
                    }
                    if (standingsTab) {
                        standingsTab.classList.remove('active');
                        standingsTab.style.color = '#ccc';
                        standingsTab.style.borderBottom = 'none';
                    }
                    // Show CFP content, hide other content
                    if (cfpContent) {
                        cfpContent.style.display = 'block';
                        loadCFPData();
                    }
                    if (top25Content) top25Content.style.display = 'none';
                    if (standingsContentOnly) standingsContentOnly.style.display = 'none';
                } else if (top25Tab && standingsTab) {
                    // For NCAAM and NCAAW, activate Top 25 tab by default
                    top25Tab.classList.add('active');
                    top25Tab.style.color = '#fff';
                    top25Tab.style.borderBottom = '2px solid #fff';
                    standingsTab.classList.remove('active');
                    standingsTab.style.color = '#ccc';
                    standingsTab.style.borderBottom = 'none';
                    // Show Top 25 content, hide other content
                    if (top25Content) {
                        top25Content.style.display = 'block';
                        loadTop25Data(leagueKey);
                    }
                    if (standingsContentOnly) standingsContentOnly.style.display = 'none';
                    if (cfpContent) cfpContent.style.display = 'none';
                }
            } else {
                // For non-NCAA leagues, load standings normally
                if (leagueKey) {
                    const leagueInfo = LEAGUE_DATA_CONFIG[leagueKey];
                    if (leagueInfo && leagueInfo.standingsUrl) {
                        fetchLeagueStandings(leagueInfo.standingsUrl, leagueKey);
                    }
                }
            }
        }
        
        // Reset stats tabs to default state when switching leagues
        if (tabType === 'stats') {
            resetStatsTabsToDefault();
        }
    });
}

// --- NCAA STANDINGS SUB-TABS INITIALIZATION (Top 25, Standings) ---
const ncaaStandingsTabsContainer = document.getElementById('ncaa-standings-tabs');
if (ncaaStandingsTabsContainer) {
    ncaaStandingsTabsContainer.addEventListener('click', (e) => {
        const clickedTab = e.target.closest('.ncaa-standings-tab');
        if (!clickedTab) return;
        
        const tabType = clickedTab.dataset.ncaaStandingsTab;
        const leagueHeader = document.getElementById('league-specific-header');
        const leagueKey = leagueHeader ? leagueHeader.innerText : null;
        
        if (!leagueKey || !['NCAAF', 'NCAAM', 'NCAAW'].includes(leagueKey)) return;
        
        // Update tab appearances
        ncaaStandingsTabsContainer.querySelectorAll('.ncaa-standings-tab').forEach(tab => {
            tab.classList.remove('active');
            tab.style.color = '#ccc';
            tab.style.borderBottom = 'none';
        });
        clickedTab.classList.add('active');
        clickedTab.style.color = '#fff';
        clickedTab.style.borderBottom = '2px solid #fff';
        
        // Show/hide content
        const top25Content = document.getElementById('league-top25-content');
        const standingsContentOnly = document.getElementById('league-standings-content');
        const cfpContent = document.getElementById('league-cfp-content');
        
        if (tabType === 'cfp') {
            if (cfpContent) {
                cfpContent.style.display = 'block';
                loadCFPData();
            }
            if (top25Content) top25Content.style.display = 'none';
            if (standingsContentOnly) standingsContentOnly.style.display = 'none';
        } else if (tabType === 'top25') {
            if (top25Content) {
                top25Content.style.display = 'block';
                loadTop25Data(leagueKey);
            }
            if (standingsContentOnly) standingsContentOnly.style.display = 'none';
            if (cfpContent) cfpContent.style.display = 'none';
        } else if (tabType === 'standings') {
            if (top25Content) top25Content.style.display = 'none';
            if (cfpContent) cfpContent.style.display = 'none';
            if (standingsContentOnly) {
                standingsContentOnly.style.display = 'block';
                const leagueInfo = LEAGUE_DATA_CONFIG[leagueKey];
                if (leagueInfo && leagueInfo.standingsUrl) {
                    fetchLeagueStandings(leagueInfo.standingsUrl, leagueKey);
                }
            }
        }
    });
}

// --- TOP 25 RANKINGS CACHE ---
// Cache for Top 25 rankings by league key: { 'NCAAF': { 'Ohio State': 1, ... }, ... }
let top25RankingsCache = {};
let cfpRankingsCache = {};

// ESPN team name to NCAA API team name mapping
// ESPN provides full names with mascots (e.g., "Duke Blue Devils")
// NCAA API provides just school names (e.g., "Duke")
// This maps ESPN names (what appears in games) to NCAA names (what's in rankings)
const ESPN_TO_NCAA_TEAM_MAP = {
    // D1 Men's Basketball Teams
    'Abilene Christian Wildcats': 'Abilene Christian',
    'Air Force Falcons': 'Air Force',
    'Akron Zips': 'Akron',
    'Alabama A&M Bulldogs': 'Alabama A&M',
    'Alabama Crimson Tide': 'Alabama',
    'Alabama State Hornets': 'Alabama St.',
    'Alcorn State Braves': 'Alcorn St.',
    'American University Eagles': 'American',
    'App State Mountaineers': 'Appalachian St.',
    'Arizona State Sun Devils': 'Arizona St.',
    'Arizona Wildcats': 'Arizona',
    'Arkansas Razorbacks': 'Arkansas',
    'Arkansas State Red Wolves': 'Arkansas St.',
    'Arkansas-Pine Bluff Golden Lions': 'Ark.-Pine Bluff',
    'Army Black Knights': 'Army',
    'Auburn Tigers': 'Auburn',
    'Austin Peay Governors': 'Austin Peay',
    'Ball State Cardinals': 'Ball St.',
    'Baylor Bears': 'Baylor',
    'Bellarmine Knights': 'Bellarmine',
    'Belmont Bruins': 'Belmont',
    'Bethune-Cookman Wildcats': 'Bethune-Cookman',
    'Binghamton Bearcats': 'Binghamton',
    'Boise State Broncos': 'Boise St.',
    'Boston College Eagles': 'Boston College',
    'Boston University Terriers': 'Boston U.',
    'Bowling Green Falcons': 'Bowling Green',
    'Bradley Braves': 'Bradley',
    'Brown Bears': 'Brown',
    'Bryant Bulldogs': 'Bryant',
    'Bucknell Bison': 'Bucknell',
    'Buffalo Bulls': 'Buffalo',
    'Butler Bulldogs': 'Butler',
    'BYU Cougars': 'BYU',
    'Cal Poly Mustangs': 'Cal Poly',
    'Cal State Bakersfield Roadrunners': 'CSU Bakersfield',
    'Cal State Fullerton Titans': 'Cal St. Fullerton',
    'Cal State Northridge Matadors': 'Cal St. Northridge',
    'California Baptist Lancers': 'Cal Baptist',
    'California Golden Bears': 'California',
    'Campbell Fighting Camels': 'Campbell',
    'Canisius Golden Griffins': 'Canisius',
    'Central Arkansas Bears': 'Central Ark.',
    'Central Connecticut Blue Devils': 'Central Conn. St.',
    'Central Michigan Chippewas': 'Central Mich.',
    'Charleston Cougars': 'Col. of Charleston',
    'Charleston Southern Buccaneers': 'Charleston So.',
    'Charlotte 49ers': 'Charlotte',
    'Chattanooga Mocs': 'Tenn-Chattanooga',
    'Chicago State Cougars': 'Chicago St.',
    'Cincinnati Bearcats': 'Cincinnati',
    'Clemson Tigers': 'Clemson',
    'Cleveland State Vikings': 'Cleveland St.',
    'Coastal Carolina Chanticleers': 'Coastal Caro.',
    'Colgate Raiders': 'Colgate',
    'Colorado Buffaloes': 'Colorado',
    'Colorado State Rams': 'Colorado St.',
    'Columbia Lions': 'Columbia',
    'Coppin State Eagles': 'Coppin St.',
    'Cornell Big Red': 'Cornell',
    'Creighton Bluejays': 'Creighton',
    'Dartmouth Big Green': 'Dartmouth',
    'Davidson Wildcats': 'Davidson',
    'Dayton Flyers': 'Dayton',
    'Delaware Blue Hens': 'Delaware',
    'Delaware State Hornets': 'Delaware St.',
    'Denver Pioneers': 'Denver',
    'DePaul Blue Demons': 'DePaul',
    'Detroit Mercy Titans': 'Detroit',
    'Drake Bulldogs': 'Drake',
    'Drexel Dragons': 'Drexel',
    'Duquesne Dukes': 'Duquesne',
    'Duke Blue Devils': 'Duke',
    'East Carolina Pirates': 'East Carolina',
    'East Tennessee State Buccaneers': 'East Tenn. St.',
    'East Texas A&M Lions': 'East Tex. A&M',
    'Eastern Illinois Panthers': 'Eastern Ill.',
    'Eastern Kentucky Colonels': 'Eastern Ky.',
    'Eastern Michigan Eagles': 'Eastern Mich.',
    'Eastern Washington Eagles': 'Eastern Wash.',
    'Elon Phoenix': 'Elon',
    'Evansville Purple Aces': 'Evansville',
    'Fairfield Stags': 'Fairfield',
    'Fairleigh Dickinson Knights': 'FDU',
    'Florida A&M Rattlers': 'Florida A&M',
    'Florida Atlantic Owls': 'Florida Atlantic',
    'Florida Gators': 'Florida',
    'Florida Gulf Coast Eagles': 'FGCU',
    'Florida International Panthers': 'FIU',
    'Fordham Rams': 'Fordham',
    'Fresno State Bulldogs': 'Fresno St.',
    'Furman Paladins': 'Furman',
    'Gardner-Webb Runnin\' Bulldogs': 'Gardner-Webb',
    'George Mason Patriots': 'George Mason',
    'George Washington Revolutionaries': 'George Washington',
    'Georgia Bulldogs': 'Georgia',
    'Georgia Southern Eagles': 'Georgia Southern',
    'Georgia State Panthers': 'Georgia St.',
    'Georgia Tech Yellow Jackets': 'Georgia Tech',
    'Gonzaga Bulldogs': 'Gonzaga',
    'Grambling Tigers': 'Grambling',
    'Grand Canyon Lopes': 'Grand Canyon',
    'Green Bay Phoenix': 'Green Bay',
    'Hampton Pirates': 'Hampton',
    'Harvard Crimson': 'Harvard',
    'Hawai\'i Rainbow Warriors': 'Hawaii',
    'High Point Panthers': 'High Point',
    'Hofstra Pride': 'Hofstra',
    'Holy Cross Crusaders': 'Holy Cross',
    'Houston Christian Huskies': 'Houston Christian',
    'Houston Cougars': 'Houston',
    'Howard Bison': 'Howard',
    'Idaho State Bengals': 'Idaho St.',
    'Idaho Vandals': 'Idaho',
    'Illinois Fighting Illini': 'Illinois',
    'Illinois State Redbirds': 'Illinois St.',
    'Incarnate Word Cardinals': 'UIW',
    'Indiana Hoosiers': 'Indiana',
    'Indiana State Sycamores': 'Indiana St.',
    'Iona Gaels': 'Iona',
    'Iowa Hawkeyes': 'Iowa',
    'Iowa State Cyclones': 'Iowa St.',
    'IU Indianapolis Jaguars': 'IU Indy',
    'Jackson State Tigers': 'Jackson St.',
    'Jacksonville Dolphins': 'Jacksonville',
    'Jacksonville State Gamecocks': 'Jacksonville St.',
    'James Madison Dukes': 'James Madison',
    'Kansas City Roos': 'Kansas City',
    'Kansas Jayhawks': 'Kansas',
    'Kansas State Wildcats': 'Kansas St.',
    'Kennesaw State Owls': 'Kennesaw St.',
    'Kent State Golden Flashes': 'Kent St.',
    'Kentucky Wildcats': 'Kentucky',
    'La Salle Explorers': 'La Salle',
    'Lafayette Leopards': 'Lafayette',
    'Lamar Cardinals': 'Lamar',
    'Le Moyne Dolphins': 'Le Moyne',
    'Lehigh Mountain Hawks': 'Lehigh',
    'Liberty Flames': 'Liberty',
    'Lindenwood Lions': 'Lindenwood',
    'Lipscomb Bisons': 'Lipscomb',
    'Little Rock Trojans': 'Little-Rock',
    'Long Beach State Beach': 'Long Beach St.',
    'Long Island University Sharks': 'Long Island',
    'Longwood Lancers': 'Longwood',
    'Louisiana Ragin\' Cajuns': 'La.-Lafayette',
    'Louisiana Tech Bulldogs': 'Louisiana Tech',
    'Louisville Cardinals': 'Louisville',
    'Loyola Chicago Ramblers': 'Loyola (IL)',
    'Loyola Marymount Lions': 'Loyola Marymount',
    'Loyola Maryland Greyhounds': 'Loyola Maryland',
    'LSU Tigers': 'LSU',
    'Maine Black Bears': 'Maine',
    'Manhattan Jaspers': 'Manhattan',
    'Marist Red Foxes': 'Marist',
    'Marquette Golden Eagles': 'Marquette',
    'Marshall Thundering Herd': 'Marshall',
    'Maryland Eastern Shore Hawks': 'Md.-East. Shore',
    'Maryland Terrapins': 'Maryland',
    'Massachusetts Minutemen': 'Mass-Amherst',
    'McNeese Cowboys': 'McNeese St.',
    'Memphis Tigers': 'Memphis',
    'Mercer Bears': 'Mercer',
    'Mercyhurst Lakers': 'Mercyhurst',
    'Merrimack Warriors': 'Merrimack',
    'Miami (OH) RedHawks': 'Miami (OH)',
    'Miami Hurricanes': 'Miami (Fla.)',
    'Michigan State Spartans': 'Michigan St.',
    'Michigan Wolverines': 'Michigan',
    'Middle Tennessee Blue Raiders': 'Middle Tenn.',
    'Milwaukee Panthers': 'Milwaukee',
    'Minnesota Golden Gophers': 'Minnesota',
    'Mississippi State Bulldogs': 'Mississippi St.',
    'Mississippi Valley State Delta Devils': 'Mississippi Val.',
    'Missouri State Bears': 'Missouri St.',
    'Missouri Tigers': 'Missouri',
    'Monmouth Hawks': 'Monmouth',
    'Montana Grizzlies': 'Montana',
    'Montana State Bobcats': 'Montana St.',
    'Morehead State Eagles': 'Morehead St.',
    'Morgan State Bears': 'Morgan St.',
    'Mount St. Mary\'s Mountaineers': 'Mt. St. Mary\'s',
    'Murray State Racers': 'Murray St.',
    'Navy Midshipmen': 'Navy',
    'NC State Wolfpack': 'North Carolina St.',
    'Nebraska Cornhuskers': 'Nebraska',
    'Nevada Wolf Pack': 'Nevada',
    'New Hampshire Wildcats': 'New Hampshire',
    'New Haven Chargers': 'New Haven',
    'New Mexico Lobos': 'New Mexico',
    'New Mexico State Aggies': 'New Mexico St.',
    'New Orleans Privateers': 'New Orleans',
    'Niagara Purple Eagles': 'Niagara',
    'Nicholls Colonels': 'Nicholls St.',
    'NJIT Highlanders': 'New-Jersey-Tech',
    'Norfolk State Spartans': 'Norfolk St.',
    'North Alabama Lions': 'North Ala.',
    'North Carolina A&T Aggies': 'North Carolina A&T',
    'North Carolina Central Eagles': 'North Carolina Central',
    'North Carolina Tar Heels': 'North Carolina',
    'North Dakota Fighting Hawks': 'North Dakota',
    'North Dakota State Bison': 'North Dakota St.',
    'North Florida Ospreys': 'North Florida',
    'North Texas Mean Green': 'North Texas',
    'Northeastern Huskies': 'Northeastern',
    'Northern Arizona Lumberjacks': 'Northern Ariz.',
    'Northern Colorado Bears': 'Northern Colo.',
    'Northern Illinois Huskies': 'Northern Ill.',
    'Northern Iowa Panthers': 'Northern Iowa',
    'Northern Kentucky Norse': 'Northern Ky.',
    'Northwestern State Demons': 'Northwestern St.',
    'Northwestern Wildcats': 'Northwestern',
    'Notre Dame Fighting Irish': 'Notre Dame',
    'Oakland Golden Grizzlies': 'Oakland',
    'Ohio Bobcats': 'Ohio',
    'Ohio State Buckeyes': 'Ohio St.',
    'Oklahoma Sooners': 'Oklahoma',
    'Oklahoma State Cowboys': 'Oklahoma St.',
    'Ole Miss Rebels': 'Mississippi',
    'Old Dominion Monarchs': 'Old Dominion',
    'Omaha Mavericks': 'Omaha',
    'Oral Roberts Golden Eagles': 'Oral Roberts',
    'Oregon Ducks': 'Oregon',
    'Oregon State Beavers': 'Oregon State',
    'Pacific Tigers': 'Pacific',
    'Penn State Nittany Lions': 'Penn State',
    'Pennsylvania Quakers': 'Penn',
    'Pepperdine Waves': 'Pepperdine',
    'Pittsburgh Panthers': 'Pittsburgh',
    'Portland Pilots': 'Portland',
    'Portland State Vikings': 'Portland St.',
    'Prairie View A&M Panthers': 'Prairie View',
    'Presbyterian Blue Hose': 'Presbyterian',
    'Princeton Tigers': 'Princeton',
    'Providence Friars': 'Providence',
    'Purdue Boilermakers': 'Purdue',
    'Purdue Fort Wayne Mastodons': 'Purdue University Fort Wayne',
    'Queens University Royals': 'Queens (NC)',
    'Quinnipiac Bobcats': 'Quinnipiac',
    'Radford Highlanders': 'Radford',
    'Rice Owls': 'Rice',
    'Rhode Island Rams': 'Rhode Island',
    'Richmond Spiders': 'Richmond',
    'Rider Broncs': 'Rider',
    'Robert Morris Colonials': 'Robert Morris',
    'Rutgers Scarlet Knights': 'Rutgers',
    'Sacramento State Hornets': 'Sacramento St.',
    'Sacred Heart Pioneers': 'Sacred Heart',
    'Saint Francis Red Flash': 'St. Francis (PA)',
    'Saint Joseph\'s Hawks': 'Saint Joseph\'s',
    'Saint Louis Billikens': 'St. Louis',
    'Saint Mary\'s Gaels': 'Saint-Mary\'s (CA)',
    'Saint Peter\'s Peacocks': 'Saint Peter\'s',
    'Sam Houston Bearkats': 'Sam Houston St.',
    'Samford Bulldogs': 'Samford',
    'San Diego State Aztecs': 'San Diego St.',
    'San Diego Toreros': 'San Diego',
    'San Francisco Dons': 'San Francisco',
    'San José State Spartans': 'San Jose St.',
    'Santa Clara Broncos': 'Santa Clara',
    'SE Louisiana Lions': 'Southeastern La.',
    'Seattle U Redhawks': 'Seattle',
    'Seton Hall Pirates': 'Seton Hall',
    'SIU Edwardsville Cougars': 'SIUE',
    'Siena Saints': 'Siena',
    'SMU Mustangs': 'SMU',
    'South Alabama Jaguars': 'South Ala.',
    'South Carolina Gamecocks': 'South Carolina',
    'South Carolina State Bulldogs': 'South Carolina St.',
    'South Dakota Coyotes': 'South Dakota',
    'South Dakota State Jackrabbits': 'South Dakota St.',
    'South Florida Bulls': 'South Fla.',
    'Southeast Missouri State Redhawks': 'Southeast Mo. St.',
    'Southern Illinois Salukis': 'Southern Ill.',
    'Southern Indiana Screaming Eagles': 'Southern Ind.',
    'Southern Jaguars': 'Southern U.',
    'Southern Miss Golden Eagles': 'Southern Miss.',
    'Southern Utah Thunderbirds': 'Southern Utah',
    'St. Bonaventure Bonnies': 'St. Bonaventure',
    'St. John\'s Red Storm': 'St. John\'s (NY)',
    'St. Thomas-Minnesota Tommies': 'St. Thomas (MN)',
    'Stanford Cardinal': 'Stanford',
    'Stephen F. Austin Lumberjacks': 'Stephen F. Austin',
    'Stetson Hatters': 'Stetson',
    'Stonehill Skyhawks': 'Stonehill',
    'Stony Brook Seawolves': 'Stony Brook',
    'Syracuse Orange': 'Syracuse',
    'Tarleton State Texans': 'Tarleton St.',
    'TCU Horned Frogs': 'TCU',
    'Temple Owls': 'Temple',
    'Tennessee State Tigers': 'Tennessee St.',
    'Tennessee Tech Golden Eagles': 'Tennessee Tech',
    'Tennessee Volunteers': 'Tennessee',
    'Texas A&M Aggies': 'Texas A&M',
    'Texas A&M-Corpus Christi Islanders': 'Texas-Am-Corpus',
    'Texas Longhorns': 'Texas',
    'Texas Southern Tigers': 'Texas Southern',
    'Texas State Bobcats': 'Texas St.',
    'Texas Tech Red Raiders': 'Texas Tech',
    'The Citadel Bulldogs': 'Citadel',
    'Toledo Rockets': 'Toledo',
    'Towson Tigers': 'Towson',
    'Troy Trojans': 'Troy',
    'Tulane Green Wave': 'Tulane',
    'Tulsa Golden Hurricane': 'Tulsa',
    'UAB Blazers': 'UAB',
    'UC Davis Aggies': 'UC Davis',
    'UC Irvine Anteaters': 'UC Irvine',
    'UC Riverside Highlanders': 'UC Riverside',
    'UC San Diego Tritons': 'UC San Diego',
    'UC Santa Barbara Gauchos': 'UC Santa Barbara',
    'UCF Knights': 'UCF',
    'UCLA Bruins': 'UCLA',
    'UConn Huskies': 'Connecticut',
    'UIC Flames': 'Ill.-Chicago',
    'UL Monroe Warhawks': 'La.-Monroe',
    'UMass Lowell River Hawks': 'Mass.-Lowell',
    'UMBC Retrievers': 'Maryland-Baltimore-County',
    'UNC Asheville Bulldogs': 'UNC Asheville',
    'UNC Greensboro Spartans': 'UNC Greensboro',
    'UNC Wilmington Seahawks': 'UNCW',
    'UNLV Rebels': 'UNLV',
    'Utah State Aggies': 'Utah St.',
    'Utah Tech Trailblazers': 'Utah Tech',
    'Utah Utes': 'Utah',
    'Utah Valley Wolverines': 'Utah Valley',
    'UT Arlington Mavericks': 'Texas at Arlington',
    'UT Martin Skyhawks': 'Tenn-Martin',
    'UT Rio Grande Valley Vaqueros': 'Texas Rio Grande Valley',
    'UTEP Miners': 'Texas at El Paso',
    'UTSA Roadrunners': 'Texas at San Antonio',
    'Valparaiso Beacons': 'Valparaiso',
    'Vanderbilt Commodores': 'Vanderbilt',
    'VCU Rams': 'VCU',
    'Vermont Catamounts': 'Vermont',
    'Villanova Wildcats': 'Villanova',
    'Virginia Cavaliers': 'Virginia',
    'Virginia Tech Hokies': 'Virginia Tech',
    'VMI Keydets': 'VMI',
    'Wagner Seahawks': 'Wagner',
    'Wake Forest Demon Deacons': 'Wake Forest',
    'Washington Huskies': 'Washington',
    'Washington State Cougars': 'Washington St.',
    'Weber State Wildcats': 'Weber St.',
    'West Georgia Wolves': 'West Ga.',
    'West Virginia Mountaineers': 'West Virginia',
    'Western Carolina Catamounts': 'Western Caro.',
    'Western Illinois Leathernecks': 'Western Ill.',
    'Western Kentucky Hilltoppers': 'Western Ky.',
    'Western Michigan Broncos': 'Western Mich.',
    'Wichita State Shockers': 'Wichita St.',
    'William & Mary Tribe': 'William & Mary',
    'Winthrop Eagles': 'Winthrop',
    'Wisconsin Badgers': 'Wisconsin',
    'Wofford Terriers': 'Wofford',
    'Wright State Raiders': 'Wright St.',
    'Wyoming Cowboys': 'Wyoming',
    'Xavier Musketeers': 'Xavier',
    'Yale Bulldogs': 'Yale',
    'Youngstown State Penguins': 'Youngstown St.'
};

// Get NCAA API team name from ESPN team name for ranking lookups
// ESPN provides "Duke Blue Devils", we need "Duke" to match rankings
function getTop25DisplayName(teamName, leagueKey) {
    if (!teamName || !leagueKey) return teamName;
    
    // Use the comprehensive ESPN to NCAA mapping
    if (ESPN_TO_NCAA_TEAM_MAP[teamName]) {
        return ESPN_TO_NCAA_TEAM_MAP[teamName];
    }
    
    // If not found in mapping, return as-is (might be already in NCAA format)
    return teamName;
}

// Load Top 25 rankings into cache (keyed by display name)
async function loadTop25RankingsCache(leagueKey) {
    try {
        const collectionMap = {
            'NCAAF': 'NCAAFStandings',
            'NCAAM': 'NCAAMStandings',
            'NCAAW': 'NCAAWStandings'
        };
        
        const collectionName = collectionMap[leagueKey];
        if (!collectionName) {
            console.warn(`No collection mapping for league key: ${leagueKey}`);
            return;
        }
        
        // Get all documents and filter for Top 25 teams client-side
        const snapshot = await db.collection(collectionName).get();
        
        if (snapshot.empty) {
            top25RankingsCache[leagueKey] = {};
            return;
        }
        
        // Build cache with 3 variants for each team:
        // 1. NCAA API name (e.g., "Duke")
        // 2. ESPN name with mascot (e.g., "Duke Blue Devils")
        // 3. ESPN name without mascot (e.g., "Duke")
        const rankingsMap = {};
        const ncaaToEspnMap = {};
        
        // Build reverse mapping (NCAA -> ESPN)
        for (const [espnName, ncaaName] of Object.entries(ESPN_TO_NCAA_TEAM_MAP)) {
            ncaaToEspnMap[ncaaName] = espnName;
        }
        
        snapshot.docs.forEach(doc => {
            const teamData = doc.data();
            if (teamData.Top25Rank !== null && teamData.Top25Rank !== undefined && teamData.Team) {
                const ncaaTeamName = teamData.Team; // e.g., "Duke"
                const rank = parseInt(teamData.Top25Rank) || null;
                
                // Find the ESPN name for this NCAA name
                const espnName = ncaaToEspnMap[ncaaTeamName];
                
                if (espnName) {
                    // Store with all 3 variants:
                    // 1. NCAA name: "Duke"
                    rankingsMap[ncaaTeamName] = rank;
                    
                    // 2. ESPN full name: "Duke Blue Devils"
                    rankingsMap[espnName] = rank;
                    
                    // 3. ESPN without mascot (extract school name from full name)
                    const schoolNameOnly = espnName.split(' ')[0]; // "Duke" from "Duke Blue Devils"
                    // For multi-word schools, try to be smarter
                    const mascotWords = ['Wildcats', 'Tigers', 'Bulldogs', 'Bears', 'Eagles', 'Panthers', 
                                       'Hawks', 'Huskies', 'Cardinals', 'Cavaliers', 'Cyclones', 'Buckeyes',
                                       'Crimson Tide', 'Crimson', 'Bruins', 'Cougars', 'Spartans', 'Wolverines', 'Volunteers',
                                       'Jayhawks', 'Terrapins', 'Hoosiers', 'Tar Heels', 'Blue Devils',
                                       'Demon Deacons', 'Yellow Jackets', 'Commodores', 'Razorbacks',
                                       'Mountaineers', 'Aggies', 'Gamecocks', 'Seminoles', 'Gators', 'Tide'];
                    
                    // Find where mascot starts
                    let schoolName = espnName;
                    for (const mascot of mascotWords) {
                        const idx = espnName.indexOf(' ' + mascot);
                        if (idx > 0) {
                            schoolName = espnName.substring(0, idx);
                            break;
                        }
                    }
                    rankingsMap[schoolName] = rank;
                } else {
                    // If no ESPN mapping found, store NCAA name
                    rankingsMap[ncaaTeamName] = rank;
                }
            }
        });
        
        top25RankingsCache[leagueKey] = rankingsMap;
        console.log(`✅ Loaded Top 25 rankings for ${leagueKey}`);
    } catch (error) {
        console.error(`Error loading Top 25 rankings cache for ${leagueKey}:`, error);
        top25RankingsCache[leagueKey] = {};
    }
}

// Get Top 25 rank for a team display name and league
function getTop25Rank(displayName, leagueKey) {
    if (!displayName || !leagueKey) return null;
    
    const rankings = top25RankingsCache[leagueKey];
    if (!rankings) return null;
    
    // Cache now stores with ESPN names as keys, so direct lookup
    return rankings[displayName] || null;
}

// Load CFP rankings into cache (keyed by ESPN display name)
async function loadCFPRankingsCache() {
    try {
        const snapshot = await db.collection('CFP').get();
        
        if (snapshot.empty) {
            cfpRankingsCache = {};
            return;
        }
        
        // Build reverse mapping (NCAA -> ESPN) for NCAAF
        const ncaaToEspnMap = {};
        for (const [espnName, ncaaName] of Object.entries(ESPN_TO_NCAA_TEAM_MAP)) {
            ncaaToEspnMap[ncaaName] = espnName;
        }
        
        // Build cache with 3 variants for each team
        const rankingsMap = {};
        const mascotWords = ['Wildcats', 'Tigers', 'Bulldogs', 'Bears', 'Eagles', 'Panthers', 
                           'Hawks', 'Huskies', 'Cardinals', 'Cavaliers', 'Cyclones', 'Buckeyes',
                           'Crimson Tide', 'Crimson', 'Bruins', 'Cougars', 'Spartans', 'Wolverines', 'Volunteers',
                           'Jayhawks', 'Terrapins', 'Hoosiers', 'Tar Heels', 'Blue Devils',
                           'Demon Deacons', 'Yellow Jackets', 'Commodores', 'Razorbacks',
                           'Mountaineers', 'Aggies', 'Gamecocks', 'Seminoles', 'Gators', 'Tide'];
        
        snapshot.docs.forEach(doc => {
            const teamData = doc.data();
            if (teamData.Rk !== null && teamData.Rk !== undefined && teamData.Team) {
                const ncaaTeamName = teamData.Team; // e.g., "Alabama"
                const rank = parseInt(teamData.Rk) || null;
                
                // Find the ESPN name for this NCAA name
                const espnName = ncaaToEspnMap[ncaaTeamName];
                
                if (espnName) {
                    // Store with all 3 variants:
                    // 1. NCAA name
                    rankingsMap[ncaaTeamName] = rank;
                    
                    // 2. ESPN full name
                    rankingsMap[espnName] = rank;
                    
                    // 3. ESPN without mascot
                    let schoolName = espnName;
                    for (const mascot of mascotWords) {
                        const idx = espnName.indexOf(' ' + mascot);
                        if (idx > 0) {
                            schoolName = espnName.substring(0, idx);
                            break;
                        }
                    }
                    rankingsMap[schoolName] = rank;
                } else {
                    // If no ESPN mapping found, store NCAA name
                    rankingsMap[ncaaTeamName] = rank;
                }
            }
        });
        
        cfpRankingsCache = rankingsMap;
        console.log(`✅ Loaded CFP rankings`);
    } catch (error) {
        console.error(`Error loading CFP rankings cache:`, error);
        cfpRankingsCache = {};
    }
}

// Get CFP rank for a team display name
function getCFPRank(displayName) {
    if (!displayName) return null;
    
    if (!cfpRankingsCache || Object.keys(cfpRankingsCache).length === 0) return null;
    
    return cfpRankingsCache[displayName] || null;
}

// Get league key from game data (for Top 25 matching)
function getLeagueKeyFromGame(game) {
    if (!game) return null;
    const league = game.League || '';
    const sport = game.Sport || '';
    
    if (league === 'USA: NCAA Women' && sport === 'Basketball') {
        return 'NCAAW';
    } else if (league === 'USA: NCAA' && sport === 'Basketball') {
        // Check if it's women's basketball by checking league name variations
        const leagueLower = league.toLowerCase();
        if (leagueLower.includes('women') || leagueLower.includes('womens')) {
            return 'NCAAW';
        } else {
            return 'NCAAM';
        }
    } else if (league === 'USA: NCAA' && sport === 'American Football') {
        return 'NCAAF';
    }
    
    return null;
}

// Format team name with Top 25 ranking (if ranked)
function formatTeamNameWithRanking(displayName, leagueKey) {
    if (!leagueKey || !['NCAAF', 'NCAAM', 'NCAAW'].includes(leagueKey)) {
        return displayName;
    }
    
    // For NCAAF, use CFP rankings instead of Top 25
    let rank = null;
    if (leagueKey === 'NCAAF') {
        rank = getCFPRank(displayName);
    } else {
        // displayName is in ESPN format (e.g., "Duke Blue Devils")
        // Cache has ESPN names as keys, so direct lookup works
        rank = getTop25Rank(displayName, leagueKey);
    }
    
    if (rank !== null && rank !== undefined) {
        return `<span style="font-size: 0.75em;">${rank}</span> ${displayName}`;
    }
    return displayName;
}

// --- TOP 25 DATA LOADING AND DISPLAY FUNCTIONS ---
async function loadTop25Data(leagueKey) {
    const top25Content = document.getElementById('league-top25-content');
    if (!top25Content) return;
    
    top25Content.innerHTML = '<p style="color: #9ca3af;">Loading Top 25...</p>';
    
    try {
        const collectionMap = {
            'NCAAF': 'NCAAFStandings',
            'NCAAM': 'NCAAMStandings',
            'NCAAW': 'NCAAWStandings'
        };
        
        const collectionName = collectionMap[leagueKey];
        if (!collectionName) {
            top25Content.innerHTML = '<p style="color: #ef4444;">Invalid league key.</p>';
            return;
        }
        
        // Get all documents and filter for Top 25 teams client-side
        // Firestore doesn't support != null queries well
        const snapshot = await db.collection(collectionName).get();
        
        if (snapshot.empty) {
            top25Content.innerHTML = '<p style="color: #9ca3af;">No Top 25 rankings available.</p>';
            return;
        }
        
        // Filter for teams with Top25Rank and sort by rank
        const teamsMap = new Map(); // Use Map to deduplicate by team name and rank
        
        snapshot.docs.forEach(doc => {
            const team = doc.data();
            if (team.Top25Rank === null || team.Top25Rank === undefined) return;
            
            // Get display name for team
            const displayName = getTop25DisplayName(team.Team, leagueKey) || team.Team || '';
            const teamKey = `${team.Top25Rank}_${displayName}`;
            
            // Use OverallRecord for Top 25 display (not conference record)
            const record = team.OverallRecord || team.Record || '';
            
            // Hard code JMU record
            if (displayName === 'JMU' || team.Team === 'JMU' || team.Team === 'James Madison') {
                team.Record = '12-1';
                team.OverallRecord = '12-1';
            } else if (team.OverallRecord && !team.Record) {
                team.Record = team.OverallRecord;
            }
            
            // Only keep teams with records, or if this is the first entry for this team/rank
            if (record || !teamsMap.has(teamKey)) {
                team.Team = displayName;
                teamsMap.set(teamKey, team);
            }
        });
        
        // Convert Map to array and sort
        const teams = Array.from(teamsMap.values())
            .filter(team => {
                // Remove duplicates - keep only teams with records
                const record = team.OverallRecord || team.Record || '';
                return record !== ''; // Only include teams with records
            })
            .sort((a, b) => {
                // Handle tie format (e.g., "T6" -> 6)
                let rankA = a.Top25Rank;
                let rankB = b.Top25Rank;
                if (typeof rankA === 'string' && rankA.startsWith('T')) {
                    rankA = parseInt(rankA.substring(1)) || 999;
                } else {
                    rankA = parseInt(rankA) || 999;
                }
                if (typeof rankB === 'string' && rankB.startsWith('T')) {
                    rankB = parseInt(rankB.substring(1)) || 999;
                } else {
                    rankB = parseInt(rankB) || 999;
                }
                return rankA - rankB;
            });
        
        if (teams.length === 0) {
            top25Content.innerHTML = '<p style="color: #9ca3af;">No Top 25 rankings available.</p>';
            return;
        }
        
        const html = createTop25Table(teams, leagueKey);
        top25Content.innerHTML = html;
        
    } catch (error) {
        console.error('Error loading Top 25 data:', error);
        top25Content.innerHTML = '<p style="color: #ef4444;">Error loading Top 25 rankings.</p>';
    }
}

function createTop25Table(teams, leagueKey) {
    teams.sort((a, b) => {
        // Handle tie format (e.g., "T6" -> 6)
        let rankA = a.Top25Rank;
        let rankB = b.Top25Rank;
        if (typeof rankA === 'string' && rankA.startsWith('T')) {
            rankA = parseInt(rankA.substring(1)) || 999;
        } else {
            rankA = parseInt(rankA) || 999;
        }
        if (typeof rankB === 'string' && rankB.startsWith('T')) {
            rankB = parseInt(rankB.substring(1)) || 999;
        } else {
            rankB = parseInt(rankB) || 999;
        }
        return rankA - rankB;
    });
    
    let html = '<div class="top25-standings" style="color: #ffffff;">';
    html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff; table-layout: fixed;">';
    html += '<colgroup>';
    // NCAAM and NCAAW get tight layout: narrower Rank and Record columns
    if (leagueKey === 'NCAAM' || leagueKey === 'NCAAW') {
        html += '<col style="width: 45px;">';
        html += '<col style="width: auto;">';
        html += '<col style="width: 85px;">';
    } else {
        html += '<col style="width: 60px;">';
        html += '<col style="width: auto;">';
        html += '<col style="width: 100px;">';
    }
    html += '</colgroup>';
    html += '<thead>';
    html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
    // NCAAM and NCAAW: push Rank to left edge with 5px padding
    if (leagueKey === 'NCAAM' || leagueKey === 'NCAAW') {
        html += '<th style="padding: 8px 8px 8px 5px; text-align: left; border-bottom: 1px solid #666;">Rank</th>';
        html += '<th style="padding: 8px; text-align: left; border-bottom: 1px solid #666;">Team</th>';
        html += '<th style="padding: 8px 8px 8px 5px; text-align: right; border-bottom: 1px solid #666;">Record</th>';
    } else {
        html += '<th style="padding: 8px; text-align: center; border-bottom: 1px solid #666;">Rank</th>';
        html += '<th style="padding: 8px; text-align: left; border-bottom: 1px solid #666;">Team</th>';
        html += '<th style="padding: 8px; text-align: right; border-bottom: 1px solid #666;">Record</th>';
    }
    html += '</tr>';
    html += '</thead>';
    html += '<tbody>';
    
    teams.forEach((team, index) => {
        const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
        html += '<tr style="' + rowStyle + '">';
        // Display rank (show "T6" format if it was a tie, but sort by number)
        let displayRank = team.Top25Rank;
        if (typeof displayRank === 'string' && displayRank.startsWith('T')) {
            // Keep the "T" prefix for display but ensure it's sorted correctly
            displayRank = displayRank;
        }
        // NCAAM and NCAAW: push Rank to left with 5px padding, left-align
        if (leagueKey === 'NCAAM' || leagueKey === 'NCAAW') {
            html += '<td style="padding: 8px 8px 8px 5px; text-align: left; font-size: 12px; font-weight: 600; color: #ffffff;">' + (displayRank || '') + '</td>';
        } else {
            html += '<td style="padding: 8px; text-align: center; font-size: 12px; font-weight: 600; color: #ffffff;">' + (displayRank || '') + '</td>';
        }
        // Get display name for team (e.g., "Southern California" -> "USC")
        const displayTeamName = getTop25DisplayName(team.Team, leagueKey) || team.Team || '';
        html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500; color: #ffffff;">' + displayTeamName + '</td>';
        // Use OverallRecord for Top 25 display (ensure it's overall, not conference)
        const displayRecord = team.OverallRecord || team.Record || '';
        // NCAAM and NCAAW: tighter padding before Record
        if (leagueKey === 'NCAAM' || leagueKey === 'NCAAW') {
            html += '<td style="padding: 8px 8px 8px 5px; text-align: right; font-size: 12px; color: #ffffff;">' + displayRecord + '</td>';
        } else {
            html += '<td style="padding: 8px; text-align: right; font-size: 12px; color: #ffffff;">' + displayRecord + '</td>';
        }
        html += '</tr>';
    });
    
    html += '</tbody></table></div>';
    return html;
}

// --- CFP DATA LOADING AND DISPLAY FUNCTIONS ---
async function loadCFPData() {
    const cfpContent = document.getElementById('league-cfp-content');
    if (!cfpContent) return;
    
    cfpContent.innerHTML = '<p style="color: #9ca3af;">Loading CFP rankings...</p>';
    
    try {
        // Get all documents from CFP collection
        const snapshot = await db.collection('CFP').get();
        
        if (snapshot.empty) {
            cfpContent.innerHTML = '<p style="color: #9ca3af;">No CFP rankings available.</p>';
            return;
        }
        
        // Convert to array and sort by Rk
        const rankings = snapshot.docs
            .map(doc => doc.data())
            .sort((a, b) => {
                const rankA = parseInt(a.Rk) || 999;
                const rankB = parseInt(b.Rk) || 999;
                return rankA - rankB;
            });
        
        if (rankings.length === 0) {
            cfpContent.innerHTML = '<p style="color: #9ca3af;">No CFP rankings available.</p>';
            return;
        }
        
        const html = createCFPTable(rankings);
        cfpContent.innerHTML = html;
        
    } catch (error) {
        console.error('Error loading CFP data:', error);
        cfpContent.innerHTML = '<p style="color: #ef4444;">Error loading CFP rankings.</p>';
    }
}

function createCFPTable(rankings) {
    let html = '<div class="cfp-standings" style="color: #ffffff;">';
    html += '<table class="standings-table" style="width: 100%; border-collapse: collapse; color: #ffffff; table-layout: fixed;">';
    html += '<colgroup>';
    html += '<col style="width: 50px;">';
    html += '<col style="width: auto;">';
    html += '<col style="width: 100px;">';
    html += '</colgroup>';
    html += '<thead>';
    html += '<tr style="background-color: #4a4a4a; font-size: 11px; font-weight: 600;">';
    html += '<th style="padding: 8px; text-align: center; border-bottom: 1px solid #666;">Rk</th>';
    html += '<th style="padding: 8px; text-align: left; border-bottom: 1px solid #666;">Team</th>';
    html += '<th style="padding: 8px; text-align: right; border-bottom: 1px solid #666;">Record</th>';
    html += '</tr>';
    html += '</thead>';
    html += '<tbody>';
    
    rankings.forEach((ranking, index) => {
        const rowStyle = index % 2 === 0 ? 'background-color: #2a2a2a;' : 'background-color: #1f1f1f;';
        html += '<tr style="' + rowStyle + '">';
        html += '<td style="padding: 8px; text-align: center; font-size: 12px; font-weight: 600; color: #ffffff;">' + (ranking.Rk || '') + '</td>';
        html += '<td style="padding: 8px; text-align: left; font-size: 12px; font-weight: 500; color: #ffffff;">' + (ranking.Team || '') + '</td>';
        html += '<td style="padding: 8px; text-align: right; font-size: 12px; color: #ffffff;">' + (ranking.Record || '') + '</td>';
        html += '</tr>';
    });
    
    html += '</tbody></table></div>';
    return html;
}

// --- SCHEDULE TABS INITIALIZATION ---
const scheduleTabsContainer = document.getElementById('schedule-tabs');
if (scheduleTabsContainer) {
    const todayScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="today"]');
    const yesterdayScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="yesterday"]');
    const upcomingScheduleTab = scheduleTabsContainer.querySelector('.schedule-tab[data-schedule-tab="upcoming"]');
    
    todayScheduleTab.addEventListener('click', () => {
        // Remove active class from all tabs and reset styling
        scheduleTabsContainer.querySelectorAll('.schedule-tab').forEach(tab => {
            tab.classList.remove('active');
            tab.style.backgroundColor = '#2a2a2a';
            tab.style.color = '#ccc';
            tab.style.borderBottom = 'none';
        });
        // Add active class and styling to clicked tab
        todayScheduleTab.classList.add('active');
        todayScheduleTab.style.backgroundColor = '#2a2a2a';
        todayScheduleTab.style.color = '#fff';
        todayScheduleTab.style.borderBottom = '2px solid #fff';
        
        // Show today content, hide other content
        document.getElementById('league-schedule-today-content').style.display = 'block';
        document.getElementById('league-schedule-yesterday-content').style.display = 'none';
        document.getElementById('league-schedule-upcoming-content').style.display = 'none';
    });
    
    // Yesterday tab commented out - functionality not working
    /*
    yesterdayScheduleTab.addEventListener('click', () => {
        // Remove active class from all tabs and reset styling
        scheduleTabsContainer.querySelectorAll('.schedule-tab').forEach(tab => {
            tab.classList.remove('active');
            tab.style.backgroundColor = '#2a2a2a';
            tab.style.color = '#ccc';
            tab.style.borderBottom = 'none';
        });
        // Add active class and styling to clicked tab
        yesterdayScheduleTab.classList.add('active');
        yesterdayScheduleTab.style.backgroundColor = '#2a2a2a';
        yesterdayScheduleTab.style.color = '#fff';
        yesterdayScheduleTab.style.borderBottom = '2px solid #fff';
        
        // Show yesterday content, hide other content
        document.getElementById('league-schedule-today-content').style.display = 'none';
        document.getElementById('league-schedule-yesterday-content').style.display = 'block';
        document.getElementById('league-schedule-upcoming-content').style.display = 'none';
        
        // Load yesterday's scores for the current league
        const currentLeagueHeader = document.getElementById('league-specific-header');
        if (currentLeagueHeader) {
            const leagueName = currentLeagueHeader.innerText;
            const leagueConfig = LEAGUE_DATA_CONFIG[leagueName];
            if (leagueConfig) {
                fetchYesterdayScoresForLeague(leagueConfig.leagueId, leagueName);
            }
        }
    });
    */
    
    upcomingScheduleTab.addEventListener('click', (event) => {
        // Remove active class from all tabs and reset styling
        scheduleTabsContainer.querySelectorAll('.schedule-tab').forEach(tab => {
            tab.classList.remove('active');
            tab.style.backgroundColor = '#2a2a2a';
            tab.style.color = '#ccc';
            tab.style.borderBottom = 'none';
        });
        // Add active class and styling to clicked tab
        upcomingScheduleTab.classList.add('active');
        upcomingScheduleTab.style.backgroundColor = '#2a2a2a';
        upcomingScheduleTab.style.color = '#fff';
        upcomingScheduleTab.style.borderBottom = '2px solid #fff';

        // Show upcoming content, hide other content
        document.getElementById('league-schedule-today-content').style.display = 'none';
        document.getElementById('league-schedule-yesterday-content').style.display = 'none';
        const upcomingContent = document.getElementById('league-schedule-upcoming-content');
        if (upcomingContent) {
            upcomingContent.style.display = 'flex';
        }
        
        // Get the current league key from the header
        const leagueHeader = document.getElementById('league-specific-header');
        let leagueKey = leagueHeader ? leagueHeader.innerText : null;
        
        // Normalize the league key (trim whitespace)
        if (leagueKey) {
            leagueKey = leagueKey.trim();
        }

        // Call the new function to load the upcoming schedule, passing the current leagueKey
        if (leagueKey) {
            loadUpcomingSchedule(leagueKey);
        }
    });
}
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const nwsltabs = document.getElementById('nwsltabs-NWSL');

  const feedMapNWSL = {
    headlines: "https://rss.app/feeds/zL71BDnU9LO5QpOP.xml",
    reddit: "https://rss.app/feeds/HL9rA42ELIkqWXJg.xml"
  };

  function fetchFeedNWSL(targetId, url) {
    const contentPane = document.querySelector(targetId);
    if (!contentPane) return;
    contentPane.innerHTML = '<p>Loading...</p>';

    const proxyUrl = 'https://api.allorigins.win/raw?url=';
    const finalUrl = proxyUrl + encodeURIComponent(url);

    fetch(finalUrl)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul style="margin:0; padding:0; list-style:none;">';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li style="margin-bottom:0.5em; padding:4px 0; border-bottom:1px solid #C9C8C7;">
              <a href="${link}" target="_blank" style="text-decoration:none; color:inherit;">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  if (nwsltabs) {
    nwsltabs.addEventListener('click', function(e) {
      if (e.target.classList.contains('headlines-tab')) {
        // Hide all panes
        document.querySelectorAll('#news-NWSL .news-feed-content')
          .forEach(p => p.style.display = 'none');
        // Remove active from all tabs
        document.querySelectorAll('#nwsltabs-NWSL .headlines-tab')
          .forEach(t => t.classList.remove('active'));

        const source = e.target.dataset.source;
        const targetPane = document.getElementById(source + '-feed-NWSL');
        if (targetPane) {
          targetPane.style.display = 'block';
          e.target.classList.add('active');
        }
        if (feedMapNWSL[source]) {
          fetchFeedNWSL(`#${source}-feed-NWSL`, feedMapNWSL[source]);
        }
      }
    });

    // initial load
    const initialActiveTab = document.querySelector('#nwsltabs-NWSL .headlines-tab.active');
    if (initialActiveTab) {
      const source = initialActiveTab.dataset.source;
      fetchFeedNWSL(`#${source}-feed-NWSL`, feedMapNWSL[source]);
    }
  }
});
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Ligue 1 - Direct feed load (no tabs)
  let ligue1FeedLoaded = false;
  
  function fetchFeedLigue1(url, contentPaneId) {
    const contentPane = document.getElementById(contentPaneId);
    if (!contentPane) return;
    if (ligue1FeedLoaded && contentPane.innerHTML && !contentPane.innerHTML.includes('Loading')) return;
    
    contentPane.innerHTML = '<p>Loading...</p>';

    fetch(url)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul>';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li>
              <a href="${link}" target="_blank">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
        ligue1FeedLoaded = true;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  // Load feed when section is shown
  const ligue1Section = document.getElementById('news-Ligue1');
  if (ligue1Section) {
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
          if (ligue1Section.style.display !== 'none' && !ligue1FeedLoaded) {
            const feedUrl = 'https://rss.app/feeds/tct5GyDJwZIxACdb.xml';
            fetchFeedLigue1(feedUrl, 'headlines-feed-Ligue1');
          }
        }
      });
    });
    observer.observe(ligue1Section, { attributes: true, attributeFilter: ['style'] });
    
    // Also check on section click events
    document.addEventListener('click', function(e) {
      if (e.target.closest('[data-section="Ligue1"]')) {
        setTimeout(() => {
          if (ligue1Section.style.display !== 'none' && !ligue1FeedLoaded) {
            const feedUrl = 'https://rss.app/feeds/tct5GyDJwZIxACdb.xml';
            fetchFeedLigue1(feedUrl, 'headlines-feed-Ligue1');
          }
        }, 100);
      }
    });
  }
});
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const ligamxtabs = document.getElementById('ligamxtabs-LigaMX');

  const feedMapLigaMX = {
    headlines: "https://rss.app/feeds/tr10VModrXb2evce.xml",
    breaking: "https://rss.app/feeds/jEo9SeX0mg1s2Zcy.xml",
    reddit: "https://rss.app/feeds/o3KVLBimGj35TqzR.xml"
  };

  function fetchFeedLigaMX(url, contentPaneId) {
    const contentPane = document.getElementById(contentPaneId);
    if (!contentPane) return;
    contentPane.innerHTML = '<p>Loading...</p>';

    const proxyUrl = 'https://api.allorigins.win/raw?url=';
    const finalUrl = proxyUrl + encodeURIComponent(url);

    fetch(finalUrl)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul>';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li>
              <a href="${link}" target="_blank">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  if (ligamxtabs) {
    ligamxtabs.addEventListener('click', function(e) {
      if (e.target.classList.contains('headlines-tab')) {
        document.querySelectorAll('#news-LigaMX .news-feed-content')
          .forEach(p => p.style.display = 'none');
        document.querySelectorAll('#ligamxtabs-LigaMX .headlines-tab')
          .forEach(t => t.classList.remove('active'));

        const source = e.target.dataset.source;
        const targetPaneId = `${source}-feed-LigaMX`;
        const targetPane = document.getElementById(targetPaneId);
        if (targetPane) {
          targetPane.style.display = 'block';
          e.target.classList.add('active');
        }
        const url = e.target.dataset.url;
        if (url) {
          fetchFeedLigaMX(url, targetPaneId);
        }
      }
    });

    const initialActiveTab = document.querySelector('#ligamxtabs-LigaMX .headlines-tab.active');
    if (initialActiveTab) {
      const source = initialActiveTab.dataset.source;
      const targetPaneId = `${source}-feed-LigaMX`;
      const url = initialActiveTab.dataset.url;
      fetchFeedLigaMX(url, targetPaneId);
    }
  }
});
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const uefaeuropaleaguetabs = document.getElementById('uefaeuropaleaguetabs-UEFAEuropaLeague');

  const feedMapUEFAEuropaLeague = {
    headlines: "https://rss.app/feeds/tw7ijzsLkAnmByMf.xml",
    breaking: "https://rss.app/feeds/Y86rdhcYGEJTzVVE.xml"
  };

  function fetchFeedUEFAEuropaLeague(url, contentPaneId) {
    const contentPane = document.getElementById(contentPaneId);
    if (!contentPane) return;
    contentPane.innerHTML = '<p>Loading...</p>';

    const proxyUrl = 'https://api.allorigins.win/raw?url=';
    const finalUrl = proxyUrl + encodeURIComponent(url);

    fetch(finalUrl)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul>';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li>
              <a href="${link}" target="_blank">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  if (uefaeuropaleaguetabs) {
    uefaeuropaleaguetabs.addEventListener('click', function(e) {
      if (e.target.classList.contains('headlines-tab')) {
        document.querySelectorAll('#news-UEFAEuropaLeague .news-feed-content')
          .forEach(p => p.style.display = 'none');
        document.querySelectorAll('#uefaeuropaleaguetabs-UEFAEuropaLeague .headlines-tab')
          .forEach(t => t.classList.remove('active'));

        const source = e.target.dataset.source;
        const targetPaneId = `${source}-feed-UEFAEuropaLeague`;
        const targetPane = document.getElementById(targetPaneId);
        if (targetPane) {
          targetPane.style.display = 'block';
          e.target.classList.add('active');
        }
        const url = e.target.dataset.url;
        if (url) {
          fetchFeedUEFAEuropaLeague(url, targetPaneId);
        }
      }
    });

    const initialActiveTab = document.querySelector('#uefaeuropaleaguetabs-UEFAEuropaLeague .headlines-tab.active');
    if (initialActiveTab) {
      const source = initialActiveTab.dataset.source;
      const targetPaneId = `${source}-feed-UEFAEuropaLeague`;
      const url = initialActiveTab.dataset.url;
      fetchFeedUEFAEuropaLeague(url, targetPaneId);
    }
  }
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // UEFA Conference League - Direct feed load (no tabs)
  let uefaConferenceLeagueFeedLoaded = false;

  function fetchFeedUEFAConferenceLeague(url, contentPaneId) {
    const contentPane = document.getElementById(contentPaneId);
    if (!contentPane) return;
    if (uefaConferenceLeagueFeedLoaded && contentPane.innerHTML && !contentPane.innerHTML.includes('Loading')) return;
    
    contentPane.innerHTML = '<p>Loading...</p>';

    fetch(url)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul>';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li>
              <a href="${link}" target="_blank">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
        uefaConferenceLeagueFeedLoaded = true;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  // Load feed when section is shown
  const uefaConferenceLeagueSection = document.getElementById('news-UEFAConferenceLeague');
  if (uefaConferenceLeagueSection) {
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
          if (uefaConferenceLeagueSection.style.display !== 'none' && !uefaConferenceLeagueFeedLoaded) {
            const feedUrl = 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-europaconferenceleague.xml';
            fetchFeedUEFAConferenceLeague(feedUrl, 'headlines-feed-UEFAConferenceLeague');
          }
        }
      });
    });
    observer.observe(uefaConferenceLeagueSection, { attributes: true, attributeFilter: ['style'] });
    
    // Also check on section click events
    document.addEventListener('click', function(e) {
      if (e.target.closest('[data-section="UEFAConferenceLeague"]')) {
        setTimeout(() => {
          if (uefaConferenceLeagueSection.style.display !== 'none' && !uefaConferenceLeagueFeedLoaded) {
            const feedUrl = 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-europaconferenceleague.xml';
            fetchFeedUEFAConferenceLeague(feedUrl, 'headlines-feed-UEFAConferenceLeague');
          }
        }, 100);
      }
    });
  }
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // UEFA Champions League - Direct bundle feed load (no tabs)
  let uefaChampionsLeagueFeedLoaded = false;
  
  function fetchFeedUEFAChampionsLeague(url, contentPaneId) {
    const contentPane = document.getElementById(contentPaneId);
    if (!contentPane) return;
    if (uefaChampionsLeagueFeedLoaded && contentPane.innerHTML && !contentPane.innerHTML.includes('Loading')) return;
    
    contentPane.innerHTML = '<p>Loading...</p>';

    fetch(url)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul>';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li>
              <a href="${link}" target="_blank">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
        uefaChampionsLeagueFeedLoaded = true;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  // Load feed when section is shown
  const uefaChampionsLeagueSection = document.getElementById('news-UEFAChampionsLeague');
  if (uefaChampionsLeagueSection) {
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
          if (uefaChampionsLeagueSection.style.display !== 'none' && !uefaChampionsLeagueFeedLoaded) {
            const feedUrl = 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/bundle/uefa-championsleague-news.xml';
            fetchFeedUEFAChampionsLeague(feedUrl, 'headlines-feed-UEFAChampionsLeague');
          }
        }
      });
    });
    observer.observe(uefaChampionsLeagueSection, { attributes: true, attributeFilter: ['style'] });
    
    // Also check on section click events
    document.addEventListener('click', function(e) {
      if (e.target.closest('[data-section="UEFAChampionsLeague"]')) {
        setTimeout(() => {
          if (uefaChampionsLeagueSection.style.display !== 'none' && !uefaChampionsLeagueFeedLoaded) {
            const feedUrl = 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/bundle/uefa-championsleague-news.xml';
            fetchFeedUEFAChampionsLeague(feedUrl, 'headlines-feed-UEFAChampionsLeague');
          }
        }, 100);
      }
    });
  }
});
</script>

		<script>
document.addEventListener('DOMContentLoaded', function() {
  const livgolftabs = document.getElementById('livgolftabs-LIVGolf');

  const feedMapLIVGolf = {
    headlines: "https://rss.app/feeds/teYHPC2ZpUGeMBx5.xml",
    breaking: "https://rss.app/feeds/InHgRAqAOeKlilq8.xml"
  };

  function fetchFeedLIVGolf(url, contentPaneId) {
    const contentPane = document.getElementById(contentPaneId);
    if (!contentPane) return;
    contentPane.innerHTML = '<p>Loading...</p>';

    const proxyUrl = 'https://api.allorigins.win/raw?url=';
    const finalUrl = proxyUrl + encodeURIComponent(url);

    fetch(finalUrl)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul>';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li>
              <a href="${link}" target="_blank">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  if (livgolftabs) {
    livgolftabs.addEventListener('click', function(e) {
      if (e.target.classList.contains('headlines-tab')) {
        document.querySelectorAll('#news-LIVGolf .news-feed-content')
          .forEach(p => p.style.display = 'none');
        document.querySelectorAll('#livgolftabs-LIVGolf .headlines-tab')
          .forEach(t => t.classList.remove('active'));

        const source = e.target.dataset.source;
        const targetPaneId = `${source}-feed-LIVGolf`;
        const targetPane = document.getElementById(targetPaneId);
        if (targetPane) {
          targetPane.style.display = 'block';
          e.target.classList.add('active');
        }
        const url = e.target.dataset.url;
        if (url) {
          fetchFeedLIVGolf(url, targetPaneId);
        }
      }
    });

    const initialActiveTab = document.querySelector('#livgolftabs-LIVGolf .headlines-tab.active');
    if (initialActiveTab) {
      const source = initialActiveTab.dataset.source;
      const targetPaneId = `${source}-feed-LIVGolf`;
      const url = initialActiveTab.dataset.url;
      fetchFeedLIVGolf(url, targetPaneId);
    }
  }
});
</script>

		<script>
document.addEventListener('DOMContentLoaded', function() {
  const indycarrtabs = document.getElementById('indycarrtabs-IndyCar');

  const feedMapIndyCar = {
    headlines: "https://rss.app/feeds/tBzOR3X3d0NpmoAA.xml",
    breaking: "https://rss.app/feeds/Zo7JsQDXIT8D0pCD.xml",
    reddit: "https://rss.app/feeds/8qBnW4yImPpMqMDD.xml"
  };

  function fetchFeedIndyCar(url, contentPaneId) {
    const contentPane = document.getElementById(contentPaneId);
    if (!contentPane) return;
    contentPane.innerHTML = '<p>Loading...</p>';

    const proxyUrl = 'https://api.allorigins.win/raw?url=';
    const finalUrl = proxyUrl + encodeURIComponent(url);

    fetch(finalUrl)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul>';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li>
              <a href="${link}" target="_blank">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  if (indycarrtabs) {
    indycarrtabs.addEventListener('click', function(e) {
      if (e.target.classList.contains('headlines-tab')) {
        document.querySelectorAll('#news-IndyCar .news-feed-content')
          .forEach(p => p.style.display = 'none');
        document.querySelectorAll('#indycarrtabs-IndyCar .headlines-tab')
          .forEach(t => t.classList.remove('active'));

        const source = e.target.dataset.source;
        const targetPaneId = `${source}-feed-IndyCar`;
        const targetPane = document.getElementById(targetPaneId);
        if (targetPane) {
          targetPane.style.display = 'block';
          e.target.classList.add('active');
        }
        const url = e.target.dataset.url;
        if (url) {
          fetchFeedIndyCar(url, targetPaneId);
        }
      }
    });

    const initialActiveTab = document.querySelector('#indycarrtabs-IndyCar .headlines-tab.active');
    if (initialActiveTab) {
      const source = initialActiveTab.dataset.source;
      const targetPaneId = `${source}-feed-IndyCar`;
      const url = initialActiveTab.dataset.url;
      fetchFeedIndyCar(url, targetPaneId);
    }
  }
});
</script>

		<script>
document.addEventListener('DOMContentLoaded', function() {
  let lpgatourFeedLoaded = false;

  function fetchFeedLPGATour(url, contentPaneId) {
    const contentPane = document.getElementById(contentPaneId);
    if (!contentPane) return;
    if (lpgatourFeedLoaded && contentPane.innerHTML && !contentPane.innerHTML.includes('Loading')) return;
    
    contentPane.innerHTML = '<p>Loading...</p>';

    fetch(url)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul>';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li>
              <a href="${link}" target="_blank">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
        lpgatourFeedLoaded = true;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  const lpgatourSection = document.getElementById('news-LPGATour');
  if (lpgatourSection) {
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
          if (lpgatourSection.style.display !== 'none' && !lpgatourFeedLoaded) {
            const feedUrl = 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-lpga.xml';
            fetchFeedLPGATour(feedUrl, 'headlines-feed-LPGATour');
        }
      }
    });
    });
    observer.observe(lpgatourSection, { attributes: true, attributeFilter: ['style'] });
    
    // Also check on section click events
    document.addEventListener('click', function(e) {
      if (e.target.closest('[data-section="LPGATour"]')) {
        setTimeout(() => {
          if (lpgatourSection.style.display !== 'none' && !lpgatourFeedLoaded) {
            const feedUrl = 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/newsnow-lpga.xml';
            fetchFeedLPGATour(feedUrl, 'headlines-feed-LPGATour');
          }
        }, 100);
      }
    });
  }
});
</script>

		<script>
document.addEventListener('DOMContentLoaded', function() {
  const trackandfieldtabs = document.getElementById('trackandfieldtabs-TrackAndField');

  const feedMapTrackAndField = {
    headlines: "https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/trackandfieldnews.xml",
    breaking: "https://rss.app/feeds/VqavgJOoX0LKkfkb.xml"
  };

  function fetchFeedTrackAndField(url, contentPaneId) {
    const contentPane = document.getElementById(contentPaneId);
    if (!contentPane) return;
    contentPane.innerHTML = '<p>Loading...</p>';

    const proxyUrl = 'https://api.allorigins.win/raw?url=';
    const finalUrl = proxyUrl + encodeURIComponent(url);

    fetch(finalUrl)
      .then(r => r.text())
      .then(str => {
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(str, "text/xml");
        const items = xmlDoc.querySelectorAll("item");
        let html = '<ul>';
        items.forEach(el => {
          const title = el.querySelector("title")?.textContent || 'No title';
          const link = el.querySelector("link")?.textContent || '#';
          html += `
            <li>
              <a href="${link}" target="_blank">
                ${title}
              </a>
            </li>`;
        });
        html += '</ul>';
        contentPane.innerHTML = html;
      })
      .catch(err => {
        console.error("Error fetching RSS feed:", err);
        contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
      });
  }

  if (trackandfieldtabs) {
    trackandfieldtabs.addEventListener('click', function(e) {
      if (e.target.classList.contains('headlines-tab')) {
        document.querySelectorAll('#news-TrackAndField .news-feed-content')
          .forEach(p => p.style.display = 'none');
        document.querySelectorAll('#trackandfieldtabs-TrackAndField .headlines-tab')
          .forEach(t => t.classList.remove('active'));

        const source = e.target.dataset.source;
        const targetPaneId = `${source}-feed-TrackAndField`;
        const targetPane = document.getElementById(targetPaneId);
        if (targetPane) {
          targetPane.style.display = 'block';
          e.target.classList.add('active');
        }
        const url = e.target.dataset.url;
        if (url) {
          fetchFeedTrackAndField(url, targetPaneId);
        }
      }
    });

    const initialActiveTab = document.querySelector('#trackandfieldtabs-TrackAndField .headlines-tab.active');
    if (initialActiveTab) {
      const source = initialActiveTab.dataset.source;
      const targetPaneId = `${source}-feed-TrackAndField`;
      const url = initialActiveTab.dataset.url;
      fetchFeedTrackAndField(url, targetPaneId);
    }
  }
});
</script>

		<script>
document.addEventListener('DOMContentLoaded', function() {
    const contentPaneNCAASoftball = document.getElementById('breaking-content-NCAASoftball');
    const urlNCAASoftball = document.querySelector('#news-NCAASoftball .news-tab').dataset.url;

    function fetchFeedNCAASoftball(url, contentPane) {
        if (!contentPane) return;
        contentPane.innerHTML = '<p>Loading...</p>';
        const proxyUrl = 'https://api.allorigins.win/raw?url=';
        const finalUrl = proxyUrl + encodeURIComponent(url);
        fetch(finalUrl)
            .then(r => r.text())
            .then(str => {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(str, "text/xml");
                const items = xmlDoc.querySelectorAll("item");
                let html = '<ul>';
                items.forEach(el => {
                    const title = el.querySelector("title")?.textContent || 'No title';
                    const link = el.querySelector("link")?.textContent || '#';
                    html += `
                    <li>
                        <a href="${link}" target="_blank">
                            ${title}
                        </a>
                    </li>`;
                });
                html += '</ul>';
                contentPane.innerHTML = html;
            })
            .catch(err => {
                console.error("Error fetching RSS feed:", err);
                contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
            });
    }

    if (urlNCAASoftball && contentPaneNCAASoftball) {
        fetchFeedNCAASoftball(urlNCAASoftball, contentPaneNCAASoftball);
    }
});
</script>

		<script>
document.addEventListener('DOMContentLoaded', function() {
    const contentPaneNCAAW = document.getElementById('breaking-content-NCAAW');
    const urlNCAAW = document.querySelector('#news-NCAAW .news-tab').dataset.url;

    function fetchFeedNCAAW(url, contentPane) {
        if (!contentPane) return;
        contentPane.innerHTML = '<p>Loading...</p>';
        const proxyUrl = 'https://api.allorigins.win/raw?url=';
        const finalUrl = proxyUrl + encodeURIComponent(url);
        fetch(finalUrl)
            .then(r => r.text())
            .then(str => {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(str, "text/xml");
                const items = xmlDoc.querySelectorAll("item");
                let html = '<ul>';
                items.forEach(el => {
                    const title = el.querySelector("title")?.textContent || 'No title';
                    const link = el.querySelector("link")?.textContent || '#';
                    html += `
                    <li>
                        <a href="${link}" target="_blank">
                            ${title}
                        </a>
                    </li>`;
                });
                html += '</ul>';
                contentPane.innerHTML = html;
            })
            .catch(err => {
                console.error("Error fetching RSS feed:", err);
                contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
            });
    }

    if (urlNCAAW && contentPaneNCAAW) {
        fetchFeedNCAAW(urlNCAAW, contentPaneNCAAW);
    }
});
</script>

		<script>
document.addEventListener('DOMContentLoaded', function() {
    const contentPaneNCAABaseball = document.getElementById('breaking-content-NCAABaseball');
    const urlNCAABaseball = document.querySelector('#news-NCAABaseball .news-tab').dataset.url;

    function fetchFeedNCAABaseball(url, contentPane) {
        if (!contentPane) return;
        contentPane.innerHTML = '<p>Loading...</p>';
        const proxyUrl = 'https://api.allorigins.win/raw?url=';
        const finalUrl = proxyUrl + encodeURIComponent(url);
        fetch(finalUrl)
            .then(r => r.text())
            .then(str => {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(str, "text/xml");
                const items = xmlDoc.querySelectorAll("item");
                let html = '<ul>';
                items.forEach(el => {
                    const title = el.querySelector("title")?.textContent || 'No title';
                    const link = el.querySelector("link")?.textContent || '#';
                    html += `
                    <li>
                        <a href="${link}" target="_blank">
                            ${title}
                        </a>
                    </li>`;
                });
                html += '</ul>';
                contentPane.innerHTML = html;
            })
            .catch(err => {
                console.error("Error fetching RSS feed:", err);
                contentPane.innerHTML = `<p>Failed to load news. Please try again later.</p>`;
            });
    }

    if (urlNCAABaseball && contentPaneNCAABaseball) {
        fetchFeedNCAABaseball(urlNCAABaseball, contentPaneNCAABaseball);
    }
});
</script>
 
<!-- Videos Column JavaScript -->
<script>
// Videos RSS Feed Configuration
const VIDEOS_CONFIG = {
    // Single tab pages (just "Videos" header)
    singleTab: {
        'Home': [
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nba.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-formula1.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-mlb.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-espncfb.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-laliga.xml',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLmkjXprBSRGPTiKLn8i8KIdN5I3nPP9sx',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLXEMPXZ3PY1gD1F0DJeQYZjN_CKWsH911',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-seriea.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nwsl.xml',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLSrXjFYZsRuP1HW8mkTM7Z5q2PExbltfj',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLXEMPXZ3PY1hMzinDc1TvSm8U2NUyz-0E',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-bundesliga.xml',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLtKVUJ3gZpTu0ApQHGUVeZa-tez87ucO6',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nhl.xml',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLcj4z4KsbIoVYKuevRiaE94KlwPuXqLHy',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PL87LlAF-2PIwKpIUaKO4_p5QNmjxhYUFG',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLJOfoNRMTY5z5QvxedrpMNi01zflJJpUN',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLkwBiY2Dq-oaG6vHAhmcCOc3Q_-To2dlA',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nfl.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-cbssportscfb.xml'
        ],
        'MLS': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-mls.xml',
        'NBA': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nba.xml',
        'LaLiga': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-laliga.xml',
        'UFC': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-ufc.xml',
        'Bundesliga': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-bundesliga.xml',
        'FormulaOne': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-formula1.xml',
        'NCAAM': [
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLn3nHXu50t5zIzgZhRCXRsZcRIfapIxEV.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLSoN6Th-EepPKUIUbnOMTwOpdBb5eNonz.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLSrXjFYZsRuMeW1ttMkXz4cQy9bap9fIB.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLhh7fyF6r5qVV2_RonsHodwkwe-GGt_Jl.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PL2RRF9GtC9s1v7L7tO5Astcl4Z8xq3BqQ.xml'
        ],
        'NCAAW': [
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLn3nHXu50t5ycOprei1VvRrS6rgFyNamo.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLhh7fyF6r5qXCuhDgwdKKfCIzXkgF4fqx.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLSrXjFYZsRuPigBvTe-tB2PWDWZr6Eks_.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PL2RRF9GtC9s32jHtkN74wyLXRtTR5Ash8.xml'
        ],
        'WNBA': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-wnba.xml',
        'Boxing': [
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-premierboxingchampions.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-toprank.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-matchroomboxing.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-daznboxing.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-ringmagazine.xml'
        ],
        'FACup': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-facup.xml',
        'Tennis': [
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-wta.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-tennischannel.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-tennistv.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-atptour.xml'
        ],
        'PremierLeague': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-premierleague-playlist-2.xml',
        'UEFAEuropaLeague': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLF1A3xcj_XjauRnOMIAX0CQbMhJbbcDvN.xml',
        'UEFAConferenceLeague': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLF1A3xcj_XjYWfzeXvnO8Uy8K3Q8JIQ5z.xml',
        'LIVGolf': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-livgolf.xml',
        'MotoGP': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-motogp.xml',
        'LPGATour': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-lpga.xml',
        'PGATour': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-pgatour.xml',
        'NASCARCupSeries': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nascar.xml',
        'TrackAndField': 'mgPf2SFmqKywYMCA',
        'LigaMX': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-ligamx.xml',
        'SerieA': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-seriea.xml',
        'Ligue1': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-ligue1.xml',
        'IndyCar': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-indycar.xml',
        'NWSL': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nwsl.xml',
        'UEFAChampionsLeague': 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-premierleague-playlist-3.xml',
        'NCAABaseball': 'vSnjvx8lfhvdkJCI',
        'NCAASoftball': '0icHbpkIigOmSTpJ',
        'Soccer': [
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-laliga.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-seriea.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nwsl.xml',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLXEMPXZ3PY1hMzinDc1TvSm8U2NUyz-0E',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-bundesliga.xml',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLcj4z4KsbIoVYKuevRiaE94KlwPuXqLHy',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLkwBiY2Dq-oaG6vHAhmcCOc3Q_-To2dlA',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-ligue1.xml',
            'https://www.youtube.com/feeds/videos.xml?channel_id=UCChcWqwYXCEs657MQ00qVWA', // @thefacup
            'https://www.youtube.com/feeds/videos.xml?channel_id=UCq8BPLXtFeiSFOvmJrknWGg', // @ligabbvamx
            'https://www.youtube.com/feeds/videos.xml?channel_id=UC7am34-1rGU_ky1vWYnoOJQ', // @GermanFootball
            'https://www.youtube.com/feeds/videos.xml?channel_id=UCET00YnetHT7tOpu12v8jxg', // @cbssportsgolazo
            'https://www.youtube.com/feeds/videos.xml?channel_id=UCf8YPuOWXlpTS7RibaJlP4g', // @CBSSportsGolazoEurope
            'https://www.youtube.com/feeds/videos.xml?channel_id=UCh4tni-ICN9z0eMIPcf2r2g', // @golazoamerica
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLF1A3xcj_XjYWfzeXvnO8Uy8K3Q8JIQ5z',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLF1A3xcj_XjahwjjdI5ovP1Rg9gKuY6tX',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLF1A3xcj_XjauRnOMIAX0CQbMhJbbcDvN',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLF1A3xcj_XjbjS6GrxUE_6FUdBsqJC8J7',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLF1A3xcj_XjZK-NiI5-H2L2I2WpWXn-b0'
        ],
        'NCAAF': [
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLmkjXprBSRGPTiKLn8i8KIdN5I3nPP9sx',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLSrXjFYZsRuP1HW8mkTM7Z5q2PExbltfj',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLtKVUJ3gZpTu0ApQHGUVeZa-tez87ucO6',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PL87LlAF-2PIwKpIUaKO4_p5QNmjxhYUFG',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLJOfoNRMTY5z5QvxedrpMNi01zflJJpUN',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-espncfb.xml',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-cfbonfox.xml',
            'https://www.youtube.com/feeds/videos.xml?playlist_id=PLXEMPXZ3PY1gD1F0DJeQYZjN_CKWsH911',
            'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-cbssportscfb.xml'
        ]
    },
    
    // Two tab pages ("Videos" header + "Highlights" and "All Videos" tabs)
    twoTabs: {
        'NFL': {
            highlights: 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/youtube/playlist/PLRdw3IjKY2gmO5mZRxR3YNII5qHYs_3RY.xml',
            allVideos: 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nfl.xml'
        },
        'MLB': {
            highlights: 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-mlb-playlist.xml',
            allVideos: 'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-mlb.xml'
        },
        'NHL': {
            highlights: 'z81NfN1oT5owhdbQ', // RECAPS tab - RSS.app widget ID
            allVideos: [
                'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/nhl-video-recaps.xml',
                'https://rss-feed-service-vp7bkrygcq-uc.a.run.app/feeds/youtube-nhl.xml'
            ]
        }
        // Add more two-tab configurations as needed
    }
};

// Initialize Videos Column
function initializeVideosColumn(currentSection) {
    const videosColumn = document.getElementById('videos-column');
    const videosTabs = document.getElementById('videos-tabs');
    const videosContent = document.getElementById('videos-content');
    
    if (!videosColumn) return;
    
    // Check if current section has two tabs
    if (VIDEOS_CONFIG.twoTabs[currentSection]) {
        // Show tabs for two-tab configuration
        videosTabs.style.display = 'flex';
        loadVideosWithTabs(currentSection);
    } else if (VIDEOS_CONFIG.singleTab[currentSection]) {
        // Hide tabs for single-tab configuration
        videosTabs.style.display = 'none';
        loadSingleVideoFeed(currentSection);
    } else {
        // Default: hide tabs and show placeholder
        videosTabs.style.display = 'none';
        videosContent.innerHTML = '<div style="padding: 20px; color: #888; text-align: center;">No videos available for this section.</div>';
    }
}

// Load videos for single tab configuration
function loadSingleVideoFeed(section) {
    const widgetId = VIDEOS_CONFIG.singleTab[section];
    const videosContent = document.getElementById('dynamicVideosContent');
    
    if (!widgetId || !videosContent) return;
    
    displayRSSWidget(widgetId, videosContent);
}

// Load videos for two tab configuration
function loadVideosWithTabs(section) {
    const config = VIDEOS_CONFIG.twoTabs[section];
    if (!config) return;
    
    // Set up tab event listeners
    let highlightsTab = document.querySelector('.videos-tab[data-tab="highlights"]');
    let allVideosTab = document.querySelector('.videos-tab[data-tab="all-videos"]');
    const videosContent = document.getElementById('dynamicVideosContent');
    
    // Remove any existing event listeners by cloning and replacing the elements
    // This prevents duplicate event listeners from accumulating
    if (highlightsTab && highlightsTab.parentNode) {
        const newHighlightsTab = highlightsTab.cloneNode(true);
        highlightsTab.parentNode.replaceChild(newHighlightsTab, highlightsTab);
        highlightsTab = newHighlightsTab;
    }
    if (allVideosTab && allVideosTab.parentNode) {
        const newAllVideosTab = allVideosTab.cloneNode(true);
        allVideosTab.parentNode.replaceChild(newAllVideosTab, allVideosTab);
        allVideosTab = newAllVideosTab;
    }
    
    // Customize tab labels for NHL and NFL, reset for others
    if (section === 'NHL') {
        if (highlightsTab) {
            highlightsTab.textContent = 'RECAPS';
        }
        if (allVideosTab) {
            allVideosTab.textContent = 'ALL VIDEOS';
        }
    } else if (section === 'NFL') {
        if (highlightsTab) {
            highlightsTab.textContent = 'HIGHLIGHTS';
        }
        if (allVideosTab) {
            allVideosTab.textContent = 'ALL VIDEOS';
        }
    } else {
        // Reset to default labels for other sections
        if (highlightsTab) {
            highlightsTab.textContent = 'HIGHLIGHTS';
        }
        if (allVideosTab) {
            allVideosTab.textContent = 'ALL VIDEOS';
        }
    }
    
    // Clear container before setting up new listeners
    if (videosContent) {
        videosContent.innerHTML = '';
    }
    
    // Store section-specific config in a way that won't be affected by section changes
    const highlightsFeed = config.highlights;
    const allVideosFeed = config.allVideos;
    
    if (highlightsTab) {
        highlightsTab.addEventListener('click', () => {
            switchVideosTab('highlights');
            const container = document.getElementById('dynamicVideosContent');
            if (container) {
                container.innerHTML = ''; // Clear before loading
                displayRSSWidget(highlightsFeed, container);
            }
        });
    }
    
    if (allVideosTab) {
        allVideosTab.addEventListener('click', () => {
            switchVideosTab('all-videos');
            const container = document.getElementById('dynamicVideosContent');
            if (container) {
                container.innerHTML = ''; // Clear before loading
                displayRSSWidget(allVideosFeed, container);
            }
        });
    }
    
    // Load highlights by default
    switchVideosTab('highlights');
    if (videosContent) {
        videosContent.innerHTML = ''; // Clear before loading
        displayRSSWidget(highlightsFeed, videosContent);
    }
}
// Switch between video tabs
function switchVideosTab(activeTab) {
    const tabs = document.querySelectorAll('.videos-tab');
    tabs.forEach(tab => {
        tab.classList.remove('active');
        if (tab.dataset.tab === activeTab) {
            tab.classList.add('active');
        }
    });
}

// Display RSS.app widget or custom RSS feed
function displayRSSWidget(widgetId, container) {
    if (!widgetId || !container) return;
    
    // Check if widgetId is an array (multiple feeds)
    if (Array.isArray(widgetId)) {
        loadCustomRSSFeed(widgetId, container);
        return;
    }
    
    // Check if widgetId is a URL (custom RSS feed) or an ID (RSS.app widget)
    if (widgetId.startsWith('http://') || widgetId.startsWith('https://')) {
        // Custom RSS feed URL - load directly
        loadCustomRSSFeed(widgetId, container);
    } else {
        // RSS.app widget ID - use RSS.app widget
        container.innerHTML = '<rssapp-feed id="' + widgetId + '"></rssapp-feed>';
        
        // Only add the script tag once
        if (!document.querySelector('script[src="https://widget.rss.app/v1/feed.js"]')) {
            const script = document.createElement('script');
            script.src = 'https://widget.rss.app/v1/feed.js';
            script.type = 'text/javascript';
            script.async = true;
            document.head.appendChild(script);
        }
    }
}

// Initialize videos when page loads
document.addEventListener('DOMContentLoaded', function() {
    // Initialize with Home section by default
    initializeVideosColumn('Home');
    
    // Listen for section changes (when user clicks on different leagues)
    const menuItems = document.querySelectorAll('#menuList li[data-section]');
    menuItems.forEach(item => {
        item.addEventListener('click', function() {
            const section = this.dataset.section;
            initializeVideosColumn(section);
        });
    });
});


// Mobile Responsiveness JavaScript
document.addEventListener('DOMContentLoaded', function() {
    let currentMobileLeague = 'Home';
    
    // Mobile toolbar button handlers
    const mobileLeagueBtn = document.getElementById('mobile-league-btn');
    const mobileGamesBtn = document.getElementById('mobile-games-btn');
    const mobileNewsBtn = document.getElementById('mobile-news-btn');
    const mobileSocialBtn = document.getElementById('mobile-social-btn');
    const mobileVideosBtn = document.getElementById('mobile-videos-btn');
    const mobileLeagueMenu = document.getElementById('mobile-league-menu');
    const mobileLeagueList = document.getElementById('mobile-league-list');
    
    // Show specific column on mobile
    function showMobileColumn(columnType) {
        try {
            
            // Scroll to top when switching columns on mobile
            window.scrollTo(0, 0);
            
            // Hide all columns
            document.querySelectorAll('.column').forEach(col => {
                col.classList.remove('mobile-active');
            });
            
            // Show the appropriate column based on current league and column type
            if (columnType === 'games') {
                if (currentMobileLeague === 'Home') {
                    document.getElementById('games-column')?.classList.add('mobile-active');
                } else {
                    document.getElementById('league-specific-column')?.classList.add('mobile-active');
                }
            } else if (columnType === 'news') {
                document.querySelector('.column.news')?.classList.add('mobile-active');
            } else if (columnType === 'social') {
                document.querySelector('.column.social')?.classList.add('mobile-active');
            } else if (columnType === 'videos') {
                document.querySelector('.column.videos-column')?.classList.add('mobile-active');
            }
            
            document.querySelectorAll('.featured-subheader').forEach(header => {
                header.style.display = columnType === 'games' ? '' : 'none';
            });
            
            // Update toolbar button states
            document.querySelectorAll('.mobile-toolbar-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`mobile-${columnType}-btn`)?.classList.add('active');
            
        } catch (error) {
            console.error('Error in showMobileColumn:', error);
        }
    }
    
    // Populate mobile league menu
    function populateMobileLeagueMenu() {
        if (!mobileLeagueList) return;
        
        mobileLeagueList.innerHTML = '';
        
        // Create mobile league list that matches desktop order exactly
        const mobileLeagues = [
            { section: 'Home', text: 'ALL' },
            { section: 'NFL', text: 'NFL' },
            { section: 'NBA', text: 'NBA' },
            { section: 'MLB', text: 'MLB' },
            { section: 'NHL', text: 'NHL' },
            { section: 'Soccer', text: 'Soccer' },
            { section: 'UEFAChampionsLeague', text: '    UEFA Champions League', indent: true },
            { section: 'PremierLeague', text: '    Premier League', indent: true },
            { section: 'MLS', text: '    MLS', indent: true },
            { section: 'LaLiga', text: '    LaLiga', indent: true },
            { section: 'SerieA', text: '    Serie A', indent: true },
            { section: 'Bundesliga', text: '    Bundesliga', indent: true },
            { section: 'FACup', text: '    FA Cup', indent: true },
            { section: 'LigaMX', text: '    Liga MX', indent: true },
            { section: 'NWSL', text: '    NWSL', indent: true },
            { section: 'Ligue1', text: '    Ligue 1', indent: true },
            { section: 'UEFAEuropaLeague', text: '    UEFA Europa League', indent: true },
            { section: 'UEFAConferenceLeague', text: '    UEFA Conference League', indent: true },
            { section: 'FormulaOne', text: 'Formula One' },
            { section: 'NCAAF', text: 'NCAAF' },
            { section: 'PGATour', text: 'PGA Tour' },
            { section: 'UFC', text: 'UFC' },
            { section: 'Boxing', text: 'Boxing' },
            { section: 'NASCARCupSeries', text: 'NASCAR Cup Series' },
            { section: 'Tennis', text: 'Tennis' },
            { section: 'WNBA', text: 'WNBA' },
            { section: 'LIVGolf', text: 'LIV Golf' },
            { section: 'IndyCar', text: 'IndyCar' },
            { section: 'NCAAM', text: 'NCAAM' },
            { section: 'NCAAW', text: 'NCAAW' },
            // { section: 'NCAABaseball', text: 'NCAA Baseball' },
            // { section: 'NCAASoftball', text: 'NCAA Softball' },
            { section: 'MotoGP', text: 'MotoGP' },
            { section: 'LPGATour', text: 'LPGA Tour' }
            // { section: 'TrackAndField', text: 'Track & Field' }
        ];
        
        mobileLeagues.forEach(league => {
            const li = document.createElement('li');
            li.textContent = league.text;
            li.dataset.section = league.section;
            li.addEventListener('click', () => {
                selectMobileLeague(league.section, league.text);
            });
            mobileLeagueList.appendChild(li);
        });
    }
    
    // Select league on mobile - use desktop functionality exactly
    function selectMobileLeague(section, displayName) {
        try {
            currentMobileLeague = section;
            
            // Scroll to top when switching leagues on mobile
            window.scrollTo(0, 0);
            
            // Update league button text
            if (mobileLeagueBtn) {
                const span = mobileLeagueBtn.querySelector('span:first-child');
                if (span) {
                    span.textContent = displayName;
                }
            }
            
            // Use the exact same logic as desktop by simulating a click on the desktop menu item
            const desktopMenuItem = document.querySelector(`#menuList-123 li[data-section="${section}"]`);
            if (desktopMenuItem) {
                // Temporarily remove mobile-active classes to prevent conflicts
                document.querySelectorAll('.column').forEach(col => col.classList.remove('mobile-active'));
                // Trigger the desktop click handler
                desktopMenuItem.click();
            }
            
            // Close menu and show news column
            if (mobileLeagueMenu) {
                mobileLeagueMenu.style.display = 'none';
            }
            showMobileColumn('news');
            
            
        } catch (error) {
            console.error('Error in mobile league selection:', error);
        }
    }
    
    // Event listeners
    if (mobileLeagueBtn) {
        mobileLeagueBtn.addEventListener('click', () => {
            mobileLeagueMenu.style.display = 'block';
        });
    }
    
    if (mobileGamesBtn) {
        mobileGamesBtn.addEventListener('click', () => showMobileColumn('games'));
    }
    
    if (mobileNewsBtn) {
        mobileNewsBtn.addEventListener('click', () => showMobileColumn('news'));
    }
    
    if (mobileSocialBtn) {
        mobileSocialBtn.addEventListener('click', () => showMobileColumn('social'));
    }
    
    if (mobileVideosBtn) {
        mobileVideosBtn.addEventListener('click', () => showMobileColumn('videos'));
    }
    
    // Close mobile league menu
    const closeBtn = mobileLeagueMenu?.querySelector('.close-btn');
    if (closeBtn) {
        closeBtn.addEventListener('click', () => {
            mobileLeagueMenu.style.display = 'none';
        });
    }
    
    // Close menu when clicking outside
    if (mobileLeagueMenu) {
        mobileLeagueMenu.addEventListener('click', (e) => {
            if (e.target === mobileLeagueMenu) {
                mobileLeagueMenu.style.display = 'none';
            }
        });
    }
    
    // Initialize mobile interface
    populateMobileLeagueMenu();
    
    // Show news column by default on mobile - more robust check
    function initializeMobileContent() {
        const toolbar = document.getElementById('mobile-bottom-toolbar');
        const isToolbarVisible = toolbar && window.getComputedStyle(toolbar).display !== 'none';
        
        if (isToolbarVisible) {
            showMobileColumn('news');
        }
    }
    
    // Check immediately
    initializeMobileContent();
    
    // Also check after delays in case CSS is still loading
    setTimeout(initializeMobileContent, 100);
    setTimeout(initializeMobileContent, 500);
    
    // Add resize listener to handle window resizing
    window.addEventListener('resize', () => {
        setTimeout(initializeMobileContent, 50);
    });
});

// Standings tab functions
function showNFLTab(conference) {
    console.log('showNFLTab called with conference:', conference);
    document.getElementById('nfl-afc-content').classList.remove('active');
    document.getElementById('nfl-nfc-content').classList.remove('active');
    document.getElementById('nfl-afc-tab').classList.remove('active');
    document.getElementById('nfl-nfc-tab').classList.remove('active');
    
    document.getElementById('nfl-' + conference + '-content').classList.add('active');
    document.getElementById('nfl-' + conference + '-tab').classList.add('active');
    console.log('Tab switching completed');
}

function showMLBTab(league) {
    document.getElementById('mlb-al-content').classList.remove('active');
    document.getElementById('mlb-nl-content').classList.remove('active');
    document.getElementById('mlb-al-tab').classList.remove('active');
    document.getElementById('mlb-nl-tab').classList.remove('active');
    
    document.getElementById('mlb-' + league + '-content').classList.add('active');
    document.getElementById('mlb-' + league + '-tab').classList.add('active');
}

function showNBATab(conference) {
    document.getElementById('nba-east-content').classList.remove('active');
    document.getElementById('nba-west-content').classList.remove('active');
    document.getElementById('nba-east-tab').classList.remove('active');
    document.getElementById('nba-west-tab').classList.remove('active');
    
    document.getElementById('nba-' + conference + '-content').classList.add('active');
    document.getElementById('nba-' + conference + '-tab').classList.add('active');
}

function showNHLTab(conference) {
    document.getElementById('nhl-east-content').classList.remove('active');
    document.getElementById('nhl-west-content').classList.remove('active');
    document.getElementById('nhl-east-tab').classList.remove('active');
    document.getElementById('nhl-west-tab').classList.remove('active');
    
    document.getElementById('nhl-' + conference + '-content').classList.add('active');
    document.getElementById('nhl-' + conference + '-tab').classList.add('active');
}

function showMLSTab(conference) {
    document.getElementById('mls-east-content').classList.remove('active');
    document.getElementById('mls-west-content').classList.remove('active');
    document.getElementById('mls-east-tab').classList.remove('active');
    document.getElementById('mls-west-tab').classList.remove('active');
    
    document.getElementById('mls-' + conference + '-content').classList.add('active');
    document.getElementById('mls-' + conference + '-tab').classList.add('active');
}

// ============================================================
// AUTO-REFRESH: Smart Background Data Updates Every 2 Minutes
// ============================================================
let autoRefreshInterval = null;
let lastRefreshTime = Date.now();

async function smartBackgroundRefresh() {
    try {
        console.log('🔄 Auto-refresh: Checking for updates...');
        const startTime = Date.now();
        
        // Check which tab is currently active (using correct selectors)
        const gamesTabsContainer = document.getElementById('games-tabs');
        const todayTab = gamesTabsContainer?.querySelector('.games-tab[data-tab="today"]');
        const scoresTab = gamesTabsContainer?.querySelector('.games-tab[data-tab="scores"]');
        const isTodayTabActive = todayTab && todayTab.classList.contains('active');
        const isScoresTabActive = scoresTab && scoresTab.classList.contains('active');
        
        // Check if we're on the home page
        const homeMenuItem = document.querySelector('#menuList li[data-section="Home"]');
        const isOnHomePage = homeMenuItem && homeMenuItem.classList.contains('selected');
        
        // Only refresh if on home page and today/scores tab is active
        if (isOnHomePage && (isTodayTabActive || isScoresTabActive)) {
            // Preserve scroll position
            const todayContent = document.getElementById('tv-listings-today');
            const scoresContent = document.getElementById('tv-listings-scores');
            const activeContent = isTodayTabActive ? todayContent : scoresContent;
            const scrollPosition = activeContent ? activeContent.scrollTop : 0;
            
            // Firestore listeners should automatically update when data changes
            // But we can force a refresh by re-subscribing if needed
            if (isTodayTabActive) {
                console.log('🔄 Auto-refresh: Today tab active - Firestore listeners will auto-update');
                // Firestore listeners are already active and will update automatically
                // Just log that we're checking
                const gamesCount = document.querySelectorAll('#games .game-row').length;
                console.log(`📊 Current games displayed: ${gamesCount}`);
            } else if (isScoresTabActive && typeof fetchYesterdayScores === 'function') {
                console.log('🔄 Auto-refresh: Refreshing scores...');
                fetchYesterdayScores();
            }
            
            // Restore scroll position after a brief delay
            setTimeout(() => {
                if (activeContent && scrollPosition > 0) {
                    activeContent.scrollTop = scrollPosition;
                }
            }, 100);
            
            const duration = Date.now() - startTime;
            console.log(`✅ Auto-refresh check complete (${duration}ms)`);
            lastRefreshTime = Date.now();
        } else {
            console.log('⏭️  Auto-refresh skipped (not on home page or not on today/scores tab)');
        }
    } catch (error) {
        console.error('❌ Auto-refresh error:', error);
    }
}

// Start auto-refresh when page loads
function initializeAutoRefresh() {
    // Clear any existing interval
    if (autoRefreshInterval) {
        clearInterval(autoRefreshInterval);
    }
    
    // Start auto-refresh every 2 minutes (120000ms)
    autoRefreshInterval = setInterval(smartBackgroundRefresh, 120000);
    console.log('✅ Auto-refresh initialized: Will update every 2 minutes');
    
    // Show indicator in console when next refresh will occur
    const nextRefreshTime = new Date(Date.now() + 120000);
    console.log(`⏰ Next auto-refresh at: ${nextRefreshTime.toLocaleTimeString()}`);
}

// Initialize auto-refresh when page is fully loaded
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeAutoRefresh);
} else {
    // DOM already loaded
    initializeAutoRefresh();
}

// Log refresh status every 30 seconds (optional - for debugging)
setInterval(() => {
    const timeSinceLastRefresh = Math.floor((Date.now() - lastRefreshTime) / 1000);
    const timeUntilNextRefresh = 120 - (timeSinceLastRefresh % 120);
    console.log(`🕐 Auto-refresh status: Last refresh ${timeSinceLastRefresh}s ago, next in ${timeUntilNextRefresh}s`);
}, 30000);

</script>
 
    <script>
    // Simple function to ensure full height
    function ensureFullHeight() {
      const container = document.querySelector('.container');
      if (container) {
        container.style.height = 'calc(100vh - 20px)';
      }
    }
    
    window.addEventListener('load', ensureFullHeight);
    window.addEventListener('resize', ensureFullHeight);
  </script>
  
  <script>
    // Support button animation - wait 5 seconds then slide up
    // setTimeout(function() {
    //   const supportButton = document.getElementById('supportButton');
    //   if (supportButton) {
    //     supportButton.classList.add('visible');
    //   }
    // }, 5000);
  </script>
  </body>
</html>
